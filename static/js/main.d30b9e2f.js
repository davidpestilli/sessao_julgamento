/*! For license information please see main.d30b9e2f.js.LICENSE.txt */
(()=>{"use strict";var t={4:(t,e,i)=>{var n=i(853),s=i(43),o=i(950);function r(t){var e="https://react.dev/errors/"+t;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var i=2;i<arguments.length;i++)e+="&args[]="+encodeURIComponent(arguments[i])}return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)}var l=Symbol.for("react.element"),h=Symbol.for("react.transitional.element"),u=Symbol.for("react.portal"),c=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),g=Symbol.for("react.provider"),m=Symbol.for("react.consumer"),p=Symbol.for("react.context"),y=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),b=Symbol.for("react.suspense_list"),v=Symbol.for("react.memo"),w=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var k=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var S=Symbol.for("react.memo_cache_sentinel"),P=Symbol.iterator;function M(t){return null===t||"object"!==typeof t?null:"function"===typeof(t=P&&t[P]||t["@@iterator"])?t:null}var C=Symbol.for("react.client.reference");function N(t){if(null==t)return null;if("function"===typeof t)return t.$$typeof===C?null:t.displayName||t.name||null;if("string"===typeof t)return t;switch(t){case c:return"Fragment";case u:return"Portal";case f:return"Profiler";case d:return"StrictMode";case x:return"Suspense";case b:return"SuspenseList"}if("object"===typeof t)switch(t.$$typeof){case p:return(t.displayName||"Context")+".Provider";case m:return(t._context.displayName||"Context")+".Consumer";case y:var e=t.render;return(t=t.displayName)||(t=""!==(t=e.displayName||e.name||"")?"ForwardRef("+t+")":"ForwardRef"),t;case v:return null!==(e=t.displayName||null)?e:N(t.type)||"Memo";case w:e=t._payload,t=t._init;try{return N(t(e))}catch(i){}}return null}var T,L,A=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,D=Object.assign;function F(t){if(void 0===T)try{throw Error()}catch(i){var e=i.stack.trim().match(/\n( *(at )?)/);T=e&&e[1]||"",L=-1<i.stack.indexOf("\n    at")?" (<anonymous>)":-1<i.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+T+t+L}var O=!1;function R(t,e){if(!t||O)return"";O=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var n={DetermineComponentFrameRoot:function(){try{if(e){var i=function(){throw Error()};if(Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(i,[])}catch(s){var n=s}Reflect.construct(t,[],i)}else{try{i.call()}catch(o){n=o}t.call(i.prototype)}}else{try{throw Error()}catch(r){n=r}(i=t())&&"function"===typeof i.catch&&i.catch((function(){}))}}catch(a){if(a&&n&&"string"===typeof a.stack)return[a.stack,n.stack]}return[null,null]}};n.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var s=Object.getOwnPropertyDescriptor(n.DetermineComponentFrameRoot,"name");s&&s.configurable&&Object.defineProperty(n.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var o=n.DetermineComponentFrameRoot(),r=o[0],a=o[1];if(r&&a){var l=r.split("\n"),h=a.split("\n");for(s=n=0;n<l.length&&!l[n].includes("DetermineComponentFrameRoot");)n++;for(;s<h.length&&!h[s].includes("DetermineComponentFrameRoot");)s++;if(n===l.length||s===h.length)for(n=l.length-1,s=h.length-1;1<=n&&0<=s&&l[n]!==h[s];)s--;for(;1<=n&&0<=s;n--,s--)if(l[n]!==h[s]){if(1!==n||1!==s)do{if(n--,0>--s||l[n]!==h[s]){var u="\n"+l[n].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}}while(1<=n&&0<=s);break}}}finally{O=!1,Error.prepareStackTrace=i}return(i=t?t.displayName||t.name:"")?F(i):""}function E(t){switch(t.tag){case 26:case 27:case 5:return F(t.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 15:return t=R(t.type,!1);case 11:return t=R(t.type.render,!1);case 1:return t=R(t.type,!0);default:return""}}function B(t){try{var e="";do{e+=E(t),t=t.return}while(t);return e}catch(i){return"\nError generating stack: "+i.message+"\n"+i.stack}}function I(t){var e=t,i=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!==(4098&(e=t).flags)&&(i=e.return),t=e.return}while(t)}return 3===e.tag?i:null}function z(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&(null!==(t=t.alternate)&&(e=t.memoizedState)),null!==e)return e.dehydrated}return null}function V(t){if(I(t)!==t)throw Error(r(188))}function j(t){var e=t.tag;if(5===e||26===e||27===e||6===e)return t;for(t=t.child;null!==t;){if(null!==(e=j(t)))return e;t=t.sibling}return null}var U=Array.isArray,G=o.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K={pending:!1,data:null,method:null,action:null},X=[],Y=-1;function _(t){return{current:t}}function H(t){0>Y||(t.current=X[Y],X[Y]=null,Y--)}function q(t,e){Y++,X[Y]=t.current,t.current=e}var W=_(null),$=_(null),J=_(null),Z=_(null);function Q(t,e){switch(q(J,e),q($,t),q(W,null),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)&&(e=e.namespaceURI)?$u(e):0;break;default:if(e=(t=8===t?e.parentNode:e).tagName,t=t.namespaceURI)e=Ju(t=$u(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}H(W),q(W,e)}function tt(){H(W),H($),H(J)}function et(t){null!==t.memoizedState&&q(Z,t);var e=W.current,i=Ju(e,t.type);e!==i&&(q($,t),q(W,i))}function it(t){$.current===t&&(H(W),H($)),Z.current===t&&(H(Z),Bc._currentValue=K)}var nt=Object.prototype.hasOwnProperty,st=n.unstable_scheduleCallback,ot=n.unstable_cancelCallback,rt=n.unstable_shouldYield,at=n.unstable_requestPaint,lt=n.unstable_now,ht=n.unstable_getCurrentPriorityLevel,ut=n.unstable_ImmediatePriority,ct=n.unstable_UserBlockingPriority,dt=n.unstable_NormalPriority,ft=n.unstable_LowPriority,gt=n.unstable_IdlePriority,mt=n.log,pt=n.unstable_setDisableYieldValue,yt=null,xt=null;function bt(t){if("function"===typeof mt&&pt(t),xt&&"function"===typeof xt.setStrictMode)try{xt.setStrictMode(yt,t)}catch(e){}}var vt=Math.clz32?Math.clz32:function(t){return 0===(t>>>=0)?32:31-(wt(t)/kt|0)|0},wt=Math.log,kt=Math.LN2;var St=128,Pt=4194304;function Mt(t){var e=42&t;if(0!==e)return e;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194176&t;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&t;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function Ct(t,e){var i=t.pendingLanes;if(0===i)return 0;var n=0,s=t.suspendedLanes,o=t.pingedLanes,r=t.warmLanes;t=0!==t.finishedLanes;var a=134217727&i;return 0!==a?0!==(i=a&~s)?n=Mt(i):0!==(o&=a)?n=Mt(o):t||0!==(r=a&~r)&&(n=Mt(r)):0!==(a=i&~s)?n=Mt(a):0!==o?n=Mt(o):t||0!==(r=i&~r)&&(n=Mt(r)),0===n?0:0!==e&&e!==n&&0===(e&s)&&((s=n&-n)>=(r=e&-e)||32===s&&0!==(4194176&r))?e:n}function Nt(t,e){return 0===(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&e)}function Tt(t,e){switch(t){case 1:case 2:case 4:case 8:return e+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;default:return-1}}function Lt(){var t=St;return 0===(4194176&(St<<=1))&&(St=128),t}function At(){var t=Pt;return 0===(62914560&(Pt<<=1))&&(Pt=4194304),t}function Dt(t){for(var e=[],i=0;31>i;i++)e.push(t);return e}function Ft(t,e){t.pendingLanes|=e,268435456!==e&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function Ot(t,e,i){t.pendingLanes|=e,t.suspendedLanes&=~e;var n=31-vt(e);t.entangledLanes|=e,t.entanglements[n]=1073741824|t.entanglements[n]|4194218&i}function Rt(t,e){var i=t.entangledLanes|=e;for(t=t.entanglements;i;){var n=31-vt(i),s=1<<n;s&e|t[n]&e&&(t[n]|=e),i&=~s}}function Et(t){return 2<(t&=-t)?8<t?0!==(134217727&t)?32:268435456:8:2}function Bt(){var t=G.p;return 0!==t?t:void 0===(t=window.event)?32:Jc(t.type)}var It=Math.random().toString(36).slice(2),zt="__reactFiber$"+It,Vt="__reactProps$"+It,jt="__reactContainer$"+It,Ut="__reactEvents$"+It,Gt="__reactListeners$"+It,Kt="__reactHandles$"+It,Xt="__reactResources$"+It,Yt="__reactMarker$"+It;function _t(t){delete t[zt],delete t[Vt],delete t[Ut],delete t[Gt],delete t[Kt]}function Ht(t){var e=t[zt];if(e)return e;for(var i=t.parentNode;i;){if(e=i[jt]||i[zt]){if(i=e.alternate,null!==e.child||null!==i&&null!==i.child)for(t=lc(t);null!==t;){if(i=t[zt])return i;t=lc(t)}return e}i=(t=i).parentNode}return null}function qt(t){if(t=t[zt]||t[jt]){var e=t.tag;if(5===e||6===e||13===e||26===e||27===e||3===e)return t}return null}function Wt(t){var e=t.tag;if(5===e||26===e||27===e||6===e)return t.stateNode;throw Error(r(33))}function $t(t){var e=t[Xt];return e||(e=t[Xt]={hoistableStyles:new Map,hoistableScripts:new Map}),e}function Jt(t){t[Yt]=!0}var Zt=new Set,Qt={};function te(t,e){ee(t,e),ee(t+"Capture",e)}function ee(t,e){for(Qt[t]=e,t=0;t<e.length;t++)Zt.add(e[t])}var ie=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),ne=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),se={},oe={};function re(t,e,i){if(s=e,nt.call(oe,s)||!nt.call(se,s)&&(ne.test(s)?oe[s]=!0:(se[s]=!0,0)))if(null===i)t.removeAttribute(e);else{switch(typeof i){case"undefined":case"function":case"symbol":return void t.removeAttribute(e);case"boolean":var n=e.toLowerCase().slice(0,5);if("data-"!==n&&"aria-"!==n)return void t.removeAttribute(e)}t.setAttribute(e,""+i)}var s}function ae(t,e,i){if(null===i)t.removeAttribute(e);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":return void t.removeAttribute(e)}t.setAttribute(e,""+i)}}function le(t,e,i,n){if(null===n)t.removeAttribute(i);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void t.removeAttribute(i)}t.setAttributeNS(e,i,""+n)}}function he(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return t;default:return""}}function ue(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function ce(t){t._valueTracker||(t._valueTracker=function(t){var e=ue(t)?"checked":"value",i=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&"undefined"!==typeof i&&"function"===typeof i.get&&"function"===typeof i.set){var s=i.get,o=i.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(t){n=""+t,o.call(this,t)}}),Object.defineProperty(t,e,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(t){n=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function de(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var i=e.getValue(),n="";return t&&(n=ue(t)?t.checked?"true":"false":t.value),(t=n)!==i&&(e.setValue(t),!0)}function fe(t){if("undefined"===typeof(t=t||("undefined"!==typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}var ge=/[\n"\\]/g;function me(t){return t.replace(ge,(function(t){return"\\"+t.charCodeAt(0).toString(16)+" "}))}function pe(t,e,i,n,s,o,r,a){t.name="",null!=r&&"function"!==typeof r&&"symbol"!==typeof r&&"boolean"!==typeof r?t.type=r:t.removeAttribute("type"),null!=e?"number"===r?(0===e&&""===t.value||t.value!=e)&&(t.value=""+he(e)):t.value!==""+he(e)&&(t.value=""+he(e)):"submit"!==r&&"reset"!==r||t.removeAttribute("value"),null!=e?xe(t,r,he(e)):null!=i?xe(t,r,he(i)):null!=n&&t.removeAttribute("value"),null==s&&null!=o&&(t.defaultChecked=!!o),null!=s&&(t.checked=s&&"function"!==typeof s&&"symbol"!==typeof s),null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a?t.name=""+he(a):t.removeAttribute("name")}function ye(t,e,i,n,s,o,r,a){if(null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o&&(t.type=o),null!=e||null!=i){if(!("submit"!==o&&"reset"!==o||void 0!==e&&null!==e))return;i=null!=i?""+he(i):"",e=null!=e?""+he(e):i,a||e===t.value||(t.value=e),t.defaultValue=e}n="function"!==typeof(n=null!=n?n:s)&&"symbol"!==typeof n&&!!n,t.checked=a?t.checked:!!n,t.defaultChecked=!!n,null!=r&&"function"!==typeof r&&"symbol"!==typeof r&&"boolean"!==typeof r&&(t.name=r)}function xe(t,e,i){"number"===e&&fe(t.ownerDocument)===t||t.defaultValue===""+i||(t.defaultValue=""+i)}function be(t,e,i,n){if(t=t.options,e){e={};for(var s=0;s<i.length;s++)e["$"+i[s]]=!0;for(i=0;i<t.length;i++)s=e.hasOwnProperty("$"+t[i].value),t[i].selected!==s&&(t[i].selected=s),s&&n&&(t[i].defaultSelected=!0)}else{for(i=""+he(i),e=null,s=0;s<t.length;s++){if(t[s].value===i)return t[s].selected=!0,void(n&&(t[s].defaultSelected=!0));null!==e||t[s].disabled||(e=t[s])}null!==e&&(e.selected=!0)}}function ve(t,e,i){null==e||((e=""+he(e))!==t.value&&(t.value=e),null!=i)?t.defaultValue=null!=i?""+he(i):"":t.defaultValue!==e&&(t.defaultValue=e)}function we(t,e,i,n){if(null==e){if(null!=n){if(null!=i)throw Error(r(92));if(U(n)){if(1<n.length)throw Error(r(93));n=n[0]}i=n}null==i&&(i=""),e=i}i=he(e),t.defaultValue=i,(n=t.textContent)===i&&""!==n&&null!==n&&(t.value=n)}function ke(t,e){if(e){var i=t.firstChild;if(i&&i===t.lastChild&&3===i.nodeType)return void(i.nodeValue=e)}t.textContent=e}var Se=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Pe(t,e,i){var n=0===e.indexOf("--");null==i||"boolean"===typeof i||""===i?n?t.setProperty(e,""):"float"===e?t.cssFloat="":t[e]="":n?t.setProperty(e,i):"number"!==typeof i||0===i||Se.has(e)?"float"===e?t.cssFloat=i:t[e]=(""+i).trim():t[e]=i+"px"}function Me(t,e,i){if(null!=e&&"object"!==typeof e)throw Error(r(62));if(t=t.style,null!=i){for(var n in i)!i.hasOwnProperty(n)||null!=e&&e.hasOwnProperty(n)||(0===n.indexOf("--")?t.setProperty(n,""):"float"===n?t.cssFloat="":t[n]="");for(var s in e)n=e[s],e.hasOwnProperty(s)&&i[s]!==n&&Pe(t,s,n)}else for(var o in e)e.hasOwnProperty(o)&&Pe(t,o,e[o])}function Ce(t){if(-1===t.indexOf("-"))return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ne=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Te=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Le(t){return Te.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}var Ae=null;function De(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var Fe=null,Oe=null;function Re(t){var e=qt(t);if(e&&(t=e.stateNode)){var i=t[Vt]||null;t:switch(t=e.stateNode,e.type){case"input":if(pe(t,i.value,i.defaultValue,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name),e=i.name,"radio"===i.type&&null!=e){for(i=t;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll('input[name="'+me(""+e)+'"][type="radio"]'),e=0;e<i.length;e++){var n=i[e];if(n!==t&&n.form===t.form){var s=n[Vt]||null;if(!s)throw Error(r(90));pe(n,s.value,s.defaultValue,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name)}}for(e=0;e<i.length;e++)(n=i[e]).form===t.form&&de(n)}break t;case"textarea":ve(t,i.value,i.defaultValue);break t;case"select":null!=(e=i.value)&&be(t,!!i.multiple,e,!1)}}}var Ee=!1;function Be(t,e,i){if(Ee)return t(e,i);Ee=!0;try{return t(e)}finally{if(Ee=!1,(null!==Fe||null!==Oe)&&(zh(),Fe&&(e=Fe,t=Oe,Oe=Fe=null,Re(e),t)))for(e=0;e<t.length;e++)Re(t[e])}}function Ie(t,e){var i=t.stateNode;if(null===i)return null;var n=i[Vt]||null;if(null===n)return null;i=n[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!n;break t;default:t=!1}if(t)return null;if(i&&"function"!==typeof i)throw Error(r(231,e,typeof i));return i}var ze=!1;if(ie)try{var Ve={};Object.defineProperty(Ve,"passive",{get:function(){ze=!0}}),window.addEventListener("test",Ve,Ve),window.removeEventListener("test",Ve,Ve)}catch(wd){ze=!1}var je=null,Ue=null,Ge=null;function Ke(){if(Ge)return Ge;var t,e,i=Ue,n=i.length,s="value"in je?je.value:je.textContent,o=s.length;for(t=0;t<n&&i[t]===s[t];t++);var r=n-t;for(e=1;e<=r&&i[n-e]===s[o-e];e++);return Ge=s.slice(t,1<e?1-e:void 0)}function Xe(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function Ye(){return!0}function _e(){return!1}function He(t){function e(e,i,n,s,o){for(var r in this._reactName=e,this._targetInst=n,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null,t)t.hasOwnProperty(r)&&(e=t[r],this[r]=e?e(s):s[r]);return this.isDefaultPrevented=(null!=s.defaultPrevented?s.defaultPrevented:!1===s.returnValue)?Ye:_e,this.isPropagationStopped=_e,this}return D(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!==typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=Ye)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!==typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=Ye)},persist:function(){},isPersistent:Ye}),e}var qe,We,$e,Je={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ze=He(Je),Qe=D({},Je,{view:0,detail:0}),ti=He(Qe),ei=D({},Qe,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:di,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==$e&&($e&&"mousemove"===t.type?(qe=t.screenX-$e.screenX,We=t.screenY-$e.screenY):We=qe=0,$e=t),qe)},movementY:function(t){return"movementY"in t?t.movementY:We}}),ii=He(ei),ni=He(D({},ei,{dataTransfer:0})),si=He(D({},Qe,{relatedTarget:0})),oi=He(D({},Je,{animationName:0,elapsedTime:0,pseudoElement:0})),ri=He(D({},Je,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}})),ai=He(D({},Je,{data:0})),li={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hi={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ui={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ci(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=ui[t])&&!!e[t]}function di(){return ci}var fi=He(D({},Qe,{key:function(t){if(t.key){var e=li[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=Xe(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?hi[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:di,charCode:function(t){return"keypress"===t.type?Xe(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?Xe(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}})),gi=He(D({},ei,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),mi=He(D({},Qe,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:di})),pi=He(D({},Je,{propertyName:0,elapsedTime:0,pseudoElement:0})),yi=He(D({},ei,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0})),xi=He(D({},Je,{newState:0,oldState:0})),bi=[9,13,27,32],vi=ie&&"CompositionEvent"in window,wi=null;ie&&"documentMode"in document&&(wi=document.documentMode);var ki=ie&&"TextEvent"in window&&!wi,Si=ie&&(!vi||wi&&8<wi&&11>=wi),Pi=String.fromCharCode(32),Mi=!1;function Ci(t,e){switch(t){case"keyup":return-1!==bi.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ni(t){return"object"===typeof(t=t.detail)&&"data"in t?t.data:null}var Ti=!1;var Li={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ai(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!Li[t.type]:"textarea"===e}function Di(t,e,i,n){Fe?Oe?Oe.push(n):Oe=[n]:Fe=n,0<(e=Bu(e,"onChange")).length&&(i=new Ze("onChange","change",null,i,n),t.push({event:i,listeners:e}))}var Fi=null,Oi=null;function Ri(t){Tu(t,0)}function Ei(t){if(de(Wt(t)))return t}function Bi(t,e){if("change"===t)return e}var Ii=!1;if(ie){var zi;if(ie){var Vi="oninput"in document;if(!Vi){var ji=document.createElement("div");ji.setAttribute("oninput","return;"),Vi="function"===typeof ji.oninput}zi=Vi}else zi=!1;Ii=zi&&(!document.documentMode||9<document.documentMode)}function Ui(){Fi&&(Fi.detachEvent("onpropertychange",Gi),Oi=Fi=null)}function Gi(t){if("value"===t.propertyName&&Ei(Oi)){var e=[];Di(e,Oi,t,De(t)),Be(Ri,e)}}function Ki(t,e,i){"focusin"===t?(Ui(),Oi=i,(Fi=e).attachEvent("onpropertychange",Gi)):"focusout"===t&&Ui()}function Xi(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return Ei(Oi)}function Yi(t,e){if("click"===t)return Ei(e)}function _i(t,e){if("input"===t||"change"===t)return Ei(e)}var Hi="function"===typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t===1/e)||t!==t&&e!==e};function qi(t,e){if(Hi(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var i=Object.keys(t),n=Object.keys(e);if(i.length!==n.length)return!1;for(n=0;n<i.length;n++){var s=i[n];if(!nt.call(e,s)||!Hi(t[s],e[s]))return!1}return!0}function Wi(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function $i(t,e){var i,n=Wi(t);for(t=0;n;){if(3===n.nodeType){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}t:{for(;n;){if(n.nextSibling){n=n.nextSibling;break t}n=n.parentNode}n=void 0}n=Wi(n)}}function Ji(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?Ji(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function Zi(t){for(var e=fe((t=null!=t&&null!=t.ownerDocument&&null!=t.ownerDocument.defaultView?t.ownerDocument.defaultView:window).document);e instanceof t.HTMLIFrameElement;){try{var i="string"===typeof e.contentWindow.location.href}catch(n){i=!1}if(!i)break;e=fe((t=e.contentWindow).document)}return e}function Qi(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}function tn(t,e){var i=Zi(e);e=t.focusedElem;var n=t.selectionRange;if(i!==e&&e&&e.ownerDocument&&Ji(e.ownerDocument.documentElement,e)){if(null!==n&&Qi(e))if(t=n.start,void 0===(i=n.end)&&(i=t),"selectionStart"in e)e.selectionStart=t,e.selectionEnd=Math.min(i,e.value.length);else if((i=(t=e.ownerDocument||document)&&t.defaultView||window).getSelection){i=i.getSelection();var s=e.textContent.length,o=Math.min(n.start,s);n=void 0===n.end?o:Math.min(n.end,s),!i.extend&&o>n&&(s=n,n=o,o=s),s=$i(e,o);var r=$i(e,n);s&&r&&(1!==i.rangeCount||i.anchorNode!==s.node||i.anchorOffset!==s.offset||i.focusNode!==r.node||i.focusOffset!==r.offset)&&((t=t.createRange()).setStart(s.node,s.offset),i.removeAllRanges(),o>n?(i.addRange(t),i.extend(r.node,r.offset)):(t.setEnd(r.node,r.offset),i.addRange(t)))}for(t=[],i=e;i=i.parentNode;)1===i.nodeType&&t.push({element:i,left:i.scrollLeft,top:i.scrollTop});for("function"===typeof e.focus&&e.focus(),e=0;e<t.length;e++)(i=t[e]).element.scrollLeft=i.left,i.element.scrollTop=i.top}}var en=ie&&"documentMode"in document&&11>=document.documentMode,nn=null,sn=null,on=null,rn=!1;function an(t,e,i){var n=i.window===i?i.document:9===i.nodeType?i:i.ownerDocument;rn||null==nn||nn!==fe(n)||("selectionStart"in(n=nn)&&Qi(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},on&&qi(on,n)||(on=n,0<(n=Bu(sn,"onSelect")).length&&(e=new Ze("onSelect","select",null,e,i),t.push({event:e,listeners:n}),e.target=nn)))}function ln(t,e){var i={};return i[t.toLowerCase()]=e.toLowerCase(),i["Webkit"+t]="webkit"+e,i["Moz"+t]="moz"+e,i}var hn={animationend:ln("Animation","AnimationEnd"),animationiteration:ln("Animation","AnimationIteration"),animationstart:ln("Animation","AnimationStart"),transitionrun:ln("Transition","TransitionRun"),transitionstart:ln("Transition","TransitionStart"),transitioncancel:ln("Transition","TransitionCancel"),transitionend:ln("Transition","TransitionEnd")},un={},cn={};function dn(t){if(un[t])return un[t];if(!hn[t])return t;var e,i=hn[t];for(e in i)if(i.hasOwnProperty(e)&&e in cn)return un[t]=i[e];return t}ie&&(cn=document.createElement("div").style,"AnimationEvent"in window||(delete hn.animationend.animation,delete hn.animationiteration.animation,delete hn.animationstart.animation),"TransitionEvent"in window||delete hn.transitionend.transition);var fn=dn("animationend"),gn=dn("animationiteration"),mn=dn("animationstart"),pn=dn("transitionrun"),yn=dn("transitionstart"),xn=dn("transitioncancel"),bn=dn("transitionend"),vn=new Map,wn="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function kn(t,e){vn.set(t,e),te(e,[t])}var Sn=[],Pn=0,Mn=0;function Cn(){for(var t=Pn,e=Mn=Pn=0;e<t;){var i=Sn[e];Sn[e++]=null;var n=Sn[e];Sn[e++]=null;var s=Sn[e];Sn[e++]=null;var o=Sn[e];if(Sn[e++]=null,null!==n&&null!==s){var r=n.pending;null===r?s.next=s:(s.next=r.next,r.next=s),n.pending=s}0!==o&&An(i,s,o)}}function Nn(t,e,i,n){Sn[Pn++]=t,Sn[Pn++]=e,Sn[Pn++]=i,Sn[Pn++]=n,Mn|=n,t.lanes|=n,null!==(t=t.alternate)&&(t.lanes|=n)}function Tn(t,e,i,n){return Nn(t,e,i,n),Dn(t)}function Ln(t,e){return Nn(t,null,null,e),Dn(t)}function An(t,e,i){t.lanes|=i;var n=t.alternate;null!==n&&(n.lanes|=i);for(var s=!1,o=t.return;null!==o;)o.childLanes|=i,null!==(n=o.alternate)&&(n.childLanes|=i),22===o.tag&&(null===(t=o.stateNode)||1&t._visibility||(s=!0)),t=o,o=o.return;s&&null!==e&&3===t.tag&&(o=t.stateNode,s=31-vt(i),null===(t=(o=o.hiddenUpdates)[s])?o[s]=[e]:t.push(e),e.lane=536870912|i)}function Dn(t){if(50<Th)throw Th=0,Lh=null,Error(r(185));for(var e=t.return;null!==e;)e=(t=e).return;return 3===t.tag?t.stateNode:null}var Fn={},On=new WeakMap;function Rn(t,e){if("object"===typeof t&&null!==t){var i=On.get(t);return void 0!==i?i:(e={value:t,source:e,stack:B(e)},On.set(t,e),e)}return{value:t,source:e,stack:B(e)}}var En=[],Bn=0,In=null,zn=0,Vn=[],jn=0,Un=null,Gn=1,Kn="";function Xn(t,e){En[Bn++]=zn,En[Bn++]=In,In=t,zn=e}function Yn(t,e,i){Vn[jn++]=Gn,Vn[jn++]=Kn,Vn[jn++]=Un,Un=t;var n=Gn;t=Kn;var s=32-vt(n)-1;n&=~(1<<s),i+=1;var o=32-vt(e)+s;if(30<o){var r=s-s%5;o=(n&(1<<r)-1).toString(32),n>>=r,s-=r,Gn=1<<32-vt(e)+s|i<<s|n,Kn=o+t}else Gn=1<<o|i<<s|n,Kn=t}function _n(t){null!==t.return&&(Xn(t,1),Yn(t,1,0))}function Hn(t){for(;t===In;)In=En[--Bn],En[Bn]=null,zn=En[--Bn],En[Bn]=null;for(;t===Un;)Un=Vn[--jn],Vn[jn]=null,Kn=Vn[--jn],Vn[jn]=null,Gn=Vn[--jn],Vn[jn]=null}var qn=null,Wn=null,$n=!1,Jn=null,Zn=!1,Qn=Error(r(519));function ts(t){throw os(Rn(Error(r(418,"")),t)),Qn}function es(t){var e=t.stateNode,i=t.type,n=t.memoizedProps;switch(e[zt]=t,e[Vt]=n,i){case"dialog":Lu("cancel",e),Lu("close",e);break;case"iframe":case"object":case"embed":Lu("load",e);break;case"video":case"audio":for(i=0;i<Cu.length;i++)Lu(Cu[i],e);break;case"source":Lu("error",e);break;case"img":case"image":case"link":Lu("error",e),Lu("load",e);break;case"details":Lu("toggle",e);break;case"input":Lu("invalid",e),ye(e,n.value,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name,!0),ce(e);break;case"select":Lu("invalid",e);break;case"textarea":Lu("invalid",e),we(e,n.value,n.defaultValue,n.children),ce(e)}"string"!==typeof(i=n.children)&&"number"!==typeof i&&"bigint"!==typeof i||e.textContent===""+i||!0===n.suppressHydrationWarning||Gu(e.textContent,i)?(null!=n.popover&&(Lu("beforetoggle",e),Lu("toggle",e)),null!=n.onScroll&&Lu("scroll",e),null!=n.onScrollEnd&&Lu("scrollend",e),null!=n.onClick&&(e.onclick=Ku),e=!0):e=!1,e||ts(t)}function is(t){for(qn=t.return;qn;)switch(qn.tag){case 3:case 27:return void(Zn=!0);case 5:case 13:return void(Zn=!1);default:qn=qn.return}}function ns(t){if(t!==qn)return!1;if(!$n)return is(t),$n=!0,!1;var e,i=!1;if((e=3!==t.tag&&27!==t.tag)&&((e=5===t.tag)&&(e=!("form"!==(e=t.type)&&"button"!==e)||Zu(t.type,t.memoizedProps)),e=!e),e&&(i=!0),i&&Wn&&ts(t),is(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(r(317));t:{for(t=t.nextSibling,i=0;t;){if(8===t.nodeType)if("/$"===(e=t.data)){if(0===i){Wn=ac(t.nextSibling);break t}i--}else"$"!==e&&"$!"!==e&&"$?"!==e||i++;t=t.nextSibling}Wn=null}}else Wn=qn?ac(t.stateNode.nextSibling):null;return!0}function ss(){Wn=qn=null,$n=!1}function os(t){null===Jn?Jn=[t]:Jn.push(t)}var rs=Error(r(460)),as=Error(r(474)),ls={then:function(){}};function hs(t){return"fulfilled"===(t=t.status)||"rejected"===t}function us(){}function cs(t,e,i){switch(void 0===(i=t[i])?t.push(e):i!==e&&(e.then(us,us),e=i),e.status){case"fulfilled":return e.value;case"rejected":if((t=e.reason)===rs)throw Error(r(483));throw t;default:if("string"===typeof e.status)e.then(us,us);else{if(null!==(t=eh)&&100<t.shellSuspendCounter)throw Error(r(482));(t=e).status="pending",t.then((function(t){if("pending"===e.status){var i=e;i.status="fulfilled",i.value=t}}),(function(t){if("pending"===e.status){var i=e;i.status="rejected",i.reason=t}}))}switch(e.status){case"fulfilled":return e.value;case"rejected":if((t=e.reason)===rs)throw Error(r(483));throw t}throw ds=e,rs}}var ds=null;function fs(){if(null===ds)throw Error(r(459));var t=ds;return ds=null,t}var gs=null,ms=0;function ps(t){var e=ms;return ms+=1,null===gs&&(gs=[]),cs(gs,t,e)}function ys(t,e){e=e.props.ref,t.ref=void 0!==e?e:null}function xs(t,e){if(e.$$typeof===l)throw Error(r(525));throw t=Object.prototype.toString.call(e),Error(r(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function bs(t){return(0,t._init)(t._payload)}function vs(t){function e(e,i){if(t){var n=e.deletions;null===n?(e.deletions=[i],e.flags|=16):n.push(i)}}function i(i,n){if(!t)return null;for(;null!==n;)e(i,n),n=n.sibling;return null}function n(t){for(var e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function s(t,e){return(t=Il(t,e)).index=0,t.sibling=null,t}function o(e,i,n){return e.index=n,t?null!==(n=e.alternate)?(n=n.index)<i?(e.flags|=33554434,i):n:(e.flags|=33554434,i):(e.flags|=1048576,i)}function a(e){return t&&null===e.alternate&&(e.flags|=33554434),e}function l(t,e,i,n){return null===e||6!==e.tag?((e=Gl(i,t.mode,n)).return=t,e):((e=s(e,i)).return=t,e)}function d(t,e,i,n){var o=i.type;return o===c?g(t,e,i.props.children,n,i.key):null!==e&&(e.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===w&&bs(o)===e.type)?(ys(e=s(e,i.props),i),e.return=t,e):(ys(e=Vl(i.type,i.key,i.props,null,t.mode,n),i),e.return=t,e)}function f(t,e,i,n){return null===e||4!==e.tag||e.stateNode.containerInfo!==i.containerInfo||e.stateNode.implementation!==i.implementation?((e=Kl(i,t.mode,n)).return=t,e):((e=s(e,i.children||[])).return=t,e)}function g(t,e,i,n,o){return null===e||7!==e.tag?((e=jl(i,t.mode,n,o)).return=t,e):((e=s(e,i)).return=t,e)}function m(t,e,i){if("string"===typeof e&&""!==e||"number"===typeof e||"bigint"===typeof e)return(e=Gl(""+e,t.mode,i)).return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case h:return ys(i=Vl(e.type,e.key,e.props,null,t.mode,i),e),i.return=t,i;case u:return(e=Kl(e,t.mode,i)).return=t,e;case w:return m(t,e=(0,e._init)(e._payload),i)}if(U(e)||M(e))return(e=jl(e,t.mode,i,null)).return=t,e;if("function"===typeof e.then)return m(t,ps(e),i);if(e.$$typeof===p)return m(t,Ca(t,e),i);xs(t,e)}return null}function y(t,e,i,n){var s=null!==e?e.key:null;if("string"===typeof i&&""!==i||"number"===typeof i||"bigint"===typeof i)return null!==s?null:l(t,e,""+i,n);if("object"===typeof i&&null!==i){switch(i.$$typeof){case h:return i.key===s?d(t,e,i,n):null;case u:return i.key===s?f(t,e,i,n):null;case w:return y(t,e,i=(s=i._init)(i._payload),n)}if(U(i)||M(i))return null!==s?null:g(t,e,i,n,null);if("function"===typeof i.then)return y(t,e,ps(i),n);if(i.$$typeof===p)return y(t,e,Ca(t,i),n);xs(t,i)}return null}function x(t,e,i,n,s){if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return l(e,t=t.get(i)||null,""+n,s);if("object"===typeof n&&null!==n){switch(n.$$typeof){case h:return d(e,t=t.get(null===n.key?i:n.key)||null,n,s);case u:return f(e,t=t.get(null===n.key?i:n.key)||null,n,s);case w:return x(t,e,i,n=(0,n._init)(n._payload),s)}if(U(n)||M(n))return g(e,t=t.get(i)||null,n,s,null);if("function"===typeof n.then)return x(t,e,i,ps(n),s);if(n.$$typeof===p)return x(t,e,i,Ca(e,n),s);xs(e,n)}return null}function b(l,d,f,g){if("object"===typeof f&&null!==f&&f.type===c&&null===f.key&&(f=f.props.children),"object"===typeof f&&null!==f){switch(f.$$typeof){case h:t:{for(var v=f.key;null!==d;){if(d.key===v){if((v=f.type)===c){if(7===d.tag){i(l,d.sibling),(g=s(d,f.props.children)).return=l,l=g;break t}}else if(d.elementType===v||"object"===typeof v&&null!==v&&v.$$typeof===w&&bs(v)===d.type){i(l,d.sibling),ys(g=s(d,f.props),f),g.return=l,l=g;break t}i(l,d);break}e(l,d),d=d.sibling}f.type===c?((g=jl(f.props.children,l.mode,g,f.key)).return=l,l=g):(ys(g=Vl(f.type,f.key,f.props,null,l.mode,g),f),g.return=l,l=g)}return a(l);case u:t:{for(v=f.key;null!==d;){if(d.key===v){if(4===d.tag&&d.stateNode.containerInfo===f.containerInfo&&d.stateNode.implementation===f.implementation){i(l,d.sibling),(g=s(d,f.children||[])).return=l,l=g;break t}i(l,d);break}e(l,d),d=d.sibling}(g=Kl(f,l.mode,g)).return=l,l=g}return a(l);case w:return b(l,d,f=(v=f._init)(f._payload),g)}if(U(f))return function(s,r,a,l){for(var h=null,u=null,c=r,d=r=0,f=null;null!==c&&d<a.length;d++){c.index>d?(f=c,c=null):f=c.sibling;var g=y(s,c,a[d],l);if(null===g){null===c&&(c=f);break}t&&c&&null===g.alternate&&e(s,c),r=o(g,r,d),null===u?h=g:u.sibling=g,u=g,c=f}if(d===a.length)return i(s,c),$n&&Xn(s,d),h;if(null===c){for(;d<a.length;d++)null!==(c=m(s,a[d],l))&&(r=o(c,r,d),null===u?h=c:u.sibling=c,u=c);return $n&&Xn(s,d),h}for(c=n(c);d<a.length;d++)null!==(f=x(c,s,d,a[d],l))&&(t&&null!==f.alternate&&c.delete(null===f.key?d:f.key),r=o(f,r,d),null===u?h=f:u.sibling=f,u=f);return t&&c.forEach((function(t){return e(s,t)})),$n&&Xn(s,d),h}(l,d,f,g);if(M(f)){if("function"!==typeof(v=M(f)))throw Error(r(150));return function(s,a,l,h){if(null==l)throw Error(r(151));for(var u=null,c=null,d=a,f=a=0,g=null,p=l.next();null!==d&&!p.done;f++,p=l.next()){d.index>f?(g=d,d=null):g=d.sibling;var b=y(s,d,p.value,h);if(null===b){null===d&&(d=g);break}t&&d&&null===b.alternate&&e(s,d),a=o(b,a,f),null===c?u=b:c.sibling=b,c=b,d=g}if(p.done)return i(s,d),$n&&Xn(s,f),u;if(null===d){for(;!p.done;f++,p=l.next())null!==(p=m(s,p.value,h))&&(a=o(p,a,f),null===c?u=p:c.sibling=p,c=p);return $n&&Xn(s,f),u}for(d=n(d);!p.done;f++,p=l.next())null!==(p=x(d,s,f,p.value,h))&&(t&&null!==p.alternate&&d.delete(null===p.key?f:p.key),a=o(p,a,f),null===c?u=p:c.sibling=p,c=p);return t&&d.forEach((function(t){return e(s,t)})),$n&&Xn(s,f),u}(l,d,f=v.call(f),g)}if("function"===typeof f.then)return b(l,d,ps(f),g);if(f.$$typeof===p)return b(l,d,Ca(l,f),g);xs(l,f)}return"string"===typeof f&&""!==f||"number"===typeof f||"bigint"===typeof f?(f=""+f,null!==d&&6===d.tag?(i(l,d.sibling),(g=s(d,f)).return=l,l=g):(i(l,d),(g=Gl(f,l.mode,g)).return=l,l=g),a(l)):i(l,d)}return function(t,e,i,n){try{ms=0;var s=b(t,e,i,n);return gs=null,s}catch(r){if(r===rs)throw r;var o=El(29,r,null,t.mode);return o.lanes=n,o.return=t,o}}}var ws=vs(!0),ks=vs(!1),Ss=_(null),Ps=_(0);function Ms(t,e){q(Ps,t=hh),q(Ss,e),hh=t|e.baseLanes}function Cs(){q(Ps,hh),q(Ss,Ss.current)}function Ns(){hh=Ps.current,H(Ss),H(Ps)}var Ts=_(null),Ls=null;function As(t){var e=t.alternate;q(Rs,1&Rs.current),q(Ts,t),null===Ls&&(null===e||null!==Ss.current||null!==e.memoizedState)&&(Ls=t)}function Ds(t){if(22===t.tag){if(q(Rs,Rs.current),q(Ts,t),null===Ls){var e=t.alternate;null!==e&&null!==e.memoizedState&&(Ls=t)}}else Fs()}function Fs(){q(Rs,Rs.current),q(Ts,Ts.current)}function Os(t){H(Ts),Ls===t&&(Ls=null),H(Rs)}var Rs=_(0);function Es(t){for(var e=t;null!==e;){if(13===e.tag){var i=e.memoizedState;if(null!==i&&(null===(i=i.dehydrated)||"$?"===i.data||"$!"===i.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!==(128&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Bs="undefined"!==typeof AbortController?AbortController:function(){var t=[],e=this.signal={aborted:!1,addEventListener:function(e,i){t.push(i)}};this.abort=function(){e.aborted=!0,t.forEach((function(t){return t()}))}},Is=n.unstable_scheduleCallback,zs=n.unstable_NormalPriority,Vs={$$typeof:p,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function js(){return{controller:new Bs,data:new Map,refCount:0}}function Us(t){t.refCount--,0===t.refCount&&Is(zs,(function(){t.controller.abort()}))}var Gs=null,Ks=0,Xs=0,Ys=null;function _s(){if(0===--Ks&&null!==Gs){null!==Ys&&(Ys.status="fulfilled");var t=Gs;Gs=null,Xs=0,Ys=null;for(var e=0;e<t.length;e++)(0,t[e])()}}var Hs=A.S;A.S=function(t,e){"object"===typeof e&&null!==e&&"function"===typeof e.then&&function(t,e){if(null===Gs){var i=Gs=[];Ks=0,Xs=wu(),Ys={status:"pending",value:void 0,then:function(t){i.push(t)}}}Ks++,e.then(_s,_s)}(0,e),null!==Hs&&Hs(t,e)};var qs=_(null);function Ws(){var t=qs.current;return null!==t?t:eh.pooledCache}function $s(t,e){q(qs,null===e?qs.current:e.pool)}function Js(){var t=Ws();return null===t?null:{parent:Vs._currentValue,pool:t}}var Zs=0,Qs=null,to=null,eo=null,io=!1,no=!1,so=!1,oo=0,ro=0,ao=null,lo=0;function ho(){throw Error(r(321))}function uo(t,e){if(null===e)return!1;for(var i=0;i<e.length&&i<t.length;i++)if(!Hi(t[i],e[i]))return!1;return!0}function co(t,e,i,n,s,o){return Zs=o,Qs=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,A.H=null===t||null===t.memoizedState?Cr:Nr,so=!1,o=i(n,s),so=!1,no&&(o=go(e,i,n,s)),fo(t),o}function fo(t){A.H=Mr;var e=null!==to&&null!==to.next;if(Zs=0,eo=to=Qs=null,io=!1,ro=0,ao=null,e)throw Error(r(300));null===t||Xr||null!==(t=t.dependencies)&&Sa(t)&&(Xr=!0)}function go(t,e,i,n){Qs=t;var s=0;do{if(no&&(ao=null),ro=0,no=!1,25<=s)throw Error(r(301));if(s+=1,eo=to=null,null!=t.updateQueue){var o=t.updateQueue;o.lastEffect=null,o.events=null,o.stores=null,null!=o.memoCache&&(o.memoCache.index=0)}A.H=Tr,o=e(i,n)}while(no);return o}function mo(){var t=A.H,e=t.useState()[0];return e="function"===typeof e.then?wo(e):e,t=t.useState()[0],(null!==to?to.memoizedState:null)!==t&&(Qs.flags|=1024),e}function po(){var t=0!==oo;return oo=0,t}function yo(t,e,i){e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i}function xo(t){if(io){for(t=t.memoizedState;null!==t;){var e=t.queue;null!==e&&(e.pending=null),t=t.next}io=!1}Zs=0,eo=to=Qs=null,no=!1,ro=oo=0,ao=null}function bo(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===eo?Qs.memoizedState=eo=t:eo=eo.next=t,eo}function vo(){if(null===to){var t=Qs.alternate;t=null!==t?t.memoizedState:null}else t=to.next;var e=null===eo?Qs.memoizedState:eo.next;if(null!==e)eo=e,to=t;else{if(null===t){if(null===Qs.alternate)throw Error(r(467));throw Error(r(310))}t={memoizedState:(to=t).memoizedState,baseState:to.baseState,baseQueue:to.baseQueue,queue:to.queue,next:null},null===eo?Qs.memoizedState=eo=t:eo=eo.next=t}return eo}function wo(t){var e=ro;return ro+=1,null===ao&&(ao=[]),t=cs(ao,t,e),e=Qs,null===(null===eo?e.memoizedState:eo.next)&&(e=e.alternate,A.H=null===e||null===e.memoizedState?Cr:Nr),t}function ko(t){if(null!==t&&"object"===typeof t){if("function"===typeof t.then)return wo(t);if(t.$$typeof===p)return Ma(t)}throw Error(r(438,String(t)))}function So(t){var e=null,i=Qs.updateQueue;if(null!==i&&(e=i.memoCache),null==e){var n=Qs.alternate;null!==n&&(null!==(n=n.updateQueue)&&(null!=(n=n.memoCache)&&(e={data:n.data.map((function(t){return t.slice()})),index:0})))}if(null==e&&(e={data:[],index:0}),null===i&&(i={lastEffect:null,events:null,stores:null,memoCache:null},Qs.updateQueue=i),i.memoCache=e,void 0===(i=e.data[e.index]))for(i=e.data[e.index]=Array(t),n=0;n<t;n++)i[n]=S;return e.index++,i}function Po(t,e){return"function"===typeof e?e(t):e}function Mo(t){return Co(vo(),to,t)}function Co(t,e,i){var n=t.queue;if(null===n)throw Error(r(311));n.lastRenderedReducer=i;var s=t.baseQueue,o=n.pending;if(null!==o){if(null!==s){var a=s.next;s.next=o.next,o.next=a}e.baseQueue=s=o,n.pending=null}if(o=t.baseState,null===s)t.memoizedState=o;else{var l=a=null,h=null,u=e=s.next,c=!1;do{var d=-536870913&u.lane;if(d!==u.lane?(nh&d)===d:(Zs&d)===d){var f=u.revertLane;if(0===f)null!==h&&(h=h.next={lane:0,revertLane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),d===Xs&&(c=!0);else{if((Zs&f)===f){u=u.next,f===Xs&&(c=!0);continue}d={lane:0,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===h?(l=h=d,a=o):h=h.next=d,Qs.lanes|=f,ch|=f}d=u.action,so&&i(o,d),o=u.hasEagerState?u.eagerState:i(o,d)}else f={lane:d,revertLane:u.revertLane,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===h?(l=h=f,a=o):h=h.next=f,Qs.lanes|=d,ch|=d;u=u.next}while(null!==u&&u!==e);if(null===h?a=o:h.next=l,!Hi(o,t.memoizedState)&&(Xr=!0,c&&null!==(i=Ys)))throw i;t.memoizedState=o,t.baseState=a,t.baseQueue=h,n.lastRenderedState=o}return null===s&&(n.lanes=0),[t.memoizedState,n.dispatch]}function No(t){var e=vo(),i=e.queue;if(null===i)throw Error(r(311));i.lastRenderedReducer=t;var n=i.dispatch,s=i.pending,o=e.memoizedState;if(null!==s){i.pending=null;var a=s=s.next;do{o=t(o,a.action),a=a.next}while(a!==s);Hi(o,e.memoizedState)||(Xr=!0),e.memoizedState=o,null===e.baseQueue&&(e.baseState=o),i.lastRenderedState=o}return[o,n]}function To(t,e,i){var n=Qs,s=vo(),o=$n;if(o){if(void 0===i)throw Error(r(407));i=i()}else i=e();var a=!Hi((to||s).memoizedState,i);if(a&&(s.memoizedState=i,Xr=!0),s=s.queue,Qo(Do.bind(null,n,s,t),[t]),s.getSnapshot!==e||a||null!==eo&&1&eo.memoizedState.tag){if(n.flags|=2048,qo(9,Ao.bind(null,n,s,i,e),{destroy:void 0},null),null===eh)throw Error(r(349));o||0!==(60&Zs)||Lo(n,e,i)}return i}function Lo(t,e,i){t.flags|=16384,t={getSnapshot:e,value:i},null===(e=Qs.updateQueue)?(e={lastEffect:null,events:null,stores:null,memoCache:null},Qs.updateQueue=e,e.stores=[t]):null===(i=e.stores)?e.stores=[t]:i.push(t)}function Ao(t,e,i,n){e.value=i,e.getSnapshot=n,Fo(e)&&Oo(t)}function Do(t,e,i){return i((function(){Fo(e)&&Oo(t)}))}function Fo(t){var e=t.getSnapshot;t=t.value;try{var i=e();return!Hi(t,i)}catch(n){return!0}}function Oo(t){var e=Ln(t,2);null!==e&&Fh(e,t,2)}function Ro(t){var e=bo();if("function"===typeof t){var i=t;if(t=i(),so){bt(!0);try{i()}finally{bt(!1)}}}return e.memoizedState=e.baseState=t,e.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Po,lastRenderedState:t},e}function Eo(t,e,i,n){return t.baseState=i,Co(t,to,"function"===typeof n?n:Po)}function Bo(t,e,i,n,s){if(kr(t))throw Error(r(485));if(null!==(t=e.action)){var o={payload:s,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(t){o.listeners.push(t)}};null!==A.T?i(!0):o.isTransition=!1,n(o),null===(i=e.pending)?(o.next=e.pending=o,Io(e,o)):(o.next=i.next,e.pending=i.next=o)}}function Io(t,e){var i=e.action,n=e.payload,s=t.state;if(e.isTransition){var o=A.T,r={};A.T=r;try{var a=i(s,n),l=A.S;null!==l&&l(r,a),zo(t,e,a)}catch(h){jo(t,e,h)}finally{A.T=o}}else try{zo(t,e,o=i(s,n))}catch(u){jo(t,e,u)}}function zo(t,e,i){null!==i&&"object"===typeof i&&"function"===typeof i.then?i.then((function(i){Vo(t,e,i)}),(function(i){return jo(t,e,i)})):Vo(t,e,i)}function Vo(t,e,i){e.status="fulfilled",e.value=i,Uo(e),t.state=i,null!==(e=t.pending)&&((i=e.next)===e?t.pending=null:(i=i.next,e.next=i,Io(t,i)))}function jo(t,e,i){var n=t.pending;if(t.pending=null,null!==n){n=n.next;do{e.status="rejected",e.reason=i,Uo(e),e=e.next}while(e!==n)}t.action=null}function Uo(t){t=t.listeners;for(var e=0;e<t.length;e++)(0,t[e])()}function Go(t,e){return e}function Ko(t,e){if($n){var i=eh.formState;if(null!==i){t:{var n=Qs;if($n){if(Wn){e:{for(var s=Wn,o=Zn;8!==s.nodeType;){if(!o){s=null;break e}if(null===(s=ac(s.nextSibling))){s=null;break e}}s="F!"===(o=s.data)||"F"===o?s:null}if(s){Wn=ac(s.nextSibling),n="F!"===s.data;break t}}ts(n)}n=!1}n&&(e=i[0])}}return(i=bo()).memoizedState=i.baseState=e,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Go,lastRenderedState:e},i.queue=n,i=br.bind(null,Qs,n),n.dispatch=i,n=Ro(!1),o=wr.bind(null,Qs,!1,n.queue),s={state:e,dispatch:null,action:t,pending:null},(n=bo()).queue=s,i=Bo.bind(null,Qs,s,o,i),s.dispatch=i,n.memoizedState=t,[e,i,!1]}function Xo(t){return Yo(vo(),to,t)}function Yo(t,e,i){e=Co(t,e,Go)[0],t=Mo(Po)[0],e="object"===typeof e&&null!==e&&"function"===typeof e.then?wo(e):e;var n=vo(),s=n.queue,o=s.dispatch;return i!==n.memoizedState&&(Qs.flags|=2048,qo(9,_o.bind(null,s,i),{destroy:void 0},null)),[e,o,t]}function _o(t,e){t.action=e}function Ho(t){var e=vo(),i=to;if(null!==i)return Yo(e,i,t);vo(),e=e.memoizedState;var n=(i=vo()).queue.dispatch;return i.memoizedState=t,[e,n,!1]}function qo(t,e,i,n){return t={tag:t,create:e,inst:i,deps:n,next:null},null===(e=Qs.updateQueue)&&(e={lastEffect:null,events:null,stores:null,memoCache:null},Qs.updateQueue=e),null===(i=e.lastEffect)?e.lastEffect=t.next=t:(n=i.next,i.next=t,t.next=n,e.lastEffect=t),t}function Wo(){return vo().memoizedState}function $o(t,e,i,n){var s=bo();Qs.flags|=t,s.memoizedState=qo(1|e,i,{destroy:void 0},void 0===n?null:n)}function Jo(t,e,i,n){var s=vo();n=void 0===n?null:n;var o=s.memoizedState.inst;null!==to&&null!==n&&uo(n,to.memoizedState.deps)?s.memoizedState=qo(e,i,o,n):(Qs.flags|=t,s.memoizedState=qo(1|e,i,o,n))}function Zo(t,e){$o(8390656,8,t,e)}function Qo(t,e){Jo(2048,8,t,e)}function tr(t,e){return Jo(4,2,t,e)}function er(t,e){return Jo(4,4,t,e)}function ir(t,e){if("function"===typeof e){t=t();var i=e(t);return function(){"function"===typeof i?i():e(null)}}if(null!==e&&void 0!==e)return t=t(),e.current=t,function(){e.current=null}}function nr(t,e,i){i=null!==i&&void 0!==i?i.concat([t]):null,Jo(4,4,ir.bind(null,e,t),i)}function sr(){}function or(t,e){var i=vo();e=void 0===e?null:e;var n=i.memoizedState;return null!==e&&uo(e,n[1])?n[0]:(i.memoizedState=[t,e],t)}function rr(t,e){var i=vo();e=void 0===e?null:e;var n=i.memoizedState;if(null!==e&&uo(e,n[1]))return n[0];if(n=t(),so){bt(!0);try{t()}finally{bt(!1)}}return i.memoizedState=[n,e],n}function ar(t,e,i){return void 0===i||0!==(1073741824&Zs)?t.memoizedState=e:(t.memoizedState=i,t=Dh(),Qs.lanes|=t,ch|=t,i)}function lr(t,e,i,n){return Hi(i,e)?i:null!==Ss.current?(t=ar(t,i,n),Hi(t,e)||(Xr=!0),t):0===(42&Zs)?(Xr=!0,t.memoizedState=i):(t=Dh(),Qs.lanes|=t,ch|=t,e)}function hr(t,e,i,n,s){var o=G.p;G.p=0!==o&&8>o?o:8;var r=A.T,a={};A.T=a,wr(t,!1,e,i);try{var l=s(),h=A.S;if(null!==h&&h(a,l),null!==l&&"object"===typeof l&&"function"===typeof l.then)vr(t,e,function(t,e){var i=[],n={status:"pending",value:null,reason:null,then:function(t){i.push(t)}};return t.then((function(){n.status="fulfilled",n.value=e;for(var t=0;t<i.length;t++)(0,i[t])(e)}),(function(t){for(n.status="rejected",n.reason=t,t=0;t<i.length;t++)(0,i[t])(void 0)})),n}(l,n),Ah());else vr(t,e,n,Ah())}catch(u){vr(t,e,{then:function(){},status:"rejected",reason:u},Ah())}finally{G.p=o,A.T=r}}function ur(){}function cr(t,e,i,n){if(5!==t.tag)throw Error(r(476));var s=dr(t).queue;hr(t,s,e,K,null===i?ur:function(){return fr(t),i(n)})}function dr(t){var e=t.memoizedState;if(null!==e)return e;var i={};return(e={memoizedState:K,baseState:K,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Po,lastRenderedState:K},next:null}).next={memoizedState:i,baseState:i,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Po,lastRenderedState:i},next:null},t.memoizedState=e,null!==(t=t.alternate)&&(t.memoizedState=e),e}function fr(t){vr(t,dr(t).next.queue,{},Ah())}function gr(){return Ma(Bc)}function mr(){return vo().memoizedState}function pr(){return vo().memoizedState}function yr(t){for(var e=t.return;null!==e;){switch(e.tag){case 24:case 3:var i=Ah(),n=Fa(e,t=Da(i),i);return null!==n&&(Fh(n,e,i),Oa(n,e,i)),e={cache:js()},void(t.payload=e)}e=e.return}}function xr(t,e,i){var n=Ah();i={lane:n,revertLane:0,action:i,hasEagerState:!1,eagerState:null,next:null},kr(t)?Sr(e,i):null!==(i=Tn(t,e,i,n))&&(Fh(i,t,n),Pr(i,e,n))}function br(t,e,i){vr(t,e,i,Ah())}function vr(t,e,i,n){var s={lane:n,revertLane:0,action:i,hasEagerState:!1,eagerState:null,next:null};if(kr(t))Sr(e,s);else{var o=t.alternate;if(0===t.lanes&&(null===o||0===o.lanes)&&null!==(o=e.lastRenderedReducer))try{var r=e.lastRenderedState,a=o(r,i);if(s.hasEagerState=!0,s.eagerState=a,Hi(a,r))return Nn(t,e,s,0),null===eh&&Cn(),!1}catch(l){}if(null!==(i=Tn(t,e,s,n)))return Fh(i,t,n),Pr(i,e,n),!0}return!1}function wr(t,e,i,n){if(n={lane:2,revertLane:wu(),action:n,hasEagerState:!1,eagerState:null,next:null},kr(t)){if(e)throw Error(r(479))}else null!==(e=Tn(t,i,n,2))&&Fh(e,t,2)}function kr(t){var e=t.alternate;return t===Qs||null!==e&&e===Qs}function Sr(t,e){no=io=!0;var i=t.pending;null===i?e.next=e:(e.next=i.next,i.next=e),t.pending=e}function Pr(t,e,i){if(0!==(4194176&i)){var n=e.lanes;i|=n&=t.pendingLanes,e.lanes=i,Rt(t,i)}}var Mr={readContext:Ma,use:ko,useCallback:ho,useContext:ho,useEffect:ho,useImperativeHandle:ho,useLayoutEffect:ho,useInsertionEffect:ho,useMemo:ho,useReducer:ho,useRef:ho,useState:ho,useDebugValue:ho,useDeferredValue:ho,useTransition:ho,useSyncExternalStore:ho,useId:ho};Mr.useCacheRefresh=ho,Mr.useMemoCache=ho,Mr.useHostTransitionStatus=ho,Mr.useFormState=ho,Mr.useActionState=ho,Mr.useOptimistic=ho;var Cr={readContext:Ma,use:ko,useCallback:function(t,e){return bo().memoizedState=[t,void 0===e?null:e],t},useContext:Ma,useEffect:Zo,useImperativeHandle:function(t,e,i){i=null!==i&&void 0!==i?i.concat([t]):null,$o(4194308,4,ir.bind(null,e,t),i)},useLayoutEffect:function(t,e){return $o(4194308,4,t,e)},useInsertionEffect:function(t,e){$o(4,2,t,e)},useMemo:function(t,e){var i=bo();e=void 0===e?null:e;var n=t();if(so){bt(!0);try{t()}finally{bt(!1)}}return i.memoizedState=[n,e],n},useReducer:function(t,e,i){var n=bo();if(void 0!==i){var s=i(e);if(so){bt(!0);try{i(e)}finally{bt(!1)}}}else s=e;return n.memoizedState=n.baseState=s,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:s},n.queue=t,t=t.dispatch=xr.bind(null,Qs,t),[n.memoizedState,t]},useRef:function(t){return t={current:t},bo().memoizedState=t},useState:function(t){var e=(t=Ro(t)).queue,i=br.bind(null,Qs,e);return e.dispatch=i,[t.memoizedState,i]},useDebugValue:sr,useDeferredValue:function(t,e){return ar(bo(),t,e)},useTransition:function(){var t=Ro(!1);return t=hr.bind(null,Qs,t.queue,!0,!1),bo().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,e,i){var n=Qs,s=bo();if($n){if(void 0===i)throw Error(r(407));i=i()}else{if(i=e(),null===eh)throw Error(r(349));0!==(60&nh)||Lo(n,e,i)}s.memoizedState=i;var o={value:i,getSnapshot:e};return s.queue=o,Zo(Do.bind(null,n,o,t),[t]),n.flags|=2048,qo(9,Ao.bind(null,n,o,i,e),{destroy:void 0},null),i},useId:function(){var t=bo(),e=eh.identifierPrefix;if($n){var i=Kn;e=":"+e+"R"+(i=(Gn&~(1<<32-vt(Gn)-1)).toString(32)+i),0<(i=oo++)&&(e+="H"+i.toString(32)),e+=":"}else e=":"+e+"r"+(i=lo++).toString(32)+":";return t.memoizedState=e},useCacheRefresh:function(){return bo().memoizedState=yr.bind(null,Qs)}};Cr.useMemoCache=So,Cr.useHostTransitionStatus=gr,Cr.useFormState=Ko,Cr.useActionState=Ko,Cr.useOptimistic=function(t){var e=bo();e.memoizedState=e.baseState=t;var i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return e.queue=i,e=wr.bind(null,Qs,!0,i),i.dispatch=e,[t,e]};var Nr={readContext:Ma,use:ko,useCallback:or,useContext:Ma,useEffect:Qo,useImperativeHandle:nr,useInsertionEffect:tr,useLayoutEffect:er,useMemo:rr,useReducer:Mo,useRef:Wo,useState:function(){return Mo(Po)},useDebugValue:sr,useDeferredValue:function(t,e){return lr(vo(),to.memoizedState,t,e)},useTransition:function(){var t=Mo(Po)[0],e=vo().memoizedState;return["boolean"===typeof t?t:wo(t),e]},useSyncExternalStore:To,useId:mr};Nr.useCacheRefresh=pr,Nr.useMemoCache=So,Nr.useHostTransitionStatus=gr,Nr.useFormState=Xo,Nr.useActionState=Xo,Nr.useOptimistic=function(t,e){return Eo(vo(),0,t,e)};var Tr={readContext:Ma,use:ko,useCallback:or,useContext:Ma,useEffect:Qo,useImperativeHandle:nr,useInsertionEffect:tr,useLayoutEffect:er,useMemo:rr,useReducer:No,useRef:Wo,useState:function(){return No(Po)},useDebugValue:sr,useDeferredValue:function(t,e){var i=vo();return null===to?ar(i,t,e):lr(i,to.memoizedState,t,e)},useTransition:function(){var t=No(Po)[0],e=vo().memoizedState;return["boolean"===typeof t?t:wo(t),e]},useSyncExternalStore:To,useId:mr};function Lr(t,e,i,n){i=null===(i=i(n,e=t.memoizedState))||void 0===i?e:D({},e,i),t.memoizedState=i,0===t.lanes&&(t.updateQueue.baseState=i)}Tr.useCacheRefresh=pr,Tr.useMemoCache=So,Tr.useHostTransitionStatus=gr,Tr.useFormState=Ho,Tr.useActionState=Ho,Tr.useOptimistic=function(t,e){var i=vo();return null!==to?Eo(i,0,t,e):(i.baseState=t,[t,i.queue.dispatch])};var Ar={isMounted:function(t){return!!(t=t._reactInternals)&&I(t)===t},enqueueSetState:function(t,e,i){t=t._reactInternals;var n=Ah(),s=Da(n);s.payload=e,void 0!==i&&null!==i&&(s.callback=i),null!==(e=Fa(t,s,n))&&(Fh(e,t,n),Oa(e,t,n))},enqueueReplaceState:function(t,e,i){t=t._reactInternals;var n=Ah(),s=Da(n);s.tag=1,s.payload=e,void 0!==i&&null!==i&&(s.callback=i),null!==(e=Fa(t,s,n))&&(Fh(e,t,n),Oa(e,t,n))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var i=Ah(),n=Da(i);n.tag=2,void 0!==e&&null!==e&&(n.callback=e),null!==(e=Fa(t,n,i))&&(Fh(e,t,i),Oa(e,t,i))}};function Dr(t,e,i,n,s,o,r){return"function"===typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(n,o,r):!e.prototype||!e.prototype.isPureReactComponent||(!qi(i,n)||!qi(s,o))}function Fr(t,e,i,n){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(i,n),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(i,n),e.state!==t&&Ar.enqueueReplaceState(e,e.state,null)}function Or(t,e){var i=e;if("ref"in e)for(var n in i={},e)"ref"!==n&&(i[n]=e[n]);if(t=t.defaultProps)for(var s in i===e&&(i=D({},i)),t)void 0===i[s]&&(i[s]=t[s]);return i}var Rr="function"===typeof reportError?reportError:function(t){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof t&&null!==t&&"string"===typeof t.message?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",t);console.error(t)};function Er(t){Rr(t)}function Br(t){console.error(t)}function Ir(t){Rr(t)}function zr(t,e){try{(0,t.onUncaughtError)(e.value,{componentStack:e.stack})}catch(i){setTimeout((function(){throw i}))}}function Vr(t,e,i){try{(0,t.onCaughtError)(i.value,{componentStack:i.stack,errorBoundary:1===e.tag?e.stateNode:null})}catch(n){setTimeout((function(){throw n}))}}function jr(t,e,i){return(i=Da(i)).tag=3,i.payload={element:null},i.callback=function(){zr(t,e)},i}function Ur(t){return(t=Da(t)).tag=3,t}function Gr(t,e,i,n){var s=i.type.getDerivedStateFromError;if("function"===typeof s){var o=n.value;t.payload=function(){return s(o)},t.callback=function(){Vr(e,i,n)}}var r=i.stateNode;null!==r&&"function"===typeof r.componentDidCatch&&(t.callback=function(){Vr(e,i,n),"function"!==typeof s&&(null===kh?kh=new Set([this]):kh.add(this));var t=n.stack;this.componentDidCatch(n.value,{componentStack:null!==t?t:""})})}var Kr=Error(r(461)),Xr=!1;function Yr(t,e,i,n){e.child=null===t?ks(e,null,i,n):ws(e,t.child,i,n)}function _r(t,e,i,n,s){i=i.render;var o=e.ref;if("ref"in n){var r={};for(var a in n)"ref"!==a&&(r[a]=n[a])}else r=n;return Pa(e),n=co(t,e,i,r,o,s),a=po(),null===t||Xr?($n&&a&&_n(e),e.flags|=1,Yr(t,e,n,s),e.child):(yo(t,e,s),da(t,e,s))}function Hr(t,e,i,n,s){if(null===t){var o=i.type;return"function"!==typeof o||Bl(o)||void 0!==o.defaultProps||null!==i.compare?((t=Vl(i.type,null,n,e,e.mode,s)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=o,qr(t,e,o,n,s))}if(o=t.child,!fa(t,s)){var r=o.memoizedProps;if((i=null!==(i=i.compare)?i:qi)(r,n)&&t.ref===e.ref)return da(t,e,s)}return e.flags|=1,(t=Il(o,n)).ref=e.ref,t.return=e,e.child=t}function qr(t,e,i,n,s){if(null!==t){var o=t.memoizedProps;if(qi(o,n)&&t.ref===e.ref){if(Xr=!1,e.pendingProps=n=o,!fa(t,s))return e.lanes=t.lanes,da(t,e,s);0!==(131072&t.flags)&&(Xr=!0)}}return Zr(t,e,i,n,s)}function Wr(t,e,i){var n=e.pendingProps,s=n.children,o=0!==(2&e.stateNode._pendingVisibility),r=null!==t?t.memoizedState:null;if(Jr(t,e),"hidden"===n.mode||o){if(0!==(128&e.flags)){if(n=null!==r?r.baseLanes|i:i,null!==t){for(s=e.child=t.child,o=0;null!==s;)o=o|s.lanes|s.childLanes,s=s.sibling;e.childLanes=o&~n}else e.childLanes=0,e.child=null;return $r(t,e,n,i)}if(0===(536870912&i))return e.lanes=e.childLanes=536870912,$r(t,e,null!==r?r.baseLanes|i:i,i);e.memoizedState={baseLanes:0,cachePool:null},null!==t&&$s(0,null!==r?r.cachePool:null),null!==r?Ms(e,r):Cs(),Ds(e)}else null!==r?($s(0,r.cachePool),Ms(e,r),Fs(),e.memoizedState=null):(null!==t&&$s(0,null),Cs(),Fs());return Yr(t,e,s,i),e.child}function $r(t,e,i,n){var s=Ws();return s=null===s?null:{parent:Vs._currentValue,pool:s},e.memoizedState={baseLanes:i,cachePool:s},null!==t&&$s(0,null),Cs(),Ds(e),null!==t&&ka(t,e,n,!0),null}function Jr(t,e){var i=e.ref;if(null===i)null!==t&&null!==t.ref&&(e.flags|=2097664);else{if("function"!==typeof i&&"object"!==typeof i)throw Error(r(284));null!==t&&t.ref===i||(e.flags|=2097664)}}function Zr(t,e,i,n,s){return Pa(e),i=co(t,e,i,n,void 0,s),n=po(),null===t||Xr?($n&&n&&_n(e),e.flags|=1,Yr(t,e,i,s),e.child):(yo(t,e,s),da(t,e,s))}function Qr(t,e,i,n,s,o){return Pa(e),e.updateQueue=null,i=go(e,n,i,s),fo(t),n=po(),null===t||Xr?($n&&n&&_n(e),e.flags|=1,Yr(t,e,i,o),e.child):(yo(t,e,o),da(t,e,o))}function ta(t,e,i,n,s){if(Pa(e),null===e.stateNode){var o=Fn,r=i.contextType;"object"===typeof r&&null!==r&&(o=Ma(r)),o=new i(n,o),e.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,o.updater=Ar,e.stateNode=o,o._reactInternals=e,(o=e.stateNode).props=n,o.state=e.memoizedState,o.refs={},La(e),r=i.contextType,o.context="object"===typeof r&&null!==r?Ma(r):Fn,o.state=e.memoizedState,"function"===typeof(r=i.getDerivedStateFromProps)&&(Lr(e,i,r,n),o.state=e.memoizedState),"function"===typeof i.getDerivedStateFromProps||"function"===typeof o.getSnapshotBeforeUpdate||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||(r=o.state,"function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),r!==o.state&&Ar.enqueueReplaceState(o,o.state,null),Ia(e,n,o,s),Ba(),o.state=e.memoizedState),"function"===typeof o.componentDidMount&&(e.flags|=4194308),n=!0}else if(null===t){o=e.stateNode;var a=e.memoizedProps,l=Or(i,a);o.props=l;var h=o.context,u=i.contextType;r=Fn,"object"===typeof u&&null!==u&&(r=Ma(u));var c=i.getDerivedStateFromProps;u="function"===typeof c||"function"===typeof o.getSnapshotBeforeUpdate,a=e.pendingProps!==a,u||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a||h!==r)&&Fr(e,o,n,r),Ta=!1;var d=e.memoizedState;o.state=d,Ia(e,n,o,s),Ba(),h=e.memoizedState,a||d!==h||Ta?("function"===typeof c&&(Lr(e,i,c,n),h=e.memoizedState),(l=Ta||Dr(e,i,l,n,d,h,r))?(u||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(e.flags|=4194308)):("function"===typeof o.componentDidMount&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=h),o.props=n,o.state=h,o.context=r,n=l):("function"===typeof o.componentDidMount&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,Aa(t,e),u=Or(i,r=e.memoizedProps),o.props=u,c=e.pendingProps,d=o.context,h=i.contextType,l=Fn,"object"===typeof h&&null!==h&&(l=Ma(h)),(h="function"===typeof(a=i.getDerivedStateFromProps)||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(r!==c||d!==l)&&Fr(e,o,n,l),Ta=!1,d=e.memoizedState,o.state=d,Ia(e,n,o,s),Ba();var f=e.memoizedState;r!==c||d!==f||Ta||null!==t&&null!==t.dependencies&&Sa(t.dependencies)?("function"===typeof a&&(Lr(e,i,a,n),f=e.memoizedState),(u=Ta||Dr(e,i,u,n,d,f,l)||null!==t&&null!==t.dependencies&&Sa(t.dependencies))?(h||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(n,f,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(n,f,l)),"function"===typeof o.componentDidUpdate&&(e.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(e.flags|=1024)):("function"!==typeof o.componentDidUpdate||r===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||r===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=f),o.props=n,o.state=f,o.context=l,n=u):("function"!==typeof o.componentDidUpdate||r===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||r===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),n=!1)}return o=n,Jr(t,e),n=0!==(128&e.flags),o||n?(o=e.stateNode,i=n&&"function"!==typeof i.getDerivedStateFromError?null:o.render(),e.flags|=1,null!==t&&n?(e.child=ws(e,t.child,null,s),e.child=ws(e,null,i,s)):Yr(t,e,i,s),e.memoizedState=o.state,t=e.child):t=da(t,e,s),t}function ea(t,e,i,n){return ss(),e.flags|=256,Yr(t,e,i,n),e.child}var ia={dehydrated:null,treeContext:null,retryLane:0};function na(t){return{baseLanes:t,cachePool:Js()}}function sa(t,e,i){return t=null!==t?t.childLanes&~i:0,e&&(t|=gh),t}function oa(t,e,i){var n,s=e.pendingProps,o=!1,a=0!==(128&e.flags);if((n=a)||(n=(null===t||null!==t.memoizedState)&&0!==(2&Rs.current)),n&&(o=!0,e.flags&=-129),n=0!==(32&e.flags),e.flags&=-33,null===t){if($n){if(o?As(e):Fs(),$n){var l,h=Wn;if(l=h){t:{for(l=h,h=Zn;8!==l.nodeType;){if(!h){h=null;break t}if(null===(l=ac(l.nextSibling))){h=null;break t}}h=l}null!==h?(e.memoizedState={dehydrated:h,treeContext:null!==Un?{id:Gn,overflow:Kn}:null,retryLane:536870912},(l=El(18,null,null,0)).stateNode=h,l.return=e,e.child=l,qn=e,Wn=null,l=!0):l=!1}l||ts(e)}if(null!==(h=e.memoizedState)&&null!==(h=h.dehydrated))return"$!"===h.data?e.lanes=16:e.lanes=536870912,null;Os(e)}return h=s.children,s=s.fallback,o?(Fs(),h=aa({mode:"hidden",children:h},o=e.mode),s=jl(s,o,i,null),h.return=e,s.return=e,h.sibling=s,e.child=h,(o=e.child).memoizedState=na(i),o.childLanes=sa(t,n,i),e.memoizedState=ia,s):(As(e),ra(e,h))}if(null!==(l=t.memoizedState)&&null!==(h=l.dehydrated)){if(a)256&e.flags?(As(e),e.flags&=-257,e=la(t,e,i)):null!==e.memoizedState?(Fs(),e.child=t.child,e.flags|=128,e=null):(Fs(),o=s.fallback,h=e.mode,s=aa({mode:"visible",children:s.children},h),(o=jl(o,h,i,null)).flags|=2,s.return=e,o.return=e,s.sibling=o,e.child=s,ws(e,t.child,null,i),(s=e.child).memoizedState=na(i),s.childLanes=sa(t,n,i),e.memoizedState=ia,e=o);else if(As(e),"$!"===h.data){if(n=h.nextSibling&&h.nextSibling.dataset)var u=n.dgst;n=u,(s=Error(r(419))).stack="",s.digest=n,os({value:s,source:null,stack:null}),e=la(t,e,i)}else if(Xr||ka(t,e,i,!1),n=0!==(i&t.childLanes),Xr||n){if(null!==(n=eh)){if(0!==(42&(s=i&-i)))s=1;else switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=64;break;case 268435456:s=134217728;break;default:s=0}if(0!==(s=0!==(s&(n.suspendedLanes|i))?0:s)&&s!==l.retryLane)throw l.retryLane=s,Ln(t,s),Fh(n,t,s),Kr}"$?"===h.data||Xh(),e=la(t,e,i)}else"$?"===h.data?(e.flags|=128,e.child=t.child,e=au.bind(null,t),h._reactRetry=e,e=null):(t=l.treeContext,Wn=ac(h.nextSibling),qn=e,$n=!0,Jn=null,Zn=!1,null!==t&&(Vn[jn++]=Gn,Vn[jn++]=Kn,Vn[jn++]=Un,Gn=t.id,Kn=t.overflow,Un=e),(e=ra(e,s.children)).flags|=4096);return e}return o?(Fs(),o=s.fallback,h=e.mode,u=(l=t.child).sibling,(s=Il(l,{mode:"hidden",children:s.children})).subtreeFlags=31457280&l.subtreeFlags,null!==u?o=Il(u,o):(o=jl(o,h,i,null)).flags|=2,o.return=e,s.return=e,s.sibling=o,e.child=s,s=o,o=e.child,null===(h=t.child.memoizedState)?h=na(i):(null!==(l=h.cachePool)?(u=Vs._currentValue,l=l.parent!==u?{parent:u,pool:u}:l):l=Js(),h={baseLanes:h.baseLanes|i,cachePool:l}),o.memoizedState=h,o.childLanes=sa(t,n,i),e.memoizedState=ia,s):(As(e),t=(i=t.child).sibling,(i=Il(i,{mode:"visible",children:s.children})).return=e,i.sibling=null,null!==t&&(null===(n=e.deletions)?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i)}function ra(t,e){return(e=aa({mode:"visible",children:e},t.mode)).return=t,t.child=e}function aa(t,e){return Ul(t,e,0,null)}function la(t,e,i){return ws(e,t.child,null,i),(t=ra(e,e.pendingProps.children)).flags|=2,e.memoizedState=null,t}function ha(t,e,i){t.lanes|=e;var n=t.alternate;null!==n&&(n.lanes|=e),va(t.return,e,i)}function ua(t,e,i,n,s){var o=t.memoizedState;null===o?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:i,tailMode:s}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=i,o.tailMode=s)}function ca(t,e,i){var n=e.pendingProps,s=n.revealOrder,o=n.tail;if(Yr(t,e,n.children,i),0!==(2&(n=Rs.current)))n=1&n|2,e.flags|=128;else{if(null!==t&&0!==(128&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&ha(t,i,e);else if(19===t.tag)ha(t,i,e);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}switch(q(Rs,n),s){case"forwards":for(i=e.child,s=null;null!==i;)null!==(t=i.alternate)&&null===Es(t)&&(s=i),i=i.sibling;null===(i=s)?(s=e.child,e.child=null):(s=i.sibling,i.sibling=null),ua(e,!1,s,i,o);break;case"backwards":for(i=null,s=e.child,e.child=null;null!==s;){if(null!==(t=s.alternate)&&null===Es(t)){e.child=s;break}t=s.sibling,s.sibling=i,i=s,s=t}ua(e,!0,i,null,o);break;case"together":ua(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function da(t,e,i){if(null!==t&&(e.dependencies=t.dependencies),ch|=e.lanes,0===(i&e.childLanes)){if(null===t)return null;if(ka(t,e,i,!1),0===(i&e.childLanes))return null}if(null!==t&&e.child!==t.child)throw Error(r(153));if(null!==e.child){for(i=Il(t=e.child,t.pendingProps),e.child=i,i.return=e;null!==t.sibling;)t=t.sibling,(i=i.sibling=Il(t,t.pendingProps)).return=e;i.sibling=null}return e.child}function fa(t,e){return 0!==(t.lanes&e)||!(null===(t=t.dependencies)||!Sa(t))}function ga(t,e,i){if(null!==t)if(t.memoizedProps!==e.pendingProps)Xr=!0;else{if(!fa(t,i)&&0===(128&e.flags))return Xr=!1,function(t,e,i){switch(e.tag){case 3:Q(e,e.stateNode.containerInfo),xa(e,Vs,t.memoizedState.cache),ss();break;case 27:case 5:et(e);break;case 4:Q(e,e.stateNode.containerInfo);break;case 10:xa(e,e.type,e.memoizedProps.value);break;case 13:var n=e.memoizedState;if(null!==n)return null!==n.dehydrated?(As(e),e.flags|=128,null):0!==(i&e.child.childLanes)?oa(t,e,i):(As(e),null!==(t=da(t,e,i))?t.sibling:null);As(e);break;case 19:var s=0!==(128&t.flags);if((n=0!==(i&e.childLanes))||(ka(t,e,i,!1),n=0!==(i&e.childLanes)),s){if(n)return ca(t,e,i);e.flags|=128}if(null!==(s=e.memoizedState)&&(s.rendering=null,s.tail=null,s.lastEffect=null),q(Rs,Rs.current),n)break;return null;case 22:case 23:return e.lanes=0,Wr(t,e,i);case 24:xa(e,Vs,t.memoizedState.cache)}return da(t,e,i)}(t,e,i);Xr=0!==(131072&t.flags)}else Xr=!1,$n&&0!==(1048576&e.flags)&&Yn(e,zn,e.index);switch(e.lanes=0,e.tag){case 16:t:{t=e.pendingProps;var n=e.elementType,s=n._init;if(n=s(n._payload),e.type=n,"function"!==typeof n){if(void 0!==n&&null!==n){if((s=n.$$typeof)===y){e.tag=11,e=_r(null,e,n,t,i);break t}if(s===v){e.tag=14,e=Hr(null,e,n,t,i);break t}}throw e=N(n)||n,Error(r(306,e,""))}Bl(n)?(t=Or(n,t),e.tag=1,e=ta(null,e,n,t,i)):(e.tag=0,e=Zr(null,e,n,t,i))}return e;case 0:return Zr(t,e,e.type,e.pendingProps,i);case 1:return ta(t,e,n=e.type,s=Or(n,e.pendingProps),i);case 3:t:{if(Q(e,e.stateNode.containerInfo),null===t)throw Error(r(387));var o=e.pendingProps;n=(s=e.memoizedState).element,Aa(t,e),Ia(e,o,null,i);var a=e.memoizedState;if(o=a.cache,xa(e,Vs,o),o!==s.cache&&wa(e,[Vs],i,!0),Ba(),o=a.element,s.isDehydrated){if(s={element:o,isDehydrated:!1,cache:a.cache},e.updateQueue.baseState=s,e.memoizedState=s,256&e.flags){e=ea(t,e,o,i);break t}if(o!==n){os(n=Rn(Error(r(424)),e)),e=ea(t,e,o,i);break t}for(Wn=ac(e.stateNode.containerInfo.firstChild),qn=e,$n=!0,Jn=null,Zn=!0,i=ks(e,null,o,i),e.child=i;i;)i.flags=-3&i.flags|4096,i=i.sibling}else{if(ss(),o===n){e=da(t,e,i);break t}Yr(t,e,o,i)}e=e.child}return e;case 26:return Jr(t,e),null===t?(i=pc(e.type,null,e.pendingProps,null))?e.memoizedState=i:$n||(i=e.type,t=e.pendingProps,(n=Wu(J.current).createElement(i))[zt]=e,n[Vt]=t,_u(n,i,t),Jt(n),e.stateNode=n):e.memoizedState=pc(e.type,t.memoizedProps,e.pendingProps,t.memoizedState),null;case 27:return et(e),null===t&&$n&&(n=e.stateNode=hc(e.type,e.pendingProps,J.current),qn=e,Zn=!0,Wn=ac(n.firstChild)),n=e.pendingProps.children,null!==t||$n?Yr(t,e,n,i):e.child=ws(e,null,n,i),Jr(t,e),e.child;case 5:return null===t&&$n&&((s=n=Wn)&&(null!==(n=function(t,e,i,n){for(;1===t.nodeType;){var s=i;if(t.nodeName.toLowerCase()!==e.toLowerCase()){if(!n&&("INPUT"!==t.nodeName||"hidden"!==t.type))break}else if(n){if(!t[Yt])switch(e){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if("stylesheet"===(o=t.getAttribute("rel"))&&t.hasAttribute("data-precedence"))break;if(o!==s.rel||t.getAttribute("href")!==(null==s.href?null:s.href)||t.getAttribute("crossorigin")!==(null==s.crossOrigin?null:s.crossOrigin)||t.getAttribute("title")!==(null==s.title?null:s.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(((o=t.getAttribute("src"))!==(null==s.src?null:s.src)||t.getAttribute("type")!==(null==s.type?null:s.type)||t.getAttribute("crossorigin")!==(null==s.crossOrigin?null:s.crossOrigin))&&o&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else{if("input"!==e||"hidden"!==t.type)return t;var o=null==s.name?null:""+s.name;if("hidden"===s.type&&t.getAttribute("name")===o)return t}if(null===(t=ac(t.nextSibling)))break}return null}(n,e.type,e.pendingProps,Zn))?(e.stateNode=n,qn=e,Wn=ac(n.firstChild),Zn=!1,s=!0):s=!1),s||ts(e)),et(e),s=e.type,o=e.pendingProps,a=null!==t?t.memoizedProps:null,n=o.children,Zu(s,o)?n=null:null!==a&&Zu(s,a)&&(e.flags|=32),null!==e.memoizedState&&(s=co(t,e,mo,null,null,i),Bc._currentValue=s),Jr(t,e),Yr(t,e,n,i),e.child;case 6:return null===t&&$n&&((t=i=Wn)&&(null!==(i=function(t,e,i){if(""===e)return null;for(;3!==t.nodeType;){if((1!==t.nodeType||"INPUT"!==t.nodeName||"hidden"!==t.type)&&!i)return null;if(null===(t=ac(t.nextSibling)))return null}return t}(i,e.pendingProps,Zn))?(e.stateNode=i,qn=e,Wn=null,t=!0):t=!1),t||ts(e)),null;case 13:return oa(t,e,i);case 4:return Q(e,e.stateNode.containerInfo),n=e.pendingProps,null===t?e.child=ws(e,null,n,i):Yr(t,e,n,i),e.child;case 11:return _r(t,e,e.type,e.pendingProps,i);case 7:return Yr(t,e,e.pendingProps,i),e.child;case 8:case 12:return Yr(t,e,e.pendingProps.children,i),e.child;case 10:return n=e.pendingProps,xa(e,e.type,n.value),Yr(t,e,n.children,i),e.child;case 9:return s=e.type._context,n=e.pendingProps.children,Pa(e),n=n(s=Ma(s)),e.flags|=1,Yr(t,e,n,i),e.child;case 14:return Hr(t,e,e.type,e.pendingProps,i);case 15:return qr(t,e,e.type,e.pendingProps,i);case 19:return ca(t,e,i);case 22:return Wr(t,e,i);case 24:return Pa(e),n=Ma(Vs),null===t?(null===(s=Ws())&&(s=eh,o=js(),s.pooledCache=o,o.refCount++,null!==o&&(s.pooledCacheLanes|=i),s=o),e.memoizedState={parent:n,cache:s},La(e),xa(e,Vs,s)):(0!==(t.lanes&i)&&(Aa(t,e),Ia(e,null,null,i),Ba()),s=t.memoizedState,o=e.memoizedState,s.parent!==n?(s={parent:n,cache:n},e.memoizedState=s,0===e.lanes&&(e.memoizedState=e.updateQueue.baseState=s),xa(e,Vs,n)):(n=o.cache,xa(e,Vs,n),n!==s.cache&&wa(e,[Vs],i,!0))),Yr(t,e,e.pendingProps.children,i),e.child;case 29:throw e.pendingProps}throw Error(r(156,e.tag))}var ma=_(null),pa=null,ya=null;function xa(t,e,i){q(ma,e._currentValue),e._currentValue=i}function ba(t){t._currentValue=ma.current,H(ma)}function va(t,e,i){for(;null!==t;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,null!==n&&(n.childLanes|=e)):null!==n&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===i)break;t=t.return}}function wa(t,e,i,n){var s=t.child;for(null!==s&&(s.return=t);null!==s;){var o=s.dependencies;if(null!==o){var a=s.child;o=o.firstContext;t:for(;null!==o;){var l=o;o=s;for(var h=0;h<e.length;h++)if(l.context===e[h]){o.lanes|=i,null!==(l=o.alternate)&&(l.lanes|=i),va(o.return,i,t),n||(a=null);break t}o=l.next}}else if(18===s.tag){if(null===(a=s.return))throw Error(r(341));a.lanes|=i,null!==(o=a.alternate)&&(o.lanes|=i),va(a,i,t),a=null}else a=s.child;if(null!==a)a.return=s;else for(a=s;null!==a;){if(a===t){a=null;break}if(null!==(s=a.sibling)){s.return=a.return,a=s;break}a=a.return}s=a}}function ka(t,e,i,n){t=null;for(var s=e,o=!1;null!==s;){if(!o)if(0!==(524288&s.flags))o=!0;else if(0!==(262144&s.flags))break;if(10===s.tag){var a=s.alternate;if(null===a)throw Error(r(387));if(null!==(a=a.memoizedProps)){var l=s.type;Hi(s.pendingProps.value,a.value)||(null!==t?t.push(l):t=[l])}}else if(s===Z.current){if(null===(a=s.alternate))throw Error(r(387));a.memoizedState.memoizedState!==s.memoizedState.memoizedState&&(null!==t?t.push(Bc):t=[Bc])}s=s.return}null!==t&&wa(e,t,i,n),e.flags|=262144}function Sa(t){for(t=t.firstContext;null!==t;){if(!Hi(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function Pa(t){pa=t,ya=null,null!==(t=t.dependencies)&&(t.firstContext=null)}function Ma(t){return Na(pa,t)}function Ca(t,e){return null===pa&&Pa(t),Na(t,e)}function Na(t,e){var i=e._currentValue;if(e={context:e,memoizedValue:i,next:null},null===ya){if(null===t)throw Error(r(308));ya=e,t.dependencies={lanes:0,firstContext:e},t.flags|=524288}else ya=ya.next=e;return i}var Ta=!1;function La(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Aa(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function Da(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function Fa(t,e,i){var n=t.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&th)){var s=n.pending;return null===s?e.next=e:(e.next=s.next,s.next=e),n.pending=e,e=Dn(t),An(t,null,i),e}return Nn(t,n,e,i),Dn(t)}function Oa(t,e,i){if(null!==(e=e.updateQueue)&&(e=e.shared,0!==(4194176&i))){var n=e.lanes;i|=n&=t.pendingLanes,e.lanes=i,Rt(t,i)}}function Ra(t,e){var i=t.updateQueue,n=t.alternate;if(null!==n&&i===(n=n.updateQueue)){var s=null,o=null;if(null!==(i=i.firstBaseUpdate)){do{var r={lane:i.lane,tag:i.tag,payload:i.payload,callback:null,next:null};null===o?s=o=r:o=o.next=r,i=i.next}while(null!==i);null===o?s=o=e:o=o.next=e}else s=o=e;return i={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:n.shared,callbacks:n.callbacks},void(t.updateQueue=i)}null===(t=i.lastBaseUpdate)?i.firstBaseUpdate=e:t.next=e,i.lastBaseUpdate=e}var Ea=!1;function Ba(){if(Ea){if(null!==Ys)throw Ys}}function Ia(t,e,i,n){Ea=!1;var s=t.updateQueue;Ta=!1;var o=s.firstBaseUpdate,r=s.lastBaseUpdate,a=s.shared.pending;if(null!==a){s.shared.pending=null;var l=a,h=l.next;l.next=null,null===r?o=h:r.next=h,r=l;var u=t.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==r&&(null===a?u.firstBaseUpdate=h:a.next=h,u.lastBaseUpdate=l))}if(null!==o){var c=s.baseState;for(r=0,u=h=l=null,a=o;;){var d=-536870913&a.lane,f=d!==a.lane;if(f?(nh&d)===d:(n&d)===d){0!==d&&d===Xs&&(Ea=!0),null!==u&&(u=u.next={lane:0,tag:a.tag,payload:a.payload,callback:null,next:null});t:{var g=t,m=a;d=e;var p=i;switch(m.tag){case 1:if("function"===typeof(g=m.payload)){c=g.call(p,c,d);break t}c=g;break t;case 3:g.flags=-65537&g.flags|128;case 0:if(null===(d="function"===typeof(g=m.payload)?g.call(p,c,d):g)||void 0===d)break t;c=D({},c,d);break t;case 2:Ta=!0}}null!==(d=a.callback)&&(t.flags|=64,f&&(t.flags|=8192),null===(f=s.callbacks)?s.callbacks=[d]:f.push(d))}else f={lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(h=u=f,l=c):u=u.next=f,r|=d;if(null===(a=a.next)){if(null===(a=s.shared.pending))break;a=(f=a).next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}null===u&&(l=c),s.baseState=l,s.firstBaseUpdate=h,s.lastBaseUpdate=u,null===o&&(s.shared.lanes=0),ch|=r,t.lanes=r,t.memoizedState=c}}function za(t,e){if("function"!==typeof t)throw Error(r(191,t));t.call(e)}function Va(t,e){var i=t.callbacks;if(null!==i)for(t.callbacks=null,t=0;t<i.length;t++)za(i[t],e)}function ja(t,e){try{var i=e.updateQueue,n=null!==i?i.lastEffect:null;if(null!==n){var s=n.next;i=s;do{if((i.tag&t)===t){n=void 0;var o=i.create,r=i.inst;n=o(),r.destroy=n}i=i.next}while(i!==s)}}catch(a){nu(e,e.return,a)}}function Ua(t,e,i){try{var n=e.updateQueue,s=null!==n?n.lastEffect:null;if(null!==s){var o=s.next;n=o;do{if((n.tag&t)===t){var r=n.inst,a=r.destroy;if(void 0!==a){r.destroy=void 0,s=e;var l=i;try{a()}catch(h){nu(s,l,h)}}}n=n.next}while(n!==o)}}catch(h){nu(e,e.return,h)}}function Ga(t){var e=t.updateQueue;if(null!==e){var i=t.stateNode;try{Va(e,i)}catch(n){nu(t,t.return,n)}}}function Ka(t,e,i){i.props=Or(t.type,t.memoizedProps),i.state=t.memoizedState;try{i.componentWillUnmount()}catch(n){nu(t,e,n)}}function Xa(t,e){try{var i=t.ref;if(null!==i){var n=t.stateNode;switch(t.tag){case 26:case 27:case 5:var s=n;break;default:s=n}"function"===typeof i?t.refCleanup=i(s):i.current=s}}catch(o){nu(t,e,o)}}function Ya(t,e){var i=t.ref,n=t.refCleanup;if(null!==i)if("function"===typeof n)try{n()}catch(s){nu(t,e,s)}finally{t.refCleanup=null,null!=(t=t.alternate)&&(t.refCleanup=null)}else if("function"===typeof i)try{i(null)}catch(o){nu(t,e,o)}else i.current=null}function _a(t){var e=t.type,i=t.memoizedProps,n=t.stateNode;try{t:switch(e){case"button":case"input":case"select":case"textarea":i.autoFocus&&n.focus();break t;case"img":i.src?n.src=i.src:i.srcSet&&(n.srcset=i.srcSet)}}catch(s){nu(t,t.return,s)}}function Ha(t,e,i){try{var n=t.stateNode;!function(t,e,i,n){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var s=null,o=null,a=null,l=null,h=null,u=null,c=null;for(g in i){var d=i[g];if(i.hasOwnProperty(g)&&null!=d)switch(g){case"checked":case"value":break;case"defaultValue":h=d;default:n.hasOwnProperty(g)||Xu(t,e,g,null,n,d)}}for(var f in n){var g=n[f];if(d=i[f],n.hasOwnProperty(f)&&(null!=g||null!=d))switch(f){case"type":o=g;break;case"name":s=g;break;case"checked":u=g;break;case"defaultChecked":c=g;break;case"value":a=g;break;case"defaultValue":l=g;break;case"children":case"dangerouslySetInnerHTML":if(null!=g)throw Error(r(137,e));break;default:g!==d&&Xu(t,e,f,g,n,d)}}return void pe(t,a,l,h,u,c,o,s);case"select":for(o in g=a=l=f=null,i)if(h=i[o],i.hasOwnProperty(o)&&null!=h)switch(o){case"value":break;case"multiple":g=h;default:n.hasOwnProperty(o)||Xu(t,e,o,null,n,h)}for(s in n)if(o=n[s],h=i[s],n.hasOwnProperty(s)&&(null!=o||null!=h))switch(s){case"value":f=o;break;case"defaultValue":l=o;break;case"multiple":a=o;default:o!==h&&Xu(t,e,s,o,n,h)}return e=l,i=a,n=g,void(null!=f?be(t,!!i,f,!1):!!n!==!!i&&(null!=e?be(t,!!i,e,!0):be(t,!!i,i?[]:"",!1)));case"textarea":for(l in g=f=null,i)if(s=i[l],i.hasOwnProperty(l)&&null!=s&&!n.hasOwnProperty(l))switch(l){case"value":case"children":break;default:Xu(t,e,l,null,n,s)}for(a in n)if(s=n[a],o=i[a],n.hasOwnProperty(a)&&(null!=s||null!=o))switch(a){case"value":f=s;break;case"defaultValue":g=s;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=s)throw Error(r(91));break;default:s!==o&&Xu(t,e,a,s,n,o)}return void ve(t,f,g);case"option":for(var m in i)if(f=i[m],i.hasOwnProperty(m)&&null!=f&&!n.hasOwnProperty(m))if("selected"===m)t.selected=!1;else Xu(t,e,m,null,n,f);for(h in n)if(f=n[h],g=i[h],n.hasOwnProperty(h)&&f!==g&&(null!=f||null!=g))if("selected"===h)t.selected=f&&"function"!==typeof f&&"symbol"!==typeof f;else Xu(t,e,h,f,n,g);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var p in i)f=i[p],i.hasOwnProperty(p)&&null!=f&&!n.hasOwnProperty(p)&&Xu(t,e,p,null,n,f);for(u in n)if(f=n[u],g=i[u],n.hasOwnProperty(u)&&f!==g&&(null!=f||null!=g))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(r(137,e));break;default:Xu(t,e,u,f,n,g)}return;default:if(Ce(e)){for(var y in i)f=i[y],i.hasOwnProperty(y)&&void 0!==f&&!n.hasOwnProperty(y)&&Yu(t,e,y,void 0,n,f);for(c in n)f=n[c],g=i[c],!n.hasOwnProperty(c)||f===g||void 0===f&&void 0===g||Yu(t,e,c,f,n,g);return}}for(var x in i)f=i[x],i.hasOwnProperty(x)&&null!=f&&!n.hasOwnProperty(x)&&Xu(t,e,x,null,n,f);for(d in n)f=n[d],g=i[d],!n.hasOwnProperty(d)||f===g||null==f&&null==g||Xu(t,e,d,f,n,g)}(n,t.type,i,e),n[Vt]=e}catch(s){nu(t,t.return,s)}}function qa(t){return 5===t.tag||3===t.tag||26===t.tag||27===t.tag||4===t.tag}function Wa(t){t:for(;;){for(;null===t.sibling;){if(null===t.return||qa(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;5!==t.tag&&6!==t.tag&&27!==t.tag&&18!==t.tag;){if(2&t.flags)continue t;if(null===t.child||4===t.tag)continue t;t.child.return=t,t=t.child}if(!(2&t.flags))return t.stateNode}}function $a(t,e,i){var n=t.tag;if(5===n||6===n)t=t.stateNode,e?8===i.nodeType?i.parentNode.insertBefore(t,e):i.insertBefore(t,e):(8===i.nodeType?(e=i.parentNode).insertBefore(t,i):(e=i).appendChild(t),null!==(i=i._reactRootContainer)&&void 0!==i||null!==e.onclick||(e.onclick=Ku));else if(4!==n&&27!==n&&null!==(t=t.child))for($a(t,e,i),t=t.sibling;null!==t;)$a(t,e,i),t=t.sibling}function Ja(t,e,i){var n=t.tag;if(5===n||6===n)t=t.stateNode,e?i.insertBefore(t,e):i.appendChild(t);else if(4!==n&&27!==n&&null!==(t=t.child))for(Ja(t,e,i),t=t.sibling;null!==t;)Ja(t,e,i),t=t.sibling}var Za=!1,Qa=!1,tl=!1,el="function"===typeof WeakSet?WeakSet:Set,il=null,nl=!1;function sl(t,e,i){var n=i.flags;switch(i.tag){case 0:case 11:case 15:yl(t,i),4&n&&ja(5,i);break;case 1:if(yl(t,i),4&n)if(t=i.stateNode,null===e)try{t.componentDidMount()}catch(a){nu(i,i.return,a)}else{var s=Or(i.type,e.memoizedProps);e=e.memoizedState;try{t.componentDidUpdate(s,e,t.__reactInternalSnapshotBeforeUpdate)}catch(l){nu(i,i.return,l)}}64&n&&Ga(i),512&n&&Xa(i,i.return);break;case 3:if(yl(t,i),64&n&&null!==(n=i.updateQueue)){if(t=null,null!==i.child)switch(i.child.tag){case 27:case 5:case 1:t=i.child.stateNode}try{Va(n,t)}catch(a){nu(i,i.return,a)}}break;case 26:yl(t,i),512&n&&Xa(i,i.return);break;case 27:case 5:yl(t,i),null===e&&4&n&&_a(i),512&n&&Xa(i,i.return);break;case 12:default:yl(t,i);break;case 13:yl(t,i),4&n&&ul(t,i);break;case 22:if(!(s=null!==i.memoizedState||Za)){e=null!==e&&null!==e.memoizedState||Qa;var o=Za,r=Qa;Za=s,(Qa=e)&&!r?bl(t,i,0!==(8772&i.subtreeFlags)):yl(t,i),Za=o,Qa=r}512&n&&("manual"===i.memoizedProps.mode?Xa(i,i.return):Ya(i,i.return))}}function ol(t){var e=t.alternate;null!==e&&(t.alternate=null,ol(e)),t.child=null,t.deletions=null,t.sibling=null,5===t.tag&&(null!==(e=t.stateNode)&&_t(e)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var rl=null,al=!1;function ll(t,e,i){for(i=i.child;null!==i;)hl(t,e,i),i=i.sibling}function hl(t,e,i){if(xt&&"function"===typeof xt.onCommitFiberUnmount)try{xt.onCommitFiberUnmount(yt,i)}catch(r){}switch(i.tag){case 26:Qa||Ya(i,e),ll(t,e,i),i.memoizedState?i.memoizedState.count--:i.stateNode&&(i=i.stateNode).parentNode.removeChild(i);break;case 27:Qa||Ya(i,e);var n=rl,s=al;for(rl=i.stateNode,ll(t,e,i),e=(i=i.stateNode).attributes;e.length;)i.removeAttributeNode(e[0]);_t(i),rl=n,al=s;break;case 5:Qa||Ya(i,e);case 6:s=rl;var o=al;if(rl=null,ll(t,e,i),al=o,null!==(rl=s))if(al)try{t=rl,n=i.stateNode,8===t.nodeType?t.parentNode.removeChild(n):t.removeChild(n)}catch(a){nu(i,e,a)}else try{rl.removeChild(i.stateNode)}catch(a){nu(i,e,a)}break;case 18:null!==rl&&(al?(e=rl,i=i.stateNode,8===e.nodeType?oc(e.parentNode,i):1===e.nodeType&&oc(e,i),md(e)):oc(rl,i.stateNode));break;case 4:n=rl,s=al,rl=i.stateNode.containerInfo,al=!0,ll(t,e,i),rl=n,al=s;break;case 0:case 11:case 14:case 15:Qa||Ua(2,i,e),Qa||Ua(4,i,e),ll(t,e,i);break;case 1:Qa||(Ya(i,e),"function"===typeof(n=i.stateNode).componentWillUnmount&&Ka(i,e,n)),ll(t,e,i);break;case 21:ll(t,e,i);break;case 22:Qa||Ya(i,e),Qa=(n=Qa)||null!==i.memoizedState,ll(t,e,i),Qa=n;break;default:ll(t,e,i)}}function ul(t,e){if(null===e.memoizedState&&(null!==(t=e.alternate)&&(null!==(t=t.memoizedState)&&null!==(t=t.dehydrated))))try{md(t)}catch(i){nu(e,e.return,i)}}function cl(t,e){var i=function(t){switch(t.tag){case 13:case 19:var e=t.stateNode;return null===e&&(e=t.stateNode=new el),e;case 22:return null===(e=(t=t.stateNode)._retryCache)&&(e=t._retryCache=new el),e;default:throw Error(r(435,t.tag))}}(t);e.forEach((function(e){var n=lu.bind(null,t,e);i.has(e)||(i.add(e),e.then(n,n))}))}function dl(t,e){var i=e.deletions;if(null!==i)for(var n=0;n<i.length;n++){var s=i[n],o=t,a=e,l=a;t:for(;null!==l;){switch(l.tag){case 27:case 5:rl=l.stateNode,al=!1;break t;case 3:case 4:rl=l.stateNode.containerInfo,al=!0;break t}l=l.return}if(null===rl)throw Error(r(160));hl(o,a,s),rl=null,al=!1,null!==(o=s.alternate)&&(o.return=null),s.return=null}if(13878&e.subtreeFlags)for(e=e.child;null!==e;)gl(e,t),e=e.sibling}var fl=null;function gl(t,e){var i=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:dl(e,t),ml(t),4&n&&(Ua(3,t,t.return),ja(3,t),Ua(5,t,t.return));break;case 1:dl(e,t),ml(t),512&n&&(Qa||null===i||Ya(i,i.return)),64&n&&Za&&(null!==(t=t.updateQueue)&&(null!==(n=t.callbacks)&&(i=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=null===i?n:i.concat(n))));break;case 26:var s=fl;if(dl(e,t),ml(t),512&n&&(Qa||null===i||Ya(i,i.return)),4&n){var o=null!==i?i.memoizedState:null;if(n=t.memoizedState,null===i)if(null===n)if(null===t.stateNode){t:{n=t.type,i=t.memoizedProps,s=s.ownerDocument||s;e:switch(n){case"title":(!(o=s.getElementsByTagName("title")[0])||o[Yt]||o[zt]||"http://www.w3.org/2000/svg"===o.namespaceURI||o.hasAttribute("itemprop"))&&(o=s.createElement(n),s.head.insertBefore(o,s.querySelector("head > title"))),_u(o,n,i),o[zt]=t,Jt(o),n=o;break t;case"link":var a=Nc("link","href",s).get(n+(i.href||""));if(a)for(var l=0;l<a.length;l++)if((o=a[l]).getAttribute("href")===(null==i.href?null:i.href)&&o.getAttribute("rel")===(null==i.rel?null:i.rel)&&o.getAttribute("title")===(null==i.title?null:i.title)&&o.getAttribute("crossorigin")===(null==i.crossOrigin?null:i.crossOrigin)){a.splice(l,1);break e}_u(o=s.createElement(n),n,i),s.head.appendChild(o);break;case"meta":if(a=Nc("meta","content",s).get(n+(i.content||"")))for(l=0;l<a.length;l++)if((o=a[l]).getAttribute("content")===(null==i.content?null:""+i.content)&&o.getAttribute("name")===(null==i.name?null:i.name)&&o.getAttribute("property")===(null==i.property?null:i.property)&&o.getAttribute("http-equiv")===(null==i.httpEquiv?null:i.httpEquiv)&&o.getAttribute("charset")===(null==i.charSet?null:i.charSet)){a.splice(l,1);break e}_u(o=s.createElement(n),n,i),s.head.appendChild(o);break;default:throw Error(r(468,n))}o[zt]=t,Jt(o),n=o}t.stateNode=n}else Tc(s,t.type,t.stateNode);else t.stateNode=kc(s,n,t.memoizedProps);else o!==n?(null===o?null!==i.stateNode&&(i=i.stateNode).parentNode.removeChild(i):o.count--,null===n?Tc(s,t.type,t.stateNode):kc(s,n,t.memoizedProps)):null===n&&null!==t.stateNode&&Ha(t,t.memoizedProps,i.memoizedProps)}break;case 27:if(4&n&&null===t.alternate){s=t.stateNode,o=t.memoizedProps;try{for(var h=s.firstChild;h;){var u=h.nextSibling,c=h.nodeName;h[Yt]||"HEAD"===c||"BODY"===c||"SCRIPT"===c||"STYLE"===c||"LINK"===c&&"stylesheet"===h.rel.toLowerCase()||s.removeChild(h),h=u}for(var d=t.type,f=s.attributes;f.length;)s.removeAttributeNode(f[0]);_u(s,d,o),s[zt]=t,s[Vt]=o}catch(m){nu(t,t.return,m)}}case 5:if(dl(e,t),ml(t),512&n&&(Qa||null===i||Ya(i,i.return)),32&t.flags){s=t.stateNode;try{ke(s,"")}catch(m){nu(t,t.return,m)}}4&n&&null!=t.stateNode&&Ha(t,s=t.memoizedProps,null!==i?i.memoizedProps:s),1024&n&&(tl=!0);break;case 6:if(dl(e,t),ml(t),4&n){if(null===t.stateNode)throw Error(r(162));n=t.memoizedProps,i=t.stateNode;try{i.nodeValue=n}catch(m){nu(t,t.return,m)}}break;case 3:if(Cc=null,s=fl,fl=dc(e.containerInfo),dl(e,t),fl=s,ml(t),4&n&&null!==i&&i.memoizedState.isDehydrated)try{md(e.containerInfo)}catch(m){nu(t,t.return,m)}tl&&(tl=!1,pl(t));break;case 4:n=fl,fl=dc(t.stateNode.containerInfo),dl(e,t),ml(t),fl=n;break;case 12:dl(e,t),ml(t);break;case 13:dl(e,t),ml(t),8192&t.child.flags&&null!==t.memoizedState!==(null!==i&&null!==i.memoizedState)&&(bh=lt()),4&n&&(null!==(n=t.updateQueue)&&(t.updateQueue=null,cl(t,n)));break;case 22:if(512&n&&(Qa||null===i||Ya(i,i.return)),h=null!==t.memoizedState,u=null!==i&&null!==i.memoizedState,Za=(c=Za)||h,Qa=(d=Qa)||u,dl(e,t),Qa=d,Za=c,ml(t),(e=t.stateNode)._current=t,e._visibility&=-3,e._visibility|=2&e._pendingVisibility,8192&n&&(e._visibility=h?-2&e._visibility:1|e._visibility,h&&(e=Za||Qa,null===i||u||e||xl(t)),null===t.memoizedProps||"manual"!==t.memoizedProps.mode))t:for(i=null,e=t;;){if(5===e.tag||26===e.tag||27===e.tag){if(null===i){u=i=e;try{if(s=u.stateNode,h)"function"===typeof(o=s.style).setProperty?o.setProperty("display","none","important"):o.display="none";else{a=u.stateNode;var g=void 0!==(l=u.memoizedProps.style)&&null!==l&&l.hasOwnProperty("display")?l.display:null;a.style.display=null==g||"boolean"===typeof g?"":(""+g).trim()}}catch(m){nu(u,u.return,m)}}}else if(6===e.tag){if(null===i){u=e;try{u.stateNode.nodeValue=h?"":u.memoizedProps}catch(m){nu(u,u.return,m)}}}else if((22!==e.tag&&23!==e.tag||null===e.memoizedState||e===t)&&null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break t;for(;null===e.sibling;){if(null===e.return||e.return===t)break t;i===e&&(i=null),e=e.return}i===e&&(i=null),e.sibling.return=e.return,e=e.sibling}4&n&&(null!==(n=t.updateQueue)&&(null!==(i=n.retryQueue)&&(n.retryQueue=null,cl(t,i))));break;case 19:dl(e,t),ml(t),4&n&&(null!==(n=t.updateQueue)&&(t.updateQueue=null,cl(t,n)));break;case 21:break;default:dl(e,t),ml(t)}}function ml(t){var e=t.flags;if(2&e){try{if(27!==t.tag){t:{for(var i=t.return;null!==i;){if(qa(i)){var n=i;break t}i=i.return}throw Error(r(160))}switch(n.tag){case 27:var s=n.stateNode;Ja(t,Wa(t),s);break;case 5:var o=n.stateNode;32&n.flags&&(ke(o,""),n.flags&=-33),Ja(t,Wa(t),o);break;case 3:case 4:var a=n.stateNode.containerInfo;$a(t,Wa(t),a);break;default:throw Error(r(161))}}}catch(l){nu(t,t.return,l)}t.flags&=-3}4096&e&&(t.flags&=-4097)}function pl(t){if(1024&t.subtreeFlags)for(t=t.child;null!==t;){var e=t;pl(e),5===e.tag&&1024&e.flags&&e.stateNode.reset(),t=t.sibling}}function yl(t,e){if(8772&e.subtreeFlags)for(e=e.child;null!==e;)sl(t,e.alternate,e),e=e.sibling}function xl(t){for(t=t.child;null!==t;){var e=t;switch(e.tag){case 0:case 11:case 14:case 15:Ua(4,e,e.return),xl(e);break;case 1:Ya(e,e.return);var i=e.stateNode;"function"===typeof i.componentWillUnmount&&Ka(e,e.return,i),xl(e);break;case 26:case 27:case 5:Ya(e,e.return),xl(e);break;case 22:Ya(e,e.return),null===e.memoizedState&&xl(e);break;default:xl(e)}t=t.sibling}}function bl(t,e,i){for(i=i&&0!==(8772&e.subtreeFlags),e=e.child;null!==e;){var n=e.alternate,s=t,o=e,r=o.flags;switch(o.tag){case 0:case 11:case 15:bl(s,o,i),ja(4,o);break;case 1:if(bl(s,o,i),"function"===typeof(s=(n=o).stateNode).componentDidMount)try{s.componentDidMount()}catch(h){nu(n,n.return,h)}if(null!==(s=(n=o).updateQueue)){var a=n.stateNode;try{var l=s.shared.hiddenCallbacks;if(null!==l)for(s.shared.hiddenCallbacks=null,s=0;s<l.length;s++)za(l[s],a)}catch(h){nu(n,n.return,h)}}i&&64&r&&Ga(o),Xa(o,o.return);break;case 26:case 27:case 5:bl(s,o,i),i&&null===n&&4&r&&_a(o),Xa(o,o.return);break;case 12:default:bl(s,o,i);break;case 13:bl(s,o,i),i&&4&r&&ul(s,o);break;case 22:null===o.memoizedState&&bl(s,o,i),Xa(o,o.return)}e=e.sibling}}function vl(t,e){var i=null;null!==t&&null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(i=t.memoizedState.cachePool.pool),t=null,null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(t=e.memoizedState.cachePool.pool),t!==i&&(null!=t&&t.refCount++,null!=i&&Us(i))}function wl(t,e){t=null,null!==e.alternate&&(t=e.alternate.memoizedState.cache),(e=e.memoizedState.cache)!==t&&(e.refCount++,null!=t&&Us(t))}function kl(t,e,i,n){if(10256&e.subtreeFlags)for(e=e.child;null!==e;)Sl(t,e,i,n),e=e.sibling}function Sl(t,e,i,n){var s=e.flags;switch(e.tag){case 0:case 11:case 15:kl(t,e,i,n),2048&s&&ja(9,e);break;case 3:kl(t,e,i,n),2048&s&&(t=null,null!==e.alternate&&(t=e.alternate.memoizedState.cache),(e=e.memoizedState.cache)!==t&&(e.refCount++,null!=t&&Us(t)));break;case 12:if(2048&s){kl(t,e,i,n),t=e.stateNode;try{var o=e.memoizedProps,r=o.id,a=o.onPostCommit;"function"===typeof a&&a(r,null===e.alternate?"mount":"update",t.passiveEffectDuration,-0)}catch(l){nu(e,e.return,l)}}else kl(t,e,i,n);break;case 23:break;case 22:o=e.stateNode,null!==e.memoizedState?4&o._visibility?kl(t,e,i,n):Ml(t,e):4&o._visibility?kl(t,e,i,n):(o._visibility|=4,Pl(t,e,i,n,0!==(10256&e.subtreeFlags))),2048&s&&vl(e.alternate,e);break;case 24:kl(t,e,i,n),2048&s&&wl(e.alternate,e);break;default:kl(t,e,i,n)}}function Pl(t,e,i,n,s){for(s=s&&0!==(10256&e.subtreeFlags),e=e.child;null!==e;){var o=t,r=e,a=i,l=n,h=r.flags;switch(r.tag){case 0:case 11:case 15:Pl(o,r,a,l,s),ja(8,r);break;case 23:break;case 22:var u=r.stateNode;null!==r.memoizedState?4&u._visibility?Pl(o,r,a,l,s):Ml(o,r):(u._visibility|=4,Pl(o,r,a,l,s)),s&&2048&h&&vl(r.alternate,r);break;case 24:Pl(o,r,a,l,s),s&&2048&h&&wl(r.alternate,r);break;default:Pl(o,r,a,l,s)}e=e.sibling}}function Ml(t,e){if(10256&e.subtreeFlags)for(e=e.child;null!==e;){var i=t,n=e,s=n.flags;switch(n.tag){case 22:Ml(i,n),2048&s&&vl(n.alternate,n);break;case 24:Ml(i,n),2048&s&&wl(n.alternate,n);break;default:Ml(i,n)}e=e.sibling}}var Cl=8192;function Nl(t){if(t.subtreeFlags&Cl)for(t=t.child;null!==t;)Tl(t),t=t.sibling}function Tl(t){switch(t.tag){case 26:Nl(t),t.flags&Cl&&null!==t.memoizedState&&function(t,e,i){if(null===Ac)throw Error(r(475));var n=Ac;if("stylesheet"===e.type&&("string"!==typeof i.media||!1!==matchMedia(i.media).matches)&&0===(4&e.state.loading)){if(null===e.instance){var s=yc(i.href),o=t.querySelector(xc(s));if(o)return null!==(t=o._p)&&"object"===typeof t&&"function"===typeof t.then&&(n.count++,n=Fc.bind(n),t.then(n,n)),e.state.loading|=4,e.instance=o,void Jt(o);o=t.ownerDocument||t,i=bc(i),(s=uc.get(s))&&Pc(i,s),Jt(o=o.createElement("link"));var a=o;a._p=new Promise((function(t,e){a.onload=t,a.onerror=e})),_u(o,"link",i),e.instance=o}null===n.stylesheets&&(n.stylesheets=new Map),n.stylesheets.set(e,t),(t=e.state.preload)&&0===(3&e.state.loading)&&(n.count++,e=Fc.bind(n),t.addEventListener("load",e),t.addEventListener("error",e))}}(fl,t.memoizedState,t.memoizedProps);break;case 5:default:Nl(t);break;case 3:case 4:var e=fl;fl=dc(t.stateNode.containerInfo),Nl(t),fl=e;break;case 22:null===t.memoizedState&&(null!==(e=t.alternate)&&null!==e.memoizedState?(e=Cl,Cl=16777216,Nl(t),Cl=e):Nl(t))}}function Ll(t){var e=t.alternate;if(null!==e&&null!==(t=e.child)){e.child=null;do{e=t.sibling,t.sibling=null,t=e}while(null!==t)}}function Al(t){var e=t.deletions;if(0!==(16&t.flags)){if(null!==e)for(var i=0;i<e.length;i++){var n=e[i];il=n,Ol(n,t)}Ll(t)}if(10256&t.subtreeFlags)for(t=t.child;null!==t;)Dl(t),t=t.sibling}function Dl(t){switch(t.tag){case 0:case 11:case 15:Al(t),2048&t.flags&&Ua(9,t,t.return);break;case 3:case 12:default:Al(t);break;case 22:var e=t.stateNode;null!==t.memoizedState&&4&e._visibility&&(null===t.return||13!==t.return.tag)?(e._visibility&=-5,Fl(t)):Al(t)}}function Fl(t){var e=t.deletions;if(0!==(16&t.flags)){if(null!==e)for(var i=0;i<e.length;i++){var n=e[i];il=n,Ol(n,t)}Ll(t)}for(t=t.child;null!==t;){switch((e=t).tag){case 0:case 11:case 15:Ua(8,e,e.return),Fl(e);break;case 22:4&(i=e.stateNode)._visibility&&(i._visibility&=-5,Fl(e));break;default:Fl(e)}t=t.sibling}}function Ol(t,e){for(;null!==il;){var i=il;switch(i.tag){case 0:case 11:case 15:Ua(8,i,e);break;case 23:case 22:if(null!==i.memoizedState&&null!==i.memoizedState.cachePool){var n=i.memoizedState.cachePool.pool;null!=n&&n.refCount++}break;case 24:Us(i.memoizedState.cache)}if(null!==(n=i.child))n.return=i,il=n;else t:for(i=t;null!==il;){var s=(n=il).sibling,o=n.return;if(ol(n),n===i){il=null;break t}if(null!==s){s.return=o,il=s;break t}il=o}}}function Rl(t,e,i,n){this.tag=t,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function El(t,e,i,n){return new Rl(t,e,i,n)}function Bl(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Il(t,e){var i=t.alternate;return null===i?((i=El(t.tag,e,t.key,t.mode)).elementType=t.elementType,i.type=t.type,i.stateNode=t.stateNode,i.alternate=t,t.alternate=i):(i.pendingProps=e,i.type=t.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=31457280&t.flags,i.childLanes=t.childLanes,i.lanes=t.lanes,i.child=t.child,i.memoizedProps=t.memoizedProps,i.memoizedState=t.memoizedState,i.updateQueue=t.updateQueue,e=t.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},i.sibling=t.sibling,i.index=t.index,i.ref=t.ref,i.refCleanup=t.refCleanup,i}function zl(t,e){t.flags&=31457282;var i=t.alternate;return null===i?(t.childLanes=0,t.lanes=e,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=i.childLanes,t.lanes=i.lanes,t.child=i.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=i.memoizedProps,t.memoizedState=i.memoizedState,t.updateQueue=i.updateQueue,t.type=i.type,e=i.dependencies,t.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),t}function Vl(t,e,i,n,s,o){var a=0;if(n=t,"function"===typeof t)Bl(t)&&(a=1);else if("string"===typeof t)a=function(t,e,i){if(1===i||null!=e.itemProp)return!1;switch(t){case"meta":case"title":return!0;case"style":if("string"!==typeof e.precedence||"string"!==typeof e.href||""===e.href)break;return!0;case"link":if("string"!==typeof e.rel||"string"!==typeof e.href||""===e.href||e.onLoad||e.onError)break;return"stylesheet"!==e.rel||(t=e.disabled,"string"===typeof e.precedence&&null==t);case"script":if(e.async&&"function"!==typeof e.async&&"symbol"!==typeof e.async&&!e.onLoad&&!e.onError&&e.src&&"string"===typeof e.src)return!0}return!1}(t,i,W.current)?26:"html"===t||"head"===t||"body"===t?27:5;else t:switch(t){case c:return jl(i.children,s,o,e);case d:a=8,s|=24;break;case f:return(t=El(12,i,e,2|s)).elementType=f,t.lanes=o,t;case x:return(t=El(13,i,e,s)).elementType=x,t.lanes=o,t;case b:return(t=El(19,i,e,s)).elementType=b,t.lanes=o,t;case k:return Ul(i,s,o,e);default:if("object"===typeof t&&null!==t)switch(t.$$typeof){case g:case p:a=10;break t;case m:a=9;break t;case y:a=11;break t;case v:a=14;break t;case w:a=16,n=null;break t}a=29,i=Error(r(130,null===t?"null":typeof t,"")),n=null}return(e=El(a,i,e,s)).elementType=t,e.type=n,e.lanes=o,e}function jl(t,e,i,n){return(t=El(7,t,n,e)).lanes=i,t}function Ul(t,e,i,n){(t=El(22,t,n,e)).elementType=k,t.lanes=i;var s={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var t=s._current;if(null===t)throw Error(r(456));if(0===(2&s._pendingVisibility)){var e=Ln(t,2);null!==e&&(s._pendingVisibility|=2,Fh(e,t,2))}},attach:function(){var t=s._current;if(null===t)throw Error(r(456));if(0!==(2&s._pendingVisibility)){var e=Ln(t,2);null!==e&&(s._pendingVisibility&=-3,Fh(e,t,2))}}};return t.stateNode=s,t}function Gl(t,e,i){return(t=El(6,t,null,e)).lanes=i,t}function Kl(t,e,i){return(e=El(4,null!==t.children?t.children:[],t.key,e)).lanes=i,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Xl(t){t.flags|=4}function Yl(t,e){if("stylesheet"!==e.type||0!==(4&e.state.loading))t.flags&=-16777217;else if(t.flags|=16777216,!Lc(e)){if(null!==(e=Ts.current)&&((4194176&nh)===nh?null!==Ls:(62914560&nh)!==nh&&0===(536870912&nh)||e!==Ls))throw ds=ls,as;t.flags|=8192}}function _l(t,e){null!==e&&(t.flags|=4),16384&t.flags&&(e=22!==t.tag?At():536870912,t.lanes|=e,mh|=e)}function Hl(t,e){if(!$n)switch(t.tailMode){case"hidden":e=t.tail;for(var i=null;null!==e;)null!==e.alternate&&(i=e),e=e.sibling;null===i?t.tail=null:i.sibling=null;break;case"collapsed":i=t.tail;for(var n=null;null!==i;)null!==i.alternate&&(n=i),i=i.sibling;null===n?e||null===t.tail?t.tail=null:t.tail.sibling=null:n.sibling=null}}function ql(t){var e=null!==t.alternate&&t.alternate.child===t.child,i=0,n=0;if(e)for(var s=t.child;null!==s;)i|=s.lanes|s.childLanes,n|=31457280&s.subtreeFlags,n|=31457280&s.flags,s.return=t,s=s.sibling;else for(s=t.child;null!==s;)i|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=i,e}function Wl(t,e,i){var n=e.pendingProps;switch(Hn(e),e.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return ql(e),null;case 3:return i=e.stateNode,n=null,null!==t&&(n=t.memoizedState.cache),e.memoizedState.cache!==n&&(e.flags|=2048),ba(Vs),tt(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==t&&null!==t.child||(ns(e)?Xl(e):null===t||t.memoizedState.isDehydrated&&0===(256&e.flags)||(e.flags|=1024,null!==Jn&&(Rh(Jn),Jn=null))),ql(e),null;case 26:return i=e.memoizedState,null===t?(Xl(e),null!==i?(ql(e),Yl(e,i)):(ql(e),e.flags&=-16777217)):i?i!==t.memoizedState?(Xl(e),ql(e),Yl(e,i)):(ql(e),e.flags&=-16777217):(t.memoizedProps!==n&&Xl(e),ql(e),e.flags&=-16777217),null;case 27:it(e),i=J.current;var s=e.type;if(null!==t&&null!=e.stateNode)t.memoizedProps!==n&&Xl(e);else{if(!n){if(null===e.stateNode)throw Error(r(166));return ql(e),null}t=W.current,ns(e)?es(e):(t=hc(s,n,i),e.stateNode=t,Xl(e))}return ql(e),null;case 5:if(it(e),i=e.type,null!==t&&null!=e.stateNode)t.memoizedProps!==n&&Xl(e);else{if(!n){if(null===e.stateNode)throw Error(r(166));return ql(e),null}if(t=W.current,ns(e))es(e);else{switch(s=Wu(J.current),t){case 1:t=s.createElementNS("http://www.w3.org/2000/svg",i);break;case 2:t=s.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;default:switch(i){case"svg":t=s.createElementNS("http://www.w3.org/2000/svg",i);break;case"math":t=s.createElementNS("http://www.w3.org/1998/Math/MathML",i);break;case"script":(t=s.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild);break;case"select":t="string"===typeof n.is?s.createElement("select",{is:n.is}):s.createElement("select"),n.multiple?t.multiple=!0:n.size&&(t.size=n.size);break;default:t="string"===typeof n.is?s.createElement(i,{is:n.is}):s.createElement(i)}}t[zt]=e,t[Vt]=n;t:for(s=e.child;null!==s;){if(5===s.tag||6===s.tag)t.appendChild(s.stateNode);else if(4!==s.tag&&27!==s.tag&&null!==s.child){s.child.return=s,s=s.child;continue}if(s===e)break t;for(;null===s.sibling;){if(null===s.return||s.return===e)break t;s=s.return}s.sibling.return=s.return,s=s.sibling}e.stateNode=t;t:switch(_u(t,i,n),i){case"button":case"input":case"select":case"textarea":t=!!n.autoFocus;break t;case"img":t=!0;break t;default:t=!1}t&&Xl(e)}}return ql(e),e.flags&=-16777217,null;case 6:if(t&&null!=e.stateNode)t.memoizedProps!==n&&Xl(e);else{if("string"!==typeof n&&null===e.stateNode)throw Error(r(166));if(t=J.current,ns(e)){if(t=e.stateNode,i=e.memoizedProps,n=null,null!==(s=qn))switch(s.tag){case 27:case 5:n=s.memoizedProps}t[zt]=e,(t=!!(t.nodeValue===i||null!==n&&!0===n.suppressHydrationWarning||Gu(t.nodeValue,i)))||ts(e)}else(t=Wu(t).createTextNode(n))[zt]=e,e.stateNode=t}return ql(e),null;case 13:if(n=e.memoizedState,null===t||null!==t.memoizedState&&null!==t.memoizedState.dehydrated){if(s=ns(e),null!==n&&null!==n.dehydrated){if(null===t){if(!s)throw Error(r(318));if(!(s=null!==(s=e.memoizedState)?s.dehydrated:null))throw Error(r(317));s[zt]=e}else ss(),0===(128&e.flags)&&(e.memoizedState=null),e.flags|=4;ql(e),s=!1}else null!==Jn&&(Rh(Jn),Jn=null),s=!0;if(!s)return 256&e.flags?(Os(e),e):(Os(e),null)}if(Os(e),0!==(128&e.flags))return e.lanes=i,e;if(i=null!==n,t=null!==t&&null!==t.memoizedState,i){s=null,null!==(n=e.child).alternate&&null!==n.alternate.memoizedState&&null!==n.alternate.memoizedState.cachePool&&(s=n.alternate.memoizedState.cachePool.pool);var o=null;null!==n.memoizedState&&null!==n.memoizedState.cachePool&&(o=n.memoizedState.cachePool.pool),o!==s&&(n.flags|=2048)}return i!==t&&i&&(e.child.flags|=8192),_l(e,e.updateQueue),ql(e),null;case 4:return tt(),null===t&&Fu(e.stateNode.containerInfo),ql(e),null;case 10:return ba(e.type),ql(e),null;case 19:if(H(Rs),null===(s=e.memoizedState))return ql(e),null;if(n=0!==(128&e.flags),null===(o=s.rendering))if(n)Hl(s,!1);else{if(0!==uh||null!==t&&0!==(128&t.flags))for(t=e.child;null!==t;){if(null!==(o=Es(t))){for(e.flags|=128,Hl(s,!1),t=o.updateQueue,e.updateQueue=t,_l(e,t),e.subtreeFlags=0,t=i,i=e.child;null!==i;)zl(i,t),i=i.sibling;return q(Rs,1&Rs.current|2),e.child}t=t.sibling}null!==s.tail&&lt()>vh&&(e.flags|=128,n=!0,Hl(s,!1),e.lanes=4194304)}else{if(!n)if(null!==(t=Es(o))){if(e.flags|=128,n=!0,t=t.updateQueue,e.updateQueue=t,_l(e,t),Hl(s,!0),null===s.tail&&"hidden"===s.tailMode&&!o.alternate&&!$n)return ql(e),null}else 2*lt()-s.renderingStartTime>vh&&536870912!==i&&(e.flags|=128,n=!0,Hl(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(null!==(t=s.last)?t.sibling=o:e.child=o,s.last=o)}return null!==s.tail?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=lt(),e.sibling=null,t=Rs.current,q(Rs,n?1&t|2:1&t),e):(ql(e),null);case 22:case 23:return Os(e),Ns(),n=null!==e.memoizedState,null!==t?null!==t.memoizedState!==n&&(e.flags|=8192):n&&(e.flags|=8192),n?0!==(536870912&i)&&0===(128&e.flags)&&(ql(e),6&e.subtreeFlags&&(e.flags|=8192)):ql(e),null!==(i=e.updateQueue)&&_l(e,i.retryQueue),i=null,null!==t&&null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(i=t.memoizedState.cachePool.pool),n=null,null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),n!==i&&(e.flags|=2048),null!==t&&H(qs),null;case 24:return i=null,null!==t&&(i=t.memoizedState.cache),e.memoizedState.cache!==i&&(e.flags|=2048),ba(Vs),ql(e),null;case 25:return null}throw Error(r(156,e.tag))}function $l(t,e){switch(Hn(e),e.tag){case 1:return 65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 3:return ba(Vs),tt(),0!==(65536&(t=e.flags))&&0===(128&t)?(e.flags=-65537&t|128,e):null;case 26:case 27:case 5:return it(e),null;case 13:if(Os(e),null!==(t=e.memoizedState)&&null!==t.dehydrated){if(null===e.alternate)throw Error(r(340));ss()}return 65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 19:return H(Rs),null;case 4:return tt(),null;case 10:return ba(e.type),null;case 22:case 23:return Os(e),Ns(),null!==t&&H(qs),65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 24:return ba(Vs),null;default:return null}}function Jl(t,e){switch(Hn(e),e.tag){case 3:ba(Vs),tt();break;case 26:case 27:case 5:it(e);break;case 4:tt();break;case 13:Os(e);break;case 19:H(Rs);break;case 10:ba(e.type);break;case 22:case 23:Os(e),Ns(),null!==t&&H(qs);break;case 24:ba(Vs)}}var Zl={getCacheForType:function(t){var e=Ma(Vs),i=e.data.get(t);return void 0===i&&(i=t(),e.data.set(t,i)),i}},Ql="function"===typeof WeakMap?WeakMap:Map,th=0,eh=null,ih=null,nh=0,sh=0,oh=null,rh=!1,ah=!1,lh=!1,hh=0,uh=0,ch=0,dh=0,fh=0,gh=0,mh=0,ph=null,yh=null,xh=!1,bh=0,vh=1/0,wh=null,kh=null,Sh=!1,Ph=null,Mh=0,Ch=0,Nh=null,Th=0,Lh=null;function Ah(){if(0!==(2&th)&&0!==nh)return nh&-nh;if(null!==A.T){return 0!==Xs?Xs:wu()}return Bt()}function Dh(){0===gh&&(gh=0===(536870912&nh)||$n?Lt():536870912);var t=Ts.current;return null!==t&&(t.flags|=32),gh}function Fh(t,e,i){(t===eh&&2===sh||null!==t.cancelPendingCommit)&&(jh(t,0),Ih(t,nh,gh,!1)),Ft(t,i),0!==(2&th)&&t===eh||(t===eh&&(0===(2&th)&&(dh|=i),4===uh&&Ih(t,nh,gh,!1)),mu(t))}function Oh(t,e,i){if(0!==(6&th))throw Error(r(327));for(var n=!i&&0===(60&e)&&0===(e&t.expiredLanes)||Nt(t,e),s=n?function(t,e){var i=th;th|=2;var n=Gh(),s=Kh();eh!==t||nh!==e?(wh=null,vh=lt()+500,jh(t,e)):ah=Nt(t,e);t:for(;;)try{if(0!==sh&&null!==ih){e=ih;var o=oh;e:switch(sh){case 1:sh=0,oh=null,$h(t,e,o,1);break;case 2:if(hs(o)){sh=0,oh=null,Wh(e);break}e=function(){2===sh&&eh===t&&(sh=7),mu(t)},o.then(e,e);break t;case 3:sh=7;break t;case 4:sh=5;break t;case 7:hs(o)?(sh=0,oh=null,Wh(e)):(sh=0,oh=null,$h(t,e,o,7));break;case 5:var a=null;switch(ih.tag){case 26:a=ih.memoizedState;case 5:case 27:var l=ih;if(!a||Lc(a)){sh=0,oh=null;var h=l.sibling;if(null!==h)ih=h;else{var u=l.return;null!==u?(ih=u,Jh(u)):ih=null}break e}}sh=0,oh=null,$h(t,e,o,5);break;case 6:sh=0,oh=null,$h(t,e,o,6);break;case 8:Vh(),uh=6;break t;default:throw Error(r(462))}}Hh();break}catch(c){Uh(t,c)}return ya=pa=null,A.H=n,A.A=s,th=i,null!==ih?0:(eh=null,nh=0,Cn(),uh)}(t,e):Yh(t,e,!0),o=n;;){if(0===s){ah&&!n&&Ih(t,e,0,!1);break}if(6===s)Ih(t,e,0,!rh);else{if(i=t.current.alternate,o&&!Bh(i)){s=Yh(t,e,!1),o=!1;continue}if(2===s){if(o=e,t.errorRecoveryDisabledLanes&o)var a=0;else a=0!==(a=-536870913&t.pendingLanes)?a:536870912&a?536870912:0;if(0!==a){e=a;t:{var l=t;s=ph;var h=l.current.memoizedState.isDehydrated;if(h&&(jh(l,a).flags|=256),2!==(a=Yh(l,a,!1))){if(lh&&!h){l.errorRecoveryDisabledLanes|=o,dh|=o,s=4;break t}o=yh,yh=s,null!==o&&Rh(o)}s=a}if(o=!1,2!==s)continue}}if(1===s){jh(t,0),Ih(t,e,0,!0);break}t:{switch(n=t,s){case 0:case 1:throw Error(r(345));case 4:if((4194176&e)===e){Ih(n,e,gh,!rh);break t}break;case 2:yh=null;break;case 3:case 5:break;default:throw Error(r(329))}if(n.finishedWork=i,n.finishedLanes=e,(62914560&e)===e&&10<(o=bh+300-lt())){if(Ih(n,e,gh,!rh),0!==Ct(n,0))break t;n.timeoutHandle=tc(Eh.bind(null,n,i,yh,wh,xh,e,gh,dh,mh,rh,2,-0,0),o)}else Eh(n,i,yh,wh,xh,e,gh,dh,mh,rh,0,-0,0)}}break}mu(t)}function Rh(t){null===yh?yh=t:yh.push.apply(yh,t)}function Eh(t,e,i,n,s,o,a,l,h,u,c,d,f){var g=e.subtreeFlags;if((8192&g||16785408===(16785408&g))&&(Ac={stylesheets:null,count:0,unsuspend:Dc},Tl(e),null!==(e=function(){if(null===Ac)throw Error(r(475));var t=Ac;return t.stylesheets&&0===t.count&&Rc(t,t.stylesheets),0<t.count?function(e){var i=setTimeout((function(){if(t.stylesheets&&Rc(t,t.stylesheets),t.unsuspend){var e=t.unsuspend;t.unsuspend=null,e()}}),6e4);return t.unsuspend=e,function(){t.unsuspend=null,clearTimeout(i)}}:null}())))return t.cancelPendingCommit=e(Qh.bind(null,t,i,n,s,a,l,h,1,d,f)),void Ih(t,o,a,!u);Qh(t,i,n,s,a,l,h,c,d,f)}function Bh(t){for(var e=t;;){var i=e.tag;if((0===i||11===i||15===i)&&16384&e.flags&&(null!==(i=e.updateQueue)&&null!==(i=i.stores)))for(var n=0;n<i.length;n++){var s=i[n],o=s.getSnapshot;s=s.value;try{if(!Hi(o(),s))return!1}catch(r){return!1}}if(i=e.child,16384&e.subtreeFlags&&null!==i)i.return=e,e=i;else{if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ih(t,e,i,n){e&=~fh,e&=~dh,t.suspendedLanes|=e,t.pingedLanes&=~e,n&&(t.warmLanes|=e),n=t.expirationTimes;for(var s=e;0<s;){var o=31-vt(s),r=1<<o;n[o]=-1,s&=~r}0!==i&&Ot(t,i,e)}function zh(){return 0!==(6&th)||(pu(0,!1),!1)}function Vh(){if(null!==ih){if(0===sh)var t=ih.return;else ya=pa=null,xo(t=ih),gs=null,ms=0,t=ih;for(;null!==t;)Jl(t.alternate,t),t=t.return;ih=null}}function jh(t,e){t.finishedWork=null,t.finishedLanes=0;var i=t.timeoutHandle;-1!==i&&(t.timeoutHandle=-1,ec(i)),null!==(i=t.cancelPendingCommit)&&(t.cancelPendingCommit=null,i()),Vh(),eh=t,ih=i=Il(t.current,null),nh=e,sh=0,oh=null,rh=!1,ah=Nt(t,e),lh=!1,mh=gh=fh=dh=ch=uh=0,yh=ph=null,xh=!1,0!==(8&e)&&(e|=32&e);var n=t.entangledLanes;if(0!==n)for(t=t.entanglements,n&=e;0<n;){var s=31-vt(n),o=1<<s;e|=t[s],n&=~o}return hh=e,Cn(),i}function Uh(t,e){Qs=null,A.H=Mr,e===rs?(e=fs(),sh=3):e===as?(e=fs(),sh=4):sh=e===Kr?8:null!==e&&"object"===typeof e&&"function"===typeof e.then?6:1,oh=e,null===ih&&(uh=1,zr(t,Rn(e,t.current)))}function Gh(){var t=A.H;return A.H=Mr,null===t?Mr:t}function Kh(){var t=A.A;return A.A=Zl,t}function Xh(){uh=4,rh||(4194176&nh)!==nh&&null!==Ts.current||(ah=!0),0===(134217727&ch)&&0===(134217727&dh)||null===eh||Ih(eh,nh,gh,!1)}function Yh(t,e,i){var n=th;th|=2;var s=Gh(),o=Kh();eh===t&&nh===e||(wh=null,jh(t,e)),e=!1;var r=uh;t:for(;;)try{if(0!==sh&&null!==ih){var a=ih,l=oh;switch(sh){case 8:Vh(),r=6;break t;case 3:case 2:case 6:null===Ts.current&&(e=!0);var h=sh;if(sh=0,oh=null,$h(t,a,l,h),i&&ah){r=0;break t}break;default:h=sh,sh=0,oh=null,$h(t,a,l,h)}}_h(),r=uh;break}catch(u){Uh(t,u)}return e&&t.shellSuspendCounter++,ya=pa=null,th=n,A.H=s,A.A=o,null===ih&&(eh=null,nh=0,Cn()),r}function _h(){for(;null!==ih;)qh(ih)}function Hh(){for(;null!==ih&&!rt();)qh(ih)}function qh(t){var e=ga(t.alternate,t,hh);t.memoizedProps=t.pendingProps,null===e?Jh(t):ih=e}function Wh(t){var e=t,i=e.alternate;switch(e.tag){case 15:case 0:e=Qr(i,e,e.pendingProps,e.type,void 0,nh);break;case 11:e=Qr(i,e,e.pendingProps,e.type.render,e.ref,nh);break;case 5:xo(e);default:Jl(i,e),e=ga(i,e=ih=zl(e,hh),hh)}t.memoizedProps=t.pendingProps,null===e?Jh(t):ih=e}function $h(t,e,i,n){ya=pa=null,xo(e),gs=null,ms=0;var s=e.return;try{if(function(t,e,i,n,s){if(i.flags|=32768,null!==n&&"object"===typeof n&&"function"===typeof n.then){if(null!==(e=i.alternate)&&ka(e,i,s,!0),null!==(i=Ts.current)){switch(i.tag){case 13:return null===Ls?Xh():null===i.alternate&&0===uh&&(uh=3),i.flags&=-257,i.flags|=65536,i.lanes=s,n===ls?i.flags|=16384:(null===(e=i.updateQueue)?i.updateQueue=new Set([n]):e.add(n),su(t,n,s)),!1;case 22:return i.flags|=65536,n===ls?i.flags|=16384:(null===(e=i.updateQueue)?(e={transitions:null,markerInstances:null,retryQueue:new Set([n])},i.updateQueue=e):null===(i=e.retryQueue)?e.retryQueue=new Set([n]):i.add(n),su(t,n,s)),!1}throw Error(r(435,i.tag))}return su(t,n,s),Xh(),!1}if($n)return null!==(e=Ts.current)?(0===(65536&e.flags)&&(e.flags|=256),e.flags|=65536,e.lanes=s,n!==Qn&&os(Rn(t=Error(r(422),{cause:n}),i))):(n!==Qn&&os(Rn(e=Error(r(423),{cause:n}),i)),(t=t.current.alternate).flags|=65536,s&=-s,t.lanes|=s,n=Rn(n,i),Ra(t,s=jr(t.stateNode,n,s)),4!==uh&&(uh=2)),!1;var o=Error(r(520),{cause:n});if(o=Rn(o,i),null===ph?ph=[o]:ph.push(o),4!==uh&&(uh=2),null===e)return!0;n=Rn(n,i),i=e;do{switch(i.tag){case 3:return i.flags|=65536,t=s&-s,i.lanes|=t,Ra(i,t=jr(i.stateNode,n,t)),!1;case 1:if(e=i.type,o=i.stateNode,0===(128&i.flags)&&("function"===typeof e.getDerivedStateFromError||null!==o&&"function"===typeof o.componentDidCatch&&(null===kh||!kh.has(o))))return i.flags|=65536,s&=-s,i.lanes|=s,Gr(s=Ur(s),t,i,n),Ra(i,s),!1}i=i.return}while(null!==i);return!1}(t,s,e,i,nh))return uh=1,zr(t,Rn(i,t.current)),void(ih=null)}catch(o){if(null!==s)throw ih=s,o;return uh=1,zr(t,Rn(i,t.current)),void(ih=null)}32768&e.flags?($n||1===n?t=!0:ah||0!==(536870912&nh)?t=!1:(rh=t=!0,(2===n||3===n||6===n)&&(null!==(n=Ts.current)&&13===n.tag&&(n.flags|=16384))),Zh(e,t)):Jh(e)}function Jh(t){var e=t;do{if(0!==(32768&e.flags))return void Zh(e,rh);t=e.return;var i=Wl(e.alternate,e,hh);if(null!==i)return void(ih=i);if(null!==(e=e.sibling))return void(ih=e);ih=e=t}while(null!==e);0===uh&&(uh=5)}function Zh(t,e){do{var i=$l(t.alternate,t);if(null!==i)return i.flags&=32767,void(ih=i);if(null!==(i=t.return)&&(i.flags|=32768,i.subtreeFlags=0,i.deletions=null),!e&&null!==(t=t.sibling))return void(ih=t);ih=t=i}while(null!==t);uh=6,ih=null}function Qh(t,e,i,n,s,o,a,l,h,u){var c=A.T,d=G.p;try{G.p=2,A.T=null,function(t,e,i,n,s,o,a,l){do{eu()}while(null!==Ph);if(0!==(6&th))throw Error(r(327));var h=t.finishedWork;if(n=t.finishedLanes,null===h)return null;if(t.finishedWork=null,t.finishedLanes=0,h===t.current)throw Error(r(177));t.callbackNode=null,t.callbackPriority=0,t.cancelPendingCommit=null;var u=h.lanes|h.childLanes;if(function(t,e,i,n,s,o){var r=t.pendingLanes;t.pendingLanes=i,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=i,t.entangledLanes&=i,t.errorRecoveryDisabledLanes&=i,t.shellSuspendCounter=0;var a=t.entanglements,l=t.expirationTimes,h=t.hiddenUpdates;for(i=r&~i;0<i;){var u=31-vt(i),c=1<<u;a[u]=0,l[u]=-1;var d=h[u];if(null!==d)for(h[u]=null,u=0;u<d.length;u++){var f=d[u];null!==f&&(f.lane&=-536870913)}i&=~c}0!==n&&Ot(t,n,0),0!==o&&0===s&&0!==t.tag&&(t.suspendedLanes|=o&~(r&~e))}(t,n,u|=Mn,o,a,l),t===eh&&(ih=eh=null,nh=0),0===(10256&h.subtreeFlags)&&0===(10256&h.flags)||Sh||(Sh=!0,Ch=u,Nh=i,function(t,e){st(t,e)}(dt,(function(){return eu(),null}))),i=0!==(15990&h.flags),0!==(15990&h.subtreeFlags)||i?(i=A.T,A.T=null,o=G.p,G.p=2,a=th,th|=4,function(t,e){if(t=t.containerInfo,Hu=Xc,Qi(t=Zi(t))){if("selectionStart"in t)var i={start:t.selectionStart,end:t.selectionEnd};else t:{var n=(i=(i=t.ownerDocument)&&i.defaultView||window).getSelection&&i.getSelection();if(n&&0!==n.rangeCount){i=n.anchorNode;var s=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{i.nodeType,o.nodeType}catch(p){i=null;break t}var a=0,l=-1,h=-1,u=0,c=0,d=t,f=null;e:for(;;){for(var g;d!==i||0!==s&&3!==d.nodeType||(l=a+s),d!==o||0!==n&&3!==d.nodeType||(h=a+n),3===d.nodeType&&(a+=d.nodeValue.length),null!==(g=d.firstChild);)f=d,d=g;for(;;){if(d===t)break e;if(f===i&&++u===s&&(l=a),f===o&&++c===n&&(h=a),null!==(g=d.nextSibling))break;f=(d=f).parentNode}d=g}i=-1===l||-1===h?null:{start:l,end:h}}else i=null}i=i||{start:0,end:0}}else i=null;for(qu={focusedElem:t,selectionRange:i},Xc=!1,il=e;null!==il;)if(t=(e=il).child,0!==(1028&e.subtreeFlags)&&null!==t)t.return=e,il=t;else for(;null!==il;){switch(o=(e=il).alternate,t=e.flags,e.tag){case 0:case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&t)&&null!==o){t=void 0,i=e,s=o.memoizedProps,o=o.memoizedState,n=i.stateNode;try{var m=Or(i.type,s,(i.elementType,i.type));t=n.getSnapshotBeforeUpdate(m,o),n.__reactInternalSnapshotBeforeUpdate=t}catch(y){nu(i,i.return,y)}}break;case 3:if(0!==(1024&t))if(9===(i=(t=e.stateNode.containerInfo).nodeType))rc(t);else if(1===i)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":rc(t);break;default:t.textContent=""}break;default:if(0!==(1024&t))throw Error(r(163))}if(null!==(t=e.sibling)){t.return=e.return,il=t;break}il=e.return}m=nl,nl=!1}(t,h),gl(h,t),tn(qu,t.containerInfo),Xc=!!Hu,qu=Hu=null,t.current=h,sl(t,h.alternate,h),at(),th=a,G.p=o,A.T=i):t.current=h,Sh?(Sh=!1,Ph=t,Mh=n):tu(t,u),u=t.pendingLanes,0===u&&(kh=null),function(t){if(xt&&"function"===typeof xt.onCommitFiberRoot)try{xt.onCommitFiberRoot(yt,t,void 0,128===(128&t.current.flags))}catch(e){}}(h.stateNode),mu(t),null!==e)for(s=t.onRecoverableError,h=0;h<e.length;h++)u=e[h],s(u.value,{componentStack:u.stack});0!==(3&Mh)&&eu(),u=t.pendingLanes,0!==(4194218&n)&&0!==(42&u)?t===Lh?Th++:(Th=0,Lh=t):Th=0,pu(0,!1)}(t,e,i,n,d,s,o,a)}finally{A.T=c,G.p=d}}function tu(t,e){0===(t.pooledCacheLanes&=e)&&(null!=(e=t.pooledCache)&&(t.pooledCache=null,Us(e)))}function eu(){if(null!==Ph){var t=Ph,e=Ch;Ch=0;var i=Et(Mh),n=A.T,s=G.p;try{if(G.p=32>i?32:i,A.T=null,null===Ph)var o=!1;else{i=Nh,Nh=null;var a=Ph,l=Mh;if(Ph=null,Mh=0,0!==(6&th))throw Error(r(331));var h=th;if(th|=4,Dl(a.current),Sl(a,a.current,l,i),th=h,pu(0,!1),xt&&"function"===typeof xt.onPostCommitFiberRoot)try{xt.onPostCommitFiberRoot(yt,a)}catch(u){}o=!0}return o}finally{G.p=s,A.T=n,tu(t,e)}}return!1}function iu(t,e,i){e=Rn(i,e),null!==(t=Fa(t,e=jr(t.stateNode,e,2),2))&&(Ft(t,2),mu(t))}function nu(t,e,i){if(3===t.tag)iu(t,t,i);else for(;null!==e;){if(3===e.tag){iu(e,t,i);break}if(1===e.tag){var n=e.stateNode;if("function"===typeof e.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===kh||!kh.has(n))){t=Rn(i,t),null!==(n=Fa(e,i=Ur(2),2))&&(Gr(i,n,e,t),Ft(n,2),mu(n));break}}e=e.return}}function su(t,e,i){var n=t.pingCache;if(null===n){n=t.pingCache=new Ql;var s=new Set;n.set(e,s)}else void 0===(s=n.get(e))&&(s=new Set,n.set(e,s));s.has(i)||(lh=!0,s.add(i),t=ou.bind(null,t,e,i),e.then(t,t))}function ou(t,e,i){var n=t.pingCache;null!==n&&n.delete(e),t.pingedLanes|=t.suspendedLanes&i,t.warmLanes&=~i,eh===t&&(nh&i)===i&&(4===uh||3===uh&&(62914560&nh)===nh&&300>lt()-bh?0===(2&th)&&jh(t,0):fh|=i,mh===nh&&(mh=0)),mu(t)}function ru(t,e){0===e&&(e=At()),null!==(t=Ln(t,e))&&(Ft(t,e),mu(t))}function au(t){var e=t.memoizedState,i=0;null!==e&&(i=e.retryLane),ru(t,i)}function lu(t,e){var i=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;null!==s&&(i=s.retryLane);break;case 19:n=t.stateNode;break;case 22:n=t.stateNode._retryCache;break;default:throw Error(r(314))}null!==n&&n.delete(e),ru(t,i)}var hu=null,uu=null,cu=!1,du=!1,fu=!1,gu=0;function mu(t){var e;t!==uu&&null===t.next&&(null===uu?hu=uu=t:uu=uu.next=t),du=!0,cu||(cu=!0,e=yu,nc((function(){0!==(6&th)?st(ut,e):e()})))}function pu(t,e){if(!fu&&du){fu=!0;do{for(var i=!1,n=hu;null!==n;){if(!e)if(0!==t){var s=n.pendingLanes;if(0===s)var o=0;else{var r=n.suspendedLanes,a=n.pingedLanes;o=(1<<31-vt(42|t)+1)-1,o=201326677&(o&=s&~(r&~a))?201326677&o|1:o?2|o:0}0!==o&&(i=!0,vu(n,o))}else o=nh,0===(3&(o=Ct(n,n===eh?o:0)))||Nt(n,o)||(i=!0,vu(n,o));n=n.next}}while(i);fu=!1}}function yu(){du=cu=!1;var t=0;0!==gu&&(function(){var t=window.event;if(t&&"popstate"===t.type)return t!==Qu&&(Qu=t,!0);return Qu=null,!1}()&&(t=gu),gu=0);for(var e=lt(),i=null,n=hu;null!==n;){var s=n.next,o=xu(n,e);0===o?(n.next=null,null===i?hu=s:i.next=s,null===s&&(uu=i)):(i=n,(0!==t||0!==(3&o))&&(du=!0)),n=s}pu(t,!1)}function xu(t,e){for(var i=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,o=-62914561&t.pendingLanes;0<o;){var r=31-vt(o),a=1<<r,l=s[r];-1===l?0!==(a&i)&&0===(a&n)||(s[r]=Tt(a,e)):l<=e&&(t.expiredLanes|=a),o&=~a}if(i=nh,i=Ct(t,t===(e=eh)?i:0),n=t.callbackNode,0===i||t===e&&2===sh||null!==t.cancelPendingCommit)return null!==n&&null!==n&&ot(n),t.callbackNode=null,t.callbackPriority=0;if(0===(3&i)||Nt(t,i)){if((e=i&-i)===t.callbackPriority)return e;switch(null!==n&&ot(n),Et(i)){case 2:case 8:i=ct;break;case 32:default:i=dt;break;case 268435456:i=gt}return n=bu.bind(null,t),i=st(i,n),t.callbackPriority=e,t.callbackNode=i,e}return null!==n&&null!==n&&ot(n),t.callbackPriority=2,t.callbackNode=null,2}function bu(t,e){var i=t.callbackNode;if(eu()&&t.callbackNode!==i)return null;var n=nh;return 0===(n=Ct(t,t===eh?n:0))?null:(Oh(t,n,e),xu(t,lt()),null!=t.callbackNode&&t.callbackNode===i?bu.bind(null,t):null)}function vu(t,e){if(eu())return null;Oh(t,e,!0)}function wu(){return 0===gu&&(gu=Lt()),gu}function ku(t){return null==t||"symbol"===typeof t||"boolean"===typeof t?null:"function"===typeof t?t:Le(""+t)}function Su(t,e){var i=e.ownerDocument.createElement("input");return i.name=e.name,i.value=e.value,t.id&&i.setAttribute("form",t.id),e.parentNode.insertBefore(i,e),t=new FormData(t),i.parentNode.removeChild(i),t}for(var Pu=0;Pu<wn.length;Pu++){var Mu=wn[Pu];kn(Mu.toLowerCase(),"on"+(Mu[0].toUpperCase()+Mu.slice(1)))}kn(fn,"onAnimationEnd"),kn(gn,"onAnimationIteration"),kn(mn,"onAnimationStart"),kn("dblclick","onDoubleClick"),kn("focusin","onFocus"),kn("focusout","onBlur"),kn(pn,"onTransitionRun"),kn(yn,"onTransitionStart"),kn(xn,"onTransitionCancel"),kn(bn,"onTransitionEnd"),ee("onMouseEnter",["mouseout","mouseover"]),ee("onMouseLeave",["mouseout","mouseover"]),ee("onPointerEnter",["pointerout","pointerover"]),ee("onPointerLeave",["pointerout","pointerover"]),te("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),te("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),te("onBeforeInput",["compositionend","keypress","textInput","paste"]),te("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),te("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),te("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Cu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nu=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Cu));function Tu(t,e){e=0!==(4&e);for(var i=0;i<t.length;i++){var n=t[i],s=n.event;n=n.listeners;t:{var o=void 0;if(e)for(var r=n.length-1;0<=r;r--){var a=n[r],l=a.instance,h=a.currentTarget;if(a=a.listener,l!==o&&s.isPropagationStopped())break t;o=a,s.currentTarget=h;try{o(s)}catch(u){Rr(u)}s.currentTarget=null,o=l}else for(r=0;r<n.length;r++){if(l=(a=n[r]).instance,h=a.currentTarget,a=a.listener,l!==o&&s.isPropagationStopped())break t;o=a,s.currentTarget=h;try{o(s)}catch(u){Rr(u)}s.currentTarget=null,o=l}}}}function Lu(t,e){var i=e[Ut];void 0===i&&(i=e[Ut]=new Set);var n=t+"__bubble";i.has(n)||(Ou(e,t,2,!1),i.add(n))}function Au(t,e,i){var n=0;e&&(n|=4),Ou(i,t,n,e)}var Du="_reactListening"+Math.random().toString(36).slice(2);function Fu(t){if(!t[Du]){t[Du]=!0,Zt.forEach((function(e){"selectionchange"!==e&&(Nu.has(e)||Au(e,!1,t),Au(e,!0,t))}));var e=9===t.nodeType?t:t.ownerDocument;null===e||e[Du]||(e[Du]=!0,Au("selectionchange",!1,e))}}function Ou(t,e,i,n){switch(Jc(e)){case 2:var s=Yc;break;case 8:s=_c;break;default:s=Hc}i=s.bind(null,e,i,t),s=void 0,!ze||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(s=!0),n?void 0!==s?t.addEventListener(e,i,{capture:!0,passive:s}):t.addEventListener(e,i,!0):void 0!==s?t.addEventListener(e,i,{passive:s}):t.addEventListener(e,i,!1)}function Ru(t,e,i,n,s){var o=n;if(0===(1&e)&&0===(2&e)&&null!==n)t:for(;;){if(null===n)return;var r=n.tag;if(3===r||4===r){var a=n.stateNode.containerInfo;if(a===s||8===a.nodeType&&a.parentNode===s)break;if(4===r)for(r=n.return;null!==r;){var l=r.tag;if((3===l||4===l)&&((l=r.stateNode.containerInfo)===s||8===l.nodeType&&l.parentNode===s))return;r=r.return}for(;null!==a;){if(null===(r=Ht(a)))return;if(5===(l=r.tag)||6===l||26===l||27===l){n=o=r;continue t}a=a.parentNode}}n=n.return}Be((function(){var n=o,s=De(i),r=[];t:{var a=vn.get(t);if(void 0!==a){var l=Ze,h=t;switch(t){case"keypress":if(0===Xe(i))break t;case"keydown":case"keyup":l=fi;break;case"focusin":h="focus",l=si;break;case"focusout":h="blur",l=si;break;case"beforeblur":case"afterblur":l=si;break;case"click":if(2===i.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=ii;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=ni;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=mi;break;case fn:case gn:case mn:l=oi;break;case bn:l=pi;break;case"scroll":case"scrollend":l=ti;break;case"wheel":l=yi;break;case"copy":case"cut":case"paste":l=ri;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=gi;break;case"toggle":case"beforetoggle":l=xi}var u=0!==(4&e),c=!u&&("scroll"===t||"scrollend"===t),d=u?null!==a?a+"Capture":null:a;u=[];for(var f,g=n;null!==g;){var m=g;if(f=m.stateNode,5!==(m=m.tag)&&26!==m&&27!==m||null===f||null===d||null!=(m=Ie(g,d))&&u.push(Eu(g,m,f)),c)break;g=g.return}0<u.length&&(a=new l(a,h,null,i,s),r.push({event:a,listeners:u}))}}if(0===(7&e)){if(l="mouseout"===t||"pointerout"===t,(!(a="mouseover"===t||"pointerover"===t)||i===Ae||!(h=i.relatedTarget||i.fromElement)||!Ht(h)&&!h[jt])&&(l||a)&&(a=s.window===s?s:(a=s.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=n,null!==(h=(h=i.relatedTarget||i.toElement)?Ht(h):null)&&(c=I(h),u=h.tag,h!==c||5!==u&&27!==u&&6!==u)&&(h=null)):(l=null,h=n),l!==h)){if(u=ii,m="onMouseLeave",d="onMouseEnter",g="mouse","pointerout"!==t&&"pointerover"!==t||(u=gi,m="onPointerLeave",d="onPointerEnter",g="pointer"),c=null==l?a:Wt(l),f=null==h?a:Wt(h),(a=new u(m,g+"leave",l,i,s)).target=c,a.relatedTarget=f,m=null,Ht(s)===n&&((u=new u(d,g+"enter",h,i,s)).target=f,u.relatedTarget=c,m=u),c=m,l&&h)t:{for(d=h,g=0,f=u=l;f;f=Iu(f))g++;for(f=0,m=d;m;m=Iu(m))f++;for(;0<g-f;)u=Iu(u),g--;for(;0<f-g;)d=Iu(d),f--;for(;g--;){if(u===d||null!==d&&u===d.alternate)break t;u=Iu(u),d=Iu(d)}u=null}else u=null;null!==l&&zu(r,a,l,u,!1),null!==h&&null!==c&&zu(r,c,h,u,!0)}if("select"===(l=(a=n?Wt(n):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var p=Bi;else if(Ai(a))if(Ii)p=_i;else{p=Xi;var y=Ki}else!(l=a.nodeName)||"input"!==l.toLowerCase()||"checkbox"!==a.type&&"radio"!==a.type?n&&Ce(n.elementType)&&(p=Bi):p=Yi;switch(p&&(p=p(t,n))?Di(r,p,i,s):(y&&y(t,a,n),"focusout"===t&&n&&"number"===a.type&&null!=n.memoizedProps.value&&xe(a,"number",a.value)),y=n?Wt(n):window,t){case"focusin":(Ai(y)||"true"===y.contentEditable)&&(nn=y,sn=n,on=null);break;case"focusout":on=sn=nn=null;break;case"mousedown":rn=!0;break;case"contextmenu":case"mouseup":case"dragend":rn=!1,an(r,i,s);break;case"selectionchange":if(en)break;case"keydown":case"keyup":an(r,i,s)}var x;if(vi)t:{switch(t){case"compositionstart":var b="onCompositionStart";break t;case"compositionend":b="onCompositionEnd";break t;case"compositionupdate":b="onCompositionUpdate";break t}b=void 0}else Ti?Ci(t,i)&&(b="onCompositionEnd"):"keydown"===t&&229===i.keyCode&&(b="onCompositionStart");b&&(Si&&"ko"!==i.locale&&(Ti||"onCompositionStart"!==b?"onCompositionEnd"===b&&Ti&&(x=Ke()):(Ue="value"in(je=s)?je.value:je.textContent,Ti=!0)),0<(y=Bu(n,b)).length&&(b=new ai(b,t,null,i,s),r.push({event:b,listeners:y}),x?b.data=x:null!==(x=Ni(i))&&(b.data=x))),(x=ki?function(t,e){switch(t){case"compositionend":return Ni(e);case"keypress":return 32!==e.which?null:(Mi=!0,Pi);case"textInput":return(t=e.data)===Pi&&Mi?null:t;default:return null}}(t,i):function(t,e){if(Ti)return"compositionend"===t||!vi&&Ci(t,e)?(t=Ke(),Ge=Ue=je=null,Ti=!1,t):null;switch(t){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Si&&"ko"!==e.locale?null:e.data}}(t,i))&&(0<(b=Bu(n,"onBeforeInput")).length&&(y=new ai("onBeforeInput","beforeinput",null,i,s),r.push({event:y,listeners:b}),y.data=x)),function(t,e,i,n,s){if("submit"===e&&i&&i.stateNode===s){var o=ku((s[Vt]||null).action),r=n.submitter;r&&null!==(e=(e=r[Vt]||null)?ku(e.formAction):r.getAttribute("formAction"))&&(o=e,r=null);var a=new Ze("action","action",null,n,s);t.push({event:a,listeners:[{instance:null,listener:function(){if(n.defaultPrevented){if(0!==gu){var t=r?Su(s,r):new FormData(s);cr(i,{pending:!0,data:t,method:s.method,action:o},null,t)}}else"function"===typeof o&&(a.preventDefault(),t=r?Su(s,r):new FormData(s),cr(i,{pending:!0,data:t,method:s.method,action:o},o,t))},currentTarget:s}]})}}(r,t,n,i,s)}Tu(r,e)}))}function Eu(t,e,i){return{instance:t,listener:e,currentTarget:i}}function Bu(t,e){for(var i=e+"Capture",n=[];null!==t;){var s=t,o=s.stateNode;5!==(s=s.tag)&&26!==s&&27!==s||null===o||(null!=(s=Ie(t,i))&&n.unshift(Eu(t,s,o)),null!=(s=Ie(t,e))&&n.push(Eu(t,s,o))),t=t.return}return n}function Iu(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag&&27!==t.tag);return t||null}function zu(t,e,i,n,s){for(var o=e._reactName,r=[];null!==i&&i!==n;){var a=i,l=a.alternate,h=a.stateNode;if(a=a.tag,null!==l&&l===n)break;5!==a&&26!==a&&27!==a||null===h||(l=h,s?null!=(h=Ie(i,o))&&r.unshift(Eu(i,h,l)):s||null!=(h=Ie(i,o))&&r.push(Eu(i,h,l))),i=i.return}0!==r.length&&t.push({event:e,listeners:r})}var Vu=/\r\n?/g,ju=/\u0000|\uFFFD/g;function Uu(t){return("string"===typeof t?t:""+t).replace(Vu,"\n").replace(ju,"")}function Gu(t,e){return e=Uu(e),Uu(t)===e}function Ku(){}function Xu(t,e,i,n,s,o){switch(i){case"children":"string"===typeof n?"body"===e||"textarea"===e&&""===n||ke(t,n):("number"===typeof n||"bigint"===typeof n)&&"body"!==e&&ke(t,""+n);break;case"className":ae(t,"class",n);break;case"tabIndex":ae(t,"tabindex",n);break;case"dir":case"role":case"viewBox":case"width":case"height":ae(t,i,n);break;case"style":Me(t,n,o);break;case"data":if("object"!==e){ae(t,"data",n);break}case"src":case"href":if(""===n&&("a"!==e||"href"!==i)){t.removeAttribute(i);break}if(null==n||"function"===typeof n||"symbol"===typeof n||"boolean"===typeof n){t.removeAttribute(i);break}n=Le(""+n),t.setAttribute(i,n);break;case"action":case"formAction":if("function"===typeof n){t.setAttribute(i,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof o&&("formAction"===i?("input"!==e&&Xu(t,e,"name",s.name,s,null),Xu(t,e,"formEncType",s.formEncType,s,null),Xu(t,e,"formMethod",s.formMethod,s,null),Xu(t,e,"formTarget",s.formTarget,s,null)):(Xu(t,e,"encType",s.encType,s,null),Xu(t,e,"method",s.method,s,null),Xu(t,e,"target",s.target,s,null))),null==n||"symbol"===typeof n||"boolean"===typeof n){t.removeAttribute(i);break}n=Le(""+n),t.setAttribute(i,n);break;case"onClick":null!=n&&(t.onclick=Ku);break;case"onScroll":null!=n&&Lu("scroll",t);break;case"onScrollEnd":null!=n&&Lu("scrollend",t);break;case"dangerouslySetInnerHTML":if(null!=n){if("object"!==typeof n||!("__html"in n))throw Error(r(61));if(null!=(i=n.__html)){if(null!=s.children)throw Error(r(60));t.innerHTML=i}}break;case"multiple":t.multiple=n&&"function"!==typeof n&&"symbol"!==typeof n;break;case"muted":t.muted=n&&"function"!==typeof n&&"symbol"!==typeof n;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==n||"function"===typeof n||"boolean"===typeof n||"symbol"===typeof n){t.removeAttribute("xlink:href");break}i=Le(""+n),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",i);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=n&&"function"!==typeof n&&"symbol"!==typeof n?t.setAttribute(i,""+n):t.removeAttribute(i);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":n&&"function"!==typeof n&&"symbol"!==typeof n?t.setAttribute(i,""):t.removeAttribute(i);break;case"capture":case"download":!0===n?t.setAttribute(i,""):!1!==n&&null!=n&&"function"!==typeof n&&"symbol"!==typeof n?t.setAttribute(i,n):t.removeAttribute(i);break;case"cols":case"rows":case"size":case"span":null!=n&&"function"!==typeof n&&"symbol"!==typeof n&&!isNaN(n)&&1<=n?t.setAttribute(i,n):t.removeAttribute(i);break;case"rowSpan":case"start":null==n||"function"===typeof n||"symbol"===typeof n||isNaN(n)?t.removeAttribute(i):t.setAttribute(i,n);break;case"popover":Lu("beforetoggle",t),Lu("toggle",t),re(t,"popover",n);break;case"xlinkActuate":le(t,"http://www.w3.org/1999/xlink","xlink:actuate",n);break;case"xlinkArcrole":le(t,"http://www.w3.org/1999/xlink","xlink:arcrole",n);break;case"xlinkRole":le(t,"http://www.w3.org/1999/xlink","xlink:role",n);break;case"xlinkShow":le(t,"http://www.w3.org/1999/xlink","xlink:show",n);break;case"xlinkTitle":le(t,"http://www.w3.org/1999/xlink","xlink:title",n);break;case"xlinkType":le(t,"http://www.w3.org/1999/xlink","xlink:type",n);break;case"xmlBase":le(t,"http://www.w3.org/XML/1998/namespace","xml:base",n);break;case"xmlLang":le(t,"http://www.w3.org/XML/1998/namespace","xml:lang",n);break;case"xmlSpace":le(t,"http://www.w3.org/XML/1998/namespace","xml:space",n);break;case"is":re(t,"is",n);break;case"innerText":case"textContent":break;default:(!(2<i.length)||"o"!==i[0]&&"O"!==i[0]||"n"!==i[1]&&"N"!==i[1])&&re(t,i=Ne.get(i)||i,n)}}function Yu(t,e,i,n,s,o){switch(i){case"style":Me(t,n,o);break;case"dangerouslySetInnerHTML":if(null!=n){if("object"!==typeof n||!("__html"in n))throw Error(r(61));if(null!=(i=n.__html)){if(null!=s.children)throw Error(r(60));t.innerHTML=i}}break;case"children":"string"===typeof n?ke(t,n):("number"===typeof n||"bigint"===typeof n)&&ke(t,""+n);break;case"onScroll":null!=n&&Lu("scroll",t);break;case"onScrollEnd":null!=n&&Lu("scrollend",t);break;case"onClick":null!=n&&(t.onclick=Ku);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:Qt.hasOwnProperty(i)||("o"!==i[0]||"n"!==i[1]||(s=i.endsWith("Capture"),e=i.slice(2,s?i.length-7:void 0),"function"===typeof(o=null!=(o=t[Vt]||null)?o[i]:null)&&t.removeEventListener(e,o,s),"function"!==typeof n)?i in t?t[i]=n:!0===n?t.setAttribute(i,""):re(t,i,n):("function"!==typeof o&&null!==o&&(i in t?t[i]=null:t.hasAttribute(i)&&t.removeAttribute(i)),t.addEventListener(e,n,s)))}}function _u(t,e,i){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Lu("error",t),Lu("load",t);var n,s=!1,o=!1;for(n in i)if(i.hasOwnProperty(n)){var a=i[n];if(null!=a)switch(n){case"src":s=!0;break;case"srcSet":o=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,e));default:Xu(t,e,n,a,i,null)}}return o&&Xu(t,e,"srcSet",i.srcSet,i,null),void(s&&Xu(t,e,"src",i.src,i,null));case"input":Lu("invalid",t);var l=n=a=o=null,h=null,u=null;for(s in i)if(i.hasOwnProperty(s)){var c=i[s];if(null!=c)switch(s){case"name":o=c;break;case"type":a=c;break;case"checked":h=c;break;case"defaultChecked":u=c;break;case"value":n=c;break;case"defaultValue":l=c;break;case"children":case"dangerouslySetInnerHTML":if(null!=c)throw Error(r(137,e));break;default:Xu(t,e,s,c,i,null)}}return ye(t,n,l,h,u,a,o,!1),void ce(t);case"select":for(o in Lu("invalid",t),s=a=n=null,i)if(i.hasOwnProperty(o)&&null!=(l=i[o]))switch(o){case"value":n=l;break;case"defaultValue":a=l;break;case"multiple":s=l;default:Xu(t,e,o,l,i,null)}return e=n,i=a,t.multiple=!!s,void(null!=e?be(t,!!s,e,!1):null!=i&&be(t,!!s,i,!0));case"textarea":for(a in Lu("invalid",t),n=o=s=null,i)if(i.hasOwnProperty(a)&&null!=(l=i[a]))switch(a){case"value":s=l;break;case"defaultValue":o=l;break;case"children":n=l;break;case"dangerouslySetInnerHTML":if(null!=l)throw Error(r(91));break;default:Xu(t,e,a,l,i,null)}return we(t,s,o,n),void ce(t);case"option":for(h in i)if(i.hasOwnProperty(h)&&null!=(s=i[h]))if("selected"===h)t.selected=s&&"function"!==typeof s&&"symbol"!==typeof s;else Xu(t,e,h,s,i,null);return;case"dialog":Lu("cancel",t),Lu("close",t);break;case"iframe":case"object":Lu("load",t);break;case"video":case"audio":for(s=0;s<Cu.length;s++)Lu(Cu[s],t);break;case"image":Lu("error",t),Lu("load",t);break;case"details":Lu("toggle",t);break;case"embed":case"source":case"link":Lu("error",t),Lu("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in i)if(i.hasOwnProperty(u)&&null!=(s=i[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,e));default:Xu(t,e,u,s,i,null)}return;default:if(Ce(e)){for(c in i)i.hasOwnProperty(c)&&(void 0!==(s=i[c])&&Yu(t,e,c,s,i,void 0));return}}for(l in i)i.hasOwnProperty(l)&&(null!=(s=i[l])&&Xu(t,e,l,s,i,null))}var Hu=null,qu=null;function Wu(t){return 9===t.nodeType?t:t.ownerDocument}function $u(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Ju(t,e){if(0===t)switch(e){case"svg":return 1;case"math":return 2;default:return 0}return 1===t&&"foreignObject"===e?0:t}function Zu(t,e){return"textarea"===t||"noscript"===t||"string"===typeof e.children||"number"===typeof e.children||"bigint"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var Qu=null;var tc="function"===typeof setTimeout?setTimeout:void 0,ec="function"===typeof clearTimeout?clearTimeout:void 0,ic="function"===typeof Promise?Promise:void 0,nc="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ic?function(t){return ic.resolve(null).then(t).catch(sc)}:tc;function sc(t){setTimeout((function(){throw t}))}function oc(t,e){var i=e,n=0;do{var s=i.nextSibling;if(t.removeChild(i),s&&8===s.nodeType)if("/$"===(i=s.data)){if(0===n)return t.removeChild(s),void md(e);n--}else"$"!==i&&"$?"!==i&&"$!"!==i||n++;i=s}while(i);md(e)}function rc(t){var e=t.firstChild;for(e&&10===e.nodeType&&(e=e.nextSibling);e;){var i=e;switch(e=e.nextSibling,i.nodeName){case"HTML":case"HEAD":case"BODY":rc(i),_t(i);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===i.rel.toLowerCase())continue}t.removeChild(i)}}function ac(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break;if(8===e){if("$"===(e=t.data)||"$!"===e||"$?"===e||"F!"===e||"F"===e)break;if("/$"===e)return null}}return t}function lc(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var i=t.data;if("$"===i||"$!"===i||"$?"===i){if(0===e)return t;e--}else"/$"===i&&e++}t=t.previousSibling}return null}function hc(t,e,i){switch(e=Wu(i),t){case"html":if(!(t=e.documentElement))throw Error(r(452));return t;case"head":if(!(t=e.head))throw Error(r(453));return t;case"body":if(!(t=e.body))throw Error(r(454));return t;default:throw Error(r(451))}}var uc=new Map,cc=new Set;function dc(t){return"function"===typeof t.getRootNode?t.getRootNode():t.ownerDocument}var fc=G.d;G.d={f:function(){var t=fc.f(),e=zh();return t||e},r:function(t){var e=qt(t);null!==e&&5===e.tag&&"form"===e.type?fr(e):fc.r(t)},D:function(t){fc.D(t),mc("dns-prefetch",t,null)},C:function(t,e){fc.C(t,e),mc("preconnect",t,e)},L:function(t,e,i){fc.L(t,e,i);var n=gc;if(n&&t&&e){var s='link[rel="preload"][as="'+me(e)+'"]';"image"===e&&i&&i.imageSrcSet?(s+='[imagesrcset="'+me(i.imageSrcSet)+'"]',"string"===typeof i.imageSizes&&(s+='[imagesizes="'+me(i.imageSizes)+'"]')):s+='[href="'+me(t)+'"]';var o=s;switch(e){case"style":o=yc(t);break;case"script":o=vc(t)}uc.has(o)||(t=D({rel:"preload",href:"image"===e&&i&&i.imageSrcSet?void 0:t,as:e},i),uc.set(o,t),null!==n.querySelector(s)||"style"===e&&n.querySelector(xc(o))||"script"===e&&n.querySelector(wc(o))||(_u(e=n.createElement("link"),"link",t),Jt(e),n.head.appendChild(e)))}},m:function(t,e){fc.m(t,e);var i=gc;if(i&&t){var n=e&&"string"===typeof e.as?e.as:"script",s='link[rel="modulepreload"][as="'+me(n)+'"][href="'+me(t)+'"]',o=s;switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":o=vc(t)}if(!uc.has(o)&&(t=D({rel:"modulepreload",href:t},e),uc.set(o,t),null===i.querySelector(s))){switch(n){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(i.querySelector(wc(o)))return}_u(n=i.createElement("link"),"link",t),Jt(n),i.head.appendChild(n)}}},X:function(t,e){fc.X(t,e);var i=gc;if(i&&t){var n=$t(i).hoistableScripts,s=vc(t),o=n.get(s);o||((o=i.querySelector(wc(s)))||(t=D({src:t,async:!0},e),(e=uc.get(s))&&Mc(t,e),Jt(o=i.createElement("script")),_u(o,"link",t),i.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},n.set(s,o))}},S:function(t,e,i){fc.S(t,e,i);var n=gc;if(n&&t){var s=$t(n).hoistableStyles,o=yc(t);e=e||"default";var r=s.get(o);if(!r){var a={loading:0,preload:null};if(r=n.querySelector(xc(o)))a.loading=5;else{t=D({rel:"stylesheet",href:t,"data-precedence":e},i),(i=uc.get(o))&&Pc(t,i);var l=r=n.createElement("link");Jt(l),_u(l,"link",t),l._p=new Promise((function(t,e){l.onload=t,l.onerror=e})),l.addEventListener("load",(function(){a.loading|=1})),l.addEventListener("error",(function(){a.loading|=2})),a.loading|=4,Sc(r,e,n)}r={type:"stylesheet",instance:r,count:1,state:a},s.set(o,r)}}},M:function(t,e){fc.M(t,e);var i=gc;if(i&&t){var n=$t(i).hoistableScripts,s=vc(t),o=n.get(s);o||((o=i.querySelector(wc(s)))||(t=D({src:t,async:!0,type:"module"},e),(e=uc.get(s))&&Mc(t,e),Jt(o=i.createElement("script")),_u(o,"link",t),i.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},n.set(s,o))}}};var gc="undefined"===typeof document?null:document;function mc(t,e,i){var n=gc;if(n&&"string"===typeof e&&e){var s=me(e);s='link[rel="'+t+'"][href="'+s+'"]',"string"===typeof i&&(s+='[crossorigin="'+i+'"]'),cc.has(s)||(cc.add(s),t={rel:t,crossOrigin:i,href:e},null===n.querySelector(s)&&(_u(e=n.createElement("link"),"link",t),Jt(e),n.head.appendChild(e)))}}function pc(t,e,i,n){var s,o,a,l,h=(h=J.current)?dc(h):null;if(!h)throw Error(r(446));switch(t){case"meta":case"title":return null;case"style":return"string"===typeof i.precedence&&"string"===typeof i.href?(e=yc(i.href),(n=(i=$t(h).hoistableStyles).get(e))||(n={type:"style",instance:null,count:0,state:null},i.set(e,n)),n):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===i.rel&&"string"===typeof i.href&&"string"===typeof i.precedence){t=yc(i.href);var u=$t(h).hoistableStyles,c=u.get(t);if(c||(h=h.ownerDocument||h,c={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(t,c),(u=h.querySelector(xc(t)))&&!u._p&&(c.instance=u,c.state.loading=5),uc.has(t)||(i={rel:"preload",as:"style",href:i.href,crossOrigin:i.crossOrigin,integrity:i.integrity,media:i.media,hrefLang:i.hrefLang,referrerPolicy:i.referrerPolicy},uc.set(t,i),u||(s=h,o=t,a=i,l=c.state,s.querySelector('link[rel="preload"][as="style"]['+o+"]")?l.loading=1:(o=s.createElement("link"),l.preload=o,o.addEventListener("load",(function(){return l.loading|=1})),o.addEventListener("error",(function(){return l.loading|=2})),_u(o,"link",a),Jt(o),s.head.appendChild(o))))),e&&null===n)throw Error(r(528,""));return c}if(e&&null!==n)throw Error(r(529,""));return null;case"script":return e=i.async,"string"===typeof(i=i.src)&&e&&"function"!==typeof e&&"symbol"!==typeof e?(e=vc(i),(n=(i=$t(h).hoistableScripts).get(e))||(n={type:"script",instance:null,count:0,state:null},i.set(e,n)),n):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,t))}}function yc(t){return'href="'+me(t)+'"'}function xc(t){return'link[rel="stylesheet"]['+t+"]"}function bc(t){return D({},t,{"data-precedence":t.precedence,precedence:null})}function vc(t){return'[src="'+me(t)+'"]'}function wc(t){return"script[async]"+t}function kc(t,e,i){if(e.count++,null===e.instance)switch(e.type){case"style":var n=t.querySelector('style[data-href~="'+me(i.href)+'"]');if(n)return e.instance=n,Jt(n),n;var s=D({},i,{"data-href":i.href,"data-precedence":i.precedence,href:null,precedence:null});return Jt(n=(t.ownerDocument||t).createElement("style")),_u(n,"style",s),Sc(n,i.precedence,t),e.instance=n;case"stylesheet":s=yc(i.href);var o=t.querySelector(xc(s));if(o)return e.state.loading|=4,e.instance=o,Jt(o),o;n=bc(i),(s=uc.get(s))&&Pc(n,s),Jt(o=(t.ownerDocument||t).createElement("link"));var a=o;return a._p=new Promise((function(t,e){a.onload=t,a.onerror=e})),_u(o,"link",n),e.state.loading|=4,Sc(o,i.precedence,t),e.instance=o;case"script":return o=vc(i.src),(s=t.querySelector(wc(o)))?(e.instance=s,Jt(s),s):(n=i,(s=uc.get(o))&&Mc(n=D({},i),s),Jt(s=(t=t.ownerDocument||t).createElement("script")),_u(s,"link",n),t.head.appendChild(s),e.instance=s);case"void":return null;default:throw Error(r(443,e.type))}else"stylesheet"===e.type&&0===(4&e.state.loading)&&(n=e.instance,e.state.loading|=4,Sc(n,i.precedence,t));return e.instance}function Sc(t,e,i){for(var n=i.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),s=n.length?n[n.length-1]:null,o=s,r=0;r<n.length;r++){var a=n[r];if(a.dataset.precedence===e)o=a;else if(o!==s)break}o?o.parentNode.insertBefore(t,o.nextSibling):(e=9===i.nodeType?i.head:i).insertBefore(t,e.firstChild)}function Pc(t,e){null==t.crossOrigin&&(t.crossOrigin=e.crossOrigin),null==t.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),null==t.title&&(t.title=e.title)}function Mc(t,e){null==t.crossOrigin&&(t.crossOrigin=e.crossOrigin),null==t.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),null==t.integrity&&(t.integrity=e.integrity)}var Cc=null;function Nc(t,e,i){if(null===Cc){var n=new Map,s=Cc=new Map;s.set(i,n)}else(n=(s=Cc).get(i))||(n=new Map,s.set(i,n));if(n.has(t))return n;for(n.set(t,null),i=i.getElementsByTagName(t),s=0;s<i.length;s++){var o=i[s];if(!(o[Yt]||o[zt]||"link"===t&&"stylesheet"===o.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==o.namespaceURI){var r=o.getAttribute(e)||"";r=t+r;var a=n.get(r);a?a.push(o):n.set(r,[o])}}return n}function Tc(t,e,i){(t=t.ownerDocument||t).head.insertBefore(i,"title"===e?t.querySelector("head > title"):null)}function Lc(t){return"stylesheet"!==t.type||0!==(3&t.state.loading)}var Ac=null;function Dc(){}function Fc(){if(this.count--,0===this.count)if(this.stylesheets)Rc(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}var Oc=null;function Rc(t,e){t.stylesheets=null,null!==t.unsuspend&&(t.count++,Oc=new Map,e.forEach(Ec,t),Oc=null,Fc.call(t))}function Ec(t,e){if(!(4&e.state.loading)){var i=Oc.get(t);if(i)var n=i.get(null);else{i=new Map,Oc.set(t,i);for(var s=t.querySelectorAll("link[data-precedence],style[data-precedence]"),o=0;o<s.length;o++){var r=s[o];"LINK"!==r.nodeName&&"not all"===r.getAttribute("media")||(i.set(r.dataset.precedence,r),n=r)}n&&i.set(null,n)}r=(s=e.instance).getAttribute("data-precedence"),(o=i.get(r)||n)===n&&i.set(null,s),i.set(r,s),this.count++,n=Fc.bind(this),s.addEventListener("load",n),s.addEventListener("error",n),o?o.parentNode.insertBefore(s,o.nextSibling):(t=9===t.nodeType?t.head:t).insertBefore(s,t.firstChild),e.state.loading|=4}}var Bc={$$typeof:p,Provider:null,Consumer:null,_currentValue:K,_currentValue2:K,_threadCount:0};function Ic(t,e,i,n,s,o,r,a){this.tag=1,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Dt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Dt(0),this.hiddenUpdates=Dt(null),this.identifierPrefix=n,this.onUncaughtError=s,this.onCaughtError=o,this.onRecoverableError=r,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=a,this.incompleteTransitions=new Map}function zc(t,e,i,n,s,o,r,a,l,h,u,c){return t=new Ic(t,e,i,r,a,l,h,c),e=1,!0===o&&(e|=24),o=El(3,null,null,e),t.current=o,o.stateNode=t,(e=js()).refCount++,t.pooledCache=e,e.refCount++,o.memoizedState={element:n,isDehydrated:i,cache:e},La(o),t}function Vc(t){return t?t=Fn:Fn}function jc(t,e,i,n,s,o){s=Vc(s),null===n.context?n.context=s:n.pendingContext=s,(n=Da(e)).payload={element:i},null!==(o=void 0===o?null:o)&&(n.callback=o),null!==(i=Fa(t,n,e))&&(Fh(i,0,e),Oa(i,t,e))}function Uc(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var i=t.retryLane;t.retryLane=0!==i&&i<e?i:e}}function Gc(t,e){Uc(t,e),(t=t.alternate)&&Uc(t,e)}function Kc(t){if(13===t.tag){var e=Ln(t,67108864);null!==e&&Fh(e,0,67108864),Gc(t,67108864)}}var Xc=!0;function Yc(t,e,i,n){var s=A.T;A.T=null;var o=G.p;try{G.p=2,Hc(t,e,i,n)}finally{G.p=o,A.T=s}}function _c(t,e,i,n){var s=A.T;A.T=null;var o=G.p;try{G.p=8,Hc(t,e,i,n)}finally{G.p=o,A.T=s}}function Hc(t,e,i,n){if(Xc){var s=qc(n);if(null===s)Ru(t,e,n,Wc,i),rd(t,n);else if(function(t,e,i,n,s){switch(e){case"focusin":return Qc=ad(Qc,t,e,i,n,s),!0;case"dragenter":return td=ad(td,t,e,i,n,s),!0;case"mouseover":return ed=ad(ed,t,e,i,n,s),!0;case"pointerover":var o=s.pointerId;return id.set(o,ad(id.get(o)||null,t,e,i,n,s)),!0;case"gotpointercapture":return o=s.pointerId,nd.set(o,ad(nd.get(o)||null,t,e,i,n,s)),!0}return!1}(s,t,e,i,n))n.stopPropagation();else if(rd(t,n),4&e&&-1<od.indexOf(t)){for(;null!==s;){var o=qt(s);if(null!==o)switch(o.tag){case 3:if((o=o.stateNode).current.memoizedState.isDehydrated){var r=Mt(o.pendingLanes);if(0!==r){var a=o;for(a.pendingLanes|=2,a.entangledLanes|=2;r;){var l=1<<31-vt(r);a.entanglements[1]|=l,r&=~l}mu(o),0===(6&th)&&(vh=lt()+500,pu(0,!1))}}break;case 13:null!==(a=Ln(o,2))&&Fh(a,0,2),zh(),Gc(o,2)}if(null===(o=qc(n))&&Ru(t,e,n,Wc,i),o===s)break;s=o}null!==s&&n.stopPropagation()}else Ru(t,e,n,null,i)}}function qc(t){return $c(t=De(t))}var Wc=null;function $c(t){if(Wc=null,null!==(t=Ht(t))){var e=I(t);if(null===e)t=null;else{var i=e.tag;if(13===i){if(null!==(t=z(e)))return t;t=null}else if(3===i){if(e.stateNode.current.memoizedState.isDehydrated)return 3===e.tag?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null)}}return Wc=t,null}function Jc(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ht()){case ut:return 2;case ct:return 8;case dt:case ft:return 32;case gt:return 268435456;default:return 32}default:return 32}}var Zc=!1,Qc=null,td=null,ed=null,id=new Map,nd=new Map,sd=[],od="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function rd(t,e){switch(t){case"focusin":case"focusout":Qc=null;break;case"dragenter":case"dragleave":td=null;break;case"mouseover":case"mouseout":ed=null;break;case"pointerover":case"pointerout":id.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":nd.delete(e.pointerId)}}function ad(t,e,i,n,s,o){return null===t||t.nativeEvent!==o?(t={blockedOn:e,domEventName:i,eventSystemFlags:n,nativeEvent:o,targetContainers:[s]},null!==e&&(null!==(e=qt(e))&&Kc(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,null!==s&&-1===e.indexOf(s)&&e.push(s),t)}function ld(t){var e=Ht(t.target);if(null!==e){var i=I(e);if(null!==i)if(13===(e=i.tag)){if(null!==(e=z(i)))return t.blockedOn=e,void function(t,e){var i=G.p;try{return G.p=t,e()}finally{G.p=i}}(t.priority,(function(){if(13===i.tag){var t=Ah(),e=Ln(i,t);null!==e&&Fh(e,0,t),Gc(i,t)}}))}else if(3===e&&i.stateNode.current.memoizedState.isDehydrated)return void(t.blockedOn=3===i.tag?i.stateNode.containerInfo:null)}t.blockedOn=null}function hd(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var i=qc(t.nativeEvent);if(null!==i)return null!==(e=qt(i))&&Kc(e),t.blockedOn=i,!1;var n=new(i=t.nativeEvent).constructor(i.type,i);Ae=n,i.target.dispatchEvent(n),Ae=null,e.shift()}return!0}function ud(t,e,i){hd(t)&&i.delete(e)}function cd(){Zc=!1,null!==Qc&&hd(Qc)&&(Qc=null),null!==td&&hd(td)&&(td=null),null!==ed&&hd(ed)&&(ed=null),id.forEach(ud),nd.forEach(ud)}function dd(t,e){t.blockedOn===e&&(t.blockedOn=null,Zc||(Zc=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,cd)))}var fd=null;function gd(t){fd!==t&&(fd=t,n.unstable_scheduleCallback(n.unstable_NormalPriority,(function(){fd===t&&(fd=null);for(var e=0;e<t.length;e+=3){var i=t[e],n=t[e+1],s=t[e+2];if("function"!==typeof n){if(null===$c(n||i))continue;break}var o=qt(i);null!==o&&(t.splice(e,3),e-=3,cr(o,{pending:!0,data:s,method:i.method,action:n},n,s))}})))}function md(t){function e(e){return dd(e,t)}null!==Qc&&dd(Qc,t),null!==td&&dd(td,t),null!==ed&&dd(ed,t),id.forEach(e),nd.forEach(e);for(var i=0;i<sd.length;i++){var n=sd[i];n.blockedOn===t&&(n.blockedOn=null)}for(;0<sd.length&&null===(i=sd[0]).blockedOn;)ld(i),null===i.blockedOn&&sd.shift();if(null!=(i=(t.ownerDocument||t).$$reactFormReplay))for(n=0;n<i.length;n+=3){var s=i[n],o=i[n+1],r=s[Vt]||null;if("function"===typeof o)r||gd(i);else if(r){var a=null;if(o&&o.hasAttribute("formAction")){if(s=o,r=o[Vt]||null)a=r.formAction;else if(null!==$c(s))continue}else a=r.action;"function"===typeof a?i[n+1]=a:(i.splice(n,3),n-=3),gd(i)}}}function pd(t){this._internalRoot=t}function yd(t){this._internalRoot=t}yd.prototype.render=pd.prototype.render=function(t){var e=this._internalRoot;if(null===e)throw Error(r(409));jc(e.current,Ah(),t,e,null,null)},yd.prototype.unmount=pd.prototype.unmount=function(){var t=this._internalRoot;if(null!==t){this._internalRoot=null;var e=t.containerInfo;0===t.tag&&eu(),jc(t.current,2,null,t,null,null),zh(),e[jt]=null}},yd.prototype.unstable_scheduleHydration=function(t){if(t){var e=Bt();t={blockedOn:null,target:t,priority:e};for(var i=0;i<sd.length&&0!==e&&e<sd[i].priority;i++);sd.splice(i,0,t),0===i&&ld(t)}};var xd=s.version;if("19.0.0"!==xd)throw Error(r(527,xd,"19.0.0"));G.findDOMNode=function(t){var e=t._reactInternals;if(void 0===e){if("function"===typeof t.render)throw Error(r(188));throw t=Object.keys(t).join(","),Error(r(268,t))}return t=function(t){var e=t.alternate;if(!e){if(null===(e=I(t)))throw Error(r(188));return e!==t?null:t}for(var i=t,n=e;;){var s=i.return;if(null===s)break;var o=s.alternate;if(null===o){if(null!==(n=s.return)){i=n;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===i)return V(s),t;if(o===n)return V(s),e;o=o.sibling}throw Error(r(188))}if(i.return!==n.return)i=s,n=o;else{for(var a=!1,l=s.child;l;){if(l===i){a=!0,i=s,n=o;break}if(l===n){a=!0,n=s,i=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===i){a=!0,i=o,n=s;break}if(l===n){a=!0,n=o,i=s;break}l=l.sibling}if(!a)throw Error(r(189))}}if(i.alternate!==n)throw Error(r(190))}if(3!==i.tag)throw Error(r(188));return i.stateNode.current===i?t:e}(e),t=null===(t=null!==t?j(t):null)?null:t.stateNode};var bd={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:A,findFiberByHostInstance:Ht,reconcilerVersion:"19.0.0"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var vd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vd.isDisabled&&vd.supportsFiber)try{yt=vd.inject(bd),xt=vd}catch(kd){}}e.createRoot=function(t,e){if(!a(t))throw Error(r(299));var i=!1,n="",s=Er,o=Br,l=Ir;return null!==e&&void 0!==e&&(!0===e.unstable_strictMode&&(i=!0),void 0!==e.identifierPrefix&&(n=e.identifierPrefix),void 0!==e.onUncaughtError&&(s=e.onUncaughtError),void 0!==e.onCaughtError&&(o=e.onCaughtError),void 0!==e.onRecoverableError&&(l=e.onRecoverableError),void 0!==e.unstable_transitionCallbacks&&e.unstable_transitionCallbacks),e=zc(t,1,!1,null,0,i,n,s,o,l,0,null),t[jt]=e.current,Fu(8===t.nodeType?t.parentNode:t),new pd(e)},e.hydrateRoot=function(t,e,i){if(!a(t))throw Error(r(299));var n=!1,s="",o=Er,l=Br,h=Ir,u=null;return null!==i&&void 0!==i&&(!0===i.unstable_strictMode&&(n=!0),void 0!==i.identifierPrefix&&(s=i.identifierPrefix),void 0!==i.onUncaughtError&&(o=i.onUncaughtError),void 0!==i.onCaughtError&&(l=i.onCaughtError),void 0!==i.onRecoverableError&&(h=i.onRecoverableError),void 0!==i.unstable_transitionCallbacks&&i.unstable_transitionCallbacks,void 0!==i.formState&&(u=i.formState)),(e=zc(t,1,!0,e,0,n,s,o,l,h,0,u)).context=Vc(null),i=e.current,(s=Da(n=Ah())).callback=null,Fa(i,s,n),e.current.lanes=n,Ft(e,n),mu(e),t[jt]=e.current,Fu(t),new yd(e)},e.version="19.0.0"},43:(t,e,i)=>{t.exports=i(288)},288:(t,e)=>{var i=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,p={};function y(t,e,i){this.props=t,this.context=e,this.refs=p,this.updater=i||g}function x(){}function b(t,e,i){this.props=t,this.context=e,this.refs=p,this.updater=i||g}y.prototype.isReactComponent={},y.prototype.setState=function(t,e){if("object"!==typeof t&&"function"!==typeof t&&null!=t)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},y.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},x.prototype=y.prototype;var v=b.prototype=new x;v.constructor=b,m(v,y.prototype),v.isPureReactComponent=!0;var w=Array.isArray,k={H:null,A:null,T:null,S:null},S=Object.prototype.hasOwnProperty;function P(t,e,n,s,o,r){return n=r.ref,{$$typeof:i,type:t,key:e,ref:void 0!==n?n:null,props:r}}function M(t){return"object"===typeof t&&null!==t&&t.$$typeof===i}var C=/\/+/g;function N(t,e){return"object"===typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function T(){}function L(t,e,s,o,r){var a=typeof t;"undefined"!==a&&"boolean"!==a||(t=null);var l,h,u=!1;if(null===t)u=!0;else switch(a){case"bigint":case"string":case"number":u=!0;break;case"object":switch(t.$$typeof){case i:case n:u=!0;break;case d:return L((u=t._init)(t._payload),e,s,o,r)}}if(u)return r=r(t),u=""===o?"."+N(t,0):o,w(r)?(s="",null!=u&&(s=u.replace(C,"$&/")+"/"),L(r,e,s,"",(function(t){return t}))):null!=r&&(M(r)&&(l=r,h=s+(null==r.key||t&&t.key===r.key?"":(""+r.key).replace(C,"$&/")+"/")+u,r=P(l.type,h,void 0,0,0,l.props)),e.push(r)),1;u=0;var c,g=""===o?".":o+":";if(w(t))for(var m=0;m<t.length;m++)u+=L(o=t[m],e,s,a=g+N(o,m),r);else if("function"===typeof(m=null===(c=t)||"object"!==typeof c?null:"function"===typeof(c=f&&c[f]||c["@@iterator"])?c:null))for(t=m.call(t),m=0;!(o=t.next()).done;)u+=L(o=o.value,e,s,a=g+N(o,m++),r);else if("object"===a){if("function"===typeof t.then)return L(function(t){switch(t.status){case"fulfilled":return t.value;case"rejected":throw t.reason;default:switch("string"===typeof t.status?t.then(T,T):(t.status="pending",t.then((function(e){"pending"===t.status&&(t.status="fulfilled",t.value=e)}),(function(e){"pending"===t.status&&(t.status="rejected",t.reason=e)}))),t.status){case"fulfilled":return t.value;case"rejected":throw t.reason}}throw t}(t),e,s,o,r);throw e=String(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.")}return u}function A(t,e,i){if(null==t)return t;var n=[],s=0;return L(t,n,"","",(function(t){return e.call(i,t,s++)})),n}function D(t){if(-1===t._status){var e=t._result;(e=e()).then((function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)}),(function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)})),-1===t._status&&(t._status=0,t._result=e)}if(1===t._status)return t._result.default;throw t._result}var F="function"===typeof reportError?reportError:function(t){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof t&&null!==t&&"string"===typeof t.message?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",t);console.error(t)};function O(){}e.Children={map:A,forEach:function(t,e,i){A(t,(function(){e.apply(this,arguments)}),i)},count:function(t){var e=0;return A(t,(function(){e++})),e},toArray:function(t){return A(t,(function(t){return t}))||[]},only:function(t){if(!M(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},e.Component=y,e.Fragment=s,e.Profiler=r,e.PureComponent=b,e.StrictMode=o,e.Suspense=u,e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,e.act=function(){throw Error("act(...) is not supported in production builds of React.")},e.cache=function(t){return function(){return t.apply(null,arguments)}},e.cloneElement=function(t,e,i){if(null===t||void 0===t)throw Error("The argument must be a React element, but you passed "+t+".");var n=m({},t.props),s=t.key;if(null!=e)for(o in void 0!==e.ref&&void 0,void 0!==e.key&&(s=""+e.key),e)!S.call(e,o)||"key"===o||"__self"===o||"__source"===o||"ref"===o&&void 0===e.ref||(n[o]=e[o]);var o=arguments.length-2;if(1===o)n.children=i;else if(1<o){for(var r=Array(o),a=0;a<o;a++)r[a]=arguments[a+2];n.children=r}return P(t.type,s,void 0,0,0,n)},e.createContext=function(t){return(t={$$typeof:l,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null}).Provider=t,t.Consumer={$$typeof:a,_context:t},t},e.createElement=function(t,e,i){var n,s={},o=null;if(null!=e)for(n in void 0!==e.key&&(o=""+e.key),e)S.call(e,n)&&"key"!==n&&"__self"!==n&&"__source"!==n&&(s[n]=e[n]);var r=arguments.length-2;if(1===r)s.children=i;else if(1<r){for(var a=Array(r),l=0;l<r;l++)a[l]=arguments[l+2];s.children=a}if(t&&t.defaultProps)for(n in r=t.defaultProps)void 0===s[n]&&(s[n]=r[n]);return P(t,o,void 0,0,0,s)},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:h,render:t}},e.isValidElement=M,e.lazy=function(t){return{$$typeof:d,_payload:{_status:-1,_result:t},_init:D}},e.memo=function(t,e){return{$$typeof:c,type:t,compare:void 0===e?null:e}},e.startTransition=function(t){var e=k.T,i={};k.T=i;try{var n=t(),s=k.S;null!==s&&s(i,n),"object"===typeof n&&null!==n&&"function"===typeof n.then&&n.then(O,F)}catch(o){F(o)}finally{k.T=e}},e.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},e.use=function(t){return k.H.use(t)},e.useActionState=function(t,e,i){return k.H.useActionState(t,e,i)},e.useCallback=function(t,e){return k.H.useCallback(t,e)},e.useContext=function(t){return k.H.useContext(t)},e.useDebugValue=function(){},e.useDeferredValue=function(t,e){return k.H.useDeferredValue(t,e)},e.useEffect=function(t,e){return k.H.useEffect(t,e)},e.useId=function(){return k.H.useId()},e.useImperativeHandle=function(t,e,i){return k.H.useImperativeHandle(t,e,i)},e.useInsertionEffect=function(t,e){return k.H.useInsertionEffect(t,e)},e.useLayoutEffect=function(t,e){return k.H.useLayoutEffect(t,e)},e.useMemo=function(t,e){return k.H.useMemo(t,e)},e.useOptimistic=function(t,e){return k.H.useOptimistic(t,e)},e.useReducer=function(t,e,i){return k.H.useReducer(t,e,i)},e.useRef=function(t){return k.H.useRef(t)},e.useState=function(t){return k.H.useState(t)},e.useSyncExternalStore=function(t,e,i){return k.H.useSyncExternalStore(t,e,i)},e.useTransition=function(){return k.H.useTransition()},e.version="19.0.0"},391:(t,e,i)=>{!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}(),t.exports=i(4)},579:(t,e,i)=>{t.exports=i(799)},672:(t,e,i)=>{var n=i(43);function s(t){var e="https://react.dev/errors/"+t;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var i=2;i<arguments.length;i++)e+="&args[]="+encodeURIComponent(arguments[i])}return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(){}var r={d:{f:o,r:function(){throw Error(s(522))},D:o,C:o,L:o,m:o,X:o,S:o,M:o},p:0,findDOMNode:null},a=Symbol.for("react.portal");var l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(t,e){return"font"===t?"":"string"===typeof e?"use-credentials"===e?e:"":void 0}e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,e.createPortal=function(t,e){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)throw Error(s(299));return function(t,e,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:a,key:null==n?null:""+n,children:t,containerInfo:e,implementation:i}}(t,e,null,i)},e.flushSync=function(t){var e=l.T,i=r.p;try{if(l.T=null,r.p=2,t)return t()}finally{l.T=e,r.p=i,r.d.f()}},e.preconnect=function(t,e){"string"===typeof t&&(e?e="string"===typeof(e=e.crossOrigin)?"use-credentials"===e?e:"":void 0:e=null,r.d.C(t,e))},e.prefetchDNS=function(t){"string"===typeof t&&r.d.D(t)},e.preinit=function(t,e){if("string"===typeof t&&e&&"string"===typeof e.as){var i=e.as,n=h(i,e.crossOrigin),s="string"===typeof e.integrity?e.integrity:void 0,o="string"===typeof e.fetchPriority?e.fetchPriority:void 0;"style"===i?r.d.S(t,"string"===typeof e.precedence?e.precedence:void 0,{crossOrigin:n,integrity:s,fetchPriority:o}):"script"===i&&r.d.X(t,{crossOrigin:n,integrity:s,fetchPriority:o,nonce:"string"===typeof e.nonce?e.nonce:void 0})}},e.preinitModule=function(t,e){if("string"===typeof t)if("object"===typeof e&&null!==e){if(null==e.as||"script"===e.as){var i=h(e.as,e.crossOrigin);r.d.M(t,{crossOrigin:i,integrity:"string"===typeof e.integrity?e.integrity:void 0,nonce:"string"===typeof e.nonce?e.nonce:void 0})}}else null==e&&r.d.M(t)},e.preload=function(t,e){if("string"===typeof t&&"object"===typeof e&&null!==e&&"string"===typeof e.as){var i=e.as,n=h(i,e.crossOrigin);r.d.L(t,i,{crossOrigin:n,integrity:"string"===typeof e.integrity?e.integrity:void 0,nonce:"string"===typeof e.nonce?e.nonce:void 0,type:"string"===typeof e.type?e.type:void 0,fetchPriority:"string"===typeof e.fetchPriority?e.fetchPriority:void 0,referrerPolicy:"string"===typeof e.referrerPolicy?e.referrerPolicy:void 0,imageSrcSet:"string"===typeof e.imageSrcSet?e.imageSrcSet:void 0,imageSizes:"string"===typeof e.imageSizes?e.imageSizes:void 0,media:"string"===typeof e.media?e.media:void 0})}},e.preloadModule=function(t,e){if("string"===typeof t)if(e){var i=h(e.as,e.crossOrigin);r.d.m(t,{as:"string"===typeof e.as&&"script"!==e.as?e.as:void 0,crossOrigin:i,integrity:"string"===typeof e.integrity?e.integrity:void 0})}else r.d.m(t)},e.requestFormReset=function(t){r.d.r(t)},e.unstable_batchedUpdates=function(t,e){return t(e)},e.useFormState=function(t,e,i){return l.H.useFormState(t,e,i)},e.useFormStatus=function(){return l.H.useHostTransitionStatus()},e.version="19.0.0"},799:(t,e)=>{var i=Symbol.for("react.transitional.element");function n(t,e,n){var s=null;if(void 0!==n&&(s=""+n),void 0!==e.key&&(s=""+e.key),"key"in e)for(var o in n={},e)"key"!==o&&(n[o]=e[o]);else n=e;return e=n.ref,{$$typeof:i,type:t,key:s,ref:void 0!==e?e:null,props:n}}Symbol.for("react.fragment"),e.jsx=n,e.jsxs=n},853:(t,e,i)=>{t.exports=i(896)},896:(t,e)=>{function i(t,e){var i=t.length;t.push(e);t:for(;0<i;){var n=i-1>>>1,s=t[n];if(!(0<o(s,e)))break t;t[n]=e,t[i]=s,i=n}}function n(t){return 0===t.length?null:t[0]}function s(t){if(0===t.length)return null;var e=t[0],i=t.pop();if(i!==e){t[0]=i;t:for(var n=0,s=t.length,r=s>>>1;n<r;){var a=2*(n+1)-1,l=t[a],h=a+1,u=t[h];if(0>o(l,i))h<s&&0>o(u,l)?(t[n]=u,t[h]=i,n=h):(t[n]=l,t[a]=i,n=a);else{if(!(h<s&&0>o(u,i)))break t;t[n]=u,t[h]=i,n=h}}}return e}function o(t,e){var i=t.sortIndex-e.sortIndex;return 0!==i?i:t.id-e.id}if(e.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var r=performance;e.unstable_now=function(){return r.now()}}else{var a=Date,l=a.now();e.unstable_now=function(){return a.now()-l}}var h=[],u=[],c=1,d=null,f=3,g=!1,m=!1,p=!1,y="function"===typeof setTimeout?setTimeout:null,x="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function v(t){for(var e=n(u);null!==e;){if(null===e.callback)s(u);else{if(!(e.startTime<=t))break;s(u),e.sortIndex=e.expirationTime,i(h,e)}e=n(u)}}function w(t){if(p=!1,v(t),!m)if(null!==n(h))m=!0,D();else{var e=n(u);null!==e&&F(w,e.startTime-t)}}var k,S=!1,P=-1,M=5,C=-1;function N(){return!(e.unstable_now()-C<M)}function T(){if(S){var t=e.unstable_now();C=t;var i=!0;try{t:{m=!1,p&&(p=!1,x(P),P=-1),g=!0;var o=f;try{e:{for(v(t),d=n(h);null!==d&&!(d.expirationTime>t&&N());){var r=d.callback;if("function"===typeof r){d.callback=null,f=d.priorityLevel;var a=r(d.expirationTime<=t);if(t=e.unstable_now(),"function"===typeof a){d.callback=a,v(t),i=!0;break e}d===n(h)&&s(h),v(t)}else s(h);d=n(h)}if(null!==d)i=!0;else{var l=n(u);null!==l&&F(w,l.startTime-t),i=!1}}break t}finally{d=null,f=o,g=!1}i=void 0}}finally{i?k():S=!1}}}if("function"===typeof b)k=function(){b(T)};else if("undefined"!==typeof MessageChannel){var L=new MessageChannel,A=L.port2;L.port1.onmessage=T,k=function(){A.postMessage(null)}}else k=function(){y(T,0)};function D(){S||(S=!0,k())}function F(t,i){P=y((function(){t(e.unstable_now())}),i)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){m||g||(m=!0,D())},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<t?Math.floor(1e3/t):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(h)},e.unstable_next=function(t){switch(f){case 1:case 2:case 3:var e=3;break;default:e=f}var i=f;f=e;try{return t()}finally{f=i}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var i=f;f=t;try{return e()}finally{f=i}},e.unstable_scheduleCallback=function(t,s,o){var r=e.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?r+o:r:o=r,t){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return t={id:c++,callback:s,priorityLevel:t,startTime:o,expirationTime:a=o+a,sortIndex:-1},o>r?(t.sortIndex=o,i(u,t),null===n(h)&&t===n(u)&&(p?(x(P),P=-1):p=!0,F(w,o-r))):(t.sortIndex=a,i(h,t),m||g||(m=!0,D())),t},e.unstable_shouldYield=N,e.unstable_wrapCallback=function(t){var e=f;return function(){var i=f;f=e;try{return t.apply(this,arguments)}finally{f=i}}}},950:(t,e,i)=>{!function t(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}(),t.exports=i(672)}},e={};function i(n){var s=e[n];if(void 0!==s)return s.exports;var o=e[n]={exports:{}};return t[n](o,o.exports,i),o.exports}i.m=t,i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.f={},i.e=t=>Promise.all(Object.keys(i.f).reduce(((e,n)=>(i.f[n](t,e),e)),[])),i.u=t=>"static/js/"+t+".aa4ddc84.chunk.js",i.miniCssF=t=>{},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={},e="gojs-react-flowchart:";i.l=(n,s,o,r)=>{if(t[n])t[n].push(s);else{var a,l;if(void 0!==o)for(var h=document.getElementsByTagName("script"),u=0;u<h.length;u++){var c=h[u];if(c.getAttribute("src")==n||c.getAttribute("data-webpack")==e+o){a=c;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,i.nc&&a.setAttribute("nonce",i.nc),a.setAttribute("data-webpack",e+o),a.src=n),t[n]=[s];var d=(e,i)=>{a.onerror=a.onload=null,clearTimeout(f);var s=t[n];if(delete t[n],a.parentNode&&a.parentNode.removeChild(a),s&&s.forEach((t=>t(i))),e)return e(i)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),l&&document.head.appendChild(a)}}})(),i.r=t=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.p="/sessao_julgamento/",(()=>{var t={792:0};i.f.j=(e,n)=>{var s=i.o(t,e)?t[e]:void 0;if(0!==s)if(s)n.push(s[2]);else{var o=new Promise(((i,n)=>s=t[e]=[i,n]));n.push(s[2]=o);var r=i.p+i.u(e),a=new Error;i.l(r,(n=>{if(i.o(t,e)&&(0!==(s=t[e])&&(t[e]=void 0),s)){var o=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;a.message="Loading chunk "+e+" failed.\n("+o+": "+r+")",a.name="ChunkLoadError",a.type=o,a.request=r,s[1](a)}}),"chunk-"+e,e)}};var e=(e,n)=>{var s,o,r=n[0],a=n[1],l=n[2],h=0;if(r.some((e=>0!==t[e]))){for(s in a)i.o(a,s)&&(i.m[s]=a[s]);if(l)l(i)}for(e&&e(n);h<r.length;h++)o=r[h],i.o(t,o)&&t[o]&&t[o][0](),t[o]=0},n=self.webpackChunkgojs_react_flowchart=self.webpackChunkgojs_react_flowchart||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})();var n=i(43),s=i(391);!function(){const t="object"==typeof globalThis&&globalThis||"object"==typeof global&&global.global===global&&global||"object"==typeof self&&self.self===self&&self||{};void 0===t.requestAnimationFrame&&(void 0===t.setImmediate?t.requestAnimationFrame=e=>t.setTimeout(e,0):t.requestAnimationFrame=t.setImmediate);class e{static hr=(()=>void 0!==t.navigator&&void 0!==t.navigator.platform&&null!==t.navigator.platform.match(/(iPhone|iPod|iPad|Mac)/i))();static Nk(t,i,n){let s=-1;return function(){const o=this,r=arguments;-1!==s&&e.Og(s),s=e.ar((()=>{s=-1,n||t.apply(o,r)}),i),n&&!s&&t.apply(o,r)}}static ar(e,i){return t.setTimeout(e,i)}static Og(e){t.clearTimeout(e)}static fs(e){return t.document.createElement(e)}static o(t){throw new Error(t)}static D(t,i){let n="The object is frozen, so its properties cannot be set: "+t.toString();void 0!==i&&(n+="  to value: "+i),e.o(n)}static rE(t,e,i,n){}static s(t,e,i,n){}static lE(t,e,i){}static lc(t,i,n){if(null===t||"object"!=typeof t){let s=e.oC(i);void 0!==n&&(s+="."+n),e.te(t,"object",s)}}static S(t,i,n){e.s(t,"function",i,n)}static hE(t,e,i){}static te(t,e,i,n){}static _(t,i,n,s){let o=e.oC(n);void 0!==s&&(o+="."+s),e.o(o+" is not in the range "+i+": "+t)}static Ie(t){}static cr(t,e){}static li(e){t.console&&t.console.log(e)}static H(t){return null!==t&&"object"==typeof t}static ot(t){return"function"==typeof t}static Ck=[];static rt(){const t=e.Ck.pop();return void 0===t?[]:t}static tt(t){t.length=0,e.Ck.push(t)}static aE=(()=>Object.freeze([]))();static oC(t){return null===t?"*":"string"==typeof t?t:e.ot(t)?t.name:""}static Vn(t){return e.ot(t)?t.className?t.className:t.name:e.H(t)&&t.constructor?e.Vn(t.constructor):typeof t}static Xh(t,i){return null==i||""===i?null:e.H(t)&&i in t||t[i]?t[i]:null}static toString(t){let i=t;return e.H(t)&&(t.text?i=t.text:t.name?i=t.name:void 0!==t.key?i=t.key:void 0!==t.id?i=t.id:t.constructor===Object&&(t.Text?i=t.Text:t.Name?i=t.Name:void 0!==t.Key?i=t.Key:void 0!==t.Id?i=t.Id:void 0!==t.ID&&(i=t.ID))),void 0===i?"undefined":null===i?"null":i.toString()}static fw(t,e){if(t.hasOwnProperty(e))return!0;let i=Object.getPrototypeOf(t);for(;i&&i!==Function;){if(i.hasOwnProperty(e))return!0;const t=i.cE;if(t&&t[e])return!0;i=Object.getPrototypeOf(i)}return!1}static XD(t){const e=[];let i=0;for(i=0;i<256;i++)e[i]=i;let n=0,s=0;for(i=0;i<256;i++)n=(n+e[i]+119)%256,s=e[i],e[i]=e[n],e[n]=s;i=0,n=0;let o="";for(let r=0;r<t.length;r++)i=(i+1)%256,n=(n+e[i])%256,s=e[i],e[i]=e[n],e[n]=s,o+=String.fromCharCode(t.charCodeAt(r)^e[(e[i]+e[n])%256]);return o}static YD(t){const e="0123456789abcdef",i=[];for(let r=0;r<256;r++)i[e.charAt(r>>4)+e.charAt(15&r)]=String.fromCharCode(r);t.length%2&&(t="0"+t);const n=[];let s=0;for(let r=0;r<t.length;r+=2)n[s++]=i[t.substring(r,r+2)];const o=n.join("");return""===o?"0":o}static Rs(t){return e.XD(e.YD(t))}static color1="@COLOR1";static color2="@COLOR2";static uw="32ab5ff3b26f42dc0ed90f21402913b5"}e.vfo="29e646fdb26f";class i{Lk;constructor(){this.Lk=[]}toString(){return this.Lk.join("")}add(t){""!==t&&this.Lk.push(t)}}class n{}class s{g;constructor(){this.g=[]}[Symbol.iterator](){return this.g.values()}key;value;get iterator(){return this}reset(){}next(){return!1}hasNext(){return!1}first(){return null}any(){return!1}all(){return!0}each(){return this}map(t){return this}filter(){return this}get count(){return 0}xl(){}toString(){return"EmptyIterator"}static instance=(()=>new s)()}class o{constructor(t){this.key=-1,this.value=t}[Symbol.iterator](){return[this.value].values()}key;value;get iterator(){return this}reset(){this.key=-1}next(){return-1===this.key&&(this.key=0,!0)}hasNext(){return this.next()}first(){return this.key=0,this.value}any(t){return this.key=-1,t(this.value)}all(t){return this.key=-1,t(this.value)}each(t){return this.key=-1,t(this.value),this}map(t){return new o(t(this.value))}filter(t){return t(this.value)?new o(this.value):s.instance}get count(){return 1}xl(){this.value=null}toString(){return"SingletonIterator("+this.value+")"}}class r{$t;vs;jt;Ft;constructor(t){this.$t=t,this.vs=null,t.fr=null,this.jt=t.ht,this.Ft=-1}[Symbol.iterator](){return null===this.vs?this.$t.r.values():this.$t.r.filter(this.vs).values()}key;value;get iterator(){return this}get predicate(){return this.vs}set predicate(t){this.vs=t}reset(){const t=this.$t;t.fr=null,this.jt=t.ht,this.Ft=-1}next(){const t=this.$t;if(t.ht!==this.jt){if(this.key<0)return!1;e.Ie(t)}const i=t.r,n=i.length;let s=++this.Ft;const o=this.vs;if(null!==o)for(;s<n;){const t=i[s];if(o(t))return this.Ft=s,this.key=s,this.value=t,!0;s++}else{if(s<n)return this.key=s,this.value=i[s],!0;this.xl()}return!1}hasNext(){return this.next()}first(){const t=this.$t;this.jt=t.ht,this.Ft=0;const e=t.r,i=e.length,n=this.vs;if(null!==n){let t=0;for(;t<i;){const i=e[t];if(n(i))return this.Ft=t,this.key=t,this.value=i,i;t++}return null}if(i>0){const t=e[0];return this.key=0,this.value=t,t}return null}any(t){const i=this.$t;i.fr=null;const n=i.ht;this.Ft=-1;const s=i.r,o=s.length,r=this.vs;for(let a=0;a<o;a++){const o=s[a];if(null===r||r(o)){if(t(o))return!0;i.ht!==n&&e.Ie(i)}}return!1}all(t){const i=this.$t;i.fr=null;const n=i.ht;this.Ft=-1;const s=i.r,o=s.length,r=this.vs;for(let a=0;a<o;a++){const o=s[a];if(null===r||r(o)){if(!t(o))return!1;i.ht!==n&&e.Ie(i)}}return!0}each(t){const i=this.$t;i.fr=null;const n=i.ht;this.Ft=-1;const s=i.r,o=s.length,r=this.vs;for(let a=0;a<o;a++){const o=s[a];null!==r&&!r(o)||(t(o),i.ht!==n&&e.Ie(i))}return this}map(t){const i=this.$t;i.fr=null;const n=i.ht;this.Ft=-1;const s=[],o=i.r,r=o.length,a=this.vs;for(let l=0;l<r;l++){const r=o[l];null!==a&&!a(r)||(s.push(t(r)),i.ht!==n&&e.Ie(i))}const h=new l;return h.r=s,h.Ee(),h.iterator}filter(t){const i=this.$t;i.fr=null;const n=i.ht;this.Ft=-1;const s=[],o=i.r,r=o.length,a=this.vs;for(let l=0;l<r;l++){const r=o[l];null!==a&&!a(r)||(t(r)&&s.push(r),i.ht!==n&&e.Ie(i))}const h=new l;return h.r=s,h.Ee(),h.iterator}get count(){const t=this.vs;if(null!==t){let e=0;const i=this.$t.r,n=i.length;for(let s=0;s<n;s++)t(i[s])&&e++;return e}return this.$t.r.length}xl(){this.key=-1,this.value=null,this.jt=-1,this.vs=null,this.$t.fr=this}toString(){return"ListIterator@"+this.Ft+"/"+this.$t.count}}class a{$t;jt;Ft;constructor(t){this.$t=t,t.ur=null,this.jt=t.ht,this.Ft=t.r.length}[Symbol.iterator](){return this.$t.r.reverse().values()}key;value;get iterator(){return this}reset(){const t=this.$t;t.ur=null,this.jt=t.ht,this.Ft=t.r.length}next(){const t=this.$t;if(t.ht!==this.jt){if(this.key<0)return!1;e.Ie(t)}const i=--this.Ft;return i>=0?(this.key=i,this.value=t.r[i],!0):(this.xl(),!1)}hasNext(){return this.next()}first(){const t=this.$t;this.jt=t.ht;const e=t.r,i=e.length-1;if(this.Ft=i,i>=0){const t=e[i];return this.key=i,this.value=t,t}return null}any(t){const i=this.$t;i.ur=null;const n=i.ht,s=i.r,o=s.length;this.Ft=o;for(let r=o-1;r>=0;r--){if(t(s[r]))return!0;i.ht!==n&&e.Ie(i)}return!1}all(t){const i=this.$t;i.ur=null;const n=i.ht,s=i.r,o=s.length;this.Ft=o;for(let r=o-1;r>=0;r--){if(!t(s[r]))return!1;i.ht!==n&&e.Ie(i)}return!0}each(t){const i=this.$t;i.ur=null;const n=i.ht,s=i.r,o=s.length;this.Ft=o;for(let r=o-1;r>=0;r--){t(s[r]),i.ht!==n&&e.Ie(i)}return this}map(t){const i=this.$t;i.ur=null;const n=i.ht,s=[],o=i.r,r=o.length;this.Ft=r;for(let l=r-1;l>=0;l--){const r=o[l];s.push(t(r)),i.ht!==n&&e.Ie(i)}const a=new l;return a.r=s,a.Ee(),a.iterator}filter(t){const i=this.$t;i.ur=null;const n=i.ht,s=[],o=i.r,r=o.length;this.Ft=r;for(let l=r-1;l>=0;l--){const r=o[l];t(r)&&s.push(r),i.ht!==n&&e.Ie(i)}const a=new l;return a.r=s,a.Ee(),a.iterator}get count(){return this.$t.r.length}xl(){this.key=-1,this.value=null,this.jt=-1,this.$t.ur=this}toString(){return"ListIteratorBackwards("+this.Ft+"/"+this.$t.count+")"}}class l{h;r;ht;fr;ur;constructor(t){u.qi(this),this.h=!1,this.r=[],this.ht=0,this.fr=null,this.ur=null,void 0!==t&&this.addAll(t)}[Symbol.iterator](){return this.r.values()}Ee(){let t=this.ht;t++,t>999999999&&(t=0),this.ht=t}u(){return this.h=!0,this}At(){return this.h=!1,this}toString(){return"List()#"+u.us(this)}add(t){return this.h&&e.D(this,t),this.r.push(t),this.Ee(),this}push(t){this.add(t)}addAll(t){if(null===t)return this;this.h&&e.D(this);const i=this.r;if(Array.isArray(t)){const e=t.length;for(let n=0;n<e;n++){const e=t[n];i.push(e)}}else{const e=t.iterator;for(;e.next();){const t=e.value;i.push(t)}}return this.Ee(),this}clear(){this.h&&e.D(this),this.r.length=0,this.Ee()}contains(t){return this.has(t)}has(t){return null!==t&&-1!==this.r.indexOf(t)}indexOf(t){return null===t?-1:this.r.indexOf(t)}elt(t){const i=this.r;return(t<0||t>=i.length)&&e._(t,"0 <= i < length",l,"elt:i"),i[t]}get(t){return this.elt(t)}setElt(t,i){const n=this.r;(t<0||t>=n.length)&&e._(t,"0 <= i < length",l,"setElt:i"),this.h&&e.D(this,t),n[t]=i}set(t,e){this.setElt(t,e)}first(){const t=this.r;return 0===t.length?null:t[0]}last(){const t=this.r,e=t.length;return e>0?t[e-1]:null}pop(){this.h&&e.D(this);const t=this.r;return t.length>0?t.pop():null}any(t){const i=this.r,n=this.ht,s=i.length;for(let o=0;o<s;o++){if(t(i[o]))return!0;this.ht!==n&&e.Ie(this)}return!1}all(t){const i=this.r,n=this.ht,s=i.length;for(let o=0;o<s;o++){if(!t(i[o]))return!1;this.ht!==n&&e.Ie(this)}return!0}each(t){const i=this.r,n=this.ht,s=i.length;for(let o=0;o<s;o++)t(i[o]),this.ht!==n&&e.Ie(this);return this}map(t){const i=new l,n=[],s=this.r,o=this.ht,r=s.length;for(let a=0;a<r;a++)n.push(t(s[a])),this.ht!==o&&e.Ie(this);return i.r=n,i.Ee(),i}filter(t){const i=new l,n=[],s=this.r,o=this.ht,r=s.length;for(let a=0;a<r;a++){const i=s[a];t(i)&&n.push(i),this.ht!==o&&e.Ie(this)}return i.r=n,i.Ee(),i}insertAt(t,i){t<0&&e._(t,">= 0",l,"insertAt:i"),this.h&&e.D(this,t);const n=this.r;t>=n.length?n.push(i):n.splice(t,0,i),this.Ee()}remove(t){return this.delete(t)}delete(t){if(null===t)return!1;this.h&&e.D(this,t);const i=this.r,n=i.indexOf(t);return-1!==n&&(n===i.length-1?i.pop():i.splice(n,1),this.Ee(),!0)}removeAt(t){const i=this.r;(t<0||t>=i.length)&&e._(t,"0 <= i < length",l,"removeAt:i"),this.h&&e.D(this,t),t===i.length-1?i.pop():i.splice(t,1),this.Ee()}removeRange(t,i){const n=this.r,s=n.length;if(t<0)t=0;else if(t>=s)return this;if(i<0)return this;if(i>=s&&(i=s-1),t>i)return this;this.h&&e.D(this);let o=t,r=i+1;for(;r<s;)n[o++]=n[r++];return n.length=s-(i-t+1),this.Ee(),this}copy(){const t=new l,e=this.r;return e.length>0&&(t.r=Array.prototype.slice.call(e)),t}toArray(){const t=this.r,e=this.count,i=new Array(e);for(let n=0;n<e;n++)i[n]=t[n];return i}get rC(){return this.r}toSet(){const t=new u,e=this.r,i=this.count;for(let n=0;n<i;n++)t.add(e[n]);return t}sort(t){return this.h&&e.D(this),this.r.sort(t),this.Ee(),this}sortRange(t,i,n){const s=this.r,o=s.length;void 0===i&&(i=0),void 0===n&&(n=o),this.h&&e.D(this);const r=n-i;if(r<=1)return this;if((i<0||i>=o-1)&&e._(i,"0 <= from < length",l,"sortRange:from"),2===r){const e=s[i],n=s[i+1];return t(e,n)>0&&(s[i]=n,s[i+1]=e,this.Ee()),this}if(0===i)if(n>=o)s.sort(t);else{const e=s.slice(0,n);e.sort(t);for(let t=0;t<n;t++)s[t]=e[t]}else if(n>=o){const e=s.slice(i);e.sort(t);for(let t=i;t<o;t++)s[t]=e[t-i]}else{const e=s.slice(i,n);e.sort(t);for(let t=i;t<n;t++)s[t]=e[t-i]}return this.Ee(),this}reverse(){return this.h&&e.D(this),this.r.reverse(),this.Ee(),this}get count(){return this.r.length}get size(){return this.r.length}get length(){return this.r.length}get iterator(){if(this.r.length<=0)return s.instance;const t=this.fr;return null!==t?(t.reset(),t):new r(this)}get iteratorBackwards(){if(this.r.length<=0)return s.instance;const t=this.ur;return null!==t?(t.reset(),t):new a(this)}}class h{Co;ni;constructor(t){this.Co=t,this.ni=t.g.values()}[Symbol.iterator](){return this.Co.g.values()}key;value;get iterator(){return this}reset(){const t=this.Co;this.ni=t.g.values()}next(){const t=this.ni.next();return this.value=t.value,this.key=t.value,!t.done}hasNext(){return this.next()}first(){return 0===this.Co.g.size?null:(this.ni=this.Co.g.values(),this.ni.next().value)}any(t){return this.Co.any(t)}all(t){return this.Co.all(t)}each(t){return this.Co.each(t),this}map(t){const e=new l;return this.Co.g.forEach((i=>e.add(t(i)))),e.iterator}filter(t){const e=new l;return this.Co.g.forEach((i=>{t(i)&&e.add(i)})),e.iterator}get count(){return this.Co.count}xl(){this.key=null,this.value=null,this.ni=null}toString(){return"SetIterator"}}class u{h;g;constructor(t){this.h=!1,this.g=new Set,void 0!==t&&this.addAll(t)}[Symbol.iterator](){return this.g.values()}values(){return this.g.values()}u(){return this.h=!0,this}At(){return this.h=!1,this}toString(){return"Set()#"+u.us(this)}add(t){return null===t||this.g.add(t),this}addAll(t){if(null===t)return this;if(Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++){const e=t[i];null!==e&&this.g.add(e)}}else{const e=t.iterator;for(;e.next();){const t=e.value;null!==t&&this.g.add(t)}}return this}has(t){return this.g.has(t)}contains(t){return this.has(t)}containsAll(t){if(null===t)return!0;const e=t.iterator;for(;e.next();)if(!this.has(e.value))return!1;return!0}containsAny(t){if(null===t)return!0;const e=t.iterator;for(;e.next();)if(this.has(e.value))return!0;return!1}first(){return 0===this.g.size?null:this.g.values().next().value}any(t){for(const e of this.g)if(t(e))return!0;return!1}all(t){for(const e of this.g)if(!t(e))return!1;return!0}each(t){for(const e of this.g)t(e);return this}map(t){const e=new u;for(const i of this.g)e.add(t(i));return e}filter(t){const e=new u;for(const i of this.g)t(i)&&e.add(i);return e}delete(t){return this.h&&e.D(this),this.g.delete(t)}remove(t){return this.delete(t)}removeAll(t){if(null===t)return this;if(this.h&&e.D(this),Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++)this.delete(t[i])}else{const e=t.iterator;for(;e.next();)this.delete(e.value)}return this}retainAll(t){if(null===t)return this;if(0===this.count)return this;this.h&&e.D(this);const i=new u;i.addAll(t);const n=[],s=this.iterator;for(;s.next();){const t=s.value;i.has(t)||n.push(t)}return this.removeAll(n),this}clear(){this.h&&e.D(this),this.g.clear()}copy(){const t=new u;return this.g.forEach((e=>t.add(e))),t}toArray(){return Array.from(this.g)}toList(){const t=new l;return this.g.forEach((e=>t.add(e))),t}get count(){return this.g.size}get size(){return this.g.size}get iterator(){return this.g.size<=0?s.instance:new h(this)}entries(){return this.g.entries()}keys(){return this.g.keys()}forEach(t,e){return this.g.forEach(t,e)}static dw=1;static qi(t){t.__gohashid=u.dw++}static us(t){return t.__gohashid}}class c{Z;ni;constructor(t){this.Z=t,this.ni=t.g.keys()}[Symbol.iterator](){return this.Z.g.keys()}key;value;get iterator(){return this}reset(){const t=this.Z;this.ni=t.g.keys()}next(){const t=this.ni.next();return this.value=t.value,this.key=t.value,!t.done}hasNext(){return this.next()}first(){return 0===this.Z.g.size?null:(this.ni=this.Z.g.keys(),this.ni.next().value)}any(t){for(const e of this.Z.g)if(t(e[0]))return!0;return!1}all(t){for(const e of this.Z.g)if(!t(e[0]))return!1;return!0}each(t){for(const e of this.Z.g)t(e[0]);return this}map(t){const e=this.Z,i=new l;for(const n of e.g)i.add(t(n[0]));return i.iterator}filter(t){const e=this.Z,i=new l;for(const n of e.g){const e=n[0];t(e)&&i.add(e)}return i.iterator}get count(){return this.Z.size}xl(){this.key=null,this.value=null,this.ni=null}toString(){return"MapKeySetIterator"}}class d extends u{Z;constructor(t){super(),u.qi(this),this.h=!0,this.Z=t}[Symbol.iterator](){return this.g.keys()}values(){return this.g.keys()}u(){return this}At(){return this}toString(){return"MapKeySet("+this.Z.toString()+")"}add(t){e.o("This Set is read-only: "+this.toString())}has(t){return this.Z.has(t)}contains(t){return this.has(t)}delete(t){e.o("This Set is read-only: "+this.toString())}remove(t){return this.delete(t)}clear(){e.o("This Set is read-only: "+this.toString())}first(){return 0===this.Z.g.size?null:this.Z.g.keys().next().value}any(t){for(const e of this.Z.g)if(t(e[0]))return!0;return!1}all(t){for(const e of this.Z.g)if(!t(e[0]))return!1;return!0}each(t){for(const e of this.Z.g)t(e[0]);return this}map(t){const e=new u;for(const i of this.Z.g)e.add(t(i[0]));return e}filter(t){const e=new u;for(const i of this.Z.g){const n=i[0];t(n)&&e.add(n)}return e}copy(){return new d(this.Z)}toSet(){const t=new u,e=this.Z.g;for(const i of e)t.add(i[0]);return t}toArray(){const t=this.Z.g,e=new Array(t.size);let i=0;for(const n of t)e[i]=n[0],i++;return e}toList(){const t=new l,e=this.Z.g;for(const i of e)t.add(i[0]);return t}get count(){return this.Z.size}get size(){return this.Z.size}get iterator(){return this.Z.size<=0?s.instance:new c(this.Z)}}class f{Z;ni;constructor(t){this.Z=t,this.ni=t.g.values()}[Symbol.iterator](){return this.Z.g.values()}key;value;get iterator(){return this}reset(){const t=this.Z;this.ni=t.g.values()}next(){const t=this.ni.next();return this.value=t.value,this.key=t.value,!t.done}hasNext(){return this.next()}first(){return 0===this.Z.g.size?null:(this.ni=this.Z.g.values(),this.ni.next().value)}any(t){for(const e of this.Z.g)if(t(e[1]))return!0;return!1}all(t){for(const e of this.Z.g)if(!t(e[1]))return!1;return!0}each(t){for(const e of this.Z.g)t(e[1]);return this}map(t){const e=this.Z,i=new l;for(const n of e.g)i.add(t(n[1]));return i.iterator}filter(t){const e=this.Z,i=new l;for(const n of e.g){const e=n[1];t(e)&&i.add(e)}return i.iterator}get count(){return this.Z.size}xl(){this.key=null,this.value=null,this.ni=null}toString(){return"MapValueSetIterator"}}class g{constructor(t,e){this.key=t,this.value=e}toString(){return"{"+this.key+":"+this.value+"}"}key;value}class m{Z;ni;constructor(t){this.Z=t,this.ni=t.g.entries()}[Symbol.iterator](){return this.Z.g.entries()}key;value;get iterator(){return this}reset(){const t=this.Z;this.ni=t.g.entries()}next(){const t=this.ni.next();return t.done?(this.key=null,this.value=null,!1):(this.key=t.value[0],this.value=t.value[1],!0)}hasNext(){return this.next()}first(){if(0===this.Z.g.size)return null;this.ni=this.Z.g.entries();const t=this.ni.next().value;return this.key=t[0],this.value=t[1],new g(t[0],t[1])}any(t){return this.Z.any(t)}all(t){return this.Z.all(t)}each(t){return this.Z.each(t),this}map(t){const e=new l;let i=null;return this.Z.g.forEach(((n,s)=>{null===i?i=new g(s,n):(i.key=s,i.value=n),e.add(t(i))})),e.iterator}filter(t){const e=new l;let i=null;return this.Z.g.forEach(((n,s)=>{null===i?i=new g(s,n):(i.key=s,i.value=n),t(i)&&(e.add(i),i=null)})),e.iterator}get count(){return this.Z.size}xl(){this.key=null,this.value=null,this.ni=null}toString(){return"MapIterator"}}class p{h;g;constructor(t){u.qi(this),this.h=!1,this.g=new Map,void 0!==t&&this.addAll(t)}[Symbol.iterator](){return this.g.entries()}entries(){return this.g.entries()}u(){return this.h=!0,this}At(){return this.h=!1,this}toString(){return"Map()#"+u.us(this)}set(t,i){return this.h&&e.D(this,t),this.g.set(t,i),this}add(t,e){return this.set(t,e)}addAll(t){if(null===t)return this;if(this.h&&e.D(this),Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++){const e=t[i];this.set(e.key,e.value)}}else if(t instanceof p){const e=t.iterator;for(;e.next();)this.set(e.key,e.value)}else{const e=t.iterator;for(;e.next();){const t=e.value;this.set(t.key,t.value)}}return this}first(){if(0===this.g.size)return null;const t=this.g.entries().next().value;return new g(t[0],t[1])}any(t){let e=null;for(const[i,n]of this.g)if(null===e?e=new g(i,n):(e.key=i,e.value=n),t(e))return!0;return!1}all(t){let e=null;for(const[i,n]of this.g)if(null===e?e=new g(i,n):(e.key=i,e.value=n),!t(e))return!1;return!0}each(t){let e=null;for(const[i,n]of this.g)null===e?e=new g(i,n):(e.key=i,e.value=n),t(e);return this}map(t){const e=new p;let i=null;for(const[n,s]of this.g)null===i?i=new g(n,s):(i.key=n,i.value=s),e.set(n,t(i));return e}filter(t){const e=new p;let i=null;for(const[n,s]of this.g)null===i?i=new g(n,s):(i.key=n,i.value=s),t(i)&&e.set(n,s);return e}has(t){return this.g.has(t)}contains(t){return this.has(t)}get(t){const e=this.g.get(t);return void 0===e?null:e}getValue(t){return this.get(t)}delete(t){return null!==t&&(this.h&&e.D(this,t),this.g.delete(t))}remove(t){return this.delete(t)}clear(){this.h&&e.D(this),this.g.clear()}copy(){const t=new p;return t.g=new Map(this.g),t}toArray(){const t=this.g,e=new Array(t.size);let i=0;for(const n of t)e[i]=new g(n[0],n[1]),i++;return e}toKeySet(){return new d(this)}get count(){return this.g.size}get size(){return this.g.size}get iterator(){return this.g.size<=0?s.instance:new m(this)}get iteratorKeys(){return this.count<=0?s.instance:new c(this)}keys(){return this.g.keys()}get iteratorValues(){return this.count<=0?s.instance:new f(this)}values(){return this.g.values()}forEach(t,e){return this.g.forEach(t,e)}}class y{p;w;h;constructor(t,i){void 0===t?(this.p=0,this.w=0):"number"==typeof t&&"number"==typeof i?(this.p=t,this.w=i):e.o("Invalid arguments to Point constructor: "+t+", "+i),this.h=!1}a(t){return this.p=t.p,this.w=t.w,this}i(t,e){return this.p=t,this.w=e,this}setTo(t,e){return this.p=t,this.w=e,this}set(t){return this.p=t.p,this.w=t.w,this}copy(){const t=new y;return t.p=this.p,t.w=this.w,t}it(){return this.h=!0,Object.freeze(this),this}N(){return this.h||Object.isFrozen(this)?this:this.copy().u()}u(){return this.h||(this.h=!0),this}At(){return this.h&&(Object.isFrozen(this)&&e.o("cannot thaw constant: "+this),this.h=!1),this}gw(t){}static parse(t){if("string"==typeof t){const e=t.split(" ");let i=0,n=0;for(;""===e[i];)i++;let s=e[i++];s&&(n=parseFloat(s));let o=0;for(;""===e[i];)i++;return s=e[i++],s&&(o=parseFloat(s)),new y(n,o)}return new y}static stringify(t){return t.x.toString()+" "+t.y.toString()}static stringifyFixed(t){return e.s(t,"number",y,"stringifyFixed:digits"),e=>e.x.toFixed(t)+" "+e.y.toFixed(t)}toString(){return"Point("+this.x+","+this.y+")"}equals(t){return t instanceof y&&(this.p===t.x&&this.w===t.y)}equalTo(t,e){return this.p===t&&this.w===e}equalsApprox(t){return S.f(this.p,t.x)&&S.f(this.w,t.y)}add(t){return this.p+=t.x,this.w+=t.y,this}subtract(t){return this.p-=t.x,this.w-=t.y,this}offset(t,e){return this.p+=t,this.w+=e,this}rotate(t){if(0===t)return this;const e=this.p,i=this.w;if(0===e&&0===i)return this;let n=0,s=0;if(t>=360?t-=360:t<0&&(t+=360),90===t)n=0,s=1;else if(180===t)n=-1,s=0;else if(270===t)n=0,s=-1;else{const e=t*Math.PI/180;n=Math.cos(e),s=Math.sin(e)}return this.p=n*e-s*i,this.w=s*e+n*i,this}scale(t,e){return this.p*=t,this.w*=e,this}distanceSquaredPoint(t){const e=t.x-this.p,i=t.y-this.w;return e*e+i*i}distanceSquared(t,e){const i=t-this.p,n=e-this.w;return i*i+n*n}normalize(){const t=this.p,e=this.w,i=Math.sqrt(t*t+e*e);return i>0&&(this.p=t/i,this.w=e/i),this}directionPoint(t){return this.lC(t.x-this.p,t.y-this.w)}direction(t,e){return this.lC(t-this.p,e-this.w)}lC(t,e){if(0===t)return e>0?90:e<0?270:0;if(0===e)return t>0?0:180;{if(isNaN(t)||isNaN(e))return 0;let i=180*Math.atan(Math.abs(e/t))/Math.PI;return t<0?e<0?i+=180:i=180-i:e<0&&(i=360-i),i}}static compareWithLineSegment(t,e,i,n,s,o){return S.hu(t,e,i,n,s,o)}compareWithLineSegmentPoint(t,e){return S.hu(t.x,t.y,e.x,e.y,this.x,this.y)}static intersectingLineSegments(t,e,i,n,s,o,r,a){return S.au(t,e,i,n,s,o,r,a)}projectOntoLineSegment(t,e,i,n){return S.bl(t,e,i,n,this.p,this.w,this),this}projectOntoLineSegmentPoint(t,e){return S.bl(t.x,t.y,e.x,e.y,this.p,this.w,this),this}snapToGrid(t,e,i,n){return S.Ig(this.p,this.w,t,e,i,n,this),this}snapToGridPoint(t,e){return S.Ig(this.p,this.w,t.x,t.y,e.width,e.height,this),this}setRectSpot(t,e){return this.p=t.x+e.x*t.width+e.offsetX,this.w=t.y+e.y*t.height+e.offsetY,this}setSpot(t,e,i,n,s){return this.p=t+s.x*i+s.offsetX,this.w=e+s.y*n+s.offsetY,this}F(t){return t.xt(this),this}Be(t){return t._e(this),this}static distanceLineSegmentSquared(t,e,i,n,s,o){let r=s-i,a=o-n;const l=r*r+a*a,h=i-t,u=n-e,c=-h*r-u*a;if(c<=0||c>=l)return r=s-t,a=o-e,Math.min(h*h+u*u,r*r+a*a);{const t=r*u-a*h;return t*t/l}}static distanceSquared(t,e,i,n){const s=i-t,o=n-e;return s*s+o*o}static direction(t,e,i,n){const s=i-t,o=n-e;if(0===s)return o>0?90:o<0?270:0;if(0===o)return s>0?0:180;{if(isNaN(s)||isNaN(o))return 0;let t=180*Math.atan(Math.abs(o/s))/Math.PI;return s<0?o<0?t+=180:t=180-t:o<0&&(t=360-t),t}}get x(){return this.p}set x(t){this.p=t}get y(){return this.w}set y(t){this.w=t}isReal(){return isFinite(this.x)&&isFinite(this.y)}static Lo=(()=>new y(0,0).it())();static hC=(()=>new y(-1/0,-1/0).it())();static aC=(()=>new y(1/0,1/0).it())();static cC=(()=>new y(6,6).it())();static Ak=(()=>new y(NaN,NaN).it())();static Tk=[];static l(){const t=y.Tk.pop();return void 0===t?new y:t}static X(t,e){const i=y.Tk.pop();return void 0===i?new y(t,e):(i.x=t,i.y=e,i)}static e(t){y.Tk.push(t)}}class x{j;q;h;constructor(t,i){void 0===t?(this.j=0,this.q=0):"number"==typeof t&&(t>=0||isNaN(t))&&"number"==typeof i&&(i>=0||isNaN(i))?(this.j=t,this.q=i):e.o("Invalid arguments to Size constructor: "+t+", "+i),this.h=!1}a(t){return this.j=t.j,this.q=t.q,this}i(t,e){return this.j=t,this.q=e,this}setTo(t,e){return this.j=t,this.q=e,this}set(t){return this.j=t.j,this.q=t.q,this}copy(){const t=new x;return t.j=this.j,t.q=this.q,t}it(){return this.h=!0,Object.freeze(this),this}N(){return this.h||Object.isFrozen(this)?this:this.copy().u()}u(){return this.h||(this.h=!0),this}At(){return this.h&&(Object.isFrozen(this)&&e.o("cannot thaw constant: "+this),this.h=!1),this}gw(t){}static parse(t){if("string"==typeof t){const e=t.split(" ");let i=0,n=0;for(;""===e[i];)i++;let s=e[i++];s&&(n=parseFloat(s));let o=0;for(;""===e[i];)i++;return s=e[i++],s&&(o=parseFloat(s)),new x(n,o)}return new x}static stringify(t){return t.width.toString()+" "+t.height.toString()}static stringifyFixed(t){return e.s(t,"number",x,"stringifyFixed:digits"),e=>e.width.toFixed(t)+" "+e.height.toFixed(t)}toString(){return"Size("+this.width+","+this.height+")"}equals(t){return t instanceof x&&(this.j===t.width&&this.q===t.height)}equalTo(t,e){return this.j===t&&this.q===e}equalsApprox(t){return S.f(this.j,t.width)&&S.f(this.q,t.height)}inflate(t,e){const i=this.width+t;this.j=i>=0?i:0;const n=this.height+e;return this.q=n>=0?n:0,this}get width(){return this.j}set width(t){t<0&&e._(t,">= 0",x,"width"),this.j=t}get height(){return this.q}set height(t){t<0&&e._(t,">= 0",x,"height"),this.q=t}isReal(){return isFinite(this.width)&&isFinite(this.height)}static hc=(()=>new x(0,0).it())();static Dk=(()=>new x(1,1).it())();static fC=(()=>new x(6,6).it())();static cu=(()=>new x(8,8).it())();static uC=(()=>new x(10,10).it())();static Fk=(()=>new x(1/0,1/0).it())();static mw=(()=>new x(NaN,NaN).it())();static dC=[];static l(){const t=x.dC.pop();return void 0===t?new x:t}static e(t){x.dC.push(t)}}class b{p;w;j;q;h;constructor(t,i,n,s){if(void 0===t)this.p=0,this.w=0,this.j=0,this.q=0;else if("number"==typeof t&&"number"==typeof i&&"number"==typeof n&&(n>=0||isNaN(n))&&"number"==typeof s&&(s>=0||isNaN(s)))this.p=t,this.w=i,this.j=n,this.q=s;else if(t instanceof y){const n=t.x,s=t.y;if(i instanceof y){const t=i.x,e=i.y;this.p=Math.min(n,t),this.w=Math.min(s,e),this.j=Math.abs(n-t),this.q=Math.abs(s-e)}else i instanceof x?(this.p=n,this.w=s,this.j=i.width,this.q=i.height):e.o("Incorrect second argument supplied to Rect constructor "+i)}else e.o("Invalid arguments to Rect constructor: "+t+", "+i+", "+n+", "+s);this.h=!1}a(t){return this.p=t.p,this.w=t.w,this.j=t.j,this.q=t.q,this}i(t,e,i,n){return this.p=t,this.w=e,this.j=i,this.q=n,this}zn(t,e){return this.j=t,this.q=e,this}setTo(t,e,i,n){return this.p=t,this.w=e,this.j=i,this.q=n,this}set(t){return this.p=t.p,this.w=t.w,this.j=t.j,this.q=t.q,this}setPoint(t){return this.p=t.x,this.w=t.y,this}setSize(t){return this.j=t.width,this.q=t.height,this}copy(){const t=new b;return t.p=this.p,t.w=this.w,t.j=this.j,t.q=this.q,t}it(){return this.h=!0,Object.freeze(this),this}N(){return this.h||Object.isFrozen(this)?this:this.copy().u()}u(){return this.h||(this.h=!0),this}At(){return this.h&&(Object.isFrozen(this)&&e.o("cannot thaw constant: "+this),this.h=!1),this}gw(t){}static parse(t){if("string"==typeof t){const e=t.split(" ");let i=0,n=0;for(;""===e[i];)i++;let s=e[i++];s&&(n=parseFloat(s));let o=0;for(;""===e[i];)i++;s=e[i++],s&&(o=parseFloat(s));let r=0;for(;""===e[i];)i++;s=e[i++],s&&(r=parseFloat(s));let a=0;for(;""===e[i];)i++;return s=e[i++],s&&(a=parseFloat(s)),new b(n,o,r,a)}return new b}static stringify(t){return t.x.toString()+" "+t.y.toString()+" "+t.width.toString()+" "+t.height.toString()}static stringifyFixed(t){return e.s(t,"number",b,"stringifyFixed:digits"),e=>e.x.toFixed(t)+" "+e.y.toFixed(t)+" "+e.width.toFixed(t)+" "+e.height.toFixed(t)}toString(){return"Rect("+this.x+","+this.y+","+this.width+","+this.height+")"}equals(t){return t instanceof b&&(this.p===t.x&&this.w===t.y&&this.j===t.width&&this.q===t.height)}equalTo(t,e,i,n){return this.p===t&&this.w===e&&this.j===i&&this.q===n}equalsApprox(t){return S.f(this.p,t.x)&&S.f(this.w,t.y)&&S.f(this.j,t.width)&&S.f(this.q,t.height)}equalsApproxTo(t,e,i,n){return S.f(this.p,t)&&S.f(this.w,e)&&S.f(this.j,i)&&S.f(this.q,n)}equalsApproxClose(t){return S.Y(this.p,t.x)&&S.Y(this.w,t.y)&&S.Y(this.j,t.width)&&S.Y(this.q,t.height)}containsPoint(t){return this.p<=t.x&&this.p+this.j>=t.x&&this.w<=t.y&&this.w+this.q>=t.y}containsRect(t){return this.p<=t.x&&t.x+t.width<=this.p+this.j&&this.w<=t.y&&t.y+t.height<=this.w+this.q}contains(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),this.p<=t&&t+i<=this.p+this.j&&this.w<=e&&e+n<=this.w+this.q}offset(t,e){return this.p+=t,this.w+=e,this}inflate(t,e){return this.pw(e,t,e,t)}addMargin(t){return this.pw(t.top,t.right,t.bottom,t.left)}subtractMargin(t){return this.pw(-t.top,-t.right,-t.bottom,-t.left)}grow(t,e,i,n){return this.pw(t,e,i,n)}pw(t,e,i,n){const s=this.j;e+n<=-s?(this.p+=s/2,this.j=0):(this.p-=n,this.j+=e+n);const o=this.q;return t+i<=-o?(this.w+=o/2,this.q=0):(this.w-=t,this.q+=t+i),this}intersectRect(t){return this.gC(t.x,t.y,t.width,t.height)}intersect(t,e,i,n){return this.gC(t,e,i,n)}gC(t,e,i,n){const s=Math.max(this.p,t),o=Math.max(this.w,e),r=Math.min(this.p+this.j,t+i),a=Math.min(this.w+this.q,e+n);return this.p=s,this.w=o,this.j=Math.max(0,r-s),this.q=Math.max(0,a-o),this}intersectsRect(t){return this.intersects(t.x,t.y,t.width,t.height)}intersects(t,e,i,n){let s=this.j;const o=this.p;if(s!==1/0&&i!==1/0&&(s+=o,i+=t,isNaN(i)||isNaN(s)||o>i||t>s))return!1;let r=this.q;const a=this.w;return!(r!==1/0&&n!==1/0&&(r+=a,n+=e,isNaN(n)||isNaN(r)||a>n||e>r))}intersectsRectPlus(t,e){let i=this.j,n=t.width+e+e;const s=this.p,o=t.x-e;if(i+=s,n+=o,s>n||o>i)return!1;let r=this.q,a=t.height+e+e;const l=this.w,h=t.y-e;return r+=l,a+=h,!(l>a||h>r)}unionPoint(t){return this.unionNoCheck(t.x,t.y,0,0)}unionRect(t){return this.unionNoCheck(t.p,t.w,t.j,t.q)}union(t,e,i,n){return void 0===i&&(i=0),void 0===n&&(n=0),this.unionNoCheck(t,e,i,n)}unionNoCheck(t,e,i,n){const s=Math.min(this.p,t),o=Math.min(this.w,e),r=Math.max(this.p+this.j,t+i),a=Math.max(this.w+this.q,e+n);return this.p=s,this.w=o,this.j=r-s,this.q=a-o,this}setSpot(t,e,i){return this.p=t-i.offsetX-i.x*this.j,this.w=e-i.offsetY-i.y*this.q,this}static contains(t,e,i,n,s,o,r,a){return void 0===r&&(r=0),void 0===a&&(a=0),t<=s&&s+r<=t+i&&e<=o&&o+a<=e+n}static intersects(t,e,i,n,s,o,r,a){let l=i,h=r;if(l+=t,h+=s,t>h||s>l)return!1;let u=n,c=a;return u+=e,c+=o,!(e>c||o>u)}static intersectsLineSegment(t,e,i,n,s,o,r,a){return S.mC(t,e,i,n,s,o,r,a)}get x(){return this.p}set x(t){this.p=t}get y(){return this.w}set y(t){this.w=t}get width(){return this.j}set width(t){t<0&&e._(t,">= 0",b,"width"),this.j=t}get height(){return this.q}set height(t){t<0&&e._(t,">= 0",b,"height"),this.q=t}get left(){return this.p}set left(t){this.p=t}get top(){return this.w}set top(t){this.w=t}get right(){return this.p+this.j}set right(t){this.p+=t-(this.p+this.j)}get bottom(){return this.w+this.q}set bottom(t){this.w+=t-(this.w+this.q)}get position(){return new y(this.p,this.w)}set position(t){this.p=t.x,this.w=t.y}get size(){return new x(this.j,this.q)}set size(t){this.j=t.width,this.q=t.height}get center(){return new y(this.p+this.j/2,this.w+this.q/2)}set center(t){this.p=t.x-this.j/2,this.w=t.y-this.q/2}get centerX(){return this.p+this.j/2}set centerX(t){this.p=t-this.j/2}get centerY(){return this.w+this.q/2}set centerY(t){this.w=t-this.q/2}isReal(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)}isEmpty(){return 0===this.width&&0===this.height}static Eg=(()=>new b(0,0,0,0).it())();static KD=(()=>new b(NaN,NaN,NaN,NaN).it())();static Rk=[];static l(){const t=b.Rk.pop();return void 0===t?new b:t}static X(t,e,i,n){const s=b.Rk.pop();return void 0===s?new b(t,e,i,n):s.i(t,e,i,n)}static e(t){b.Rk.push(t)}}class v{rn;ln;hn;an;h;constructor(t,i,n,s){void 0===t?(this.rn=0,this.ln=0,this.hn=0,this.an=0):void 0===i?(i=t,n=t,s=t,this.top=t,this.right=i,this.bottom=n,this.left=s):void 0===n?(n=t,s=i,this.top=t,this.right=i,this.bottom=n,this.left=s):void 0!==s?(this.top=t,this.right=i,this.bottom=n,this.left=s):e.o("Invalid arguments to Margin constructor: "+t+", "+i+", "+n+", "+s),this.h=!1}a(t){return this.rn=t.rn,this.ln=t.ln,this.hn=t.hn,this.an=t.an,this}setTo(t,e,i,n){return this.rn=t,this.ln=e,this.hn=i,this.an=n,this}set(t){return this.rn=t.rn,this.ln=t.ln,this.hn=t.hn,this.an=t.an,this}copy(){const t=new v;return t.rn=this.rn,t.ln=this.ln,t.hn=this.hn,t.an=this.an,t}it(){return this.h=!0,Object.freeze(this),this}N(){return this.h||Object.isFrozen(this)?this:this.copy().u()}u(){return this.h||(this.h=!0),this}At(){return this.h&&(Object.isFrozen(this)&&e.o("cannot thaw constant: "+this),this.h=!1),this}gw(t){}static parse(t){if("string"==typeof t){const e=t.split(" ");let i=0,n=NaN;for(;""===e[i];)i++;let s=e[i++];if(s&&(n=parseFloat(s)),isNaN(n))return new v;let o=NaN;for(;""===e[i];)i++;if(s=e[i++],s&&(o=parseFloat(s)),isNaN(o))return new v(n);let r=NaN;for(;""===e[i];)i++;if(s=e[i++],s&&(r=parseFloat(s)),isNaN(r))return new v(n,o);let a=NaN;for(;""===e[i];)i++;return s=e[i++],s&&(a=parseFloat(s)),isNaN(a)?new v(n,o):new v(n,o,r,a)}return new v}static stringify(t){return t.top.toString()+" "+t.right.toString()+" "+t.bottom.toString()+" "+t.left.toString()}static stringifyFixed(t){return e.s(t,"number",v,"stringifyFixed:digits"),e=>e.top.toFixed(t)+" "+e.right.toFixed(t)+" "+e.bottom.toFixed(t)+" "+e.left.toFixed(t)}toString(){return"Margin("+this.top+","+this.right+","+this.bottom+","+this.left+")"}equals(t){return t instanceof v&&(this.rn===t.top&&this.ln===t.right&&this.hn===t.bottom&&this.an===t.left)}equalTo(t,e,i,n){return this.rn===t&&this.ln===e&&this.hn===i&&this.an===n}equalsApprox(t){return S.f(this.rn,t.top)&&S.f(this.ln,t.right)&&S.f(this.hn,t.bottom)&&S.f(this.an,t.left)}get top(){return this.rn}set top(t){this.rn=t}get right(){return this.ln}set right(t){this.ln=t}get bottom(){return this.hn}set bottom(t){this.hn=t}get left(){return this.an}set left(t){this.an=t}isReal(){return isFinite(this.top)&&isFinite(this.right)&&isFinite(this.bottom)&&isFinite(this.left)}static Bg=(()=>new v(0,0,0,0).it())();static pC=(()=>new v(2,2,2,2).it())();static yC=[];static l(){const t=v.yC.pop();return void 0===t?new v:t}static e(t){v.yC.push(t)}}class w{p;w;Os;Is;h;constructor(t,e,i,n){void 0===t?(this.p=0,this.w=0,this.Os=0,this.Is=0):(void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=0),this.x=t,this.y=e,this.offsetX=i,this.offsetY=n),this.h=!1}a(t){return this.p=t.p,this.w=t.w,this.Os=t.Os,this.Is=t.Is,this}setTo(t,e,i,n){return this.p=t,this.w=e,this.Os=i,this.Is=n,this}set(t){return this.p=t.p,this.w=t.w,this.Os=t.Os,this.Is=t.Is,this}copy(){const t=new w;return t.p=this.p,t.w=this.w,t.Os=this.Os,t.Is=this.Is,t}it(){return this.h=!0,Object.freeze(this),this}N(){return this.h||Object.isFrozen(this)?this:this.copy().u()}u(){return this.h||(this.h=!0),this}At(){return this.h&&(Object.isFrozen(this)&&e.o("cannot thaw constant: "+this),this.h=!1),this}gw(t){}Ue(t){return this.p=NaN,this.w=NaN,this.Os=t,this}fE(t,i){(isNaN(t)||t>1||t<0)&&e._(t,"0 <= "+i+" <= 1",w,i)}uE(t,i){(isNaN(t)||t===1/0||t===-1/0)&&e._(t,"real number, not NaN or Infinity",w,i)}static parse(t){if("string"==typeof t){if("None"===(t=t.trim()))return w.None;if("TopLeft"===t)return w.TopLeft;if("Top"===t||"TopCenter"===t||"MiddleTop"===t)return w.TopCenter;if("TopRight"===t)return w.TopRight;if("Left"===t||"LeftCenter"===t||"MiddleLeft"===t)return w.LeftCenter;if("Center"===t)return w.Center;if("Right"===t||"RightCenter"===t||"MiddleRight"===t)return w.RightCenter;if("BottomLeft"===t)return w.BottomLeft;if("Bottom"===t||"BottomCenter"===t||"MiddleBottom"===t)return w.BottomCenter;if("BottomRight"===t)return w.BottomRight;if("TopSide"===t)return w.TopSide;if("LeftSide"===t)return w.LeftSide;if("RightSide"===t)return w.RightSide;if("BottomSide"===t)return w.BottomSide;if("TopBottomSides"===t)return w.TopBottomSides;if("LeftRightSides"===t)return w.LeftRightSides;if("TopLeftSides"===t)return w.TopLeftSides;if("TopRightSides"===t)return w.TopRightSides;if("BottomLeftSides"===t)return w.BottomLeftSides;if("BottomRightSides"===t)return w.BottomRightSides;if("NotTopSide"===t)return w.NotTopSide;if("NotLeftSide"===t)return w.NotLeftSide;if("NotRightSide"===t)return w.NotRightSide;if("NotBottomSide"===t)return w.NotBottomSide;if("AllSides"===t)return w.AllSides;if("Default"===t)return w.Default;const e=t.split(" ");let i=0,n=0;for(;""===e[i];)i++;let s=e[i++];void 0!==s&&s.length>0&&(n=parseFloat(s));let o=0;for(;""===e[i];)i++;s=e[i++],void 0!==s&&s.length>0&&(o=parseFloat(s));let r=0;for(;""===e[i];)i++;s=e[i++],void 0!==s&&s.length>0&&(r=parseFloat(s));let a=0;for(;""===e[i];)i++;return s=e[i++],void 0!==s&&s.length>0&&(a=parseFloat(s)),new w(n,o,r,a)}return new w}static stringify(t){return t.isSpot()?t.x.toString()+" "+t.y.toString()+" "+t.offsetX.toString()+" "+t.offsetY.toString():t.toString()}static stringifyFixed(t){return e.s(t,"number",w,"stringifyFixed:digits"),e=>e.x.toFixed(t)+" "+e.y.toFixed(t)+" "+e.offsetX.toFixed(t)+" "+e.offsetY.toFixed(t)}toString(){return this.isSpot()?0===this.Os&&0===this.Is?"Spot("+this.x+","+this.y+")":"Spot("+this.x+","+this.y+","+this.offsetX+","+this.offsetY+")":this.equals(w.None)?"None":this.equals(w.TopLeft)?"TopLeft":this.equals(w.TopCenter)?"Top":this.equals(w.TopRight)?"TopRight":this.equals(w.LeftCenter)?"Left":this.equals(w.Center)?"Center":this.equals(w.RightCenter)?"Right":this.equals(w.BottomLeft)?"BottomLeft":this.equals(w.BottomCenter)?"Bottom":this.equals(w.BottomRight)?"BottomRight":this.equals(w.TopSide)?"TopSide":this.equals(w.LeftSide)?"LeftSide":this.equals(w.RightSide)?"RightSide":this.equals(w.BottomSide)?"BottomSide":this.equals(w.TopBottomSides)?"TopBottomSides":this.equals(w.LeftRightSides)?"LeftRightSides":this.equals(w.TopLeftSides)?"TopLeftSides":this.equals(w.TopRightSides)?"TopRightSides":this.equals(w.BottomLeftSides)?"BottomLeftSides":this.equals(w.BottomRightSides)?"BottomRightSides":this.equals(w.NotTopSide)?"NotTopSide":this.equals(w.NotLeftSide)?"NotLeftSide":this.equals(w.NotRightSide)?"NotRightSide":this.equals(w.NotBottomSide)?"NotBottomSide":this.equals(w.AllSides)?"AllSides":this.equals(w.Default)?"Default":"None"}equals(t){return t instanceof w&&((this.p===t.x||isNaN(this.p)&&isNaN(t.x))&&(this.w===t.y||isNaN(this.w)&&isNaN(t.y))&&this.Os===t.offsetX&&this.Is===t.offsetY)}opposite(){return new w(.5-(this.p-.5),.5-(this.w-.5),-this.Os,-this.Is)}includesSide(t){if(!this.isSide())return!1;if(!t.isSide())if(t.equals(w.Left))t=w.LeftSide;else if(t.equals(w.Right))t=w.RightSide;else if(t.equals(w.Top))t=w.TopSide;else{if(!t.equals(w.Bottom))return!1;t=w.BottomSide}const e=this.Is,i=t.offsetY;return(e&i)===i}get x(){return this.p}set x(t){this.p=t}get y(){return this.w}set y(t){this.w=t}get offsetX(){return this.Os}set offsetX(t){this.Os=t}get offsetY(){return this.Is}set offsetY(t){this.Is=t}isSpot(){return!isNaN(this.x)&&!isNaN(this.y)}isNoSpot(){return isNaN(this.x)||isNaN(this.y)}isSide(){return isNaN(this.x)&&isNaN(this.y)&&1===this.offsetX&&0!==this.offsetY}isNone(){return isNaN(this.x)&&isNaN(this.y)&&0===this.offsetX&&0===this.offsetY}isDefault(){return isNaN(this.x)&&isNaN(this.y)&&-1===this.offsetX&&0===this.offsetY}static None=(()=>new w(0,0,0,0).Ue(0).it())();static Default=(()=>new w(0,0,-1,0).Ue(-1).it())();static TopLeft=(()=>new w(0,0,0,0).it())();static TopCenter=(()=>new w(.5,0,0,0).it())();static TopRight=(()=>new w(1,0,0,0).it())();static LeftCenter=(()=>new w(0,.5,0,0).it())();static Center=(()=>new w(.5,.5,0,0).it())();static RightCenter=(()=>new w(1,.5,0,0).it())();static BottomLeft=(()=>new w(0,1,0,0).it())();static BottomCenter=(()=>new w(.5,1,0,0).it())();static BottomRight=(()=>new w(1,1,0,0).it())();static MiddleTop=(()=>w.TopCenter)();static MiddleLeft=(()=>w.LeftCenter)();static MiddleRight=(()=>w.RightCenter)();static MiddleBottom=(()=>w.BottomCenter)();static Top=(()=>w.TopCenter)();static Left=(()=>w.LeftCenter)();static Right=(()=>w.RightCenter)();static Bottom=(()=>w.BottomCenter)();static TopSide=(()=>new w(0,0,1,1).Ue(1).it())();static LeftSide=(()=>new w(0,0,1,2).Ue(1).it())();static RightSide=(()=>new w(0,0,1,4).Ue(1).it())();static BottomSide=(()=>new w(0,0,1,8).Ue(1).it())();static TopBottomSides=(()=>new w(0,0,1,9).Ue(1).it())();static LeftRightSides=(()=>new w(0,0,1,6).Ue(1).it())();static TopLeftSides=(()=>new w(0,0,1,3).Ue(1).it())();static TopRightSides=(()=>new w(0,0,1,5).Ue(1).it())();static BottomLeftSides=(()=>new w(0,0,1,10).Ue(1).it())();static BottomRightSides=(()=>new w(0,0,1,12).Ue(1).it())();static NotTopSide=(()=>new w(0,0,1,14).Ue(1).it())();static NotLeftSide=(()=>new w(0,0,1,13).Ue(1).it())();static NotRightSide=(()=>new w(0,0,1,11).Ue(1).it())();static NotBottomSide=(()=>new w(0,0,1,7).Ue(1).it())();static AllSides=(()=>new w(0,0,1,15).Ue(1).it())();static vk=(()=>new w(.156,.156).it())();static Ok=(()=>new w(.844,.844).it())();static wC=[];static l(){const t=w.wC.pop();return void 0===t?new w:t}static e(t){w.wC.push(t)}}class k{m11;m12;m21;m22;dx;dy;constructor(){this.m11=1,this.m12=0,this.m21=0,this.m22=1,this.dx=0,this.dy=0}set(t){return this.m11=t.m11,this.m12=t.m12,this.m21=t.m21,this.m22=t.m22,this.dx=t.dx,this.dy=t.dy,this}setTo(t,e,i,n,s,o){return this.m11=t,this.m12=e,this.m21=i,this.m22=n,this.dx=s,this.dy=o,this}copy(){const t=new k;return t.m11=this.m11,t.m12=this.m12,t.m21=this.m21,t.m22=this.m22,t.dx=this.dx,t.dy=this.dy,t}toString(){return"Transform("+this.m11+","+this.m12+","+this.m21+","+this.m22+","+this.dx+","+this.dy+")"}equals(t){return this.m11===t.m11&&this.m12===t.m12&&this.m21===t.m21&&this.m22===t.m22&&this.dx===t.dx&&this.dy===t.dy}Ik(){return 0===this.dx&&0===this.dy&&1===this.m11&&0===this.m12&&0===this.m21&&1===this.m22}Ii(){return this.m11=1,this.m12=0,this.m21=0,this.m22=1,this.dx=0,this.dy=0,this}ac(t){const e=this.m11*t.m11+this.m21*t.m12,i=this.m12*t.m11+this.m22*t.m12,n=this.m11*t.m21+this.m21*t.m22,s=this.m12*t.m21+this.m22*t.m22;return this.dx=this.m11*t.dx+this.m21*t.dy+this.dx,this.dy=this.m12*t.dx+this.m22*t.dy+this.dy,this.m11=e,this.m12=i,this.m21=n,this.m22=s,this}xC(t){const e=1/(t.m11*t.m22-t.m12*t.m21),i=t.m22*e,n=-t.m12*e,s=-t.m21*e,o=t.m11*e,r=e*(t.m21*t.dy-t.m22*t.dx),a=e*(t.m12*t.dx-t.m11*t.dy),l=this.m11*i+this.m21*n,h=this.m12*i+this.m22*n,u=this.m11*s+this.m21*o,c=this.m12*s+this.m22*o;return this.dx=this.m11*r+this.m21*a+this.dx,this.dy=this.m12*r+this.m22*a+this.dy,this.m11=l,this.m12=h,this.m21=u,this.m22=c,this}yw(){const t=1/(this.m11*this.m22-this.m12*this.m21),e=this.m22*t,i=-this.m12*t,n=-this.m21*t,s=this.m11*t,o=t*(this.m21*this.dy-this.m22*this.dx),r=t*(this.m12*this.dx-this.m11*this.dy);return this.m11=e,this.m12=i,this.m21=n,this.m22=s,this.dx=o,this.dy=r,this}ds(t,e,i){if(t>=360?t-=360:t<0&&(t+=360),0===t)return this;this.Es(e,i);let n=0,s=0;if(90===t)n=0,s=1;else if(180===t)n=-1,s=0;else if(270===t)n=0,s=-1;else{const e=t*Math.PI/180;n=Math.cos(e),s=Math.sin(e)}const o=this.m11*n+this.m21*s,r=this.m12*n+this.m22*s,a=this.m11*-s+this.m21*n,l=this.m12*-s+this.m22*n;return this.m11=o,this.m12=r,this.m21=a,this.m22=l,this.Es(-e,-i),this}Es(t,e){return this.dx+=this.m11*t+this.m21*e,this.dy+=this.m12*t+this.m22*e,this}nt(t,e){return void 0===e&&(e=t),this.m11*=t,this.m12*=t,this.m21*=e,this.m22*=e,this}GD(){if(1===this.m11&&0===this.m12)return 0;let t=180*Math.atan2(this.m12,this.m11)/Math.PI;return t<0&&(t+=360),t}xt(t){const e=t.x,i=t.y;return t.i(e*this.m11+i*this.m21+this.dx,e*this.m12+i*this.m22+this.dy)}_e(t){const e=1/(this.m11*this.m22-this.m12*this.m21),i=this.m22*e,n=-this.m12*e,s=-this.m21*e,o=this.m11*e,r=t.x-this.dx,a=t.y-this.dy;return t.i(r*i+a*s,r*n+a*o)}ww(t){const e=1/(this.m11*this.m22-this.m12*this.m21),i=this.m22*e,n=-this.m12*e,s=-this.m21*e,o=this.m11*e,r=e*(this.m21*this.dy-this.m22*this.dx),a=e*(this.m12*this.dx-this.m11*this.dy),l=1.25*t.x,h=1.2*t.y;return t.i(l*i+h*s+r,l*n+h*o+a)}Ug(t){const e=t.x,i=t.y,n=e+t.width,s=i+t.height,o=this.m11,r=this.m12,a=this.m21,l=this.m22,h=this.dx,u=this.dy,c=e*o+i*a+h,d=e*r+i*l+u,f=n*o+i*a+h,g=n*r+i*l+u,m=e*o+s*a+h,p=e*r+s*l+u,y=n*o+s*a+h,x=n*r+s*l+u;let b=c,v=c,w=d,k=d;return b=Math.min(b,f),v=Math.max(v,f),w=Math.min(w,g),k=Math.max(k,g),b=Math.min(b,m),v=Math.max(v,m),w=Math.min(w,p),k=Math.max(k,p),b=Math.min(b,y),v=Math.max(v,y),w=Math.min(w,x),k=Math.max(k,x),t.i(b,w,v-b,k-w),t}static bC=[];static l(){const t=k.bC.pop();return void 0===t?new k:t}static e(t){k.bC.push(t)}static Ek="54a702f3e53909c447824c6706603faf4c"}const S={HD:"7da71ca0ad381e90",Xn:(Math.sqrt(2)-1)/3*4,kC:null,xw:t=>{if(t<=0)return 0;let e=S.kC;if(null===e){e=[];for(let t=0;t<=2e3;t++)e[t]=Math.sqrt(t);S.kC=e}if(t<1){const i=1/t;return i<=2e3?1/e[0|i]:Math.sqrt(t)}return t<=2e3?e[0|t]:Math.sqrt(t)},f:(t,e)=>{const i=t-e;return i<.5&&i>-.5},Y:(t,e)=>{const i=t-e;return i<5e-8&&i>-5e-8},Ei:(t,e,i,n,s,o,r)=>{s<=0&&(s=1e-6);let a=0,l=0,h=0,u=0;if(t<i?(l=t,a=i):(l=i,a=t),e<n?(u=e,h=n):(u=n,h=e),t===i)return u<=r&&r<=h&&t-s<=o&&o<=t+s;if(e===n)return l<=o&&o<=a&&e-s<=r&&r<=e+s;const c=a+s,d=l-s;if(d<=o&&o<=c){const a=h+s,l=u-s;if(l<=r&&r<=a)if(c-d>a-l){if(!(t-i>s||i-t>s))return!0;{const a=(n-e)/(i-t)*(o-t)+e;if(a-s<=r&&r<=a+s)return!0}}else{if(!(e-n>s||n-e>s))return!0;{const a=(i-t)/(n-e)*(r-e)+t;if(a-s<=o&&o<=a+s)return!0}}}return!1},bw:(t,e,i,n,s,o,r,a,l,h,u,c)=>{if(S.Ei(t,e,r,a,c,i,n)&&S.Ei(t,e,r,a,c,s,o))return S.Ei(t,e,r,a,c,h,u);{const d=(t+i)/2,f=(e+n)/2,g=(i+s)/2,m=(n+o)/2,p=(s+r)/2,y=(o+a)/2,x=(d+g)/2,b=(f+m)/2,v=(g+p)/2,w=(m+y)/2,k=(x+v)/2,P=(b+w)/2;return S.bw(t,e,d,f,x,b,k,P,l,h,u,c)||S.bw(k,P,v,w,p,y,r,a,l,h,u,c)}},PC:(t,e,i,n,s,o,r,a,l)=>{const h=(i+s)/2,u=(n+o)/2,c=((t+i)/2+h)/2,d=((e+n)/2+u)/2,f=(h+(s+r)/2)/2,g=(u+(o+a)/2)/2;return l.i((c+f)/2,(d+g)/2),l},jD:(t,e,i,n,s,o,r,a)=>{const l=(i+s)/2,h=(n+o)/2,u=((t+i)/2+l)/2,c=((e+n)/2+h)/2,d=(l+(s+r)/2)/2,f=(h+(o+a)/2)/2;return y.direction(u,c,d,f)},fu:(t,e,i,n,s,o,r,a,l,h)=>{if(S.Ei(t,e,r,a,l,i,n)&&S.Ei(t,e,r,a,l,s,o))h.unionNoCheck(t,e,0,0),h.unionNoCheck(r,a,0,0);else{const u=(t+i)/2,c=(e+n)/2,d=(i+s)/2,f=(n+o)/2,g=(s+r)/2,m=(o+a)/2,p=(u+d)/2,y=(c+f)/2,x=(d+g)/2,b=(f+m)/2,v=(p+x)/2,w=(y+b)/2;S.fu(t,e,u,c,p,y,v,w,l,h),S.fu(v,w,x,b,g,m,r,a,l,h)}return h},Yn:(t,e,i,n,s,o,r,a,l,h)=>{if(S.Ei(t,e,r,a,l,i,n)&&S.Ei(t,e,r,a,l,s,o))0===h.length&&(h.push(t),h.push(e)),h.push(r),h.push(a);else{const u=(t+i)/2,c=(e+n)/2,d=(i+s)/2,f=(n+o)/2,g=(s+r)/2,m=(o+a)/2,p=(u+d)/2,y=(c+f)/2,x=(d+g)/2,b=(f+m)/2,v=(p+x)/2,w=(y+b)/2;S.Yn(t,e,u,c,p,y,v,w,l,h),S.Yn(v,w,x,b,g,m,r,a,l,h)}return h},Bk:(t,e,i,n,s,o,r,a,l,h)=>{if(S.Ei(t,e,s,o,h,i,n))return S.Ei(t,e,s,o,h,a,l);{const u=(t+i)/2,c=(e+n)/2,d=(i+s)/2,f=(n+o)/2,g=(u+d)/2,m=(c+f)/2;return S.Bk(t,e,u,c,g,m,r,a,l,h)||S.Bk(g,m,d,f,s,o,r,a,l,h)}},dE:(t,e,i,n,s,o,r)=>{const a=(t+i)/2,l=(e+n)/2,h=(i+s)/2,u=(n+o)/2;return r.i((a+h)/2,(l+u)/2),r},Uk:(t,e,i,n,s,o,r,a)=>{if(S.Ei(t,e,s,o,r,i,n))a.unionNoCheck(t,e,0,0),a.unionNoCheck(s,o,0,0);else{const l=(t+i)/2,h=(e+n)/2,u=(i+s)/2,c=(n+o)/2,d=(l+u)/2,f=(h+c)/2;S.Uk(t,e,l,h,d,f,r,a),S.Uk(d,f,u,c,s,o,r,a)}return a},Vg:(t,e,i,n,s,o,r,a)=>{if(S.Ei(t,e,s,o,r,i,n))0===a.length&&(a.push(t),a.push(e)),a.push(s),a.push(o);else{const l=(t+i)/2,h=(e+n)/2,u=(i+s)/2,c=(n+o)/2,d=(l+u)/2,f=(h+c)/2;S.Vg(t,e,l,h,d,f,r,a),S.Vg(d,f,u,c,s,o,r,a)}return a},zg:(t,e,i,n,s,o,r,a,l,h,u,c,d,f)=>{if(S.Ei(t,e,r,a,d,i,n)&&S.Ei(t,e,r,a,d,s,o)){if(!S.au(t,e,r,a,l,h,u,c))return!1;const i=(t-r)*(h-c)-(e-a)*(l-u);if(0===i)return!1;const n=((t*a-e*r)*(l-u)-(t-r)*(l*c-h*u))/i,s=((t*a-e*r)*(h-c)-(e-a)*(l*c-h*u))/i;return f.i(n,s),!0}{const g=(t+i)/2,m=(e+n)/2,p=(i+s)/2,y=(n+o)/2,x=(s+r)/2,b=(o+a)/2,v=(g+p)/2,w=(m+y)/2,k=(p+x)/2,P=(y+b)/2,M=(v+k)/2,C=(w+P)/2;let N=1/0,T=!1,L=0,A=0;if(S.zg(t,e,g,m,v,w,M,C,l,h,u,c,d,f)){const t=(f.x-l)**2+(f.y-h)**2;t<N&&(N=t,T=!0,L=f.x,A=f.y)}if(S.zg(M,C,k,P,x,b,r,a,l,h,u,c,d,f)){const t=(f.x-l)**2+(f.y-h)**2;t<N&&(N=t,T=!0,L=f.x,A=f.y)}return T&&(f.x=L,f.y=A),T}},Xg:(t,e,i,n,s,o,r,a,l,h,u,c,d)=>{let f=0;if(S.Ei(t,e,r,a,d,i,n)&&S.Ei(t,e,r,a,d,s,o)){const i=(t-r)*(h-c)-(e-a)*(l-u);if(0===i)return f;const n=((t*a-e*r)*(l-u)-(t-r)*(l*c-h*u))/i,s=((t*a-e*r)*(h-c)-(e-a)*(l*c-h*u))/i;if(n>=u)return f;let o=0,d=0;if((l>u?l-u:u-l)<(h>c?h-c:c-h)){if(e<a?(o=e,d=a):(o=a,d=e),s<o||s>d)return f}else if(t<r?(o=t,d=r):(o=r,d=t),n<o||n>d)return f;i>0?f++:i<0&&f--}else{const g=(t+i)/2,m=(e+n)/2,p=(i+s)/2,y=(n+o)/2,x=(s+r)/2,b=(o+a)/2,v=(g+p)/2,w=(m+y)/2,k=(p+x)/2,P=(y+b)/2,M=(v+k)/2,C=(w+P)/2;f+=S.Xg(t,e,g,m,v,w,M,C,l,h,u,c,d),f+=S.Xg(M,C,k,P,x,b,r,a,l,h,u,c,d)}return f},bl:(t,e,i,n,s,o,r)=>{if(S.Y(t,i)){let i=0,s=0;e<n?(i=e,s=n):(i=n,s=e);const a=o;return a<i?(r.i(t,i),!1):a>s?(r.i(t,s),!1):(r.i(t,a),!0)}if(S.Y(e,n)){let n=0,o=0;t<i?(n=t,o=i):(n=i,o=t);const a=s;return a<n?(r.i(n,e),!1):a>o?(r.i(o,e),!1):(r.i(a,e),!0)}{const a=((t-s)*(t-i)+(e-o)*(e-n))/((i-t)**2+(n-e)**2);if(a<-5e-6)return r.i(t,e),!1;if(a>1.000005)return r.i(i,n),!1;{const s=t+a*(i-t),o=e+a*(n-e);return r.i(s,o),!0}}},Kn:(t,e,i,n,s,o,r,a,l)=>{if(S.f(t,i)&&S.f(e,n))return l.i(t,e),!1;if(S.Y(s,r)){if(S.Y(t,i))return S.bl(t,e,i,n,s,o,l),!1;{const o=(n-e)/(i-t)*(s-t)+e;return S.bl(t,e,i,n,s,o,l)}}{const h=(a-o)/(r-s);if(S.Y(t,i)){const i=h*(t-s)+o;let r=0,a=0;return e<n?(r=e,a=n):(r=n,a=e),i<r?(l.i(t,r),!1):i>a?(l.i(t,a),!1):(l.i(t,i),!0)}{const r=(n-e)/(i-t);if(S.Y(h,r))return S.bl(t,e,i,n,s,o,l),!1;{const a=(r*t-h*s+o-e)/(r-h);if(S.Y(r,0)){let n=0,s=0;return t<i?(n=t,s=i):(n=i,s=t),a<n?(l.i(n,e),!1):a>s?(l.i(s,e),!1):(l.i(a,e),!0)}{const s=r*(a-t)+e;return S.bl(t,e,i,n,a,s,l)}}}}},gE:(t,e,i,n,s)=>S.Kn(i.x,i.y,n.x,n.y,t.x,t.y,e.x,e.y,s),mE:(t,e,i,n,s,o,r,a,l,h)=>{let u=1/0;function c(i,n){const s=(i-t)**2+(n-e)**2;s<u&&(u=s,l.i(i,n))}c(l.x,l.y);let d=0,f=0,g=0,m=0;s<r?(d=s,f=r):(d=r,f=s),o<a?(g=s,m=r):(g=r,m=s);const p=(f-d)/2+h,y=(m-g)/2+h,x=(s+r)/2,b=(o+a)/2;if(0===p||0===y)return l;if(S.f(t,i)){const t=1-(i-x)**2/(p*p);if(t<0)return l;const e=Math.sqrt(t),n=-y*e+b;c(i,y*e+b),c(i,n)}else{const s=(n-e)/(i-t),o=1/(p*p)+s*s/(y*y),r=2*s*(e-s*t)/(y*y)-2*s*b/(y*y)-2*x/(p*p),a=r*r-4*o*(2*s*t*b/(y*y)-2*e*b/(y*y)+b*b/(y*y)+x*x/(p*p)-1+(e-s*t)*(e-s*t)/(y*y));if(a<0)return l;const h=Math.sqrt(a),u=(-r+h)/(2*o);c(u,s*u-s*t+e);const d=(-r-h)/(2*o);c(d,s*d-s*t+e)}return l},kl:(t,e,i,n,s,o,r,a,l)=>{let h=1e21,u=t,c=e;if(S.Kn(t,e,t,n,s,o,r,a,l)){const t=(l.x-s)**2+(l.y-o)**2;t<h&&(h=t,u=l.x,c=l.y)}if(S.Kn(i,e,i,n,s,o,r,a,l)){const t=(l.x-s)**2+(l.y-o)**2;t<h&&(h=t,u=l.x,c=l.y)}if(S.Kn(t,e,i,e,s,o,r,a,l)){const t=(l.x-s)**2+(l.y-o)**2;t<h&&(h=t,u=l.x,c=l.y)}if(S.Kn(t,n,i,n,s,o,r,a,l)){const t=(l.x-s)**2+(l.y-o)**2;t<h&&(h=t,u=l.x,c=l.y)}return l.i(u,c),h<1e21},kw:(t,e,i)=>S.mC(t.x,t.y,t.width,t.height,e.x,e.y,i.x,i.y),mC:(t,e,i,n,s,o,r,a)=>{const l=t,h=t+i,u=e,c=e+n;if(s===r){let t=0,e=0;return o<a?(t=o,e=a):(t=a,e=o),l<=s&&s<=h&&t<=c&&e>=u}if(o===a){let t=0,e=0;return s<r?(t=s,e=r):(t=r,e=s),u<=o&&o<=c&&t<=h&&e>=l}return!!(b.contains(t,e,i,n,s,o)||b.contains(t,e,i,n,r,a)||S.au(l,u,h,u,s,o,r,a)||S.au(h,u,h,c,s,o,r,a)||S.au(h,c,l,c,s,o,r,a)||S.au(l,c,l,u,s,o,r,a))},au:(t,e,i,n,s,o,r,a)=>t===i&&e===n&&s===r&&o===a?t===s&&e===o:S.hu(t,e,i,n,s,o)*S.hu(t,e,i,n,r,a)<=0&&S.hu(s,o,r,a,t,e)*S.hu(s,o,r,a,i,n)<=0,hu:(t,e,i,n,s,o)=>{const r=i-t,a=n-e;let l=s-t,h=o-e,u=l*a-h*r;return 0===u&&(u=l*r+h*a,u>0&&(l-=r,h-=a,u=l*r+h*a,u<0&&(u=0))),u},Yg:t=>(t<0&&(t+=360),t>=360&&(t-=360),t),SC:(t,e,i,n,s,o)=>{const r=Math.PI;o||(n*=r/180,s*=r/180);const a=n>s?-1:1,l=1e-5,h=2*r,u=[],c=r/2;let d=n,f=Math.min(h,Math.abs(s-n));if(f<l){const n=d+a*Math.min(f,c),s=t+i*Math.cos(d),o=e+i*Math.sin(d),r=t+i*Math.cos(n),l=e+i*Math.sin(n),h=(s+r)/2,g=(o+l)/2;return u.push([s,o,h,g,h,g,r,l]),u}for(;f>l;){const n=d+a*Math.min(f,c);u.push(S.qD(i,d,n,t,e)),f-=Math.abs(n-d),d=n}return u},qD:(t,e,i,n,s)=>{const o=(i-e)/2,r=t*Math.cos(o),a=t*Math.sin(o),l=r,h=-a,u=l*l+h*h,c=u+l*r+h*a,d=4/3*(Math.sqrt(2*u*c)-c)/(l*a-h*r),f=l-d*h,g=h+d*l,m=f,p=-g,y=o+e,x=Math.cos(y),b=Math.sin(y);return[n+t*Math.cos(e),s+t*Math.sin(e),n+f*x-g*b,s+f*b+g*x,n+m*x-p*b,s+m*b+p*x,n+t*Math.cos(i),s+t*Math.sin(i)]},Ig:(t,e,i,n,s,o,r)=>{const a=s,l=o,h=Math.floor((t-i)/a)*a+i,u=Math.floor((e-n)/l)*l+n;let c=h;h+a-t<a/2&&(c=h+a);let d=u;return u+l-e<l/2&&(d=u+l),r.i(c,d),r},MC:(t,e)=>{let i=Math.max(t,e),n=Math.min(t,e),s=1,o=1;do{s=i%n,o=n,i=n,n=s}while(s>0);return o},WD:(t,e,i,n)=>{const s=i<0,o=n<0;let r=0,a=0,l=0;t<e?(a=1,l=0):(a=0,l=1);let h=0,u=0,c=0,d=0;return r=a,h=0===r?t:e,c=0===r?i:n,(0===r?s:o)&&(c=-c),r=l,u=0===r?t:e,d=0===r?i:n,(0===r?s:o)&&(d=-d),S.JD(h,u,c,d,0,0)},JD:(t,e,i,n,s,o)=>{let r=0;if(n>0)if(i>0){const a=t*t,l=e*e,h=t*i,u=e*n;let c=-l+u,d=-l+Math.sqrt(h*h+u*u),f=c;const g=9999999999;for(let t=0;t<g&&(f=.5*(c+d),f!==c&&f!==d);++t){const t=h/(f+a),e=u/(f+l),i=t*t+e*e-1;if(i>0)c=f;else{if(!(i<0))break;d=f}}const m=(s=a*i/(f+a))-i,p=(o=l*n/(f+l))-n;r=Math.sqrt(m*m+p*p)}else s=0,o=e,r=Math.abs(n-e);else{const n=t*t-e*e,a=t*i;if(a<n){const l=a/n,h=l*l;s=t*l,o=e*Math.sqrt(Math.abs(1-h));const u=s-i;r=Math.sqrt(u*u+o*o)}else s=t,o=0,r=Math.abs(i-t)}return r},Gn:new n,Kg:new n,dr:new n,gr:0,Gg:100};S.za=S.HD;var P,M=((P=M||{})[P.Line=1]="Line",P[P.Rectangle=2]="Rectangle",P[P.Ellipse=3]="Ellipse",P[P.Path=4]="Path",P),C=(t=>(t[t.None=0]="None",t[t.Default=1]="Default",t[t.Fill=2]="Fill",t[t.Uniform=6]="Uniform",t))(C||{});class N{n;Hg;jg;cc;uu;du;Hn;jn;qn;$;ke;Pe;ie;ee;Bs;fc;uc;constructor(t){u.qi(this),this.n=2,void 0===t&&(t=4),this.$=t,this.ke=0,this.Pe=0,this.ie=0,this.ee=0,this.Bs=4===t?new l:N.Pw,this.Hg=this.Bs.ht,this.jg=(new b).u(),this.cc=null,this.uu=null,this.du=NaN,this.Hn=w.TopLeft,this.jn=w.BottomRight,this.fc=NaN,this.uc=NaN,this.qn=2}copy(){const t=new N;if(t.n=-2&this.n,t.$=this.$,t.ke=this.ke,t.Pe=this.Pe,t.ie=this.ie,t.ee=this.ee,4===this.$){const e=this.Bs.r,i=t.Bs;for(let t=0;t<e.length;t++){const n=e[t];i.add(n.copy())}t.Bs=i}else t.Bs=this.Bs;return t.Hg=this.Hg,t.jg.a(this.jg),t.cc=this.cc,t.uu=this.uu,t.du=this.du,t.Hn=this.Hn.N(),t.jn=this.jn.N(),t.fc=this.fc,t.uc=this.uc,t.qn=this.qn,t}static Line=1;static Rectangle=2;static Ellipse=3;static Path=4;static Pw=(()=>(new l).u())();get h(){return 0!==(1&this.n)}set h(t){t?this.n|=1:this.n&=-2}get kt(){return 0!==(2&this.n)}set kt(t){t?this.n|=2:this.n&=-3}u(){if(this.h=!0,4!==this.type)return this;const t=this.figures;t.u();for(const e of t)e.u();return this}equalsApprox(t){if(!(t instanceof N))return!1;if(this.type!==t.type)return 1===this.type&&4===t.type?this.NC(t):1===t.type&&4===this.type&&t.NC(this);if(4===this.type){const e=this.figures.r,i=t.figures.r,n=e.length;if(n!==i.length)return!1;for(let t=0;t<n;t++){const n=e[t],s=i[t];if(!n.equalsApprox(s))return!1}return!0}return S.f(this.startX,t.startX)&&S.f(this.startY,t.startY)&&S.f(this.endX,t.endX)&&S.f(this.endY,t.endY)}NC(t){if(1!==this.type||4!==t.type)return!1;if(1===t.figures.count){const e=t.figures.elt(0);if(1===e.segments.count&&S.f(this.startX,e.startX)&&S.f(this.startY,e.startY)){const t=e.segments.elt(0);if(2===t.type&&S.f(this.endX,t.endX)&&S.f(this.endY,t.endY))return!0}}return!1}static stringify(t){return t.toString()}static stringifyFixed(t){return e.s(t,"number",N,"stringifyFixed:digits"),e=>e.toString(t)}hi(t){t in M?this.type=t:e.cr(this,t)}toString(t){void 0===t&&(t=-1);const e=e=>0===e?"0":e.toFixed(t);let i;switch(this.type){case 1:return t<0?"M"+this.startX.toString()+" "+this.startY.toString()+"L"+this.endX.toString()+" "+this.endY.toString():"M"+e(this.startX)+" "+e(this.startY)+"L"+e(this.endX)+" "+e(this.endY);case 2:return i=new b(this.startX,this.startY,0,0),i.union(this.endX,this.endY,0,0),t<0?"M"+i.x.toString()+" "+i.y.toString()+"H"+i.right.toString()+"V"+i.bottom.toString()+"H"+i.left.toString()+"z":"M"+e(i.x)+" "+e(i.y)+"H"+e(i.right)+"V"+e(i.bottom)+"H"+e(i.left)+"z";case 3:if(i=new b(this.startX,this.startY,0,0),i.union(this.endX,this.endY,0,0),t<0){const t=i.left.toString()+" "+(i.y+i.height/2).toString(),e=i.right.toString()+" "+(i.y+i.height/2).toString();return"M"+t+"A"+(i.width/2).toString()+" "+(i.height/2).toString()+" 0 0 1 "+e+"A"+(i.width/2).toString()+" "+(i.height/2).toString()+" 0 0 1 "+t}{const t=e(i.left)+" "+e(i.y+i.height/2),n=e(i.right)+" "+e(i.y+i.height/2);return"M"+t+"A"+e(i.width/2)+" "+e(i.height/2)+" 0 0 1 "+n+"A"+e(i.width/2)+" "+e(i.height/2)+" 0 0 1 "+t}case 4:let n="";const s=this.figures.r,o=s.length;for(let e=0;e<o;e++){const i=s[e];e>0&&(n+=" x "),i.isFilled&&(n+="F "),n+=i.toString(t)}return n;default:return M[this.type]}}static fillPath(t){"string"!=typeof t&&e.te(t,"string",N,"fillPath:str");const i=t.split(/[Xx]/),n=i.length;let s="";for(let e=0;e<n;e++){const t=i[e];null===t.match(/[Ff]/)?s+=(0===e?"":"X ")+"F"+(" "===t[0]?"":" ")+t:s+=0===e?t:"X"+(" "===t[0]?"":" ")+t}return s}static qg="UuBbMmZzLlHhVvCcSsQqTtAaFfXx";static parse(t,i){void 0===i&&(i=!1),"string"!=typeof t&&e.te(t,"string",N,"parse:str");const n=new RegExp("(["+N.qg+"])(["+N.qg+"])","gm"),s=new RegExp("(["+N.qg+"])([^s])","gm"),o=new RegExp("([^s])(["+N.qg+"])","gm"),r=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/,/gm," ")).replace(n,"$1 $2")).replace(n,"$1 $2")).replace(s,"$1 $2")).replace(o,"$1 $2")).replace(/([0-9])([+\-])/gm,"$1 $2")).replace(/[\s\r\t\n]+/gm," ")).replace(/^\s+|\s+$/g,"")).split(" ");for(let y=0;y<r.length;y++){const t=r[y];if(null!==t.match(/(\.[0-9]*)(\.)/gm)){const i=e.rt();let n="",s=!1;for(let e=0;e<t.length;e++){const o=t[e];"."!==o||s?"."===o?(i.push(n),n="."):n+=o:(s=!0,n+=o)}i.push(n),r.splice(y,1);for(let t=0;t<i.length;t++)r.splice(y+t,0,i[t]);y+=i.length-1,e.tt(i)}}let a=-1,l="",h="";const u=new y(0,0),c=new y(0,0),d=new y(0,0);let f=!0;function g(){return a>=w-1||null!==r[a+1].match(T)||(f=!1,!1)}function m(){return a++,r[a]}function p(t){let e=parseFloat(m()),i=parseFloat(m());l===l.toLowerCase()&&(e=d.x+e,i=d.y+i),t.i(e,i)}function x(){return p(d),d}function b(){return p(c),c}function v(){const t=h.toLowerCase();return"c"===t||"s"===t||"q"===t||"t"===t?new y(2*d.x-c.x,2*d.y-c.y):new y(d.x,d.y)}const w=r.length,k=he.CC(null);let S=!1,P=!1,M=!1,C=!0;const T=new RegExp("["+N.qg+"]");for(;!(a>=w-1);){if(h=l,l=m(),""===l)continue;f=!0;let i=!1;switch(l.toUpperCase()){case"X":C=!0,S=!1,P=!1;break;case"M":const t=x();for(null===k.Si||!0===C?(k.gu(t.x,t.y,S,!1,!P,M),C=!1):k.$D(t.x,t.y),u.a(d);!g();){const t=x();k.mr(t.x,t.y)}break;case"L":for(;!g();){const t=x();k.mr(t.x,t.y)}f&&(i=!0);break;case"H":for(;!g();)d.i((l===l.toLowerCase()?d.x:0)+parseFloat(m()),d.y),k.mr(d.x,d.y);break;case"V":for(;!g();)d.i(d.x,(l===l.toLowerCase()?d.y:0)+parseFloat(m())),k.mr(d.x,d.y);f&&(i=!0);break;case"C":for(;!g();){const t=new y;p(t);const e=b(),i=x();k.pr(t.x,t.y,e.x,e.y,i.x,i.y)}f&&(i=!0);break;case"S":for(;!g();){const t=v(),e=b(),i=x();k.pr(t.x,t.y,e.x,e.y,i.x,i.y)}f&&(i=!0);break;case"Q":for(;!g();){const t=b(),e=x();k.Sw(t.x,t.y,e.x,e.y)}f&&(i=!0);break;case"T":for(;!g();){const t=v();c.a(t);const e=x();k.Sw(t.x,t.y,e.x,e.y),c.a(e)}f&&(i=!0);break;case"B":for(;!g();){const t=parseFloat(m()),e=parseFloat(m());let i=parseFloat(m()),n=parseFloat(m());const s=parseFloat(m());let o=s,r=!1;g()||(o=parseFloat(m()),g()||(r=0!==parseFloat(m()))),l===l.toLowerCase()&&(i+=d.x,n+=d.y),k.ZD(t,e,i,n,s,o,r)}f&&(i=!0);break;case"A":for(;!g();){const t=Math.abs(parseFloat(m())),e=Math.abs(parseFloat(m())),i=parseFloat(m());let n=!1,s=!1,o=0,r=0;const a=m();1===a.length?(n=!!parseFloat(a),s=!!parseFloat(m()),o=parseFloat(m()),r=parseFloat(m())):2===a.length?(n=!!parseFloat(a[0]),s=!!parseFloat(a[1]),o=parseFloat(m()),r=parseFloat(m())):(n=!!parseFloat(a[0]),s=!!parseFloat(a[1]),o=parseFloat(a.slice(2)),r=parseFloat(m())),l===l.toLowerCase()&&(o=d.x+o,r=d.y+r),d.i(o,r),k.QD(t,e,i,n,s,o,r)}f&&(i=!0);break;case"Z":k._D(),d.a(u);break;case"F":{let t="",e=1;for(;r[a+e];)if("0"!==r[a+e])if(null===r[a+e].match(/[Uu]/)){if(null!==r[a+e].match(T)){t=r[a+e];break}e++}else e++;else M=!0,e++;t.match(/[Mm]/)?S=!0:k.tF();break}case"U":{let t="",e=1;for(;r[a+e];)if(null===r[a+e].match(/[Ff]/)){if(null!==r[a+e].match(T)){t=r[a+e];break}e++}else e++;t.match(/[Mm]/)?P=!0:k.iF(!1);break}default:if("0"===l||"1"===l)break;e.li("Unknown geometry command: "+l)}if(i){e.li(`Bad geometry command: ${l}, next token: ${m()},\nstring: ${t}`);break}}const L=k.Wg;if(he.LC(k),i){const t=L.figures.iterator;for(;t.next();){t.value.isFilled=!0}}return L}static AC(t,e){const i=t.length,n=y.l();for(let s=0;s<i;s++){const i=t[s];n.x=i[0],n.y=i[1],e.xt(n),i[0]=n.x,i[1]=n.y,n.x=i[2],n.y=i[3],e.xt(n),i[2]=n.x,i[3]=n.y,n.x=i[4],n.y=i[5],e.xt(n),i[4]=n.x,i[5]=n.y,n.x=i[6],n.y=i[7],e.xt(n),i[6]=n.x,i[7]=n.y}y.e(n)}Vk(){if(this.kt)return!0;if(4===this.type){const t=this.figures;if(this.Hg!==t.ht)return!0;const e=this.figures.r,i=e.length;for(let n=0;n<i;n++)if(e[n].Vk())return!0}return!1}Mw(){if(this.kt=!1,this.cc=null,this.uu=null,this.du=NaN,4===this.type){const t=this.figures;this.Hg=t.ht;const e=this.figures.r,i=e.length;for(let n=0;n<i;n++)e[n].eF()}const t=this.jg;t.At(),isNaN(this.fc)||isNaN(this.uc)?t.i(0,0,0,0):t.i(0,0,this.fc,this.uc),this.TC(t,!1),t.unionNoCheck(0,0,0,0),t.u()}computeBoundsWithoutOrigin(){const t=new b;return this.TC(t,!0),t}TC(t,i){switch(this.type){case 1:case 2:case 3:i?t.i(this.ke,this.Pe,0,0):t.unionNoCheck(this.ke,this.Pe,0,0),t.unionNoCheck(this.ie,this.ee,0,0);break;case 4:const n=this.figures,s=n.r,o=n.length;for(let r=0;r<o;r++){const n=s[r];i&&0===r?t.i(n.startX,n.startY,0,0):t.unionNoCheck(n.startX,n.startY,0,0);const o=n.segments.r,a=o.length;let l=n.startX,h=n.startY;for(let i=0;i<a;i++){const s=o[i];switch(s.type){case 2:case 1:l=s.endX,h=s.endY,t.unionNoCheck(l,h,0,0);break;case 3:S.fu(l,h,s.point1X,s.point1Y,s.point2X,s.point2Y,s.endX,s.endY,.5,t),l=s.endX,h=s.endY;break;case 4:S.Uk(l,h,s.point1X,s.point1Y,s.endX,s.endY,.5,t),l=s.endX,h=s.endY;break;case 5:case 6:const i=5===s.type?s.Ao(n):s.Yh(n,l,h),o=i.length;if(0===o){l=5===s.type?s.centerX:s.endX,h=5===s.type?s.centerY:s.endY,t.unionNoCheck(l,h,0,0);break}let r=null;for(let e=0;e<o;e++)r=i[e],S.fu(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],.5,t);null!==r&&(l=r[6],h=r[7]);break;default:e.o("Unknown Segment type: "+s.type)}}}break;default:e.o("Unknown Geometry type: "+this.type)}}sF(t,e){const i=this.bounds;let n=t/i.width,s=e/i.height;return isFinite(n)||(n=1),isFinite(s)||(s=1),1===n&&1===s?this:this.copy().scale(n,s)}normalize(){this.h&&e.D(this);const t=this.computeBoundsWithoutOrigin();return this.offset(-t.x,-t.y),new y(-t.x,-t.y)}offset(t,i){return this.h&&e.D(this),this.F(1,0,0,1,t,i),this}scale(t,i){return this.h&&e.D(this),this.F(t,0,0,i,0,0),this}rotate(t,i,n){this.h&&e.D(this),void 0===i&&(i=0),void 0===n&&(n=0);const s=k.l();return s.Ii(),s.ds(t,i,n),this.F(s.m11,s.m12,s.m21,s.m22,s.dx,s.dy),k.e(s),this}F(t,i,n,s,o,r){let a=0,l=0;switch(this.type){case 1:case 2:case 3:a=this.ke,l=this.Pe,this.ke=a*t+l*n+o,this.Pe=a*i+l*s+r,a=this.ie,l=this.ee,this.ie=a*t+l*n+o,this.ee=a*i+l*s+r;break;case 4:const h=this.figures.r,u=h.length;for(let c=0;c<u;c++){const u=h[c];a=u.startX,l=u.startY,u.startX=a*t+l*n+o,u.startY=a*i+l*s+r;const d=u.segments.r,f=d.length;for(let h=0;h<f;h++){const u=d[h];switch(u.type){case 2:case 1:a=u.endX,l=u.endY,u.endX=a*t+l*n+o,u.endY=a*i+l*s+r;break;case 3:a=u.point1X,l=u.point1Y,u.point1X=a*t+l*n+o,u.point1Y=a*i+l*s+r,a=u.point2X,l=u.point2Y,u.point2X=a*t+l*n+o,u.point2Y=a*i+l*s+r,a=u.endX,l=u.endY,u.endX=a*t+l*n+o,u.endY=a*i+l*s+r;break;case 4:a=u.point1X,l=u.point1Y,u.point1X=a*t+l*n+o,u.point1Y=a*i+l*s+r,a=u.endX,l=u.endY,u.endX=a*t+l*n+o,u.endY=a*i+l*s+r;break;case 5:if(a=u.centerX,l=u.centerY,u.centerX=a*t+l*n+o,u.centerY=a*i+l*s+r,0!==i){let e=180*Math.atan2(i,t)/Math.PI;e<0&&(e+=360),u.startAngle+=e}t<0&&(u.startAngle=180-u.startAngle,u.sweepAngle=-u.sweepAngle),s<0&&(u.startAngle=-u.startAngle,u.sweepAngle=-u.sweepAngle),u.radiusX*=Math.sqrt(t*t+n*n),void 0!==u.radiusY&&(u.radiusY*=Math.sqrt(i*i+s*s));break;case 6:if(a=u.endX,l=u.endY,u.endX=a*t+l*n+o,u.endY=a*i+l*s+r,0===u.radiusX||0===u.radiusY)break;if(0!==i){let e=180*Math.atan2(i,t)/Math.PI;e<0&&(e+=360),u.xAxisRotation+=e}t<0&&(u.xAxisRotation=180-u.xAxisRotation,u.isClockwiseArc=!u.isClockwiseArc),s<0&&(u.xAxisRotation=-u.xAxisRotation,u.isClockwiseArc=!u.isClockwiseArc),u.radiusX*=Math.sqrt(t*t+n*n),u.radiusY*=Math.sqrt(i*i+s*s);break;default:e.o("Unknown Segment type: "+u.type)}}}}return this.kt=!0,this}containsPoint(t,e){void 0===e&&(e=0);const i=this.ke,n=this.Pe,s=this.ie,o=this.ee;switch(this.type){case 1:return S.Ei(i,n,s,o,e,t.x,t.y);case 2:{const r=Math.min(i,s)-e,a=Math.min(n,o)-e,l=Math.abs(s-i)+2*e,h=Math.abs(o-n)+2*e,u=b.X(r,a,l,h),c=u.containsPoint(t);return b.e(u),c}case 3:{let r=Math.min(i,s)-e,a=Math.min(n,o)-e;const l=(Math.abs(s-i)+2*e)/2,h=(Math.abs(o-n)+2*e)/2;return!(l<=0||h<=0)&&(r=t.x-(r+l),a=t.y-(a+h),r*r/(l*l)+a*a/(h*h)<=1)}case 4:return this.zk(t,e,!0,!1);default:return!1}}zk(t,i,n,s){const o=t.x,r=t.y,a=this.bounds.x-20,l=r;let h=0,u=0,c=0,d=0,f=0,g=0;const m=this.figures.r,p=m.length;for(let y=0;y<p;y++){const t=m[y],p=!t.isEvenOdd;if(!t.isFilled){if(t.Xk(o,r,s?i:i+2))return!0;continue}if(n&&t.Xk(o,r,i))return!0;const x=t.segments;u=t.startX,c=t.startY;let b=u,v=c;const w=x.r;for(let i=0;i<=x.length;i++){let n,s;switch(i!==x.length?(n=w[i],s=n.type,f=n.endX,g=n.endY):(s=2,f=b,g=v),s){case 1:{const t=this.Nw(o,r,a,l,u,c,b,v);if(isNaN(t))return!0;h+=t,b=f,v=g;break}case 2:{const t=this.Nw(o,r,a,l,u,c,f,g);if(isNaN(t))return!0;h+=t;break}case 3:d=S.Xg(u,c,n.point1X,n.point1Y,n.point2X,n.point2Y,f,g,a,l,o,r,.5),h+=d;break;case 4:{const t=(u+2*n.point1X)/3,e=(c+2*n.point1Y)/3,i=(2*n.point1X+f)/3,s=(2*n.point1Y+g)/3;d=S.Xg(u,c,t,e,i,s,f,g,a,l,o,r,.5),h+=d;break}case 5:case 6:{const e=5===n.type?n.Ao(t):n.Yh(t,u,c),i=e.length;if(0===i){const t=this.Nw(o,r,a,l,u,c,5===n.type?n.centerX:n.endX,5===n.type?n.centerY:n.endY);if(isNaN(t))return!0;h+=t;break}let s=null;for(let t=0;t<i;t++){if(s=e[t],0===t){const t=this.Nw(o,r,a,l,u,c,s[0],s[1]);if(isNaN(t))return!0;h+=t}d=S.Xg(s[0],s[1],s[2],s[3],s[4],s[5],s[6],s[7],a,l,o,r,.5),h+=d}null!==s&&(f=s[6],g=s[7]);break}default:e.o("Unknown Segment type: "+n.type)}u=f,c=g}if(p){if(0!==h)return!0}else if(h%2!==0)return!0;h=0}return!1}Nw(t,e,i,n,s,o,r,a){if(S.Ei(s,o,r,a,.05,t,e))return NaN;const l=(t-i)*(o-a);if(0===l)return 0;const h=((t*n-e*i)*(s-r)-(t-i)*(s*a-o*r))/l,u=(t*n-e*i)*(o-a)/l;if(h>=t)return 0;if((s>r?s-r:r-s)<(o>a?o-a:a-o)){if(o<a){if(u<o||u>a)return 0}else if(u<a||u>o)return 0}else if(s<r){if(h<s||h>r)return 0}else if(h<r||h>s)return 0;return l>0?1:-1}DC(t,e,i){const n=this.figures.r,s=n.length;for(let o=0;o<s;o++)if(n[o].Xk(t,e,i))return!0;return!1}getPointAlongPath(t,e){if(t<0?t=0:t>1&&(t=1),void 0===e&&(e=new y),1===this.type)return e.i(this.startX+t*(this.endX-this.startX),this.startY+t*(this.endY-this.startY)),e;const i=this.flattenedSegments,n=this.flattenedLengths,s=this.flattenedTotalLength,o=i.length,r=s*t;let a=0;for(let l=0;l<o;l++){const t=n[l],s=t.length;for(let n=0;n<s;n++){const s=t[n];if(a+s>=r){const t=0===s?0:(r-a)/s,o=i[l],h=o[2*n],u=o[2*n+1],c=o[2*n+2],d=o[2*n+3];return e.i(h+(c-h)*t,u+(d-u)*t),e}a+=s}}return e}getAngleAlongPath(t){if(t<0?t=0:t>1&&(t=1),1===this.type)return 180*Math.atan2(this.endY-this.startY,this.endX-this.startX)/Math.PI;const e=this.flattenedSegments,i=this.flattenedLengths,n=this.flattenedTotalLength,s=e.length,o=n*t;let r=0;for(let a=0;a<s;a++){const t=i[a],n=t.length;for(let i=0;i<n;i++){const n=t[i];if(r+n>=o){const t=e[a],n=t[2*i],s=t[2*i+1],o=t[2*i+2],r=t[2*i+3];return Math.abs(o-n)<1&&Math.abs(r-s)<1?0:Math.abs(o-n)<1?r-s>=0?90:270:Math.abs(r-s)<1?o-n>=0?0:180:180*Math.atan2(r-s,o-n)/Math.PI}r+=n}}return NaN}getPointAndAngleAlongPath(t,e){if(t<0?t=0:t>1&&(t=1),void 0===e&&(e=[]),e.length=3,1===this.type)return e[0]=this.startX+t*(this.endX-this.startX),e[1]=this.startY+t*(this.endY-this.startY),e[2]=180*Math.atan2(this.endY-this.startY,this.endX-this.startX)/Math.PI,e;const i=this.flattenedSegments,n=this.flattenedLengths,s=this.flattenedTotalLength,o=i.length,r=s*t;let a=0;for(let l=0;l<o;l++){const t=n[l],s=t.length;for(let n=0;n<s;n++){const s=t[n];if(a+s>=r){const t=0===s?0:(r-a)/s,o=i[l],h=o[2*n],u=o[2*n+1],c=o[2*n+2],d=o[2*n+3];let f;return e[0]=h+(c-h)*t,e[1]=u+(d-u)*t,f=Math.abs(c-h)<1&&Math.abs(d-u)<1?0:Math.abs(c-h)<1?d-u>=0?90:270:Math.abs(d-u)<1?c-h>=0?0:180:180*Math.atan2(d-u,c-h)/Math.PI,e[2]=f,e}a+=s}}return e}getFractionForPoint(t){if(1===this.type){const e=this.startX,i=this.startY,n=this.endX,s=this.endY;if(e===n&&i===s)return 0;{const o=t.x,r=t.y;let a=0,l=0;if(e===n)return i<s?(a=i,l=s):(a=s,l=i),r<=a?a===i?0:1:r>=l?l===i?0:1:Math.abs(r-i)/(l-a);if(i===s)return e<n?(a=e,l=n):(a=n,l=e),o<=a?a===e?0:1:o>=l?l===e?0:1:Math.abs(o-e)/(l-a);{const t=(n-e)**2+(s-i)**2,a=y.l();S.bl(e,i,n,s,o,r,a);const l=a.x,h=a.y;return y.e(a),Math.sqrt(((l-e)**2+(h-i)**2)/t)}}}if(2!==this.type){const e=this.flattenedSegments,i=this.flattenedLengths,n=this.flattenedTotalLength,s=y.l();let o=1/0,r=0,a=0;const l=e.length;let h=0,u=0;for(let d=0;d<l;d++){const n=e[d],l=i[d],c=n.length;for(let e=0;e<c;e+=2){const i=n[e],c=n[e+1];if(0===e){h=i,u=c;continue}S.bl(h,u,i,c,t.x,t.y,s);const d=(s.x-t.x)**2+(s.y-t.y)**2;d<o&&(o=d,r=a,r+=Math.sqrt((s.x-h)**2+(s.y-u)**2)),a+=l[(e-2)/2],h=i,u=c}}y.e(s);const c=r/n;return c<0?0:c>1?1:c}{const e=this.startX,i=this.startY,n=this.endX,s=this.endY;if(e===n&&i===s)return 0;{const o=n-e,r=s-i,a=2*o+2*r;let l=t.x,h=t.y;l=Math.min(Math.max(l,e),n),h=Math.min(Math.max(h,i),s);const u=Math.abs(l-e),c=Math.abs(l-n),d=Math.abs(h-i),f=Math.abs(h-s),g=Math.min(u,c,d,f);if(g===d)return l/a;if(g===c)return(o+h)/a;if(g===f)return(2*o+r-l)/a;if(g===u)return(2*o+2*r-h)/a}}return 0}get flattenedSegments(){return this.FC(),this.cc}FC(){if(null===this.cc){const t=this.cc=[],e=this.uu=[];this.nF(t,e)}}get flattenedLengths(){return this.FC(),this.uu}get flattenedTotalLength(){let t=this.du;if(isNaN(t)){if(1===this.type){const e=Math.abs(this.endX-this.startX),i=Math.abs(this.endY-this.startY);t=Math.sqrt(e*e+i*i)}else if(2===this.type){t=2*Math.abs(this.endX-this.startX)+2*Math.abs(this.endY-this.startY)}else{const e=this.flattenedLengths,i=e.length;t=0;for(let n=0;n<i;n++){const i=e[n],s=i.length;for(let e=0;e<s;e++)t+=i[e]}}this.du=t}return t}Yk(t){const e=[];let i=0,n=0;const s=t.length;for(let o=0;o<s;o+=2){const s=t[o],r=t[o+1];if(0===o){i=s,n=r;continue}const a=Math.sqrt(y.distanceSquared(i,n,s,r));e.push(a),i=s,n=r}return e}nF(t,i){let n=[];const s=[];if(1===this.type)n.push(this.startX),n.push(this.startY),n.push(this.endX),n.push(this.endY),t.push(n),s.push(Math.sqrt((this.startX-this.endX)**2+(this.startY-this.endY)**2)),i.push(s);else if(2===this.type)n.push(this.startX),n.push(this.startY),n.push(this.endX),n.push(this.startY),n.push(this.endX),n.push(this.endY),n.push(this.startX),n.push(this.endY),n.push(this.startX),n.push(this.startY),t.push(n),s.push(Math.abs(this.startX-this.endX)),s.push(Math.abs(this.startY-this.endY)),s.push(Math.abs(this.startX-this.endX)),s.push(Math.abs(this.startY-this.endY)),i.push(s);else if(3===this.type){const e=new T;e.startX=this.endX,e.startY=(this.startY+this.endY)/2;const s=new A(5);s.startAngle=0,s.sweepAngle=360,s.centerX=(this.startX+this.endX)/2,s.centerY=(this.startY+this.endY)/2,s.radiusX=Math.abs(this.startX-this.endX)/2,s.radiusY=Math.abs(this.startY-this.endY)/2,e.add(s);const o=s.Ao(e),r=o.length;if(0===r)n.push(s.centerX),n.push(s.centerY);else{let t=e.startX,i=e.startY;for(let e=0;e<r;e++){const s=o[e];S.Yn(t,i,s[2],s[3],s[4],s[5],s[6],s[7],.5,n),t=s[6],i=s[7]}}t.push(n),i.push(this.Yk(n))}else{const s=this.figures.iterator;for(;s.next();){const o=s.value;n=[],n.push(o.startX),n.push(o.startY);let r=o.startX,a=o.startY,l=r,h=a;const u=o.segments.r,c=u.length;for(let s=0;s<c;s++){const c=u[s];switch(c.type){case 1:n.length>=4&&(t.push(n),i.push(this.Yk(n))),n=[],n.push(c.endX),n.push(c.endY),r=c.endX,a=c.endY,l=r,h=a;break;case 2:n.push(c.endX),n.push(c.endY),r=c.endX,a=c.endY;break;case 3:S.Yn(r,a,c.point1X,c.point1Y,c.point2X,c.point2Y,c.endX,c.endY,.5,n),r=c.endX,a=c.endY;break;case 4:S.Vg(r,a,c.point1X,c.point1Y,c.endX,c.endY,.5,n),r=c.endX,a=c.endY;break;case 5:{const t=c.Ao(o),e=t.length;if(0===e){n.push(c.centerX),n.push(c.centerY),r=c.centerX,a=c.centerY;break}for(let i=0;i<e;i++){const e=t[i];S.Yn(r,a,e[2],e[3],e[4],e[5],e[6],e[7],.5,n),r=e[6],a=e[7]}break}case 6:{const t=c.Yh(o,r,a),e=t.length,i=c.endX,s=c.endY;if(0===e){n.push(i),n.push(s),r=i,a=s;break}for(let o=0;o<e;o++){const e=t[o];S.Yn(r,a,e[2],e[3],e[4],e[5],e[6],e[7],.5,n),r=e[6],a=e[7]}break}default:e.o("Segment not of valid type: "+c.type)}c.isClosed&&(n.push(l),n.push(h))}n.length>=4&&(t.push(n),i.push(this.Yk(n)))}}}get type(){return this.$}set type(t){this.$!==t&&(this.h&&e.D(this,t),this.$=t,4===t?this.Bs=new l:(null===N.Pw&&(N.Pw=(new l).u()),this.Bs=N.Pw),this.kt=!0)}get startX(){return this.ke}set startX(t){this.ke!==t&&(this.h&&e.D(this,t),this.ke=t,this.kt=!0)}get startY(){return this.Pe}set startY(t){this.Pe!==t&&(this.h&&e.D(this,t),this.Pe=t,this.kt=!0)}get endX(){return this.ie}set endX(t){this.ie!==t&&(this.h&&e.D(this,t),this.ie=t,this.kt=!0)}get endY(){return this.ee}set endY(t){this.ee!==t&&(this.h&&e.D(this,t),this.ee=t,this.kt=!0)}get figures(){return this.Bs}set figures(t){this.Bs!==t&&(this.h&&e.D(this,t),this.Bs=t,this.kt=!0)}add(t){return this.Bs.add(t),this}setSpots(t,i,n,s,o,r,a,l){return this.h&&e.D(this),this.Hn=new w(t,i,o,r).u(),this.jn=new w(n,s,a,l).u(),this}get spot1(){return this.Hn}set spot1(t){this.h&&e.D(this,t),this.Hn=t.N()}get spot2(){return this.jn}set spot2(t){this.h&&e.D(this,t),this.jn=t.N()}get defaultStretch(){return this.qn}set defaultStretch(t){this.qn=t}get bounds(){return this.Vk()&&this.Mw(),this.jg}}N.stringify=N.stringify,N.stringifyFixed=N.stringifyFixed,N.fillPath=N.fillPath,N.parse=N.parse;class T{n;ke;Pe;dc;Jg;Ve;constructor(t,e,i,n,s){void 0===i&&(i=!0),void 0===n&&(n=!0),void 0===s&&(s=!1),this.n=2|(i?4:0)|(n?8:0)|(s?16:0),this.ke=void 0!==t?t:0,this.Pe=void 0!==e?e:0,this.dc=new l,this.Jg=this.dc.ht,this.Ve=null}copy(){const t=new T;t.n=-2&this.n,t.ke=this.ke,t.Pe=this.Pe;const e=this.dc.r,i=e.length,n=t.dc;for(let s=0;s<i;s++){const t=e[s].copy();n.add(t)}return t.Jg=this.Jg,t.Ve=this.Ve,t}equalsApprox(t){if(!(t instanceof T)||!S.f(this.startX,t.startX)||!S.f(this.startY,t.startY))return!1;const e=this.segments.r,i=t.segments.r,n=e.length;if(n!==i.length)return!1;for(let s=0;s<n;s++){const t=e[s],n=i[s];if(!t.equalsApprox(n))return!1}return!0}toString(t){void 0===t&&(t=-1);let e="";if(t<0)e="M"+this.startX.toString()+" "+this.startY.toString();else{const i=e=>0===e?"0":e.toFixed(t);e="M"+i(this.startX)+" "+i(this.startY)}const i=this.segments.r,n=i.length;for(let s=0;s<n;s++){e+=" "+i[s].toString(t)}return e}get h(){return 0!==(1&this.n)}set h(t){t?this.n|=1:this.n&=-2}get kt(){return 0!==(2&this.n)}set kt(t){t?this.n|=2:this.n&=-3}u(){this.h=!0;const t=this.segments;t.u();const e=t.r,i=t.length;for(let n=0;n<i;n++)e[n].u();return this}Vk(){if(this.kt)return!0;const t=this.segments;if(this.Jg!==t.ht)return!0;for(const e of t)if(e.kt)return!0;return!1}eF(){this.kt=!1,this.Ve=null;const t=this.segments;this.Jg=t.ht;for(const e of t)e.kt=!1,e.Us=null}get isFilled(){return 0!==(4&this.n)}set isFilled(t){this.h&&e.D(this,t),t?this.n|=4:this.n&=-5}get isShadowed(){return 0!==(8&this.n)}set isShadowed(t){this.h&&e.D(this,t),t?this.n|=8:this.n&=-9}get isEvenOdd(){return 0!==(16&this.n)}set isEvenOdd(t){this.h&&e.D(this,t),t?this.n|=16:this.n&=-17}get startX(){return this.ke}set startX(t){this.h&&e.D(this,t),this.ke=t,this.Ve=null,this.kt=!0}get startY(){return this.Pe}set startY(t){this.h&&e.D(this,t),this.Pe=t,this.Ve=null,this.kt=!0}get segments(){return this.dc}set segments(t){this.h&&e.D(this,t),this.dc=t,this.Ve=null,this.kt=!0}add(t){return this.dc.add(t),this.Ve=null,this}Xk(t,i,n){const s=this;let o=s.startX,r=s.startY,a=o,l=r;const h=s.segments.r,u=h.length;for(let c=0;c<u;c++){const u=h[c];switch(u.type){case 1:a=u.endX,l=u.endY,o=u.endX,r=u.endY;break;case 2:if(S.Ei(o,r,u.endX,u.endY,n,t,i))return!0;o=u.endX,r=u.endY;break;case 3:if(S.bw(o,r,u.point1X,u.point1Y,u.point2X,u.point2Y,u.endX,u.endY,.5,t,i,n))return!0;o=u.endX,r=u.endY;break;case 4:if(S.Bk(o,r,u.point1X,u.point1Y,u.endX,u.endY,.5,t,i,n))return!0;o=u.endX,r=u.endY;break;case 5:case 6:const h=5===u.type?u.Ao(s):u.Yh(s,o,r),c=h.length,d=5===u.type?u.centerX:u.endX,f=5===u.type?u.centerY:u.endY;if(0===c){if(S.Ei(o,r,d,f,n,t,i))return!0;o=d,r=f;break}let g=null;for(let e=0;e<c;e++)if(g=h[e],0===e&&S.Ei(o,r,g[0],g[1],n,t,i)||S.bw(g[0],g[1],g[2],g[3],g[4],g[5],g[6],g[7],.5,t,i,n))return!0;null!==g&&(o=g[6],r=g[7]);break;default:e.o("Unknown Segment type: "+u.type)}if(u.isClosed&&(o!==a||r!==l)&&S.Ei(o,r,a,l,n,t,i))return!0}return!1}}var L=(t=>(t[t.Move=1]="Move",t[t.Line=2]="Line",t[t.Bezier=3]="Bezier",t[t.QuadraticBezier=4]="QuadraticBezier",t[t.Arc=5]="Arc",t[t.SvgArc=6]="SvgArc",t))(L||{});class A{$;n;ie;ee;cn;Pl;Sl;yr;Us;constructor(t,e,i,n,s,o,r,a){if(u.qi(this),void 0===t&&(t=2),this.$=t,this.n=2,this.ie=void 0!==e?e:0,this.ee=void 0!==i?i:0,void 0===n&&(n=0),void 0===s&&(s=0),void 0===o&&(o=0),void 0===r&&(r=0),6===t){let t=o;t%=360,t<0&&(t+=360),this.cn=t,this.Pl=0,this.Sl=Math.max(n,0),this.yr=Math.max(s,0),"boolean"==typeof r?r&&(this.isLargeArc=!0):"number"==typeof r&&r&&(this.isLargeArc=!0),a&&(this.isClockwiseArc=!0)}else this.cn=n,this.Pl=s,5===t&&(o=Math.max(o,0)),this.Sl=o,"number"==typeof r?(5===t&&(r=Math.max(r,0)),this.yr=r):this.yr=0;this.Us=null}copy(){const t=new A;return t.$=this.$,t.n=-2&this.n,t.ie=this.ie,t.ee=this.ee,t.cn=this.cn,t.Pl=this.Pl,t.Sl=this.Sl,t.yr=this.yr,t}equalsApprox(t){if(!(t instanceof A)||this.type!==t.type||this.isClosed!==t.isClosed)return!1;switch(this.type){case 1:case 2:return S.f(this.endX,t.endX)&&S.f(this.endY,t.endY);case 3:return S.f(this.endX,t.endX)&&S.f(this.endY,t.endY)&&S.f(this.point1X,t.point1X)&&S.f(this.point1Y,t.point1Y)&&S.f(this.point2X,t.point2X)&&S.f(this.point2Y,t.point2Y);case 4:return S.f(this.endX,t.endX)&&S.f(this.endY,t.endY)&&S.f(this.point1X,t.point1X)&&S.f(this.point1Y,t.point1Y);case 5:return S.f(this.startAngle,t.startAngle)&&S.f(this.sweepAngle,t.sweepAngle)&&S.f(this.centerX,t.centerX)&&S.f(this.centerY,t.centerY)&&S.f(this.radiusX,t.radiusX)&&S.f(this.radiusY,t.radiusY);case 6:return this.isClockwiseArc===t.isClockwiseArc&&this.isLargeArc===t.isLargeArc&&S.f(this.xAxisRotation,t.xAxisRotation)&&S.f(this.endX,t.endX)&&S.f(this.endY,t.endY)&&S.f(this.radiusX,t.radiusX)&&S.f(this.radiusY,t.radiusY);default:return!1}}hi(t){t in L?this.type=t:e.cr(this,t)}toString(t){void 0===t&&(t=-1);const e=e=>0===e?"0":e.toFixed(t);let i="";switch(this.type){case 1:i=t<0?"M"+this.endX.toString()+" "+this.endY.toString():"M"+e(this.endX)+" "+e(this.endY);break;case 2:i=t<0?"L"+this.endX.toString()+" "+this.endY.toString():"L"+e(this.endX)+" "+e(this.endY);break;case 3:i=t<0?"C"+this.point1X.toString()+" "+this.point1Y.toString()+" "+this.point2X.toString()+" "+this.point2Y.toString()+" "+this.endX.toString()+" "+this.endY.toString():"C"+e(this.point1X)+" "+e(this.point1Y)+" "+e(this.point2X)+" "+e(this.point2Y)+" "+e(this.endX)+" "+e(this.endY);break;case 4:i=t<0?"Q"+this.point1X.toString()+" "+this.point1Y.toString()+" "+this.endX.toString()+" "+this.endY.toString():"Q"+e(this.point1X)+" "+e(this.point1Y)+" "+e(this.endX)+" "+e(this.endY);break;case 5:i=t<0?"B"+this.startAngle.toString()+" "+this.sweepAngle.toString()+" "+this.centerX.toString()+" "+this.centerY.toString()+" "+this.radiusX.toString()+" "+this.radiusY.toString():"B"+e(this.startAngle)+" "+e(this.sweepAngle)+" "+e(this.centerX)+" "+e(this.centerY)+" "+e(this.radiusX)+" "+e(this.radiusY);break;case 6:i=t<0?"A"+this.radiusX.toString()+" "+this.radiusY.toString()+" "+this.xAxisRotation.toString()+" "+(this.isLargeArc?1:0)+" "+(this.isClockwiseArc?1:0)+" "+this.endX.toString()+" "+this.endY.toString():"A"+e(this.radiusX)+" "+e(this.radiusY)+" "+e(this.xAxisRotation)+" "+(this.isLargeArc?1:0)+" "+(this.isClockwiseArc?1:0)+" "+e(this.endX)+" "+e(this.endY);break;default:i=L[this.type]}return i+(this.isClosed?"z":"")}static Move=1;static Line=2;static Bezier=3;static QuadraticBezier=4;static Arc=5;static SvgArc=6;get h(){return 0!==(1&this.n)}set h(t){t?this.n|=1:this.n&=-2}get kt(){return 0!==(2&this.n)}set kt(t){t?this.n|=2:this.n&=-3}u(){return this.h=!0,this}close(){return this.isClosed=!0,this}Ao(t){if(null!==this.Us&&!1===t.kt)return this.Us;const e=this.radiusX;let i=this.radiusY;if(void 0===i&&(i=e),0===e||0===i)return this.Us=[],this.Us;const n=this.cn,s=this.Pl,o=S.SC(0,0,e<i?e:i,this.startAngle,this.startAngle+this.sweepAngle,!1);if(e!==i){const t=k.l();t.Ii(),e<i?t.nt(1,i/e):t.nt(e/i,1),N.AC(o,t),k.e(t)}const r=o.length;for(let a=0;a<r;a++){const t=o[a];t[0]+=n,t[1]+=s,t[2]+=n,t[3]+=s,t[4]+=n,t[5]+=s,t[6]+=n,t[7]+=s}return this.Us=o,this.Us}Yh(t,e,i){if(null!==this.Us&&!1===t.kt)return this.Us;if(0===this.radiusX||0===this.radiusY)return this.Us=[],this.Us;const n=e,s=i;let o=this.Sl,r=this.yr;0===o&&(o=1e-4),0===r&&(r=1e-4);const a=this.cn*(Math.PI/180),l=this.isLargeArc,h=this.isClockwiseArc,u=this.ie,c=this.ee,d=Math.cos(a),f=Math.sin(a),g=d*(n-u)/2+f*(s-c)/2,m=-f*(n-u)/2+d*(s-c)/2,p=g*g/(o*o)+m*m/(r*r);p>1&&(o*=Math.sqrt(p),r*=Math.sqrt(p));let y=(l===h?-1:1)*Math.sqrt((o*o*r*r-o*o*m*m-r*r*g*g)/(o*o*m*m+r*r*g*g));isNaN(y)&&(y=0);let x=y*o*m/r,b=y*-r*g/o;isNaN(x)&&(x=0),isNaN(b)&&(b=0);const v=(n+u)/2+d*x-f*b,w=(s+c)/2+f*x+d*b,P=(t,e)=>Math.sqrt(t*t+e*e),M=(t,e,i,n)=>(t*i+e*n)/(P(t,e)*P(i,n)),C=(t,e,i,n)=>(t*n<e*i?-1:1)*Math.acos(M(t,e,i,n)),T=C(1,0,(g-x)/o,(m-b)/r),L=(g-x)/o,A=(m-b)/r,D=(-g-x)/o,F=(-m-b)/r;let O=C(L,A,D,F);const R=M(L,A,D,F);R<=-1?O=Math.PI:R>=1&&(O=0),!h&&O>0&&(O-=2*Math.PI),h&&O<0&&(O+=2*Math.PI);const E=o>r?o:r,B=o>r?1:o/r,I=o>r?r/o:1,z=S.SC(0,0,E,T,T+O,!0),V=k.l();return V.Ii(),V.Es(v,w),V.ds(this.cn,0,0),V.nt(B,I),N.AC(z,V),k.e(V),this.Us=z,this.Us}get isClosed(){return 0!==(8&this.n)}set isClosed(t){this.isClosed!==t&&(t?this.n|=8:this.n&=-9,this.kt=!0)}get type(){return this.$}set type(t){this.h&&e.D(this,t),this.$=t,this.kt=!0}get endX(){return this.ie}set endX(t){this.h&&e.D(this,t),this.ie=t,this.kt=!0}get endY(){return this.ee}set endY(t){this.h&&e.D(this,t),this.ee=t,this.kt=!0}get point1X(){return this.cn}set point1X(t){this.h&&e.D(this,t),this.cn=t,this.kt=!0}get point1Y(){return this.Pl}set point1Y(t){this.h&&e.D(this,t),this.Pl=t,this.kt=!0}get point2X(){return this.Sl}set point2X(t){this.h&&e.D(this,t),this.Sl=t,this.kt=!0}get point2Y(){return this.yr}set point2Y(t){this.h&&e.D(this,t),this.yr=t,this.kt=!0}get centerX(){return this.cn}set centerX(t){this.h&&e.D(this,t),this.cn=t,this.kt=!0}get centerY(){return this.Pl}set centerY(t){this.h&&e.D(this,t),this.Pl=t,this.kt=!0}get radiusX(){return this.Sl}set radiusX(t){t<0&&e._(t,">= zero",A,"radiusX"),this.h&&e.D(this,t),this.Sl=t,this.kt=!0}get radiusY(){return this.yr}set radiusY(t){t<0&&e._(t,">= zero",A,"radiusY"),this.h&&e.D(this,t),this.yr=t,this.kt=!0}get startAngle(){return this.ie}set startAngle(t){this.h&&e.D(this,t),(t%=360)<0&&(t+=360),this.ie=t,this.kt=!0}get sweepAngle(){return this.ee}set sweepAngle(t){this.h&&e.D(this,t),t>360&&(t=360),t<-360&&(t=-360),this.ee=t,this.kt=!0}get isClockwiseArc(){return 0!==(4&this.n)}set isClockwiseArc(t){this.h&&e.D(this,t),t?this.n|=4:this.n&=-5,this.kt=!0}get isLargeArc(){return 0!==(16&this.n)}set isLargeArc(t){this.h&&e.D(this,t),t?this.n|=16:this.n&=-17,this.kt=!0}get xAxisRotation(){return this.cn}set xAxisRotation(t){this.h&&e.D(this,t),(t%=360)<0&&(t+=360),this.cn=t,this.kt=!0}}class D{L;Cw;Lw;$g;Zg;Qg;_g;tm;im;em;sm;nm;om;rm;To;lm;hm;am;Se;constructor(){this.L=null,this.Cw=new y(0,0).u(),this.Lw=new y(0,0).u(),this.$g=0,this.Zg=0,this.Qg=1,this._g="",this.tm="",this.im=!1,this.em=!1,this.sm=0,this.nm=0,this.om=!1,this.rm=!1,this.To=!1,this.lm=null,this.hm=0,this.am=null,this.Se=null}copy(){const t=new D;return this.clone(t)}clone(t){return t.L=this.L,t.Cw.a(this.viewPoint),t.Lw.a(this.documentPoint),t.$g=this.$g,t.Zg=this.Zg,t.Qg=this.Qg,t._g=this._g,t.tm=this.tm,t.im=this.im,t.em=this.em,t.sm=this.sm,t.nm=this.nm,t.om=this.om,t.rm=this.rm,t.To=this.To,t.lm=this.lm,t.hm=this.hm,t.am=this.am,t.Se=this.Se,t}toString(){let t="^";return 0!==this.modifiers&&(t+="M:"+this.modifiers),0!==this.button&&(t+="B:"+this.button),""!==this.key&&(t+="K:"+this.key),0!==this.clickCount&&(t+="C:"+this.clickCount),0!==this.delta&&(t+="D:"+this.delta),this.handled&&(t+="h"),this.bubbles&&(t+="b"),null!==this.documentPoint&&(t+="@"+this.documentPoint.toString()),t}get diagram(){return this.L}set diagram(t){this.L=t}get viewPoint(){return this.Cw}set viewPoint(t){this.Cw.a(t)}get documentPoint(){return this.Lw}set documentPoint(t){this.Lw.a(t)}getMultiTouchViewPoint(t,e){const i=this.diagram;return null===i||i.RC(this.event,t,e),e}getMultiTouchDocumentPoint(t,e){const i=this.diagram;return null===i||(i.RC(this.event,t,e),e.a(i.transformViewToDoc(e))),e}get modifiers(){return this.$g}set modifiers(t){this.$g=t}get button(){return this.Zg}set button(t){if(this.Zg=t,null===this.event)switch(t){case 0:return void(this.buttons=1);case 1:return void(this.buttons=4);case 2:return void(this.buttons=2)}}get buttons(){return this.Qg}set buttons(t){this.Qg=t}get key(){return this._g}set key(t){this._g=t}get code(){return this.tm}set code(t){this.tm=t}get down(){return this.im}set down(t){this.im=t}get up(){return this.em}set up(t){this.em=t}get clickCount(){return this.sm}set clickCount(t){this.sm=t}get delta(){return this.nm}set delta(t){this.nm=t}get isMultiTouch(){return this.om}set isMultiTouch(t){this.om=t}get handled(){return this.rm}set handled(t){this.rm=t}get bubbles(){return this.To}set bubbles(t){this.To=t}get event(){return this.lm}set event(t){this.lm=t}get isTouchEvent(){const t=this.event;return null!==t&&("touch"===t.pointerType||"pen"===t.pointerType)}get timestamp(){return this.hm}set timestamp(t){this.hm=t}get targetDiagram(){return this.am}set targetDiagram(t){this.am=t}get targetObject(){return this.Se}set targetObject(t){this.Se=t}get control(){return 0!==(1&this.modifiers)}set control(t){this.modifiers=t?1|this.modifiers:-2&this.modifiers}get shift(){return 0!==(4&this.modifiers)}set shift(t){this.modifiers=t?4|this.modifiers:-5&this.modifiers}get alt(){return 0!==(2&this.modifiers)}set alt(t){this.modifiers=t?2|this.modifiers:-3&this.modifiers}get meta(){return 0!==(8&this.modifiers)}set meta(t){this.modifiers=t?8|this.modifiers:-9&this.modifiers}get left(){const t=this.event;return null===t||"mousedown"!==t.type&&"mouseup"!==t.type&&"pointerdown"!==t.type&&"pointerup"!==t.type?0!==(1&this.buttons):0===this.button}set left(t){t?this.buttons|=1:this.buttons&=-2}get right(){const t=this.event;return null===t||"mousedown"!==t.type&&"mouseup"!==t.type&&"pointerdown"!==t.type&&"pointerup"!==t.type?0!==(2&this.buttons):2===this.button}set right(t){t?this.buttons|=2:this.buttons&=-3}get middle(){const t=this.event;return null===t||"mousedown"!==t.type&&"mouseup"!==t.type&&"pointerdown"!==t.type&&"pointerup"!==t.type?0!==(4&this.buttons):1===this.button}set middle(t){t?this.buttons|=4:this.buttons&=-5}get commandKey(){const t=this.code,e=this.key;return"cxvyzagCXVYZAG".includes(e)?e.toLowerCase():"KeyC"===t?"c":"KeyX"===t?"x":"KeyV"===t?"v":"KeyY"===t?"y":"KeyZ"===t?"z":"KeyA"===t?"a":"KeyG"===t?"g":""!==t?t:e}}class F{L;Nt;cm;fm;constructor(){this.L=null,this.Nt="",this.cm=null,this.fm=null}copy(){const t=new F;return t.L=this.L,t.Nt=this.Nt,t.cm=this.cm,t.fm=this.fm,t}toString(){let t="*"+this.name;return null!==this.subject&&(t+=":"+this.subject.toString()),null!==this.parameter&&(t+="("+this.parameter.toString()+")"),t}get diagram(){return this.L}set diagram(t){this.L=t}get name(){return this.Nt}set name(t){this.Nt=t}get subject(){return this.cm}set subject(t){this.cm=t}get parameter(){return this.fm}set parameter(t){this.fm=t}}var O=(t=>(t[t.Transaction=1]="Transaction",t[t.Property=2]="Property",t[t.Insert=3]="Insert",t[t.Remove=4]="Remove",t))(O||{});class R{mu;um;fn;Mi;L;pu;gc;mc;pc;yc;constructor(){this.mu=2,this.um="",this.fn="",this.Mi=null,this.L=null,this.pu=null,this.gc=null,this.mc=null,this.pc=null,this.yc=null}static Transaction=1;static Property=2;static Insert=3;static Remove=4;clear(){this.Mi=null,this.L=null,this.pu=null,this.gc=null,this.mc=null,this.pc=null,this.yc=null}copy(){const t=new R;t.mu=this.mu,t.um=this.um,t.fn=this.fn,t.Mi=this.Mi,t.L=this.L,t.pu=this.pu;let i=this.gc;return e.H(i)&&e.ot(i.copyFrozen)?t.gc=i.copyFrozen():t.gc=i,i=this.mc,e.H(i)&&e.ot(i.copyFrozen)?t.mc=i.copyFrozen():t.mc=i,i=this.pc,e.H(i)&&e.ot(i.copyFrozen)?t.pc=i.copyFrozen():t.pc=i,i=this.yc,e.H(i)&&e.ot(i.copyFrozen)?t.yc=i.copyFrozen():t.yc=i,t}hi(t){t in O?this.change=t:e.cr(this,t)}toString(){let t="";return 1===this.change?t+="* ":2===this.change?t+=null!==this.model?"!m":"!d":t+=(null!==this.model?"!m":"!d")+this.change,this.propertyName&&"string"==typeof this.propertyName&&(t+=" "+this.propertyName),this.modelChange&&this.modelChange!==this.propertyName&&(t+=" "+this.modelChange),t+=": ",1===this.change?null!==this.oldValue&&(t+=" "+this.oldValue):(null!==this.object&&(t+=e.toString(this.object)),null!==this.oldValue&&(t+="  old: "+e.toString(this.oldValue)),null!==this.oldParam&&(t+=" "+this.oldParam),null!==this.newValue&&(t+="  new: "+e.toString(this.newValue)),null!==this.newParam&&(t+=" "+this.newParam)),t}getValue(t){return t?this.oldValue:this.newValue}getParam(t){return t?this.oldParam:this.newParam}canUndo(){return null!==this.model||null!==this.diagram}undo(){this.canUndo()&&(null!==this.model?this.model.changeState(this,!0):null!==this.diagram&&this.diagram.vC(this,!0))}canRedo(){return null!==this.model||null!==this.diagram}redo(){this.canRedo()&&(null!==this.model?this.model.changeState(this,!1):null!==this.diagram&&this.diagram.vC(this,!1))}get model(){return this.Mi}set model(t){this.Mi=t}get diagram(){return this.L}set diagram(t){this.L=t}get change(){return this.mu}set change(t){this.mu=t}get modelChange(){return this.um}set modelChange(t){this.um=t}get propertyName(){return this.fn}set propertyName(t){this.fn=t}get isTransactionFinished(){return 1===this.mu&&("CommittedTransaction"===this.fn||"FinishedUndo"===this.fn||"FinishedRedo"===this.fn)}get object(){return this.pu}set object(t){this.pu=t}get oldValue(){return this.gc}set oldValue(t){this.gc=t}get oldParam(){return this.mc}set oldParam(t){this.mc=t}get newValue(){return this.pc}set newValue(t){this.pc=t}get newParam(){return this.yc}set newParam(t){this.yc=t}}class E{OC;Nt;Kk;constructor(){this.OC=(new l).u(),this.Nt="",this.Kk=!1}toString(t){let e="Transaction: "+this.name+" "+this.changes.count.toString()+(this.isComplete?"":", incomplete");if(void 0!==t&&t>0){const t=this.changes.count;for(let i=0;i<t;i++){const t=this.changes.elt(i);null!==t&&(e+="\n  "+t.toString())}}return e}clear(){const t=this.changes;t.At();for(let e=t.count-1;e>=0;e--){const i=t.elt(e);null!==i&&i.clear()}t.clear(),t.u()}canUndo(){return this.isComplete}undo(){if(this.canUndo())for(let t=this.changes.count-1;t>=0;t--){const e=this.changes.elt(t);null!==e&&e.undo()}}canRedo(){return this.isComplete}redo(){if(!this.canRedo())return;const t=this.changes.count;for(let e=0;e<t;e++){const t=this.changes.elt(e);null!==t&&t.redo()}}oF(t){const e=this.changes;for(let i=e.count-1;i>=t;i--){const t=e.elt(i);null!==t&&t.undo(),e.At(),e.removeAt(i)}e.u()}optimize(){if(!this.isComplete)return;const t=this.changes;t.At();const e=new p;for(let n=0;n<t.count;n++){const i=t.elt(n);if(null===i||2!==i.change||!i.object)continue;let s=e.get(i.object);s||(s=new p,e.set(i.object,s));const o=s.get(i.propertyName);null===o?s.set(i.propertyName,-1):(o>0&&t.setElt(o,null),s.set(i.propertyName,n))}let i=0;for(let n=0;n<t.count;n++){const e=t.elt(n);null!==e&&(n>i&&t.setElt(i,e),i++)}for(;t.length>i;)t.pop();t.u()}get changes(){return this.OC}get name(){return this.Nt}set name(t){this.Nt=t}get isComplete(){return this.Kk}set isComplete(t){this.Kk=t}}class B{Aw;Bi;IC;Vs;Gk;dm;Wn;Hk;jk;un;wc;Tw;zs;Dw;Fw;gm;Rw;constructor(t){this.Aw=new u,this.Bi=!1,this.IC=(new l).u(),this.Vs=-1,this.Gk=999,this.zs=!1,this.dm=null,this.Wn=0,this.Hk=!1,this.jk=23,this.un=(new l).u(),this.wc=new l,this.Tw=!0,this.Dw=!1,this.Fw=!1,this.gm=!1,this.Rw=!1,t&&Object.assign(this,t)}toString(t){let e="UndoManager "+this.historyIndex+"<"+this.history.count+"<="+this.maxHistoryLength;e+="[";let i=this.nestedTransactionNames.count;for(let n=0;n<i;n++)n>0&&(e+=" "),e+=this.nestedTransactionNames.elt(n);if(e+="]",void 0!==t&&t>0){i=this.history.count;for(let n=0;n<i;n++)e+="\n "+this.history.elt(n).toString(t-1)}return e}clear(){const t=this.history;t.At();for(let e=t.count-1;e>=0;e--){const i=t.elt(e);null!==i&&i.clear()}t.clear(),this.Vs=-1,t.u(),this.zs=!1,this.dm=null,this.Wn=0,this.un.At(),this.un.clear(),this.un.u(),this.wc.clear(),this.Dw=!1,this.Fw=!1,this.gm=!1,this.Rw=!1}copyProperties(t){this.isEnabled=t.isEnabled,this.maxHistoryLength=t.maxHistoryLength,this.mm=t.mm}addModel(t){this.Aw.add(t)}removeModel(t){this.Aw.delete(t)}startTransaction(t){if(void 0===t&&(t=""),null===t&&(t=""),this.isUndoingRedoing)return!1;!0===this.Tw&&(this.Tw=!1,this.Wn++,this.Ml||this.Nl("StartingFirstTransaction",t,this.currentTransaction),this.Wn>0&&this.Wn--),this.isEnabled&&(this.un.At(),this.un.add(t),this.un.u(),null===this.currentTransaction?this.wc.add(0):this.wc.add(this.currentTransaction.changes.count)),this.Wn++;const e=1===this.transactionLevel;return e&&(this.Ml||this.Nl("StartedTransaction",t,this.currentTransaction)),e}commitTransaction(t){return void 0===t&&(t=""),this.EC(!0,t)}rollbackTransaction(){return this.EC(!1,"")}EC(t,i){if(this.isUndoingRedoing)return!1;this.mm&&this.transactionLevel<1&&e.li("Ending transaction without having started a transaction: "+i);const n=1===this.transactionLevel;let s=this.currentTransaction;n&&t&&(this.Ml||this.Nl("CommittingTransaction",i,s));let o=0;if(this.transactionLevel>0&&(this.Wn--,this.isEnabled)){const t=this.un.count;t>0&&(""===i&&(i=this.un.elt(0)),this.un.At(),this.un.removeAt(t-1),this.un.u());const e=this.wc.count;e>0&&(o=this.wc.elt(e-1),this.wc.removeAt(e-1))}if(n){if(t){if(this.gm=!1,null===s&&""!==i&&(s=this.currentTransaction),this.isEnabled&&null!==s){const t=s;t.isComplete||(t.isComplete=!0,t.name=i),this.discardHistoryAfterIndex();const e=this.history;e.At();const n=this.maxHistoryLength;if(n>=0)if(0===n)e.clear();else if(e.count>=n){const t=e.elt(0);null!==t&&t.clear(),e.removeAt(0),this.Vs--}0!==n&&(0===e.count||e.get(e.count-1)!==t)&&(e.add(t),this.Vs++),e.u(),s=t}this.Ml||this.Nl("CommittedTransaction",i,s)}else{this.zs=!0;try{this.isEnabled&&null!==s&&(s.isComplete=!0,s.undo())}finally{this.Ml||this.Nl("RolledBackTransaction",i,s),this.zs=!1}null!==s&&s.clear()}return this.dm=null,this.vw&&this.clear(),this.vw=!1,this.Ow=!1,!0}return this.isEnabled&&!t&&null!==s&&s.oF(o),!1}discardHistoryAfterIndex(){if(this.isUndoingRedoing||!this.canRedo())return;const t=this.history;t.At();for(let e=t.count-1;e>this.historyIndex;e--){const i=t.elt(e);null!==i&&i.clear(),t.removeAt(e),this.gm=!0}t.u()}pE(t){this.Wn+=t,this.Wn<0&&(this.Wn=0)}canUndo(){if(!this.isEnabled||this.transactionLevel>0)return!1;const t=this.transactionToUndo;return!(null===t||!t.canUndo())}undo(){if(!this.canUndo())return;const t=this.transactionToUndo;try{this.zs=!0,this.Nl("StartingUndo","Undo",t),this.Vs--,t.undo()}catch(i){e.li("undo error: "+i.toString())}finally{this.Nl("FinishedUndo","Undo",t),this.zs=!1}}canRedo(){if(!this.isEnabled||this.transactionLevel>0)return!1;const t=this.transactionToRedo;return!(null===t||!t.canRedo())}redo(){if(!this.canRedo())return;const t=this.transactionToRedo;try{this.zs=!0,this.Nl("StartingRedo","Redo",t),this.Vs++,t.redo()}catch(i){e.li("redo error: "+i.toString())}finally{this.Nl("FinishedRedo","Redo",t),this.zs=!1}}Nl(t,e,i){void 0===i&&(i=null);const n=new R;n.change=1,n.propertyName=t,n.object=i,n.oldValue=e;const s=this.models;for(;s.next();){const t=s.value;n.model=t,t.rF(n)}}handleChanged(t){if(this.isEnabled&&!this.isUndoingRedoing&&!this.skipsEvent(t)){let i=this.currentTransaction;null===i&&(i=new E,this.dm=i);const n=t.copy(),s=i.changes;if(s.At(),s.add(n),s.u(),this.mm&&this.jk>0&&this.transactionLevel<=0&&!this.Tw){const i=t.diagram;if(null!==i&&!1===i.Kh)return;e.li("Change not within a transaction: "+n.toString()),this.jk--}}}skipsEvent(t){if(null===t||1===t.change)return!0;const e=t.object;if(null===e)return!1;if(void 0!==e.layer){const t=e.layer;if(null!==t&&t.isTemporary)return!0}else if(e.isTemporary)return!0;return!1}get models(){return this.Aw.iterator}get isEnabled(){return this.Bi}set isEnabled(t){this.Bi=t}get transactionToUndo(){return this.historyIndex>=0&&this.historyIndex<=this.history.count-1?this.history.elt(this.historyIndex):null}get transactionToRedo(){return this.historyIndex<this.history.count-1?this.history.elt(this.historyIndex+1):null}get isUndoingRedoing(){return this.zs}get history(){return this.IC}get maxHistoryLength(){return this.Gk}set maxHistoryLength(t){this.Gk=t}get historyIndex(){return this.Vs}get currentTransaction(){return this.dm}get transactionLevel(){return this.Wn}get isInTransaction(){return this.Wn>0}get mm(){return this.Hk}set mm(t){this.Hk=t}get nestedTransactionNames(){return this.un}get vw(){return this.Dw}set vw(t){this.Dw=t}get Ow(){return this.Fw}set Ow(t){this.Fw=t}get Ml(){return this.Rw}set Ml(t){this.Rw=t}get isJustDiscarded(){return this.gm}}class I{L;Nt;Bi;qk;Wk;pm;BC;constructor(){u.qi(this),this.L=bt.ym(),this.Nt="",this.Bi=!0,this.qk=!1,this.Wk=null,this.BC=new D,this.pm=-1}get diagram(){return this.L}set diagram(t){t instanceof bt&&(this.L=t)}toString(){return""!==this.name?this.name+" Tool":e.Vn(this.constructor)}updateAdornments(t){}canStart(){return this.isEnabled}doStart(){}doActivate(){this.isActive=!0}doDeactivate(){this.isActive=!1}doStop(){}doCancel(){this.transactionResult=null,this.stopTool()}stopTool(){const t=this.diagram;t.currentTool===this&&(t.currentTool=null,t.currentCursor="")}doMouseDown(){!this.isActive&&this.canStart()&&this.doActivate()}doMouseMove(){}doMouseUp(){this.stopTool()}doMouseWheel(){}canStartMultiTouch(){return!0}standardPinchZoomStart(){const t=this.diagram,e=t.lastInput,i=e.getMultiTouchViewPoint(0,y.X(NaN,NaN)),n=e.getMultiTouchViewPoint(1,y.X(NaN,NaN));if(!i.isReal()||!n.isReal())return y.e(i),void y.e(n);if(this.doCancel(),t.getInputOption("hasGestureZoom")){t.Jk=t.scale;const s=n.x-i.x,o=n.y-i.y,r=Math.sqrt(s*s+o*o);t.$k=r,e.bubbles=!1}y.e(i),y.e(n)}standardPinchZoomMove(){const t=this.diagram,e=t.lastInput,i=e.getMultiTouchViewPoint(0,y.X(NaN,NaN)),n=e.getMultiTouchViewPoint(1,y.X(NaN,NaN));if(!i.isReal()||!n.isReal())return y.e(i),void y.e(n);if(this.doCancel(),t.getInputOption("hasGestureZoom")){const s=n.x-i.x,o=n.y-i.y,r=Math.sqrt(s*s+o*o)/t.$k,a=new y((Math.min(n.x,i.x)+Math.max(n.x,i.x))/2,(Math.min(n.y,i.y)+Math.max(n.y,i.y))/2),l=t.Jk*r,h=t.commandHandler;if(l!==t.scale&&h.canResetZoom(l)){const e=t.zoomPoint;t.zoomPoint=a,h.resetZoom(l),t.zoomPoint=e}e.bubbles=!1}y.e(i),y.e(n)}doKeyDown(){"Escape"===this.diagram.lastInput.code&&this.doCancel()}doKeyUp(){}startTransaction(t){return void 0===t&&(t=this.name),this.transactionResult=null,this.diagram.startTransaction(t)}stopTransaction(){const t=this.diagram;return null===this.transactionResult?t.rollbackTransaction():t.commitTransaction(this.transactionResult)}standardMouseSelect(){const t=this.diagram;if(!t.allowSelect)return;const i=t.lastInput,n=t.findPartAt(i.documentPoint,!1);if(null!==n){if(e.hr?i.meta:i.control){t.v("ChangingSelection",t.selection);let e=n;for(;null!==e&&!e.canSelect();)e=e.containingGroup;null!==e&&(e.isSelected=!e.isSelected),t.v("ChangedSelection",t.selection)}else if(i.shift){if(!n.isSelected){t.v("ChangingSelection",t.selection);let e=n;for(;null!==e&&!e.canSelect();)e=e.containingGroup;null!==e&&(e.isSelected=!0),t.v("ChangedSelection",t.selection)}}else if(!n.isSelected){let e=n;for(;null!==e&&!e.canSelect();)e=e.containingGroup;null!==e&&t.select(e)}}else i.left&&!(e.hr?i.meta:i.control)&&!i.shift&&t.clearSelection()}standardMouseClick(t,e){void 0===t&&(t=null),void 0===e&&(e=t=>!t.layer?.isTemporary);const i=this.diagram,n=i.lastInput,s=i.findObjectAt(n.documentPoint,t,e);return n.targetObject=s,this.lF(s,n,i),n.handled}lF(t,e,i){if(e.handled=!1,null!==t&&!t.isEnabledObject())return;let n=0;e.left?n=1===e.clickCount?1:2===e.clickCount?2:1:e.right&&1===e.clickCount&&(n=3);let s="ObjectSingleClicked";if(null!==t){switch(n){case 1:s="ObjectSingleClicked";break;case 2:s="ObjectDoubleClicked";break;case 3:s="ObjectContextClicked"}0!==n&&i.v(s,t)}else{switch(n){case 1:s="BackgroundSingleClicked";break;case 2:s="BackgroundDoubleClicked";break;case 3:s="BackgroundContextClicked"}0!==n&&i.v(s)}if(null!==t)for(;null!==t;){let i=null;switch(n){case 1:i=t.click;break;case 2:i=t.doubleClick?t.doubleClick:t.click;break;case 3:i=t.contextClick}if(null!==i&&(i(e,t),e.handled))break;t=t.panel}else{let t=null;switch(n){case 1:t=i.click;break;case 2:t=i.doubleClick?i.doubleClick:i.click;break;case 3:t=i.contextClick}null!==t&&t(e)}}standardMouseOver(){const t=this.diagram,e=t.lastInput;if(!0===t.animationManager.xi)return;const i=t.skipsUndoManager;t.skipsUndoManager=!0;let n=t.viewportBounds.containsPoint(e.documentPoint)?t.findObjectAt(e.documentPoint,null,null):null;e.event&&("pointercancel"===e.event.type||"pointerout"===e.event.type)&&(n=null),e.targetObject=n;let s=!1;if(n!==t.xc){let i=t.xc;const o=i;for(t.xc=n,this.doCurrentObjectChanged(i,n),e.handled=!1;null!==i;){const t=i.mouseLeave;if(null!==t&&(n===i||null!==n&&n.isContainedBy(i)||(t(e,i,n),s=!0,e.handled)))break;i=i.panel}for(i=o,e.handled=!1;null!==n;){const t=n.mouseEnter;if(null!==t&&(i===n||null!==i&&i.isContainedBy(n)||(t(e,n,i),s=!0,e.handled)))break;n=n.panel}n=t.xc}if(null!==n){let i=n,o="";for(;null!==i&&(o=i.cursor,""===o);)i=i.panel;for(t.currentCursor=o,e.handled=!1,i=n;null!==i;){const t=i.mouseOver;if(null!==t&&(t(e,i),s=!0,e.handled))break;i=i.panel}}else{this.doUpdateCursor(null);const i=t.mouseOver;null!==i&&(i(e),s=!0)}s&&t.requestUpdate(),t.skipsUndoManager=i}doUpdateCursor(t){const e=this.diagram;e&&(e.currentCursor="")}doCurrentObjectChanged(t,e){}standardMouseWheel(){const t=this.diagram,e=t.lastInput;let i=e.delta;if(0===i||!t.documentBounds.isReal())return;const n=t.commandHandler,s=t.toolManager.mouseWheelBehavior;if(null!==n&&(2===s&&!e.shift||1===s&&e.control)){if(i>0?n.canIncreaseZoom():n.canDecreaseZoom()){const s=t.zoomPoint;t.zoomPoint=e.viewPoint,i>0?n.increaseZoom():n.decreaseZoom(),t.zoomPoint=s}e.bubbles=!1}else if(2===s&&e.shift||1===s&&!e.control){const n=t.position.copy(),s=e.event,o=s.deltaMode;let r=s.deltaX,a=s.deltaY,l="pixel";if(0===r&&0===a||e.shift)!e.shift&&t.allowVerticalScroll?(i=3*i*t.scrollVerticalLineChange,t.scroll(l,i>0?"up":"down",Math.abs(i))):e.shift&&t.allowHorizontalScroll&&(i=3*i*t.scrollHorizontalLineChange,t.scroll(l,i>0?"left":"right",Math.abs(i)));else{switch(o){case 0:l="pixel";break;case 1:l="line";break;case 2:l="page"}if(0!==r&&t.allowHorizontalScroll){r*=t.scrollHorizontalLineChange/16,t.scroll(l,r>0?"right":"left",Math.abs(r))}if(0!==a&&t.allowVerticalScroll){a*=t.scrollVerticalLineChange/16,t.scroll(l,a>0?"down":"up",Math.abs(a))}}this.doWheelChange(t,n,e)}}doWheelChange(t,e,i){(!t.position.equals(e)||0!==i.event.wheelDeltaX)&&(i.bubbles=!1)}standardWaitAfter(t,i){void 0===i&&(i=this.diagram.lastInput),this.cancelWaitAfter();const n=this,s=i.clone(this.BC);this.pm=e.ar((()=>n.doWaitAfter(s)),t)}cancelWaitAfter(){-1!==this.pm&&e.Og(this.pm),this.pm=-1}doWaitAfter(t){}findToolHandleAt(t,e){const i=this.diagram.findObjectAt(t,(t=>{for(;null!==t&&!(t.panel instanceof fe);)t=t.panel;return t}));return null===i?null:i.part.category===e?i:null}isBeyondDragSize(t,e){const i=this.diagram;void 0===t&&(t=i.firstInput.viewPoint),void 0===e&&(e=i.lastInput.viewPoint);const n=i.toolManager.dragSize;let s=n.width,o=n.height;return i.firstInput.isTouchEvent&&(s+=6,o+=6),Math.abs(e.x-t.x)>s||Math.abs(e.y-t.y)>o}get name(){return this.Nt}set name(t){e.s(t,"string",I,"name"),this.Nt=t}get isEnabled(){return this.Bi}set isEnabled(t){e.s(t,"boolean",I,"isEnabled"),this.Bi=t}get isActive(){return this.qk}set isActive(t){e.s(t,"boolean",I,"isActive"),this.qk=t}get transactionResult(){return this.Wk}set transactionResult(t){null!==t&&e.s(t,"string",I,"transactionResult"),this.Wk=t}}var z=(t=>(t[t.Scroll=1]="Scroll",t[t.Zoom=2]="Zoom",t[t.None=3]="None",t))(z||{}),V=(t=>(t[t.Zoom=1]="Zoom",t[t.Cancel=2]="Cancel",t[t.None=3]="None",t))(V||{});class j extends I{UC;VC;zC;Zk;Qk;_k;tP;iP;eP;sP;wm;Gh;constructor(t){super(),this.name="ToolManager",this.UC=new l,this.VC=new l,this.zC=new l,this.Zk=850,this.Qk=850,this._k=new x(2,2).it(),this.tP=5e3,this.iP=1,this.eP=1,this.sP=null,this.wm=null,this.Gh=-1,t&&Object.assign(this,t)}static WheelScroll=1;static WheelZoom=2;static WheelNone=3;static GestureZoom=1;static GestureCancel=2;static GestureNone=3;get mouseWheelBehavior(){return this.iP}set mouseWheelBehavior(t){this.iP=t}get gestureBehavior(){return this.eP}set gestureBehavior(t){this.eP=t}initializeStandardTools(){}updateAdornments(t){const e=this.currentToolTip;if(e instanceof fe&&this.wm===t){const i=e.adornedObject;(null!==t?null!==i&&i.part===t:null===i)?this.showToolTip(e,i):this.hideToolTip()}}doMouseDown(){const t=this.diagram,e=t.lastInput;if(e.isTouchEvent&&2===this.gestureBehavior&&(e.bubbles=!1),e.isMultiTouch){if(this.cancelWaitAfter(),3===this.gestureBehavior)return void(e.bubbles=!0);if(2===this.gestureBehavior)return;if(t.currentTool.canStartMultiTouch())return void t.currentTool.standardPinchZoomStart()}t.undoManager;const i=this.mouseDownTools.length;for(let n=0;n<i;n++){const e=this.mouseDownTools.elt(n);if(e.diagram=this.diagram,e.canStart())return t.doFocus(),t.currentTool=e,void(t.currentTool===e&&(e.isActive||e.doActivate(),e.doMouseDown()))}1===t.lastInput.button&&(1===this.mouseWheelBehavior?this.mouseWheelBehavior=2:2===this.mouseWheelBehavior&&(this.mouseWheelBehavior=1)),this.doActivate(),this.standardWaitAfter(this.holdDelay,e)}doMouseMove(){const t=this.diagram,e=t.lastInput;if(e.isMultiTouch){if(3===this.gestureBehavior)return void(e.bubbles=!0);if(2===this.gestureBehavior)return;if(t.currentTool.canStartMultiTouch())return void t.currentTool.standardPinchZoomMove()}if(this.isActive){const e=this.mouseMoveTools.length;for(let i=0;i<e;i++){const e=this.mouseMoveTools.elt(i);if(e.diagram=this.diagram,e.canStart())return t.doFocus(),t.currentTool=e,void(t.currentTool===e&&(e.isActive||e.doActivate(),e.doMouseMove()))}}this.standardMouseActivity(t);const i=e.event;null!==i&&("pointermove"===i.type||!i.cancelable)&&(e.bubbles=!0)}standardMouseActivity(t){this.standardMouseOver(),this.isBeyondDragSize()&&this.standardWaitAfter(this.isActive?this.holdDelay:this.hoverDelay,t.lastInput)}doCurrentObjectChanged(t,e){const i=this.currentToolTip;null!==i&&(null!==e&&i instanceof fe&&(e===i||e.isContainedBy(i))||this.hideToolTip())}doWaitAfter(t){const e=this.diagram;if(e.hF()&&(this.doMouseHover(),this.isActive||this.doToolTip(),t.isTouchEvent&&!e.lastInput.handled)){const i=t.copy();return i.button=2,e.lastInput=i,e.Iw=!0,void e.doMouseUp()}}doMouseHover(){const t=this.diagram,e=t.lastInput;null===e.targetObject&&(e.targetObject=t.findObjectAt(e.documentPoint,null,null));let i=e.targetObject;if(null!==i)for(e.handled=!1;null!==i;){const t=this.isActive?i.mouseHold:i.mouseHover;if(null!==t&&(t(e,i),e.handled))break;i=i.panel}else{const i=this.isActive?t.mouseHold:t.mouseHover;null!==i&&i(e)}}doToolTip(){const t=this.diagram,e=t.lastInput;null===e.targetObject&&(e.targetObject=t.findObjectAt(e.documentPoint,null,null));let i=e.targetObject;if(null!==i){const t=this.currentToolTip;if(t instanceof fe&&(i===t||i.isContainedBy(t)))return;for(;null!==i;){const t=i.toolTip;if(null!==t)return void this.showToolTip(t,i);i=i.panel}this.hideToolTip()}else{const e=t.toolTip;null!==e?this.showToolTip(e,null):this.hideToolTip()}}showToolTip(t,i){const n=this.diagram;if(t!==this.currentToolTip&&this.hideToolTip(),t instanceof fe){t.layerName="Tool",t.selectable=!1,t.scale=1/n.scale,t.category="ToolTip",t.hasPlaceholder()&&(t.placeholder.scale=n.scale);const e=t.diagram;null!==e&&e!==n&&e.remove(t),n.add(t),null!==i?t.adornedObject=i:t.data=n.model,t.ensureBounds(),this.positionToolTip(t,i)}else t instanceof et&&t!==this.currentToolTip&&null!==t.show&&t.show(i,n,this);this.currentToolTip=t,-1!==this.Gh&&(e.Og(this.Gh),this.Gh=-1);const s=this.toolTipDuration;if(s>0&&s!==1/0){const t=this;this.Gh=e.ar((()=>t.hideToolTip()),s)}}positionToolTip(t,e){if(t.hasPlaceholder())return;const i=t,n=this.diagram,s=n.lastInput.documentPoint.copy(),o=i.measuredBounds,r=n.viewportBounds;n.lastInput.isTouchEvent&&(s.x-=o.width),s.x+o.width>r.right&&(s.x-=o.width+5/n.scale),s.x<r.x&&(s.x=r.x),s.y+20/n.scale+o.height>r.bottom?s.y-=o.height+5/n.scale:s.y+=20/n.scale,s.y<r.y&&(s.y=r.y),i.position=s}hideToolTip(){-1!==this.Gh&&(e.Og(this.Gh),this.Gh=-1);const t=this.diagram,i=this.currentToolTip;null!==i&&(i instanceof fe?(t.remove(i),null!==this.wm&&this.wm.removeAdornment(i.category),i.data=null,i.adornedObject=null):i instanceof et&&null!==i.hide&&i.hide(t,this),this.currentToolTip=null)}get currentToolTip(){return this.sP}set currentToolTip(t){this.sP=t,this.wm=null!==t&&t instanceof fe?t.adornedPart:null}doMouseUp(){this.cancelWaitAfter();const t=this.diagram;if(this.isActive){const e=this.mouseUpTools.length;for(let i=0;i<e;i++){const e=this.mouseUpTools.elt(i);if(e.diagram=this.diagram,e.canStart())return t.doFocus(),t.currentTool=e,void(t.currentTool===e&&(e.isActive||e.doActivate(),e.doMouseUp()))}}t.doFocus(),this.doDeactivate()}doMouseWheel(){this.standardMouseWheel()}doKeyDown(){const t=this.diagram;null!==t.commandHandler&&t.commandHandler.doKeyDown()}doKeyUp(){const t=this.diagram;null!==t.commandHandler&&t.commandHandler.doKeyUp()}findTool(t){e.s(t,"string",j,"findTool:name");let i=this.mouseDownTools.length;for(let e=0;e<i;e++){const i=this.mouseDownTools.elt(e);if(i.name===t)return i}i=this.mouseMoveTools.length;for(let e=0;e<i;e++){const i=this.mouseMoveTools.elt(e);if(i.name===t)return i}i=this.mouseUpTools.length;for(let e=0;e<i;e++){const i=this.mouseUpTools.elt(e);if(i.name===t)return i}return null}replaceTool(t,i){e.s(t,"string",j,"replaceTool:name"),null!==i&&(i.diagram=this.diagram);let n=this.mouseDownTools.length;for(let e=0;e<n;e++){const n=this.mouseDownTools.elt(e);if(n.name===t)return null!==i?this.mouseDownTools.setElt(e,i):this.mouseDownTools.removeAt(e),n}n=this.mouseMoveTools.length;for(let e=0;e<n;e++){const n=this.mouseMoveTools.elt(e);if(n.name===t)return null!==i?this.mouseMoveTools.setElt(e,i):this.mouseMoveTools.removeAt(e),n}n=this.mouseUpTools.length;for(let e=0;e<n;e++){const n=this.mouseUpTools.elt(e);if(n.name===t)return null!==i?this.mouseUpTools.setElt(e,i):this.mouseUpTools.removeAt(e),n}return null}replaceStandardTool(t,e,i){this.Qt(t,e,i)}Qt(t,i,n){e.s(t,"string",j,"replaceStandardTool:name"),null!==i&&(i.name=t,i.diagram=this.diagram),this.findTool(t)?this.replaceTool(t,i):null!==i&&n.add(i)}get mouseDownTools(){return this.UC}get mouseMoveTools(){return this.VC}get mouseUpTools(){return this.zC}get hoverDelay(){return this.Zk}set hoverDelay(t){e.s(t,"number",j,"hoverDelay"),this.Zk=t}get holdDelay(){return this.Qk}set holdDelay(t){e.s(t,"number",j,"holdDelay"),this.Qk=t}get dragSize(){return this._k}set dragSize(t){this._k=t.N()}get toolTipDuration(){return this.tP}set toolTipDuration(t){e.s(t,"number",j,"toolTipDuration"),this.tP=t}get actionTool(){return this.findTool("Action")}set actionTool(t){this.Qt("Action",t,this.mouseDownTools)}get relinkingTool(){return this.findTool("Relinking")}set relinkingTool(t){this.Qt("Relinking",t,this.mouseDownTools)}get linkReshapingTool(){return this.findTool("LinkReshaping")}set linkReshapingTool(t){this.Qt("LinkReshaping",t,this.mouseDownTools)}get resizingTool(){return this.findTool("Resizing")}set resizingTool(t){this.Qt("Resizing",t,this.mouseDownTools)}get rotatingTool(){return this.findTool("Rotating")}set rotatingTool(t){this.Qt("Rotating",t,this.mouseDownTools)}get linkingTool(){return this.findTool("Linking")}set linkingTool(t){this.Qt("Linking",t,this.mouseMoveTools)}get draggingTool(){return this.findTool("Dragging")}set draggingTool(t){this.Qt("Dragging",t,this.mouseMoveTools)}get dragSelectingTool(){return this.findTool("DragSelecting")}set dragSelectingTool(t){this.Qt("DragSelecting",t,this.mouseMoveTools)}get panningTool(){return this.findTool("Panning")}set panningTool(t){this.Qt("Panning",t,this.mouseMoveTools)}get contextMenuTool(){return this.findTool("ContextMenu")}set contextMenuTool(t){this.Qt("ContextMenu",t,this.mouseUpTools)}get textEditingTool(){return this.findTool("TextEditing")}set textEditingTool(t){this.Qt("TextEditing",t,this.mouseUpTools)}get clickCreatingTool(){return this.findTool("ClickCreating")}set clickCreatingTool(t){this.Qt("ClickCreating",t,this.mouseUpTools)}get clickSelectingTool(){return this.findTool("ClickSelecting")}set clickSelectingTool(t){this.Qt("ClickSelecting",t,this.mouseUpTools)}}class U extends I{nP;oP;dn;rP;lP;hP;aP;bc;xm;cP;Hh;wr;XC;fP;yu;wu;uP;dP;gP;mP;constructor(t){super(),this.name="Dragging",this.nP=!0,this.mP=!0,this.oP=!0,this.dn=null,this.rP=null,this.lP=null,this.hP=null,this.aP=!1,this.yu=!1,this.bc=new y(NaN,NaN),this.xm=new y,this.cP=!0,this.Hh=100,this.wr=[],this.XC=(new u).u(),this.fP=new St,this.wu=null,this.uP="copy",this.dP="",this.gP="no-drop",t&&Object.assign(this,t)}get isCopyEnabled(){return this.nP}set isCopyEnabled(t){e.s(t,"boolean",U,"isCopyEnabled"),this.nP=t}get copiesEffectiveCollection(){return this.oP}set copiesEffectiveCollection(t){e.s(t,"boolean",U,"copiesEffectiveCollection"),this.oP=t}get dragOptions(){return this.fP}set dragOptions(t){this.fP=t}get isGridSnapEnabled(){return this.dragOptions.isGridSnapEnabled}set isGridSnapEnabled(t){e.s(t,"boolean",U,"isGridSnapEnabled"),this.dragOptions.isGridSnapEnabled=t}get isComplexRoutingRealtime(){return this.cP}set isComplexRoutingRealtime(t){this.cP=t;const e=this.diagram.findRouter("AvoidsLinks");null!==e&&(e.isRealtime=t)}get isGridSnapRealtime(){return this.dragOptions.isGridSnapRealtime}set isGridSnapRealtime(t){e.s(t,"boolean",U,"isGridSnapRealtime"),this.dragOptions.isGridSnapRealtime=t}get gridSnapCellSize(){return this.dragOptions.gridSnapCellSize}set gridSnapCellSize(t){this.dragOptions.gridSnapCellSize.equals(t)||(t=t.N(),this.dragOptions.gridSnapCellSize=t)}get gridSnapCellSpot(){return this.dragOptions.gridSnapCellSpot}set gridSnapCellSpot(t){this.dragOptions.gridSnapCellSpot.equals(t)||(t=t.N(),this.dragOptions.gridSnapCellSpot=t)}get gridSnapOrigin(){return this.dragOptions.gridSnapOrigin}set gridSnapOrigin(t){this.dragOptions.gridSnapOrigin.equals(t)||(t=t.N(),this.dragOptions.gridSnapOrigin=t)}get dragsLink(){return this.dragOptions.dragsLink}set dragsLink(t){e.s(t,"boolean",U,"dragsLink"),this.dragOptions.dragsLink=t}get dragsTree(){return this.dragOptions.dragsTree}set dragsTree(t){e.s(t,"boolean",U,"dragsTree"),this.dragOptions.dragsTree=t}get copyCursor(){return this.uP}set copyCursor(t){this.uP=t}get moveCursor(){return this.dP}set moveCursor(t){this.dP=t}get nodropCursor(){return this.gP}set nodropCursor(t){this.gP=t}get currentPart(){return this.rP}set currentPart(t){this.rP=t}get copiedParts(){return this.hP}set copiedParts(t){this.hP=t}get draggedParts(){return this.lP}set draggedParts(t){this.lP=t}get draggingParts(){return null!==this.copiedParts?this.copiedParts.toKeySet():null!==this.draggedParts?this.draggedParts.toKeySet():this.XC}get draggedLink(){return this.diagram.draggedLink}set draggedLink(t){this.diagram.draggedLink=t}get isDragOutStarted(){return this.aP}set isDragOutStarted(t){this.aP=t}get startPoint(){return this.xm}set startPoint(t){this.xm.equals(t)||this.xm.a(t)}get delay(){return this.Hh}set delay(t){e.s(t,"number",U,"delay"),this.Hh=t}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;if(null===t||t.isReadOnly&&!t.allowDragOut||!t.allowMove&&!t.allowCopy&&!t.allowDragOut||!t.allowSelect)return!1;const e=t.lastInput;return!(!e.left||t.currentTool!==this&&(!this.isBeyondDragSize()||e.isTouchEvent&&e.timestamp-t.firstInput.timestamp<this.Hh))&&null!==this.findDraggablePart()}findDraggablePart(){const t=this.diagram;let e=t.findPartAt(t.firstInput.documentPoint,!1);if(null===e)return null;for(;null!==e&&!e.canSelect();)e=e.containingGroup;return null!==e&&(e.canMove()||e.canCopy())?e:null}standardMouseSelect(){const t=this.diagram;if(!t.allowSelect)return;let i=t.findPartAt(t.firstInput.documentPoint,!1);if(null!==i){for(;null!==i&&!i.canSelect();)i=i.containingGroup;if(this.currentPart=i,null!==this.currentPart&&!this.currentPart.isSelected){t.v("ChangingSelection",t.selection);const i=t.lastInput;!(e.hr?i.meta:i.control)&&!i.shift&&t.clearSelection(!0),this.currentPart.isSelected=!0,t.v("ChangedSelection",t.selection)}}}doActivate(){const t=this.diagram;this.wu=null,null===this.currentPart&&this.standardMouseSelect();const e=this.currentPart;if(null===e||!e.canMove()&&!e.canCopy())return;t.cacheGroupExternalLinks(!0),U.wt=null,this.isActive=!0,this.bc.set(t.position),this.pP(t.selection),this.wr.length=0,t.animationManager.stopAnimation();const i=this.computeEffectiveCollection(t.selection,this.dragOptions);this.draggedParts=i,this.mP=!!this.diagram.layout.isRealtime,this.diagram.layout.isRealtime=!1,t.kc=!0,!0===t.getRenderingHint("temporaryPixelRatio")&&t.avgSpf>30&&t.Ew(),t.YC(this.draggedParts),t.xu=!0,this.startTransaction("Drag"),this.startPoint=t.firstInput.documentPoint,t.isMouseCaptured=!0,t.allowDragOut&&this.aF()}pP(t){if(!this.dragsLink)return;const e=this.diagram,i=e.model.bm(),n=t.first();i&&1===t.count&&n instanceof ve&&this.mayDragLink(n)?(this.draggedLink=n,this.draggedLink.canRelinkFrom()&&this.draggedLink.canRelinkTo()&&this.draggedLink.clearAdornments(),this.dn=e.toolManager.findTool("Relinking"),null===this.dn&&(this.dn=new Y,this.dn.diagram=e),this.dn.originalLink=this.draggedLink):(this.draggedLink=null,this.dn=null)}mayDragLink(t){const e=this.diagram;return null!==e&&e.allowRelink}computeEffectiveCollection(t,e){return this.diagram.commandHandler.computeEffectiveCollection(t,e)}Xs(t){return void 0===t?new wt(y.Lo):this.isGridSnapEnabled?new wt(new y(Math.round(1e3*t.x)/1e3,Math.round(1e3*t.y)/1e3)):new wt(t.copy())}doDeactivate(){this.isActive=!1;const t=this.diagram;this.diagram.layout.isRealtime=this.mP,t.xu=!1,t.Cl=!0,t.cacheGroupExternalLinks(!1),t.stopAutoScroll(),this.yP(),t.wP(this.draggedParts),this.wu=null,this.currentPart=null,this.draggedParts=null,this.isDragOutStarted=!1,this.yu=!1,U.cF(),this.KC(),this.bc.i(NaN,NaN),null!==U.jh&&(U.jh.currentCursor=""),U.jh=null,U.wt=null,this.Ll(),t.isMouseCaptured=!1,t.currentCursor="",t.kc=!1,this.stopTransaction(),t.xP(!0)}stopTransaction(){const t=this.diagram,e=super.stopTransaction();return e&&null!==t.undoManager.transactionToUndo&&t.undoManager.transactionToUndo.optimize(),e}yP(){const t=this.diagram,e=t.skipsUndoManager;t.skipsUndoManager=!0;const i=t.lastInput;this.GC(i,null),t.skipsUndoManager=e,this.wr.length=0}HC(){this.Ll(),this.bP();const t=this.diagram;this.bc.isReal()&&(t.position=this.bc),t.stopAutoScroll()}doCancel(){this.Ll(),this.bP();const t=this.diagram;this.bc.isReal()&&(t.position=this.bc),this.stopTool()}doKeyDown(){const t=this.diagram;if(!this.isActive)return;const e=t.lastInput,i=t.previousInput;"Escape"===e.code?this.doCancel():(e.code!==i.code||e.modifiers!==i.modifiers)&&this.doMouseMove()}doKeyUp(){this.isActive&&this.doMouseMove()}fF(t,e){let i=1/0,n=1/0,s=-1/0,o=-1/0;const r=t.iterator;for(;r.next();){const t=r.value;if(!t.isVisible())continue;const e=t.location,a=e.x,l=e.y;isNaN(a)||isNaN(l)||(a<i&&(i=a),l<n&&(n=l),a>s&&(s=a),l>o&&(o=l))}return i===1/0?e.i(0,0,0,0):e.i(i,n,s-i,o-n),e}kP(t){if(null!==this.copiedParts)return;const e=this.diagram;if(t&&(e.isReadOnly||e.isModelReadOnly)||null===this.draggedParts)return;const i=e.undoManager;i.isEnabled&&i.isInTransaction?null!==i.currentTransaction&&i.currentTransaction.changes.count>0&&(e.undoManager.rollbackTransaction(),e.startTransaction("Drag")):this.bP(),e.skipsUndoManager=!t,e.partManager.addsToTemporaryLayer=!t,this.startPoint=e.firstInput.documentPoint;const n=this.copiesEffectiveCollection?this.draggedParts.toKeySet():e.selection,s=e.copyParts(n,e,!0),o=new p,r=this.draggedParts.iterator;for(;r.next();){const t=r.key;if(t.Me()&&t.canCopy()){const e=s.get(t);if(null===e)continue;e.location=t.location,e.ensureBounds(),o.set(e,this.Xs(e.location))}}const a=s.iterator;for(;a.next();){const t=a.value;t instanceof ve&&t.canCopy()&&o.set(t,this.Xs())}if(this.copiedParts=o,this.pP(o.toKeySet()),null!==this.draggedLink){const t=this.draggedLink,e=t.routeBounds;t.xr(this.startPoint.x-(e.x+e.width/2),this.startPoint.y-(e.y+e.height/2))}this.doUpdateCursor(null)}Ll(){const t=this.diagram;if(null!==this.copiedParts){if(t.removeParts(this.copiedParts.toKeySet(),!1),this.copiedParts=null,null!==this.draggedParts){const t=this.draggedParts.iterator;for(;t.next();)if(t.key instanceof ve){t.value.point=new y(0,0)}}this.doUpdateCursor(null)}t.skipsUndoManager=!1,t.partManager.addsToTemporaryLayer=!1,this.startPoint=t.firstInput.documentPoint}KC(){null!==this.draggedLink&&(this.dragsLink&&null!==this.dn&&(this.dn.stopDraggingMouseMove(),this.dn.originalLink=null),this.draggedLink=null,this.dn=null)}Pc(t,e){if(null===t)return;const i=this.diagram,n=this.startPoint,s=y.l();s.a(i.lastInput.documentPoint),this.moveParts(t,s.subtract(n),e),y.e(s),!0===i.getRenderingHint("temporaryPixelRatio")&&null===i.Al&&i.avgSpf>30&&(i.Ew(),i.bu())}moveParts(t,e,i){void 0===i&&(i=!1);const n=this.diagram;null!==n&&n.PP(t,e,this.dragOptions,i)}bP(){if(null===this.draggedParts)return;const t=this.diagram;let e=this.draggedParts.iterator;for(;e.next();){const t=e.key;t.Me()&&(t.location=e.value.point)}for(e=this.draggedParts.iterator;e.next();){const t=e.key;if(t instanceof ve&&t.suspendsRouting){const i=e.value.point;this.draggedParts.set(t,this.Xs()),t.xr(-i.x,-i.y)}}t.maybeUpdate()}uF(t){if(null===t)return!0;const e=t.part;return!!(null===e||e instanceof fe||e.layer?.isTemporary||this.draggedParts&&this.draggedParts.has(e)||this.copiedParts&&this.copiedParts.has(e))}SP(t){const e=this.diagram;this.dragsLink&&(null!==this.draggedLink&&(this.draggedLink.fromNode=null,this.draggedLink.toNode=null),this.jC(!1));const i=this.findDragOverObject(t),n=e.lastInput;n.targetObject=i,this.doUpdateCursor(i);const s=e.skipsUndoManager;let o=!1;try{if(e.skipsUndoManager=!0,o=this.GC(n,i),!this.isActive&&null===U.wt)return;const s=null!==i?i.part:null;if(null===s||e.handlesDragDropForTopLevelParts&&s.isTopLevel&&!(s instanceof Ne)){const t=e.mouseDragOver;null!==t&&(t(n),o=!0)}if(!this.isActive&&null===U.wt||(this.doDragOver(t,i),!this.isActive&&null===U.wt))return}finally{e.skipsUndoManager=s,o&&e.maybeUpdate()}this.wu=i,!e.isReadOnly&&(e.allowMove||e.allowCopy)&&(e.allowHorizontalScroll||e.allowVerticalScroll)&&e.doAutoScroll(n.viewPoint)}findDragOverObject(t){return this.diagram.MP(t,null,(t=>!this.uF(t)))}doUpdateCursor(t){const e=this.diagram;(null===t||this.wu!==t)&&(!this.diagram.currentTool.isActive||this.mayCopy()?e.currentCursor=this.copyCursor:this.mayMove()?e.currentCursor=this.moveCursor:this.mayDragOut()&&(e.currentCursor=this.nodropCursor))}GC(t,e){let i=!1,n=this.wr.length;const s=n>0?this.wr[0]:null;if(e===s)return!1;t.handled=!1;for(let r=0;r<n;r++){const n=this.wr[r],s=n.mouseDragLeave;if(null!==s&&(s(t,n,e),i=!0,t.handled))break}if(this.wr.length=0,!this.isActive&&null===U.wt||null===e)return i;t.handled=!1;let o=e;for(;null!==o;)this.wr.push(o),o=this.qC(o);n=this.wr.length;for(let r=0;r<n;r++){const e=this.wr[r],n=e.mouseDragEnter;if(null!==n&&(n(t,e,s),i=!0,t.handled))break}return i}yE(t,e){return null!==t&&!!(t===e||t.isContainedBy(e)||e instanceof Ne&&!(t instanceof Ne)&&e.handlesDragDropForMembers&&t.part?.isMemberOf(e))}qC(t){const e=t.panel;if(null!==e)return e;if(t instanceof ce&&!(t instanceof Ne)){const e=t.containingGroup;if(null!==e&&e.handlesDragDropForMembers)return e}return null}WC(t,e){const i=this.diagram,n=this.dn;if(null===n)return null;const s=n.portGravity,o=i.findObjectsNear(t,s,(t=>n.findValidLinkablePort(t,e))),r=y.l();let a=1/0,l=null;for(const h=o.iterator;h.next();){const e=h.value;if(null===e.part)continue;const i=e.getDocumentPoint(w.Center,r),n=t.distanceSquaredPoint(i);n<a&&(l=e,a=n)}return y.e(r),l}jC(t){const e=this.draggedLink;if(null!==e){if(e.pointsCount<2)return;const i=this.diagram;if(i.isReadOnly)return;const n=this.dn;if(null===n)return;let s=null,o=null;null===e.fromNode&&(s=this.WC(e.getPoint(0),!1),null!==s&&(o=s.part));let r=null,a=null;null===e.toNode&&(r=this.WC(e.getPoint(e.pointsCount-1),!0),null!==r&&(a=r.part)),n.isValidLink(o,s,a,r)?t?(e.defaultFromPoint=e.getPoint(0),e.defaultToPoint=e.getPoint(e.pointsCount-1),e.suspendsRouting=!1,e.fromNode=o,null!==s&&(e.fromPortId=s.portId),e.toNode=a,null!==r&&(e.toPortId=r.portId),e.fromPort!==i.NP&&i.v("LinkRelinked",e,i.NP),e.toPort!==i.CP&&i.v("LinkRelinked",e,i.CP)):n.doDraggingMouseMove(o,s,a,r):n.doDraggingMouseMove(null,null,null,null)}}doDragOver(t,e){}JC(t){const e=this.diagram;this.dragsLink&&this.jC(!0),this.yP();const i=this.findDragOverObject(t),n=e.lastInput;if(n.targetObject=i,null!==i){n.handled=!1;let t=i;for(;null!==t;){const e=t.mouseDrop;if(null!==e&&(e(n,t),n.handled))break;this.dF(n,t),t=this.qC(t)}}else{const t=e.mouseDrop;null!==t&&t(n)}if(!this.isActive&&null===U.wt)return;const s=this.copiedParts||this.draggedParts;if(null!==s){const t=s.iterator;for(;t.next();){const e=t.key;e instanceof me&&e.linksConnected.each((t=>t.suspendsRouting=!1))}}if(this.doDropOnto(t,i),!this.isActive&&null===U.wt)return;const o=b.l(),r=e.selection.iterator;for(;r.next();){const t=r.value;t instanceof me&&this.gF(e,t,o)}b.e(o)}dF(t,e){const i=this.diagram,n=e.part;if(i.handlesDragDropForTopLevelParts&&null!==n&&n.isTopLevel&&!(n instanceof Ne)){const e=i.mouseDrop;null!==e&&e(t)}}gF(t,e,i){if(!e.canAvoid())return;let n=!1;i=e.getAvoidableRect(i),t.viewportBounds.containsRect(i)&&(n=!0);const s=this.copiedParts||this.draggedParts;if(null===s)return;const o=t.LP(i,(t=>t.part),(t=>t instanceof ve),!0,(t=>t instanceof ve),n);if(0===o.count)return;const r=o.iterator;for(;r.next();){const t=r.value;s.has(t)&&s.has(e)||!t.isMemberOf(e)&&t.isAvoiding&&t.invalidateRoute()}}doDropOnto(t,e){}doMouseMove(){if(!this.isActive)return;const t=this.diagram,e=t.lastInput;this.simulatedMouseMove(e.event,e.documentPoint,e.targetDiagram)||null!==this.currentPart&&null!==this.draggedParts&&(this.mayCopy()?(this.kP(!1),this.Pc(this.copiedParts,!1)):this.mayMove()?(this.Ll(),this.Pc(this.draggedParts,!0)):this.mayDragOut()?(this.kP(!1),this.Pc(this.copiedParts,!1)):this.Ll(),this.SP(t.lastInput.documentPoint))}doMouseUp(){if(!this.isActive)return;const t=this.diagram,e=t.lastInput;if(this.simulatedMouseUp(e.event,e.documentPoint,e.targetDiagram))return;let i=!1;const n=this.mayCopy();if(n&&null!==this.copiedParts?(this.Ll(),this.kP(!0),this.Pc(this.copiedParts,!1),null!==this.copiedParts&&(t.v("ChangingSelection",t.selection),t.clearSelection(!0),this.copiedParts.iteratorKeys.each((t=>{t.isSelected=!0})))):(i=!0,this.Ll(),this.mayMove()&&(this.Pc(this.draggedParts,!0),this.SP(t.lastInput.documentPoint))),this.yu=!0,this.JC(t.lastInput.documentPoint),this.isActive){const e=n&&this.copiedParts,s=e?this.copiedParts.toKeySet():this.draggedParts?this.draggedParts.toKeySet():null;this.copiedParts=null,i&&this.mF(),t.invalidateDocumentBounds(),t.wP(this.draggedParts),this.transactionResult=e?"Copy":"Move",t.v(e?"SelectionCopied":"SelectionMoved",s)}this.stopTool(),n&&t.v("ChangedSelection",t.selection)}simulatedMouseMove(t,e,i){if(null===U.wt)return!1;const n=U.wt.diagram;i instanceof bt||(i=null);const s=U.jh;if(i!==s){if(null!==s&&s!==n){s.stopAutoScroll(),U.wt.isDragOutStarted=!1;const t=s.toolManager.findTool("Dragging");null!==t&&t.doSimulatedDragLeave()}if(U.jh=i,null!==i&&i!==n){U.wt.HC();const t=i.toolManager.findTool("Dragging");null!==t&&(t.$C(),t.doSimulatedDragEnter())}this.doUpdateCursor(null)}if(null===i||i===n||!i.allowDrop||i.isReadOnly||!i.allowInsert)return!1;const o=i.toolManager.findTool("Dragging");if(null!==o){let n=e;null!==t&&(void 0!==t.targetTouches&&(t.targetTouches.length>0?t=t.targetTouches[0]:t.changedTouches.length>0&&(t=t.changedTouches[0])),n=i.getMouse(t)),i.lastInput.documentPoint=n,i.lastInput.viewPoint=i.transformDocToView(n),i.lastInput.down=!1,i.lastInput.up=!1,o.doSimulatedDragOver()}return!0}simulatedMouseUp(t,e,i){if(null===U.wt)return!1;const n=U.jh,s=U.wt.diagram;if(null===i)return U.wt.doCancel(),!0;if(i!==n){if(null!==n){const t=n.toolManager.findTool("Dragging");if(null!==n&&n!==s&&null!==t)return n.stopAutoScroll(),U.wt.isDragOutStarted=!1,t.doSimulatedDragLeave(),!1}U.jh=i;const t=i.toolManager.findTool("Dragging");null!==t&&(U.wt.HC(),t.$C(),t.doSimulatedDragEnter())}if(i!==this.diagram){let n=e;null!==t?(void 0!==t.targetTouches&&(t.targetTouches.length>0?t=t.targetTouches[0]:t.changedTouches.length>0&&(t=t.changedTouches[0])),n=i.getMouse(t)):null===n&&(n=new y),i.lastInput.documentPoint=n,i.lastInput.viewPoint=i.transformDocToView(n),i.lastInput.down=!1,i.lastInput.up=!0;const s=i.toolManager.findTool("Dragging");null!==s&&s.doSimulatedDrop();const o=U.wt;if(null!==o){const t=o.mayCopy();o.transactionResult=t?"Copy":"Move",o.stopTool()}return!0}return!1}mF(){if(null===this.draggedParts)return;const t=this.draggedParts.iterator;for(;t.next();){const e=t.key;if(e instanceof me){const t=e.containingGroup;null!==t&&t.hasPlaceholder()&&!this.draggedParts.has(t)&&t.placeholder.c()}}}mayCopy(){if(!this.isCopyEnabled)return!1;const t=this.diagram;if(t.isReadOnly||t.isModelReadOnly||!t.allowInsert||!t.allowCopy||!(e.hr?t.lastInput.alt:t.lastInput.control))return!1;const i=t.selection.iterator;for(;i.next();)if(i.value.canCopy())return!0;return!(null===this.draggedLink||!this.dragsLink||!this.draggedLink.canCopy())}mayDragOut(){if(!this.isCopyEnabled)return!1;const t=this.diagram;if(!t.allowDragOut||!t.allowCopy||t.allowMove)return!1;const e=t.selection.iterator;for(;e.next();)if(e.value.canCopy())return!0;return!(null===this.draggedLink||!this.dragsLink||!this.draggedLink.canCopy())}mayMove(){const t=this.diagram;if(t.isReadOnly||!t.allowMove)return!1;const e=t.selection.iterator;for(;e.next();)if(e.value.canMove())return!0;return!(null===this.draggedLink||!this.dragsLink||!this.draggedLink.canMove())}$C(){U.Bw.has(this)||U.Bw.add(this)}static cF(){if(U.Bw.count>0){const t=U.Bw,e=t.length;for(let i=0;i<e;i++){const e=t.elt(i);e.KC(),e.Ll(),e.yP(),e.diagram.stopAutoScroll()}t.clear()}}computeBorder(t,e,i){return this.yu||null===this.draggedParts||this.draggedParts.has(t)?null:i.a(e)}getDraggingSource(){return U.wt}mayDragIn(){const t=this.diagram;if(!t.allowDrop||t.isReadOnly||t.isModelReadOnly||!t.allowInsert)return!1;const e=U.wt;return!(null===e||e.diagram.model.dataFormat!==t.model.dataFormat)}doSimulatedDragEnter(){if(!this.mayDragIn())return;const t=this.diagram;t.animationManager.stopAnimation(),t.br(),t.animationManager.stopAnimation();const e=U.wt;null!==e&&(this.diagram.kc=!0,null===t.lastInput.event&&(t.lastInput.event=e.diagram.lastInput.event)),this.doUpdateCursor(null)}doSimulatedDragLeave(){const t=U.wt;null!==t&&t.doSimulatedDragOut(),this.diagram.kc=!1,this.doCancel()}doSimulatedDragOver(){const t=this.diagram;t.animationManager.ku=!0;const e=U.wt;if(null!==e&&null!==e.draggedParts){if(!this.mayDragIn())return;this.ZC(e.draggedParts.toKeySet(),!1,t.firstInput),this.Pc(this.copiedParts,!1),this.SP(t.lastInput.documentPoint)}t.animationManager.ku=!1}doSimulatedDrop(){const t=this.diagram,e=U.wt;if(null!==e){const i=e.diagram;if(e.yu=!0,this.Ll(),null===e.draggedParts||!this.mayDragIn())return;t.animationManager.ku=!0,t.v("ChangingSelection",t.selection),this.startTransaction("Drop"),this.ZC(e.draggedParts.toKeySet(),!0,t.lastInput),this.Pc(this.copiedParts,!1);const n=new u;null!==this.copiedParts&&(t.clearSelection(!0),this.copiedParts.iteratorKeys.each((t=>{t.isSelected=!0,n.add(t)}))),this.JC(t.lastInput.documentPoint),t.invalidateDocumentBounds(),null!==this.copiedParts&&(this.transactionResult="ExternalCopy"),this.copiedParts=null,t.doFocus(),t.kc=!1,t.v("ExternalObjectsDropped",n,i),this.stopTransaction(),t.v("ChangedSelection",t.selection)}t.animationManager.ku=!1}ZC(t,e,i){if(null!==this.copiedParts)return;const n=this.diagram;if(n.isReadOnly||n.isModelReadOnly)return;n.skipsUndoManager=!e,n.partManager.addsToTemporaryLayer=!e,this.startPoint=i.documentPoint;const s=n.copyParts(t,n,!0),o=b.l();this.fF(t,o);const r=o.x+o.width/2,a=o.y+o.height/2;b.e(o);const l=this.xm,h=new p,u=y.l(),c=t.iterator;for(;c.next();){const t=c.value;if(t instanceof ve&&t.canCopy()){const e=s.get(t);if(null===e)continue;e.points=t.points,e.xr(l.x-r,l.y-a),e.suspendsRouting=!0,h.set(e,this.Xs())}}const d=t.iterator;for(;d.next();){const t=d.value;if(t.Me()&&t.canCopy()){const e=s.get(t);if(null===e)continue;const i=t.location;u.i(l.x-(r-i.x),l.y-(a-i.y)),e.location=u,e.ensureBounds(),h.set(e,this.Xs(u))}}if(y.e(u),this.copiedParts=h,this.pP(h.toKeySet()),null!==this.draggedLink){const t=this.draggedLink,e=t.routeBounds;t.xr(this.startPoint.x-(e.x+e.width/2),this.startPoint.y-(e.y+e.height/2))}this.doUpdateCursor(null)}aF(){this.isDragOutStarted=!0,this.yu=!1,U.wt=this,U.jh=this.diagram,this.doSimulatedDragOut()}doSimulatedDragOut(){const t=this.diagram;t.kc=!1,this.mayCopy()||this.mayMove()?t.currentCursor="":t.currentCursor=this.nodropCursor,this.wu=null}computeMove(t,e,i,n){const s=this.diagram;return null!==s?s.computeMove(t,e,this.dragOptions,n):new y}static Bw=(()=>new l)();static wt=null;static jh=null}j.prototype.doCancel=function(){null!==U.wt&&U.wt.doCancel(),I.prototype.doCancel.call(this)};class G extends I{AP;TP;Tl;DP;FP;qh;RP;Wh;vP;OP;IP;EP;BP;UP;QC;VP;Dl;zP;constructor(){super(),this.AP=100,this.TP=!1,this.Tl="pointer",this.DP=new ve({layerName:"Tool"}).add(new Jt({isPanelMain:!0,stroke:"blue"}).theme("stroke","tempLink"),new Jt({toArrow:"Standard",fill:"blue",stroke:"blue"}).theme("fill","tempLink").theme("stroke","tempLink")).zt(),this.qh=new Jt("Rectangle",{portId:"",fill:null,stroke:"magenta",strokeWidth:2,desiredSize:x.Dk}).theme("stroke","tempPort"),this.FP=new me({selectable:!1,layerName:"Tool"}).add(this.qh).zt(),this.Wh=new Jt("Rectangle",{portId:"",fill:null,stroke:"magenta",strokeWidth:2,desiredSize:x.Dk}).theme("stroke","tempPort"),this.RP=new me({selectable:!1,layerName:"Tool"}).add(this.Wh).zt(),this.vP=null,this.OP=null,this.IP=null,this.EP=null,this.BP=null,this.UP=!0,this.QC=new p,this.VP=null,this.Dl=null,this.zP=null}doStop(){this.diagram.stopAutoScroll(),this.originalLink=null,this.originalFromNode=null,this.originalFromPort=null,this.originalToNode=null,this.originalToPort=null,this.validPortsCache.clear(),this.targetPort=null}get portGravity(){return this.AP}set portGravity(t){e.s(t,"number",G,"portGravity"),t>=0&&(this.AP=t)}get isUnconnectedLinkValid(){return this.TP}set isUnconnectedLinkValid(t){e.s(t,"boolean",G,"isUnconnectedLinkValid"),this.TP=t}get linkingCursor(){return this.Tl}set linkingCursor(t){this.Tl=t}get temporaryLink(){return this.DP}set temporaryLink(t){t.zt(),this.DP=t}get temporaryFromNode(){return this.FP}set temporaryFromNode(t){t.zt(),this.FP=t,t&&(this.qh=t.port)}get temporaryFromPort(){return this.qh}set temporaryFromPort(t){if(null!==this.qh){const e=this.qh.panel;if(null!==e){const i=e.T.indexOf(this.qh);e.removeAt(i),e.insertAt(i,t)}}this.qh=t}get temporaryToNode(){return this.RP}set temporaryToNode(t){t.zt(),this.RP=t,t&&(this.Wh=t.port)}get temporaryToPort(){return this.Wh}set temporaryToPort(t){if(null!==this.Wh){const e=this.Wh.panel;if(null!==e){const i=e.T.indexOf(this.Wh);e.removeAt(i),e.insertAt(i,t)}}this.Wh=t}get originalLink(){return this.vP}set originalLink(t){this.vP=t}get originalFromNode(){return this.OP}set originalFromNode(t){this.OP=t}get originalFromPort(){return this.IP}set originalFromPort(t){this.IP=t}get originalToNode(){return this.EP}set originalToNode(t){this.EP=t}get originalToPort(){return this.BP}set originalToPort(t){this.BP=t}get isForwards(){return this.UP}set isForwards(t){this.UP=t}get validPortsCache(){return this.QC}get targetPort(){return this.VP}set targetPort(t){this.VP=t}copyPortProperties(t,e,i,n,s){if(null===t||null===e||null===i||null===n)return;const o=e.getDocumentScale(),r=x.l();r.width=e.naturalBounds.width*o,r.height=e.naturalBounds.height*o,n.desiredSize=r,x.e(r),s?(n.toSpot=e.toSpot,n.toEndSegmentLength=e.toEndSegmentLength):(n.fromSpot=e.fromSpot,n.fromEndSegmentLength=e.fromEndSegmentLength),i.locationSpot=w.Center;const a=y.l();i.location=e.getDocumentPoint(w.Center,a),y.e(a),n.angle=e.getDocumentAngle(),null!==this.portTargeted&&this.portTargeted(t,e,i,n,s)}setNoTargetPortProperties(t,e,i){null!==e&&(e.desiredSize=x.Dk,e.fromSpot=w.None,e.toSpot=w.None),null!==t&&(t.location=this.diagram.lastInput.documentPoint),null!==this.portTargeted&&this.portTargeted(null,null,t,e,i)}doMouseDown(){this.isActive&&this.doMouseMove()}doMouseMove(){if(this.isActive){const t=this.diagram;if(this.targetPort=this.findTargetPort(this.isForwards),null!==this.targetPort&&this.targetPort.part instanceof me){const t=this.targetPort.part;this.isForwards?this.copyPortProperties(t,this.targetPort,this.temporaryToNode,this.temporaryToPort,!0):this.copyPortProperties(t,this.targetPort,this.temporaryFromNode,this.temporaryFromPort,!1)}else this.isForwards?this.setNoTargetPortProperties(this.temporaryToNode,this.temporaryToPort,!0):this.setNoTargetPortProperties(this.temporaryFromNode,this.temporaryFromPort,!1);(t.allowHorizontalScroll||t.allowVerticalScroll)&&t.doAutoScroll(t.lastInput.viewPoint)}}findValidLinkablePort(t,e){if(null===t)return null;const i=t.part;if(!(i instanceof me))return null;for(;null!==t;){const n=e?t.toLinkable:t.fromLinkable;if(!0===n&&(null!==t.portId||t instanceof me)&&(e?this.isValidTo(i,t):this.isValidFrom(i,t)))return t;if(!1===n)return null;t=t.panel}return null}findTargetPort(t){const e=this.diagram,i=e.lastInput.documentPoint;let n=this.portGravity;let s=1/0,o=null;const r=e.findObjectsNear(i,n,(e=>this.findValidLinkablePort(e,t)),null,!0).iterator;for(;r.next();){const e=r.value,n=e.part;if(!(n instanceof me))continue;const a=e.getDocumentPoint(w.Center,y.l()),l=i.x-a.x,h=i.y-a.y;y.e(a);const u=l*l+h*h;if(u<s){const i=this.validPortsCache.get(e);null!==i?i&&(o=e,s=u):t&&this.isValidLink(this.originalFromNode,this.originalFromPort,n,e)||!t&&this.isValidLink(n,e,this.originalToNode,this.originalToPort)?(this.validPortsCache.set(e,!0),o=e,s=u):this.validPortsCache.set(e,!1)}}if(null!==o){const t=o.part;if(t instanceof me&&(null===t.layer||t.layer.allowLink))return o}return null}isValidFrom(t,e){if(null===t||null===e)return this.isUnconnectedLinkValid;if(this.diagram.currentTool===this&&(null!==t.layer&&!t.layer.allowLink||!0!==e.fromLinkable))return!1;const i=e.fromMaxLinks;if(i<1/0){if(null!==this.originalLink&&t===this.originalFromNode&&e===this.originalFromPort)return!0;let n=e.portId;if(null===n&&(n=""),t.findLinksOutOf(n).count>=i)return!1}return!0}isValidTo(t,e){if(null===t||null===e)return this.isUnconnectedLinkValid;if(this.diagram.currentTool===this&&(null!==t.layer&&!t.layer.allowLink||!0!==e.toLinkable))return!1;const i=e.toMaxLinks;if(i<1/0){if(null!==this.originalLink&&t===this.originalToNode&&e===this.originalToPort)return!0;let n=e.portId;if(null===n&&(n=""),t.findLinksInto(n).count>=i)return!1}return!0}isInSameNode(t,e){if(null===t||null===e)return!1;if(t===e)return!0;const i=t.part,n=e.part;return null!==i&&i===n}isLinked(t,e){if(null===t||null===e)return!1;const i=t.part;if(!(i instanceof me))return!1;let n=t.portId;null===n&&(n="");const s=e.part;if(!(s instanceof me))return!1;let o=e.portId;null===o&&(o="");const r=s.findLinksInto(o);for(;r.next();){const t=r.value;if(t.fromNode===i&&t.fromPortId===n)return!0}return!1}isValidLink(t,e,i,n){if(!this.isValidFrom(t,e)||!this.isValidTo(i,n)||null!==e&&null!==n&&((!e.fromLinkableSelfNode||!n.toLinkableSelfNode)&&this.isInSameNode(e,n)||(!e.fromLinkableDuplicates||!n.toLinkableDuplicates)&&this.isLinked(e,n))||null!==this.originalLink&&(null!==t&&this.isLabelDependentOnLink(t,this.originalLink)||null!==i&&this.isLabelDependentOnLink(i,this.originalLink))||null!==t&&null!==i&&(null===t.data&&null!==i.data||null!==t.data&&null===i.data)||!this.isValidCycle(t,i,this.originalLink))return!1;let s;return!(null!==t&&null!==e&&(s=t.linkValidation,null!==s&&!s(t,e,i,n,this.originalLink))||null!==i&&null!==n&&(s=i.linkValidation,null!==s&&!s(t,e,i,n,this.originalLink)))&&(s=this.linkValidation,null===s||s(t,e,i,n,this.originalLink))}isLabelDependentOnLink(t,e){if(null===t)return!1;const i=t.labeledLink;if(null===i)return!1;if(i===e)return!0;const n=new u;return n.add(t),this.XP(i,e,n)}XP(t,e,i){if(t===e)return!0;const n=t.fromNode;if(null!==n&&n.labeledLink&&(i.add(n),this.XP(n.labeledLink,e,i)))return!0;const s=t.toNode;return!(null===s||!s.labeledLink||(i.add(s),!this.XP(s.labeledLink,e,i)))}isValidCycle(t,e,i){if(void 0===i&&(i=null),null===t||null===e)return this.isUnconnectedLinkValid;const n=this.diagram;let s=1;if(n&&(s=n.model.km()?n.isTreePathToChildren?5:6:n.validCycle),1===s)return!0;if(5===s){const n=i||this.temporaryLink;if(null!==n&&!n.isTreeLink)return!0;const s=e.linksConnected;for(;s.next();){const t=s.value;if(t!==i&&t.isTreeLink&&t.toNode===e)return!1}return!this.Pu(t,e,i,!0)}if(6===s){const n=i||this.temporaryLink;if(null!==n&&!n.isTreeLink)return!0;const s=t.linksConnected;for(;s.next();){const e=s.value;if(e!==i&&e.isTreeLink&&e.fromNode===t)return!1}return!this.Pu(t,e,i,!0)}return 2===s?!this.pF(t,e,i):3===s?!this.Pu(t,e,i,!1):4!==s||!this.yF(t,e,i)}Pu(t,e,i,n){if(t===e)return!0;if(null===t||null===e)return!1;const s=t.linksConnected;for(;s.next();){const o=s.value;if(o===i||n&&!o.isTreeLink||o.toNode!==t)continue;const r=o.fromNode;if(r!==t&&null!==r&&this.Pu(r,e,i,n))return!0}return!1}pF(t,e,i){if(t===e)return!0;const n=new u;return n.add(e),this._C(n,t,e,i)}_C(t,e,i,n){if(e===i)return!0;if(null===e||null===i||t.has(e))return!1;t.add(e);const s=e.linksConnected;for(;s.next();){const o=s.value;if(o===n||o.toNode!==e)continue;const r=o.fromNode;if(r!==e&&null!==r&&this._C(t,r,i,n))return!0}return!1}yF(t,e,i){if(t===e)return!0;const n=new u;return n.add(e),this.tL(n,t,e,i)}tL(t,e,i,n){if(e===i)return!0;if(null===e||null===i||t.has(e))return!1;t.add(e);const s=e.linksConnected;for(;s.next();){const o=s.value;if(o===n)continue;const r=o.fromNode,a=o.toNode,l=r===e?a:r;if(l!==e&&null!==l&&this.tL(t,l,i,n))return!0}return!1}get linkValidation(){return this.Dl}set linkValidation(t){null!==t&&e.S(t,G,"linkValidation"),this.Dl=t}get portTargeted(){return this.zP}set portTargeted(t){null!==t&&e.S(t,G,"portTargeted"),this.zP=t}}var K=(t=>(t[t.Either=1]="Either",t[t.ForwardsOnly=2]="ForwardsOnly",t[t.BackwardsOnly=3]="BackwardsOnly",t))(K||{});class X extends G{YP;KP;P;GP;constructor(t){super(),this.name="Linking",this.YP={},this.KP=null,this.P=1,this.GP=null,t&&Object.assign(this,t)}static Either=1;static ForwardsOnly=2;static BackwardsOnly=3;get archetypeLinkData(){return this.YP}set archetypeLinkData(t){null!==t&&e.lc(t,X,"archetypeLinkData"),this.YP=t}get archetypeLabelNodeData(){return this.KP}set archetypeLabelNodeData(t){null!==t&&e.lc(t,X,"archetypeLabelNodeData"),this.KP=t}get direction(){return this.P}set direction(t){this.P=t}get startObject(){return this.GP}set startObject(t){this.GP=t}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;return!(t.isReadOnly||t.isModelReadOnly||!t.allowLink||!t.model.Uw()||!t.lastInput.left||t.currentTool!==this&&!this.isBeyondDragSize())&&null!==this.findLinkablePort()}findLinkablePort(){const t=this.diagram;let e=this.startObject;if(null===e&&(e=t.findObjectAt(t.firstInput.documentPoint,null,null)),null===e)return null;const i=e.part;if(!(i instanceof me))return null;const n=this.direction;if(1===n||2===n){const t=this.findValidLinkablePort(e,!1);if(null!==t)return this.isForwards=!0,t;if(this.startObject===i){const t=i.port;if(this.findValidLinkablePort(t,!1))return this.isForwards=!0,t}}if(1===n||3===n){const t=this.findValidLinkablePort(e,!0);if(null!==t)return this.isForwards=!1,t;if(this.startObject===i){const t=i.port;if(this.findValidLinkablePort(t,!0))return this.isForwards=!1,t}}return null}doActivate(){const t=this.diagram,e=this.findLinkablePort();if(null!==e){if(this.startTransaction(this.name),t.isMouseCaptured=!0,t.currentCursor=this.linkingCursor,this.isForwards){null!==this.temporaryToNode&&(this.temporaryToNode.location=t.lastInput.documentPoint),this.originalFromPort=e;const i=this.originalFromPort.part;i instanceof me&&(this.originalFromNode=i),this.copyPortProperties(this.originalFromNode,this.originalFromPort,this.temporaryFromNode,this.temporaryFromPort,!1)}else{null!==this.temporaryFromNode&&(this.temporaryFromNode.location=t.lastInput.documentPoint),this.originalToPort=e;const i=this.originalToPort.part;i instanceof me&&(this.originalToNode=i),this.copyPortProperties(this.originalToNode,this.originalToPort,this.temporaryToNode,this.temporaryToPort,!0)}t.add(this.temporaryFromNode),this.temporaryFromNode&&this.temporaryFromNode.ensureBounds(),t.add(this.temporaryToNode),this.temporaryToNode&&this.temporaryToNode.ensureBounds(),null!==this.temporaryLink&&(null!==this.temporaryFromNode&&(this.temporaryLink.fromNode=this.temporaryFromNode),null!==this.temporaryToNode&&(this.temporaryLink.toNode=this.temporaryToNode),this.temporaryLink.isTreeLink=this.isNewTreeLink(),this.temporaryLink.invalidateRoute(),t.add(this.temporaryLink)),this.isActive=!0}else this.stopTool()}doDeactivate(){this.isActive=!1;const t=this.diagram;t.remove(this.temporaryLink),t.remove(this.temporaryFromNode),t.remove(this.temporaryToNode),t.isMouseCaptured=!1,t.currentCursor="",this.stopTransaction()}doStop(){super.doStop(),this.startObject=null}doMouseUp(){if(this.isActive){const t=this.diagram;this.transactionResult=null;let e=null,i=null,n=null,s=null,o=null;try{this.targetPort=this.findTargetPort(this.isForwards);const r=this.targetPort;if(null!==r){const t=r.part;t instanceof me&&(this.isForwards?(null!==this.originalFromNode&&(e=this.originalFromNode,i=this.originalFromPort),n=t,s=r):(e=t,i=r,null!==this.originalToNode&&(n=this.originalToNode,s=this.originalToPort)))}else this.isForwards?null!==this.originalFromNode&&this.isUnconnectedLinkValid&&(e=this.originalFromNode,i=this.originalFromPort):null!==this.originalToNode&&this.isUnconnectedLinkValid&&(n=this.originalToNode,s=this.originalToPort);null!==e||null!==n?(o=this.insertLink(e,i,n,s),null!==o?(null===r&&(this.isForwards?o.defaultToPoint=t.lastInput.documentPoint:o.defaultFromPoint=t.lastInput.documentPoint),t.allowSelect&&(t.v("ChangingSelection",t.selection),t.clearSelection(!0),o.isSelected=!0),this.transactionResult=this.name,t.v("LinkDrawn",o)):this.doNoLink(e,i,n,s)):this.isForwards?this.doNoLink(this.originalFromNode,this.originalFromPort,null,null):this.doNoLink(null,null,this.originalToNode,this.originalToPort)}finally{this.stopTool(),o&&t.allowSelect&&t.v("ChangedSelection",t.selection)}}}isNewTreeLink(){const t=this.archetypeLinkData;if(null===t)return!0;if(t instanceof ve)return t.isTreeLink;const e=this.diagram;if(null===e)return!0;const i=e.partManager.getLinkCategoryForData(t),n=e.partManager.findLinkTemplateForCategory(i);return null===n||n.isTreeLink}insertLink(t,e,i,n){return this.diagram.partManager.insertLink(t,e,i,n)}doNoLink(t,e,i,n){}}class Y extends G{iL;eL;HP;jP;gs;qP;constructor(t){super(),this.name="Relinking",this.fromHandleArchetype=new Jt("Diamond",{desiredSize:x.cu,fill:"lightblue",stroke:"dodgerblue",cursor:this.linkingCursor,segmentIndex:0}).theme("fill","adornmentFill").theme("stroke","adornmentStroke"),this.toHandleArchetype=new Jt("Diamond",{desiredSize:x.cu,fill:"lightblue",stroke:"dodgerblue",cursor:this.linkingCursor,segmentIndex:-1}).theme("fill","adornmentFill").theme("stroke","adornmentStroke"),this.gs=null,this.qP=new b,t&&Object.assign(this,t)}updateAdornments(t){if(null===t||!(t instanceof ve))return;let e="RelinkFrom",i=null;if(t.isSelected&&!this.diagram.isReadOnly){const n=t.selectionObject;null!==n&&t.canRelinkFrom()&&t.actualBounds.isReal()&&t.isVisible()&&n.actualBounds.isReal()&&n.isVisibleObject()&&(i=t.findAdornment(e),null===i&&(i=this.makeAdornment(n,!1),t.addAdornment(e,i)))}if(null===i&&t.removeAdornment(e),e="RelinkTo",i=null,t.isSelected&&!this.diagram.isReadOnly){const n=t.selectionObject;null!==n&&t.canRelinkTo()&&t.actualBounds.isReal()&&t.isVisible()&&n.actualBounds.isReal()&&n.isVisibleObject()&&(i=t.findAdornment(e),null===i?(i=this.makeAdornment(n,!0),t.addAdornment(e,i)):i.c())}null===i&&t.removeAdornment(e)}makeAdornment(t,e){let i=e?this.jP:this.HP;return i&&(i=i.copy(),i.adornedObject=t),i}get fromHandleArchetype(){return this.iL}set fromHandleArchetype(t){this.iL=t,this.HP=null!==t?new fe(Yt.Link).add(t).zt():null}get toHandleArchetype(){return this.eL}set toHandleArchetype(t){this.eL=t,this.jP=null!==t?new fe(Yt.Link).add(t).zt():null}get handle(){return this.gs}set handle(t){null!==t&&(t.part instanceof fe||e.o("new handle is not in an Adornment: "+t)),this.gs=t}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;if(t.isReadOnly||t.isModelReadOnly||!t.allowRelink||!t.model.Uw()||!t.lastInput.left)return!1;let e=this.findToolHandleAt(t.firstInput.documentPoint,"RelinkFrom");return null===e&&(e=this.findToolHandleAt(t.firstInput.documentPoint,"RelinkTo")),null!==e}doActivate(){const t=this.diagram;if(null===this.originalLink){let e=this.handle;if(null===e&&(e=this.findToolHandleAt(t.firstInput.documentPoint,"RelinkFrom"),null===e&&(e=this.findToolHandleAt(t.firstInput.documentPoint,"RelinkTo"))),null===e)return;const i=e.part;if(!(i instanceof fe)||!(i.adornedPart instanceof ve))return;this.handle=e,this.isForwards=null===i||"RelinkTo"===i.category,this.originalLink=i.adornedPart}const e=this.originalLink;null!==e&&(this.startTransaction(this.name),t.isMouseCaptured=!0,t.currentCursor=this.linkingCursor,this.originalFromPort=e.fromPort,this.originalFromNode=e.fromNode,this.originalToPort=e.toPort,this.originalToNode=e.toNode,this.qP.set(e.actualBounds),e.pointsCount>0&&(null===e.fromNode&&(null!==this.temporaryFromPort&&(this.temporaryFromPort.desiredSize=x.hc),null!==this.temporaryFromNode&&(this.temporaryFromNode.location=e.getPoint(0))),null===e.toNode&&(null!==this.temporaryToPort&&(this.temporaryToPort.desiredSize=x.hc),null!==this.temporaryToNode&&(this.temporaryToNode.location=e.getPoint(e.pointsCount-1)))),this.copyPortProperties(this.originalFromNode,this.originalFromPort,this.temporaryFromNode,this.temporaryFromPort,!1),this.copyPortProperties(this.originalToNode,this.originalToPort,this.temporaryToNode,this.temporaryToPort,!0),t.add(this.temporaryFromNode),t.add(this.temporaryToNode),null!==this.temporaryLink&&(null!==this.temporaryFromNode&&(this.temporaryLink.fromNode=this.temporaryFromNode),null!==this.temporaryToNode&&(this.temporaryLink.toNode=this.temporaryToNode),this.copyLinkProperties(e,this.temporaryLink),this.temporaryLink.invalidateRoute(),t.add(this.temporaryLink)),this.isActive=!0)}copyLinkProperties(t,e){if(null===t||null===e)return;e.adjusting=t.adjusting,e.corner=t.corner;let i=t.curve;(11===i||10===i)&&(i=0),e.curve=i,e.curviness=t.curviness,e.isTreeLink=t.isTreeLink,e.points=t.points,e.routing=t.routing,e.smoothness=t.smoothness,e.fromSpot=t.fromSpot,e.fromEndSegmentLength=t.fromEndSegmentLength,e.fromShortLength=t.fromShortLength,e.toSpot=t.toSpot,e.toEndSegmentLength=t.toEndSegmentLength,e.toShortLength=t.toShortLength}doDeactivate(){this.isActive=!1;const t=this.diagram;t.remove(this.temporaryLink),t.remove(this.temporaryFromNode),t.remove(this.temporaryToNode),t.isMouseCaptured=!1,t.currentCursor="",this.stopTransaction()}doStop(){super.doStop(),this.handle=null}doMouseUp(){if(this.isActive){const t=this.diagram;this.transactionResult=null;let e=this.originalFromNode,i=this.originalFromPort,n=this.originalToNode,s=this.originalToPort,o=this.originalLink;try{if(this.targetPort=this.findTargetPort(this.isForwards),null!==this.targetPort){const t=this.targetPort.part;t instanceof me&&(this.isForwards?(n=t,s=this.targetPort):(e=t,i=this.targetPort))}else this.isUnconnectedLinkValid?this.isForwards?(n=null,s=null):(e=null,i=null):o=null;null!==o?(this.reconnectLink(o,this.isForwards?n:e,this.isForwards?s:i,this.isForwards),null===this.targetPort&&(this.isForwards?o.defaultToPoint=t.lastInput.documentPoint:o.defaultFromPoint=t.lastInput.documentPoint,o.invalidateRoute()),this.transactionResult=this.name,t.v("LinkRelinked",o,this.isForwards?this.originalToPort:this.originalFromPort)):null!==this.originalLink&&this.doNoRelink(this.originalLink,this.isForwards),null!==this.originalLink&&this.originalLink.invalidateOtherJumpOvers(this.qP)}finally{this.stopTool()}}}reconnectLink(t,e,i,n){const s=null!==i&&null!==i.portId?i.portId:"";return n?(t.toNode=e,t.toPortId=s):(t.fromNode=e,t.fromPortId=s),!0}doNoRelink(t,e){}doDraggingMouseMove(t,e,i,n){null!==t?(this.copyPortProperties(t,e,this.temporaryFromNode,this.temporaryFromPort,!1),this.diagram.add(this.temporaryFromNode)):this.diagram.remove(this.temporaryFromNode),null!==i?(this.copyPortProperties(i,n,this.temporaryToNode,this.temporaryToPort,!0),this.diagram.add(this.temporaryToNode)):this.diagram.remove(this.temporaryToNode)}stopDraggingMouseMove(){this.diagram.remove(this.temporaryFromNode),this.diagram.remove(this.temporaryToNode)}}var _=(t=>(t[t.None=0]="None",t[t.Horizontal=1]="Horizontal",t[t.Vertical=2]="Vertical",t[t.All=3]="All",t))(_||{});class H extends I{kr;WP;JP;gs;Vw;$P;Pm;constructor(t){super(),this.name="LinkReshaping",this.kr=new Jt("Rectangle",{desiredSize:x.fC,fill:"lightblue",stroke:"dodgerblue"}).theme("fill","adornmentFill").theme("stroke","adornmentStroke"),this.WP=new Jt("Diamond",{desiredSize:x.cu,fill:"lightblue",stroke:"dodgerblue",cursor:"move"}).theme("fill","adornmentFill").theme("stroke","adornmentStroke"),this.JP=3,this.gs=null,this.Vw=null,this.$P=new y,this.Pm=new l,t&&Object.assign(this,t)}static None=0;static Horizontal=1;static Vertical=2;static All=3;getReshapingBehavior(t){return t?t.Pr:0}setReshapingBehavior(t,e){t.Pr=e}updateAdornments(t){if(null===t||!(t instanceof ve))return;let e=null;if(t.isSelected&&!this.diagram.isReadOnly){const i=t.path;null!==i&&t.canReshape()&&t.actualBounds.isReal()&&t.isVisible()&&i.actualBounds.isReal()&&i.isVisibleObject()&&(e=t.findAdornment(this.name),(null===e||e.ZP!==t.pointsCount||e.QP!==t.resegmentable)&&(e=this.makeAdornment(i),null!==e&&(e.ZP=t.pointsCount,e.QP=t.resegmentable,t.addAdornment(this.name,e))))}null===e&&t.removeAdornment(this.name)}makeAdornment(t){const e=t.part,i=e.points,n=e.pointsCount,s=e.isOrthogonal;let o=null;if(null!==i&&n>1){o=new fe,o.type=Yt.Link;const i=e.firstPickIndex,n=e.lastPickIndex,r=s?1:0;if(e.resegmentable&&9!==e.computeCurve())for(let e=i+r;e<n-r;e++){const i=this.makeResegmentHandle(t,e);null!==i&&(i.segmentIndex=e,i.segmentFraction=.5,i.fromMaxLinks=999,o.add(i))}for(let a=i+1;a<n;a++){const r=this.makeHandle(t,a);if(null!==r){if(r.segmentIndex=a,a!==i)if(a===i+1&&s){const t=e.getPoint(i);let n=e.getPoint(i+1);S.f(t.x,n.x)&&S.f(t.y,n.y)?(n=e.getPoint(i-1),S.f(t.x,n.x)?(this.setReshapingBehavior(r,2),r.cursor="n-resize"):S.f(t.y,n.y)&&(this.setReshapingBehavior(r,1),r.cursor="w-resize")):S.f(t.x,n.x)?(this.setReshapingBehavior(r,2),r.cursor="n-resize"):S.f(t.y,n.y)&&(this.setReshapingBehavior(r,1),r.cursor="w-resize")}else if(a===n-1&&s){let t=e.getPoint(n-1);const i=e.getPoint(n);S.f(t.x,i.x)&&S.f(t.y,i.y)?(t=e.getPoint(n+1),S.f(t.x,i.x)?(this.setReshapingBehavior(r,2),r.cursor="n-resize"):S.f(t.y,i.y)&&(this.setReshapingBehavior(r,1),r.cursor="w-resize")):S.f(t.x,i.x)?(this.setReshapingBehavior(r,2),r.cursor="n-resize"):S.f(t.y,i.y)&&(this.setReshapingBehavior(r,1),r.cursor="w-resize")}else a===n||(this.setReshapingBehavior(r,3),r.cursor="move");o.add(r)}}o.adornedObject=t}return o}makeHandle(t,e){const i=this.handleArchetype;return null===i?null:i.copy()._P()}get handleArchetype(){return this.kr}set handleArchetype(t){this.kr=t}makeResegmentHandle(t,e){const i=this.midHandleArchetype;return null===i?null:i.copy()._P()}get midHandleArchetype(){return this.WP}set midHandleArchetype(t){this.WP=t}get handle(){return this.gs}set handle(t){null!==t&&(t.part instanceof fe||e.o("new handle is not in an Adornment: "+t)),this.gs=t}get adornedLink(){return this.Vw}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;return!(t.isReadOnly||!t.allowReshape||!t.lastInput.left)&&null!==this.findToolHandleAt(t.firstInput.documentPoint,this.name)}doActivate(){const t=this.diagram;if(null===this.handle&&(this.handle=this.findToolHandleAt(t.firstInput.documentPoint,this.name)),null===this.handle)return;const e=this.handle.part.adornedPart;if(e instanceof ve){if(this.Vw=e,t.isMouseCaptured=!0,this.startTransaction(this.name),e.resegmentable&&999===this.handle.fromMaxLinks){const i=e.points.copy(),n=this.getResegmentingPoint();if(i.insertAt(this.handle.segmentIndex+1,n),e.isOrthogonal&&i.insertAt(this.handle.segmentIndex+1,n),e.points=i,e.invalidateAdornments(),e.updateAdornments(),this.handle=this.findToolHandleAt(t.firstInput.documentPoint,this.name),null===this.handle)return void this.doDeactivate()}this.$P=e.getPoint(this.handle.segmentIndex),this.Pm=e.points.copy(),this.isActive=!0}}doDeactivate(){this.stopTransaction(),this.handle=null,this.Vw=null;this.diagram.isMouseCaptured=!1,this.isActive=!1}stopTransaction(){const t=this.diagram,e=super.stopTransaction();return e&&null!==t.undoManager.transactionToUndo&&t.undoManager.transactionToUndo.optimize(),e}doCancel(){const t=this.adornedLink;null!==t&&(t.points=this.Pm),this.stopTool()}getResegmentingPoint(){return this.handle.getDocumentPoint(w.Center)}doMouseMove(){const t=this.diagram;if(this.isActive){const e=this.computeReshape(t.lastInput.documentPoint);this.reshape(e)}}doMouseUp(){const t=this.diagram;if(this.isActive){const e=this.computeReshape(t.lastInput.documentPoint);this.reshape(e);const i=this.adornedLink;if(null!==i&&i.resegmentable&&null!==this.handle){const t=this.handle.segmentIndex,e=i.getPoint(t-1),n=i.getPoint(t),s=i.getPoint(t+1);if(i.isOrthogonal){if(t>i.firstPickIndex+1&&t<i.lastPickIndex-1){let o=i.getPoint(t-2);if(this.isWithinResegmentingDistance(e,n)&&(this.isInLineOrtho(o,e,n,s,!0)||this.isInLineOrtho(o,e,n,s,!1))){const r=i.points.copy();this.isInLineOrtho(o,e,n,s,!0)?(r.setElt(t-2,new y(o.x,(s.y+o.y)/2)),r.setElt(t+1,new y(s.x,(s.y+o.y)/2))):(r.setElt(t-2,new y((s.x+o.x)/2,o.y)),r.setElt(t+1,new y((s.x+o.x)/2,s.y))),r.removeAt(t),r.removeAt(t-1),i.points=r,i.invalidateAdornments()}else if(o=i.getPoint(t+2),this.isWithinResegmentingDistance(n,s)&&(this.isInLineOrtho(e,n,s,o,!0)||this.isInLineOrtho(e,n,s,o,!1))){const r=i.points.copy();this.isInLineOrtho(e,n,s,o,!0)?(r.setElt(t-1,new y(e.x,(e.y+o.y)/2)),r.setElt(t+2,new y(o.x,(e.y+o.y)/2))):(r.setElt(t-1,new y((e.x+o.x)/2,e.y)),r.setElt(t+2,new y((e.x+o.x)/2,o.y))),r.removeAt(t+1),r.removeAt(t),i.points=r,i.invalidateAdornments()}}}else{const o=y.l();if(S.bl(e.x,e.y,s.x,s.y,n.x,n.y,o)&&o.distanceSquaredPoint(n)<this.resegmentingDistance*this.resegmentingDistance){const e=i.points.copy();e.removeAt(t),i.points=e,i.invalidateAdornments()}y.e(o)}}t.invalidateDocumentBounds(),this.transactionResult=this.name,t.v("LinkReshaped",this.adornedLink,this.Pm)}this.stopTool()}isWithinResegmentingDistance(t,e){return Math.abs(t.x-e.x)<this.resegmentingDistance&&Math.abs(t.y-e.y)<this.resegmentingDistance}isInLineOrtho(t,e,i,n,s){return s?Math.abs(t.y-e.y)<this.resegmentingDistance&&Math.abs(e.y-i.y)<this.resegmentingDistance&&Math.abs(i.y-n.y)<this.resegmentingDistance:Math.abs(t.x-e.x)<this.resegmentingDistance&&Math.abs(e.x-i.x)<this.resegmentingDistance&&Math.abs(i.x-n.x)<this.resegmentingDistance}get resegmentingDistance(){return this.JP}set resegmentingDistance(t){e.s(t,"number",H,"resegmentingDistance"),this.JP=t}reshape(t){const e=this.adornedLink;if(null===e)return;const i=this.handle;if(null===i)return;e.startRoute();let n=i.segmentIndex;const s=this.getReshapingBehavior(i);if(e.isOrthogonal)if(n===e.firstPickIndex+1){const i=e.firstPickIndex+1;2===s?(e.setPointAt(i,e.getPoint(i-1).x,t.y),e.setPointAt(i+1,e.getPoint(i+2).x,t.y)):1===s&&(e.setPointAt(i,t.x,e.getPoint(i-1).y),e.setPointAt(i+1,t.x,e.getPoint(i+2).y))}else if(n===e.lastPickIndex-1){const i=e.lastPickIndex-1;2===s?(e.setPointAt(i-1,e.getPoint(i-2).x,t.y),e.setPointAt(i,e.getPoint(i+1).x,t.y)):1===s&&(e.setPointAt(i-1,t.x,e.getPoint(i-2).y),e.setPointAt(i,t.x,e.getPoint(i+1).y))}else{let i=n;const s=e.getPoint(i),o=e.getPoint(i-1),r=e.getPoint(i+1);S.f(o.x,s.x)&&S.f(s.y,r.y)?(S.f(o.x,e.getPoint(i-2).x)&&!S.f(o.y,e.getPoint(i-2).y)?(e.insertPointAt(i,t.x,o.y),n++,i++):e.setPointAt(i-1,t.x,o.y),S.f(r.y,e.getPoint(i+2).y)&&!S.f(r.x,e.getPoint(i+2).x)?e.insertPointAt(i+1,r.x,t.y):e.setPointAt(i+1,r.x,t.y)):S.f(o.y,s.y)&&S.f(s.x,r.x)?(S.f(o.y,e.getPoint(i-2).y)&&!S.f(o.x,e.getPoint(i-2).x)?(e.insertPointAt(i,o.x,t.y),n++,i++):e.setPointAt(i-1,o.x,t.y),S.f(r.x,e.getPoint(i+2).x)&&!S.f(r.y,e.getPoint(i+2).y)?e.insertPointAt(i+1,t.x,r.y):e.setPointAt(i+1,t.x,r.y)):S.f(o.x,s.x)&&S.f(s.x,r.x)?(S.f(o.x,e.getPoint(i-2).x)&&!S.f(o.y,e.getPoint(i-2).y)?(e.insertPointAt(i,t.x,o.y),n++,i++):e.setPointAt(i-1,t.x,o.y),S.f(r.x,e.getPoint(i+2).x)&&!S.f(r.y,e.getPoint(i+2).y)?e.insertPointAt(i+1,t.x,r.y):e.setPointAt(i+1,t.x,r.y)):S.f(o.y,s.y)&&S.f(s.y,r.y)&&(S.f(o.y,e.getPoint(i-2).y)&&!S.f(o.x,e.getPoint(i-2).x)?(e.insertPointAt(i,o.x,t.y),n++,i++):e.setPointAt(i-1,o.x,t.y),S.f(r.y,e.getPoint(i+2).y)&&!S.f(r.x,e.getPoint(i+2).x)?e.insertPointAt(i+1,r.x,t.y):e.setPointAt(i+1,r.x,t.y)),e.setPointAt(n,t.x,t.y)}else{e.setPointAt(n,t.x,t.y);let i=e.fromNode,s=e.fromPort;if(null!==i){const t=i.findVisibleNode();null!==t&&t!==i&&(i=t,s=i.port)}if(1===n&&null!==s&&e.computeSpot(!0,s).isNoSpot()){const n=s.getDocumentPoint(w.Center,y.l()),o=e.getLinkPointFromPoint(i,s,n,t,!0,y.l());e.setPointAt(0,o.x,o.y),y.e(n),y.e(o)}let o=e.toNode,r=e.toPort;if(null!==o){const t=o.findVisibleNode();null!==t&&t!==o&&(o=t,r=o.port)}if(n===e.pointsCount-2&&null!==r&&e.computeSpot(!1,r).isNoSpot()){const i=r.getDocumentPoint(w.Center,y.l()),n=e.getLinkPointFromPoint(o,r,i,t,!1,y.l());e.setPointAt(e.pointsCount-1,n.x,n.y),y.e(i),y.e(n)}}e.commitRoute()}computeReshape(t){const e=this.adornedLink;if(null===e)return t;const i=this.handle;if(null===i)return t;const n=i.segmentIndex;switch(this.getReshapingBehavior(i)){case 3:return t;case 2:{const i=e.getPoint(n);return new y(i.x,t.y)}case 1:{const i=e.getPoint(n);return new y(t.x,i.y)}default:return e.getPoint(n)}}get originalPoint(){return this.$P}get originalPoints(){return this.Pm}}class q extends I{Sr;Mr;Do;Sc;tS;ms;kr;gs;Sm;iS;Mc;zw;Xw;Yw;constructor(t){super(),this.name="Resizing",this.Sr=new x(1,1).u(),this.Mr=new x(9999,9999).u(),this.Do=new x(NaN,NaN).u(),this.Sc=!1,this.tS=!0,this.ms=null,this.kr=new Jt("Rectangle",{alignmentFocus:w.Center,desiredSize:x.fC,fill:"lightblue",stroke:"dodgerblue",strokeWidth:1,cursor:"pointer"}).theme("fill","adornmentFill").theme("stroke","adornmentStroke"),this.gs=null,this.Sm=new y,this.iS=new x,this.Mc=new y,this.zw=new x(0,0),this.Xw=new x(1/0,1/0),this.Yw=new x(1,1),t&&Object.assign(this,t)}updateAdornments(t){if(!(null===t||t instanceof ve)){if(t.isSelected&&!this.diagram.isReadOnly){const e=t.resizeObject;let i=t.findAdornment(this.name);if(null!==e&&t.canResize()&&t.actualBounds.isReal()&&t.isVisible()&&e.actualBounds.isReal()&&e.isVisibleObject()&&((null===i||i.adornedObject!==e)&&(i=this.makeAdornment(e)),null!==i)){const n=e.getDocumentAngle();return t.Fl()&&this.updateResizeHandles(i,n),void t.addAdornment(this.name,i)}}t.removeAdornment(this.name)}}makeAdornment(t){let e=null;const i=t.part?.resizeAdornmentTemplate;if(i){if(e=i.copy(),null===e)return null}else{e=new fe,e.type=Yt.Spot,e.locationSpot=w.Center;const i=new Te;i.isPanelMain=!0,e.add(i);let n=this.makeHandle(t,w.TopLeft);null!==n&&e.add(n),n=this.makeHandle(t,w.TopRight),null!==n&&e.add(n),n=this.makeHandle(t,w.BottomRight),null!==n&&e.add(n),n=this.makeHandle(t,w.BottomLeft),null!==n&&e.add(n),n=this.makeHandle(t,w.MiddleTop),null!==n&&e.add(n),n=this.makeHandle(t,w.MiddleRight),null!==n&&e.add(n),n=this.makeHandle(t,w.MiddleBottom),null!==n&&e.add(n),n=this.makeHandle(t,w.MiddleLeft),null!==n&&e.add(n)}return e.adornedObject=t,e}makeHandle(t,e){const i=this.handleArchetype;if(null===i)return null;const n=i.copy()._P();return n.alignment=e,n}updateResizeHandles(t,e){if(null!==t)if(!t.alignment.isDefault()&&("pointer"===t.cursor||t.cursor.indexOf("resize")>0))this.wF(t,e);else if(t instanceof Yt){const i=t.elements;for(;i.next();){const t=i.value;this.updateResizeHandles(t,e)}}}wF(t,e){let i=t.alignment;i.isNoSpot()&&(i=w.Center);let n=e;if(i.x<=0)i.y<=0?n+=225:i.y>=1?n+=135:n+=180;else if(i.x>=1)i.y<=0?n+=315:i.y>=1&&(n+=45);else if(i.y<=0)n+=270;else{if(!(i.y>=1))return;n+=90}n<0?n+=360:n>=360&&(n-=360),t.cursor=n<22.5?"e-resize":n<67.5?"se-resize":n<112.5?"s-resize":n<157.5?"sw-resize":n<202.5?"w-resize":n<247.5?"nw-resize":n<292.5?"n-resize":n<337.5?"ne-resize":"e-resize"}get handleArchetype(){return this.kr}set handleArchetype(t){this.kr=t}get handle(){return this.gs}set handle(t){null!==t&&(t.part instanceof fe||e.o("new handle is not in an Adornment: "+t)),this.gs=t}get adornedObject(){return this.ms}set adornedObject(t){null!==t&&t.part instanceof fe&&e.o("new handle must not be in an Adornment: "+t),this.ms=t}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;return!(t.isReadOnly||!t.allowResize||!t.lastInput.left)&&null!==this.findToolHandleAt(t.firstInput.documentPoint,this.name)}doActivate(){const t=this.diagram;null===this.handle&&(this.handle=this.findToolHandleAt(t.firstInput.documentPoint,this.name)),null!==this.handle&&(this.adornedObject=this.handle.part.adornedObject,null!==this.adornedObject&&null!==this.adornedObject.part&&(t.isMouseCaptured=!0,t.animationManager.stopAnimation(),t.xu=!0,this.startTransaction(this.name),this.Sm.set(this.adornedObject.getDocumentPoint(this.handle.alignment.opposite())),this.Mc.set(this.adornedObject.part.location),this.iS.set(this.adornedObject.desiredSize),this.Yw=this.computeCellSize(),this.zw=this.computeMinSize(),this.Xw=this.computeMaxSize(),this.isActive=!0))}doDeactivate(){const t=this.diagram;t.xu=!1,t.Cl=!0,this.stopTransaction(),this.handle=null,this.ms=null,t.isMouseCaptured=!1,this.isActive=!1}stopTransaction(){const t=this.diagram,e=super.stopTransaction();return e&&null!==t.undoManager.transactionToUndo&&t.undoManager.transactionToUndo.optimize(),e}doCancel(){null!==this.adornedObject&&null!==this.adornedObject.part&&(this.adornedObject.desiredSize=this.originalDesiredSize,this.adornedObject.part.location=this.originalLocation),this.stopTool()}doMouseMove(){const t=this.diagram;if(!this.isActive||null===this.adornedObject||null===this.handle)return;const e=this.zw,i=this.Xw,n=this.Yw,s=t.lastInput.documentPoint,o=this.adornedObject.getLocalPoint(s,y.l()),r=this.computeReshape(),a=this.computeResize(o,this.handle.alignment,e,i,n,r);this.resize(a),t.maybeUpdate(),y.e(o)}doMouseUp(){const t=this.diagram;if(this.isActive&&null!==this.adornedObject&&null!==this.handle){const e=this.zw,i=this.Xw,n=this.Yw,s=this.adornedObject.getLocalPoint(t.lastInput.documentPoint,y.l()),o=this.computeReshape(),r=this.computeResize(s,this.handle.alignment,e,i,n,o);this.resize(r),y.e(s),t.invalidateDocumentBounds(),this.transactionResult=this.name,t.v("PartResized",this.adornedObject,this.originalDesiredSize)}this.stopTool()}resize(t){const e=this.diagram,i=this.adornedObject;if(null===i)return;i.desiredSize=t.size;const n=i.part;if(null===n||null===this.handle)return;n.ensureBounds();const s=i.getDocumentPoint(this.handle.alignment.opposite());if(n instanceof Ne){const t=new l;let i;t.add(n),!this.dragsMembers&&!n.hasPlaceholder()&&(i=new St,i.dragsMembers=!1),e.moveParts(t,this.oppositePoint.copy().subtract(s),!0,i)}else n.location=n.location.copy().subtract(s).add(this.oppositePoint);e.maybeUpdate()}computeResize(t,e,i,n,s,o){if(null===this.adornedObject)return b.Eg;e.isNoSpot()&&(e=w.Center);const r=this.adornedObject.naturalBounds,a=r.x,l=r.y,h=r.x+r.width,u=r.y+r.height;let c=1;if(!o){let t=r.width,e=r.height;t<=0&&(t=1),e<=0&&(e=1),c=e/t}const d=y.l();S.Ig(t.x,t.y,a,l,s.width,s.height,d);const f=r.copy();return e.x<=0?e.y<=0?(f.x=Math.max(d.x,h-n.width),f.x=Math.min(f.x,h-i.width),f.width=Math.max(h-f.x,i.width),f.y=Math.max(d.y,u-n.height),f.y=Math.min(f.y,u-i.height),f.height=Math.max(u-f.y,i.height),o||(f.height/f.width>=1?(f.height=Math.max(Math.min(c*f.width,n.height),i.height),f.width=f.height/c):(f.width=Math.max(Math.min(f.height/c,n.width),i.width),f.height=c*f.width),f.x=h-f.width,f.y=u-f.height)):e.y>=1?(f.x=Math.max(d.x,h-n.width),f.x=Math.min(f.x,h-i.width),f.width=Math.max(h-f.x,i.width),f.height=Math.max(Math.min(d.y-l,n.height),i.height),o||(f.height/f.width>=1?(f.height=Math.max(Math.min(c*f.width,n.height),i.height),f.width=f.height/c):(f.width=Math.max(Math.min(f.height/c,n.width),i.width),f.height=c*f.width),f.x=h-f.width)):(f.x=Math.max(d.x,h-n.width),f.x=Math.min(f.x,h-i.width),f.width=h-f.x,o||(f.height=Math.max(Math.min(c*f.width,n.height),i.height),f.width=f.height/c,f.y=l+.5*(u-l-f.height))):e.x>=1?e.y<=0?(f.width=Math.max(Math.min(d.x-a,n.width),i.width),f.y=Math.max(d.y,u-n.height),f.y=Math.min(f.y,u-i.height),f.height=Math.max(u-f.y,i.height),o||(f.height/f.width>=1?(f.height=Math.max(Math.min(c*f.width,n.height),i.height),f.width=f.height/c):(f.width=Math.max(Math.min(f.height/c,n.width),i.width),f.height=c*f.width),f.y=u-f.height)):e.y>=1?(f.width=Math.max(Math.min(d.x-a,n.width),i.width),f.height=Math.max(Math.min(d.y-l,n.height),i.height),o||(f.height/f.width>=1?(f.height=Math.max(Math.min(c*f.width,n.height),i.height),f.width=f.height/c):(f.width=Math.max(Math.min(f.height/c,n.width),i.width),f.height=c*f.width))):(f.width=Math.max(Math.min(d.x-a,n.width),i.width),o||(f.height=Math.max(Math.min(c*f.width,n.height),i.height),f.width=f.height/c,f.y=l+.5*(u-l-f.height))):e.y<=0?(f.y=Math.max(d.y,u-n.height),f.y=Math.min(f.y,u-i.height),f.height=u-f.y,o||(f.width=Math.max(Math.min(f.height/c,n.width),i.width),f.height=c*f.width,f.x=a+.5*(h-a-f.width))):e.y>=1&&(f.height=Math.max(Math.min(d.y-l,n.height),i.height),o||(f.width=Math.max(Math.min(f.height/c,n.width),i.width),f.height=c*f.width,f.x=a+.5*(h-a-f.width))),y.e(d),f}computeReshape(){let t=0;return this.adornedObject instanceof Jt&&(t=this.adornedObject.eS()),!(6===t||this.diagram.lastInput.shift)}computeMinSize(){if(null===this.adornedObject)return x.hc;const t=this.adornedObject.minSize.copy(),e=this.minSize;return!isNaN(e.width)&&e.width>t.width&&(t.width=e.width),!isNaN(e.height)&&e.height>t.height&&(t.height=e.height),t}computeMaxSize(){if(null===this.adornedObject)return x.Fk;const t=this.adornedObject.maxSize.copy(),e=this.maxSize;return!isNaN(e.width)&&e.width<t.width&&(t.width=e.width),!isNaN(e.height)&&e.height<t.height&&(t.height=e.height),t}computeCellSize(){const t=new x(NaN,NaN),e=this.adornedObject?.part;if(e){const i=e.resizeCellSize;!isNaN(i.width)&&i.width>0&&(t.width=i.width),!isNaN(i.height)&&i.height>0&&(t.height=i.height)}let i=this.cellSize;isNaN(t.width)&&!isNaN(i.width)&&i.width>0&&(t.width=i.width),isNaN(t.height)&&!isNaN(i.height)&&i.height>0&&(t.height=i.height);const n=this.diagram;if((isNaN(t.width)||isNaN(t.height))&&n){const e=n.grid;null!==e&&e.visible&&this.isGridSnapEnabled&&(i=e.gridCellSize,isNaN(t.width)&&!isNaN(i.width)&&i.width>0&&(t.width=i.width),isNaN(t.height)&&!isNaN(i.height)&&i.height>0&&(t.height=i.height))}return(isNaN(t.width)||0===t.width||t.width===1/0)&&(t.width=1),(isNaN(t.height)||0===t.height||t.height===1/0)&&(t.height=1),t}get minSize(){return this.Sr}set minSize(t){if(!this.Sr.equals(t)){let e=t.width;isNaN(e)&&(e=0);let i=t.height;isNaN(i)&&(i=0),this.Sr.i(e,i)}}get maxSize(){return this.Mr}set maxSize(t){if(!this.Mr.equals(t)){let e=t.width;isNaN(e)&&(e=1/0);let i=t.height;isNaN(i)&&(i=1/0),this.Mr.i(e,i)}}get cellSize(){return this.Do}set cellSize(t){this.Do.equals(t)||this.Do.a(t)}get isGridSnapEnabled(){return this.Sc}set isGridSnapEnabled(t){e.s(t,"boolean",q,"isGridSnapEnabled"),this.Sc=t}get dragsMembers(){return this.tS}set dragsMembers(t){e.s(t,"boolean",q,"dragsMembers"),this.tS=t}get oppositePoint(){return this.Sm}set oppositePoint(t){this.Sm.equals(t)||this.Sm.a(t)}get originalDesiredSize(){return this.iS}get originalLocation(){return this.Mc}}class W extends I{sS;nS;ms;kr;Kw;gs;oS;Mm;Mc;rS;lS;constructor(t){super(),this.name="Rotating",this.sS=45,this.nS=2,this.Mc=new y,this.ms=null,this.handleArchetype=new Jt("Ellipse",{desiredSize:x.cu,fill:"lightblue",stroke:"dodgerblue",strokeWidth:1,cursor:"pointer"}).theme("fill","adornmentFill").theme("stroke","adornmentStroke"),this.gs=null,this.oS=0,this.Mm=new y(NaN,NaN),this.rS=0,this.lS=50,t&&Object.assign(this,t)}updateAdornments(t){if(null!==t){if(t.Rl()){const e=t.rotateObject;if(e===t||e===t.path||e.isPanelMain)return}if(t.isSelected&&!this.diagram.isReadOnly){const e=t.rotateObject;if(null!==e&&t.canRotate()&&t.actualBounds.isReal()&&t.isVisible()&&e.actualBounds.isReal()&&e.isVisibleObject()){let i=t.findAdornment(this.name);if((null===i||i.adornedObject!==e)&&(i=this.makeAdornment(e)),null!==i)return i.angle=e.getDocumentAngle(),i.hasPlaceholder()||(i.location=this.computeAdornmentLocation(e)),void t.addAdornment(this.name,i)}}t.removeAdornment(this.name)}}makeAdornment(t){let e=null;const i=t.part?.rotateAdornmentTemplate;return i?e=i.copy():null!==this.Kw&&(e=this.Kw.copy()),null===e?null:(e.adornedObject=t,e)}get handleArchetype(){return this.kr}set handleArchetype(t){this.kr=t,this.Kw=null!==t?new fe(Yt.Position,{locationSpot:w.Center}).add(t).zt():null}get handle(){return this.gs}set handle(t){null!==t&&(t.part instanceof fe||e.o("new handle is not in an Adornment: "+t)),this.gs=t}get adornedObject(){return this.ms}set adornedObject(t){null!==t&&t.part instanceof fe&&e.o("new handle must not be in an Adornment: "+t),this.ms=t}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;return!(t.isReadOnly||!t.allowRotate||!t.lastInput.left)&&null!==this.findToolHandleAt(t.firstInput.documentPoint,this.name)}doActivate(){const t=this.diagram;if(null===this.adornedObject){if(null===this.handle&&(this.handle=this.findToolHandleAt(t.firstInput.documentPoint,this.name)),null===this.handle)return;this.adornedObject=this.handle.part.adornedObject}null===this.adornedObject||null===this.adornedObject.part||(t.isMouseCaptured=!0,t.delaysLayout=!0,this.startTransaction(this.name),this.oS=this.adornedObject.angle,this.Mm=this.computeRotationPoint(this.adornedObject),this.Mc=this.adornedObject.part.location.copy(),this.isActive=!0)}computeRotationPoint(t){const e=t.part;if(null!==e){const i=e.locationObject;if(e.rotationSpot.isSpot())return t.getDocumentPoint(e.rotationSpot);if(t===e||t===i)return i.getDocumentPoint(e.locationSpot)}return t.getDocumentPoint(w.Center)}computeAdornmentLocation(t){let e=this.rotationPoint;e.isReal()||(e=this.computeRotationPoint(t));const i=t.getLocalPoint(e);let n=this.handleAngle;n<0?n+=360:n>=360&&(n-=360),n=Math.round(45*Math.round(n/45));const s=this.handleDistance;return 0===n?i.x=t.naturalBounds.width+s:45===n?(i.x=t.naturalBounds.width+s,i.y=t.naturalBounds.height+s):90===n?i.y=t.naturalBounds.height+s:135===n?(i.x=-s,i.y=t.naturalBounds.height+s):180===n?i.x=-s:225===n?(i.x=-s,i.y=-s):270===n?i.y=-s:315===n&&(i.x=t.naturalBounds.width+s,i.y=-s),t.getDocumentPoint(i)}doDeactivate(){const t=this.diagram;this.stopTransaction(),this.handle=null,this.ms=null,this.Mm=new y(NaN,NaN),t.isMouseCaptured=!1,this.isActive=!1}stopTransaction(){const t=this.diagram,e=super.stopTransaction();return e&&null!==t.undoManager.transactionToUndo&&t.undoManager.transactionToUndo.optimize(),e}doCancel(){this.diagram.delaysLayout=!1,this.rotate(this.originalAngle),this.stopTool()}doMouseMove(){const t=this.diagram;if(this.isActive){const e=this.computeRotate(t.lastInput.documentPoint);this.rotate(e)}}doMouseUp(){const t=this.diagram;if(this.isActive){t.delaysLayout=!1;const e=this.computeRotate(t.lastInput.documentPoint);this.rotate(e),t.invalidateDocumentBounds(),this.transactionResult=this.name,t.v("PartRotated",this.adornedObject,this.originalAngle)}this.stopTool()}rotate(t){const e=this.adornedObject;if(null===e||null===e.part)return;e.angle=t;const i=e.part;i.ensureBounds();const n=i.locationObject,s=i.rotateObject;if(n===s||n.isContainedBy(s)){const e=this.Mc.copy();i.location=e.subtract(this.rotationPoint).rotate(t-this.originalAngle).add(this.rotationPoint)}this.diagram.maybeUpdate()}computeRotate(t){let e=this.rotationPoint.directionPoint(t)-this.handleAngle;const i=this.adornedObject?.panel;i&&(e-=i.getDocumentAngle()),e>=360?e-=360:e<0&&(e+=360);const n=Math.min(Math.abs(this.snapAngleMultiple),180),s=Math.min(Math.abs(this.snapAngleEpsilon),n/2);return!this.diagram.lastInput.shift&&n>0&&s>0&&(e%n<s?e=Math.floor(e/n)*n:e%n>n-s&&(e=(Math.floor(e/n)+1)*n)),e>=360?e-=360:e<0&&(e+=360),e}get snapAngleMultiple(){return this.sS}set snapAngleMultiple(t){e.s(t,"number",W,"snapAngleMultiple"),this.sS=t}get snapAngleEpsilon(){return this.nS}set snapAngleEpsilon(t){e.s(t,"number",W,"snapAngleEpsilon"),this.nS=t}get originalAngle(){return this.oS}get rotationPoint(){return this.Mm}set rotationPoint(t){this.Mm=t.copy()}get handleAngle(){return this.rS}set handleAngle(t){e.s(t,"number",W,"handleAngle"),this.rS=t}get handleDistance(){return this.lS}set handleDistance(t){e.s(t,"number",W,"handleDistance"),this.lS=t}}class $ extends I{constructor(t){super(),this.name="ClickSelecting",t&&Object.assign(this,t)}canStart(){return!(!this.isEnabled||this.isBeyondDragSize())}doMouseUp(){this.isActive&&(this.standardMouseSelect(),this.standardMouseClick()||this.diagram.lastInput.isTouchEvent&&this.diagram.toolManager.doToolTip()),this.stopTool()}}class J extends I{Nc;constructor(t){super(),this.name="Action",this.Nc=null,t&&Object.assign(this,t)}canStart(){if(!this.isEnabled)return!1;const t=this.diagram,e=t.lastInput,i=t.findObjectAt(e.documentPoint,(t=>{for(;null!==t.panel;){if(t.isActionable)return t;t=t.panel}return t}));return!(null===i||!i.isActionable)&&(this.Nc=i,t.xc=t.findObjectAt(e.documentPoint,null,null),!0)}doMouseDown(){if(this.isActive){const t=this.diagram.lastInput,e=this.Nc;if(null===e)return;t.targetObject=e,null!==e.actionDown&&e.actionDown(t,e)}else this.canStart()&&this.doActivate()}doMouseMove(){if(this.isActive){const t=this.diagram.lastInput,e=this.Nc;if(null===e)return;t.targetObject=e,null!==e.actionMove&&e.actionMove(t,e)}}doMouseUp(){if(this.isActive){const t=this.diagram.lastInput,e=this.Nc;if(null===e)return;t.targetObject=e,null!==e.actionUp&&e.actionUp(t,e),this.standardMouseClick((t=>{for(;null!==t.panel;){if(t.isActionable&&t===e)return t;t=t.panel}return t}),(t=>t===e))}this.stopTool()}doCancel(){const t=this.diagram.lastInput,e=this.Nc;null!==e&&(t.targetObject=e,null!==e.actionCancel&&e.actionCancel(t,e),this.stopTool())}doStop(){this.Nc=null}}class Z extends I{vl;hS;Sc;aS;constructor(t){super(),this.name="ClickCreating",this.vl=null,this.hS=!0,this.Sc=!1,this.aS=new y(0,0),t&&Object.assign(this,t)}canStart(){if(!this.isEnabled||null===this.archetypeNodeData)return!1;const t=this.diagram;if(t.isReadOnly||t.isModelReadOnly||!t.allowInsert||!t.lastInput.left||this.isBeyondDragSize())return!1;if(this.isDoubleClick){if(1===t.lastInput.clickCount&&(this.aS=t.lastInput.viewPoint.copy()),2!==t.lastInput.clickCount||this.isBeyondDragSize(this.aS))return!1}else if(1!==t.lastInput.clickCount)return!1;return!(t.currentTool!==this&&null!==t.findPartAt(t.lastInput.documentPoint,!0))}doMouseUp(){const t=this.diagram;this.isActive&&this.insertPart(t.lastInput.documentPoint),this.stopTool()}insertPart(t){const i=this.diagram,n=this.archetypeNodeData;if(null===n)return null;let s=null;try{if(i.v("ChangingSelection",i.selection),this.startTransaction(this.name),n instanceof ce)n.Me()&&(n.zt(),s=n.copy(),null!==s&&i.add(s));else if(null!==n){const t=i.model.copyNodeData(n);e.H(t)&&(i.model.addNodeData(t),s=i.findPartForData(t))}if(null!==s){const e=y.X(t.x,t.y);this.isGridSnapEnabled&&this.diagram.cS(s,t,e),s.location=e,i.allowSelect&&(i.clearSelection(!0),s.isSelected=!0),y.e(e)}i.invalidateDocumentBounds(),this.transactionResult=this.name,i.v("PartCreated",s)}finally{this.stopTransaction(),i.v("ChangedSelection",i.selection)}return s}get archetypeNodeData(){return this.vl}set archetypeNodeData(t){null!==t&&e.lc(t,Z,"archetypeNodeData"),this.vl=t}get isDoubleClick(){return this.hS}set isDoubleClick(t){e.s(t,"boolean",Z,"isDoubleClick"),this.hS=t}get isGridSnapEnabled(){return this.Sc}set isGridSnapEnabled(t){e.s(t,"boolean",Z,"isGridSnapEnabled"),this.Sc=t}}class Q extends I{Hh;fS;Ol;constructor(t){super(),this.name="DragSelecting",this.Hh=175,this.fS=!1,this.Ol=new ce({layerName:"Tool",selectable:!1}).add(new Jt("Rectangle",{name:"SHAPE",fill:null,stroke:"magenta"}).theme("stroke","dragSelect")).zt(),t&&Object.assign(this,t)}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;if(!t.allowSelect)return!1;const e=t.lastInput;return!(!e.left||t.currentTool!==this&&(!this.isBeyondDragSize()||e.timestamp-t.firstInput.timestamp<this.delay||null!==t.findPartAt(e.documentPoint,!0)))}doActivate(){const t=this.diagram;this.isActive=!0,t.isMouseCaptured=!0,t.skipsUndoManager=!0,this.box&&t.add(this.box),this.doMouseMove()}doDeactivate(){const t=this.diagram;t.stopAutoScroll(),this.box&&t.remove(this.box),t.skipsUndoManager=!1,t.isMouseCaptured=!1,this.isActive=!1}doMouseMove(){const t=this.diagram;if(this.isActive&&null!==this.box){const e=this.computeBoxBounds();let i=this.box.findObject("SHAPE");null===i&&(i=this.box.findMainElement());const n=x.l().i(e.width,e.height);null!==i&&(i.desiredSize=n),this.box.Cc(e.x,e.y,!1),x.e(n),(t.allowHorizontalScroll||t.allowVerticalScroll)&&t.doAutoScroll(t.lastInput.viewPoint)}}doMouseUp(){if(this.isActive){const t=this.diagram;this.box&&t.remove(this.box);try{t.currentCursor="wait",t.v("ChangingSelection",t.selection),this.selectInRect(this.computeBoxBounds()),t.v("ChangedSelection",t.selection)}finally{t.currentCursor=""}}this.stopTool()}computeBoxBounds(){const t=this.diagram;return new b(t.firstInput.documentPoint,t.lastInput.documentPoint)}selectInRect(t){const i=this.diagram,n=i.lastInput,s=i.findPartsIn(t,this.isPartialInclusion);if(e.hr?n.meta:n.control)if(n.shift){const t=s.iterator;for(;t.next();){const e=t.value;e.isSelected&&(e.isSelected=!1)}}else{const t=s.iterator;for(;t.next();){const e=t.value;e.isSelected=!e.isSelected}}else if(n.shift){const t=s.iterator;for(;t.next();){const e=t.value;e.isSelected||(e.isSelected=!0)}}else{const t=new l,e=i.selection.iterator;for(;e.next();){const i=e.value;s.has(i)||t.add(i)}const n=t.iterator;for(;n.next();){n.value.isSelected=!1}const o=s.iterator;for(;o.next();){const t=o.value;t.isSelected||(t.isSelected=!0)}}}get delay(){return this.Hh}set delay(t){e.s(t,"number",Q,"delay"),this.Hh=t}get isPartialInclusion(){return this.fS}set isPartialInclusion(t){e.s(t,"boolean",Q,"isPartialInclusion"),this.fS=t}get box(){return this.Ol}set box(t){null!==t&&t.zt(),this.Ol=t}}class tt extends I{Gw;sL;To;uS;constructor(e){super(),this.name="Panning",this.Gw=new y,this.sL=new y,this.To=!1;const i=this;this.uS=()=>{const e=i.diagram;null!==e&&e.Ni(t.document,"scroll",i.uS,!1),i.stopTool()},e&&Object.assign(this,e)}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;return!(!t.allowHorizontalScroll&&!t.allowVerticalScroll||!t.lastInput.left||t.currentTool!==this&&!this.isBeyondDragSize())}doActivate(){const e=this.diagram;this.To?(e.lastInput.bubbles=!0,e.Xt(t.document,"scroll",this.uS,!1)):(e.currentCursor="move",e.isMouseCaptured=!0,this.Gw.a(e.position)),this.isActive=!0}doDeactivate(){const t=this.diagram;t.currentCursor="",t.isMouseCaptured=!1,this.isActive=!1}doCancel(){const t=this.diagram;t.position=this.Gw,t.isMouseCaptured=!1,this.stopTool()}doMouseMove(){this.nL()}doMouseUp(){this.nL(),this.stopTool()}nL(){const t=this.diagram;if(this.isActive&&t){if(this.To)return void(t.lastInput.bubbles=!0);const e=t.position,i=t.firstInput.documentPoint,n=t.lastInput.documentPoint;let s=e.x+i.x-n.x,o=e.y+i.y-n.y;t.allowHorizontalScroll||(s=e.x),t.allowVerticalScroll||(o=e.y),t.position=this.sL.i(s,o)}}get bubbles(){return this.To}set bubbles(t){e.s(t,"boolean",tt,"bubbles"),this.To=t}get originalPosition(){return this.Gw}}class et{Hw;jw;dS;gS;constructor(t){this.Hw=null,this.jw=null,this.dS=null,this.gS=null,t&&Object.assign(this,t)}get mainElement(){return this.dS}set mainElement(t){this.dS=t}get show(){return this.Hw}set show(t){this.Hw!==t&&(null!==t&&e.S(t,et,"show"),this.Hw=t)}get hide(){return this.jw}set hide(t){this.jw!==t&&(null!==t&&e.S(t,et,"hide"),this.jw=t)}get valueFunction(){return this.gS}set valueFunction(t){this.gS=t}}class it{ai;qw;Lc;constructor(t,e,i){this.ai=t,this.qw=e,this.Lc=i}}class nt extends I{mS;Ww;pS;yS;Jw;$w;Nm;constructor(t){super(),this.name="ContextMenu",this.mS=null,this.Ww=null,this.pS=null,this.yS=new y,this.Jw=null,this.Nm=!1;const e=this;this.$w=()=>e.stopTool(),t&&Object.assign(this,t)}xF(){const i=new et;i.show=(t,e,i)=>i.showDefaultContextMenu(),i.hide=(t,e)=>e.hideDefaultContextMenu(),nt.Su=i;const n=this;this.$w=()=>n.stopTool();const s=e.fs("div"),o=e.fs("div");s.style.cssText="top: 0px;z-index:10002;position: fixed;display: none;text-align: center;left: 25%;width: 50%;background-color: #F5F5F5;padding: 16px;border: 16px solid #444;border-radius: 10px;margin-top: 10px",o.style.cssText="z-index:10001;position: fixed;display: none;top: 0;left: 0;width: 100%;height: 100%;background-color: black;opacity: 0.8;";const r=e.fs("style");t.document.getElementsByTagName("head")[0].appendChild(r),r.sheet.insertRule(".goCXul { list-style: none; }",0),r.sheet.insertRule(".goCXli {font:700 1.5em Helvetica, Arial, sans-serif;position: relative;min-width: 60px; }",0),r.sheet.insertRule(".goCXa {color: #444;display: inline-block;padding: 4px;text-decoration: none;margin: 2px;border: 1px solid gray;border-radius: 10px; }",0);const a=this.diagram;null!==a&&(a.Xt(s,"contextmenu",nt.Jh,!1),a.Xt(s,"selectstart",nt.Jh,!1),a.Xt(o,"contextmenu",nt.Jh,!1)),s.className="goCXforeground",o.className="goCXbackground",t.document.body&&(t.document.body.appendChild(s),t.document.body.appendChild(o)),nt.Cm=s,nt.Lm=o,nt.wS=!0}static Su=null;static wS=!1;static Lm=null;static Cm=null;static Jh(t){return t.preventDefault(),!1}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;return!(this.isBeyondDragSize()||!t.lastInput.right||t.lastInput.clickCount>1)&&!!(t.lastInput.isTouchEvent&&null!==this.defaultTouchContextMenu||null!==this.findObjectWithContextMenu())}doStart(){const t=this.diagram;this.yS.set(t.firstInput.documentPoint)}doStop(){this.hideContextMenu(),this.currentObject=null,this.Nm=!1}findObjectWithContextMenu(t){void 0===t&&(t=null);const e=this.diagram,i=e.lastInput;let n=null;if(t instanceof bt||(n=t instanceof At?t:e.findObjectAt(i.documentPoint,null,(t=>!t.layer?.isTemporary))),null!==n){let t=n;for(;null!==t;){if(null!==t.contextMenu)return t;t=t.panel}if(e.lastInput.isTouchEvent&&this.defaultTouchContextMenu)return n.part}else if(null!==e.contextMenu)return e;return null}doActivate(){}doMouseDown(){if(super.doMouseDown(),this.isActive&&this.currentContextMenu instanceof fe){const t=this.diagram.toolManager.findTool("Action");null!==t&&t.canStart()&&(t.doActivate(),t.doMouseDown(),t.doDeactivate())}this.diagram.toolManager.mouseDownTools.has(this)&&this.doContextClick()}doMouseUp(){if(this.isActive&&this.currentContextMenu instanceof fe){const t=this.diagram.toolManager.findTool("Action");null!==t&&t.canStart()&&(t.doActivate(),t.doCancel(),t.doDeactivate())}this.doContextClick()}doContextClick(){const t=this.diagram;if(this.isActive){const e=this.currentContextMenu;if(null===e)return;let i=null;e instanceof et||(i=t.findObjectAt(t.lastInput.documentPoint,null,null),null!==i&&i.isContainedBy(e)&&this.standardMouseClick(null,null)),this.maybeStopTool(i)}else this.canStart()&&(this.openMenu(!0),this.isActive||this.stopTool())}maybeStopTool(t){this.stopTool(),this.canStart()&&(this.diagram.currentTool=this,this.doMouseUp())}openMenu(t,e){if(void 0===e&&(e=null),this.Nm)return;this.Nm=!0,t&&this.standardMouseSelect();const i=this.standardMouseClick();if(this.Nm=!1,!i){this.isActive=!0;const t=nt.Su;if(null===e&&(e=this.findObjectWithContextMenu()),null!==e){const i=e.contextMenu;null!==i?(this.currentObject=e instanceof At?e:null,this.showContextMenu(i,this.currentObject)):null!==t&&this.showContextMenu(t,this.currentObject)}else null!==t&&this.showContextMenu(t,null);this.currentContextMenu instanceof fe&&!this.currentContextMenu.visible&&this.stopTool()}}doMouseMove(){const t=this.diagram.toolManager.findTool("Action");null!==t&&t.doMouseMove(),this.isActive&&this.diagram.toolManager.doMouseMove()}showContextMenu(t,e){const i=this.diagram;if(t!==this.currentContextMenu&&this.hideContextMenu(),t instanceof fe){const n=t;n.layerName="Tool",n.selectable=!1,n.scale=1/i.scale,n.category=this.name,n.hasPlaceholder()&&(n.placeholder.scale=i.scale);const s=n.diagram;null!==s&&s!==i&&s.remove(n),i.add(n),null!==e?n.adornedObject=e:n.data=i.model,n.ensureBounds(),this.positionContextMenu(n,e)}else t instanceof et&&null!==t.show&&t.show(e,i,this);this.currentContextMenu=t}positionContextMenu(t,e){if(t.hasPlaceholder())return;const i=t,n=this.diagram,s=n.lastInput.documentPoint.copy(),o=i.measuredBounds,r=n.viewportBounds;n.lastInput.isTouchEvent&&(s.x-=o.width),s.x+o.width>r.right&&(s.x-=o.width+5/n.scale),s.x<r.x&&(s.x=r.x),s.y+o.height>r.bottom&&(s.y-=o.height+5/n.scale),s.y<r.y&&(s.y=r.y),i.position=s}hideContextMenu(){const t=this.diagram,e=this.currentContextMenu;null!==e&&(e instanceof fe?(t.remove(e),null!==this.Ww&&this.Ww.removeAdornment(e.category),e.data=null,e.adornedObject=null):e instanceof et&&(null!==e.hide?e.hide(t,this):null!==e.mainElement&&(e.mainElement.style.display="none")),this.currentContextMenu=null,this.standardMouseOver())}bF(){const t=this,e=new l;return e.add(new it("Copy",(t=>t.commandHandler.copySelection()),(t=>t.commandHandler.canCopySelection()))),e.add(new it("Cut",(t=>t.commandHandler.cutSelection()),(t=>t.commandHandler.canCutSelection()))),e.add(new it("Delete",(t=>t.commandHandler.deleteSelection()),(t=>t.commandHandler.canDeleteSelection()))),e.add(new it("Paste",(e=>e.commandHandler.pasteSelection(t.mouseDownPoint)),(e=>e.commandHandler.canPasteSelection(t.mouseDownPoint)))),e.add(new it("Select All",(t=>t.commandHandler.selectAll()),(t=>t.commandHandler.canSelectAll()))),e.add(new it("Undo",(t=>t.commandHandler.undo()),(t=>t.commandHandler.canUndo()))),e.add(new it("Redo",(t=>t.commandHandler.redo()),(t=>t.commandHandler.canRedo()))),e.add(new it("Scroll To Part",(t=>t.commandHandler.scrollToPart()),(t=>t.commandHandler.canScrollToPart()))),e.add(new it("Zoom To Fit",(t=>t.commandHandler.zoomToFit()),(t=>t.commandHandler.canZoomToFit()))),e.add(new it("Reset Zoom",(t=>t.commandHandler.resetZoom()),(t=>t.commandHandler.canResetZoom()))),e.add(new it("Group Selection",(t=>t.commandHandler.groupSelection()),(t=>t.commandHandler.canGroupSelection()))),e.add(new it("Ungroup Selection",(t=>t.commandHandler.ungroupSelection()),(t=>t.commandHandler.canUngroupSelection()))),e.add(new it("Edit Text",(t=>t.commandHandler.editTextBlock()),(t=>t.commandHandler.canEditTextBlock()))),e}showDefaultContextMenu(){const t=this.diagram;null===this.Jw&&(this.Jw=this.bF()),nt.Cm.innerHTML="",nt.Lm.addEventListener("pointerdown",this.$w,!1);const i=this,n=e.fs("ul");n.className="goCXul",nt.Cm.appendChild(n),n.innerHTML="";const s=this.Jw.iterator;for(;s.next();){const o=s.value,r=o.qw,a=o.Lc;if(!e.ot(r)||e.ot(a)&&!a(t))continue;const l=e.fs("li");l.className="goCXli";const h=e.fs("a");h.className="goCXa",h.href="#",h.qw=r,h.addEventListener("pointerdown",(function(e){return this.qw(t),i.stopTool(),e.preventDefault(),!1}),!1),h.textContent=o.ai,l.appendChild(h),n.appendChild(l)}nt.Cm.style.display="block",nt.Lm.style.display="block"}hideDefaultContextMenu(){if(null===this.currentContextMenu||this.currentContextMenu!==nt.Su)return;nt.Cm.style.display="none",nt.Lm.style.display="none";const t=this.diagram;null!==t&&t.Ni(nt.Lm,"pointerdown",this.$w,!1),this.currentContextMenu=null}get currentContextMenu(){return this.mS}set currentContextMenu(t){this.mS=t,this.Ww=t instanceof fe?t.adornedPart:null}get defaultTouchContextMenu(){return!1===nt.wS&&null===nt.Su&&bt.isUsingDOM()&&this.xF(),nt.Su}set defaultTouchContextMenu(t){null===t&&(nt.wS=!0),nt.Su=t}get currentObject(){return this.pS}set currentObject(t){this.pS=t}get mouseDownPoint(){return this.yS}}var st=(t=>(t[t.LostFocus=1]="LostFocus",t[t.MouseDown=2]="MouseDown",t[t.Tab=3]="Tab",t[t.Enter=4]="Enter",t))(st||{}),ot=(t=>(t[t.SingleClick=1]="SingleClick",t[t.SingleClickSelected=2]="SingleClickSelected",t[t.DoubleClick=3]="DoubleClick",t))(ot||{}),rt=(t=>(t[t.None=1]="None",t[t.Active=2]="Active",t[t.Editing=3]="Editing",t[t.Validating=4]="Validating",t[t.Invalid=5]="Invalid",t[t.Validated=6]="Validated",t))(rt||{});class at extends I{Ne;xS;bS;Il;jt;kS;PS;SS;Zw;MS;constructor(t){super(),this.name="TextEditing",this.Ne=new ie,this.xS=null,this.bS=2,this.Il=null,this.jt=1,this.kS=1,this.PS=!0,this.SS=null,this.Zw=new et,this.kF(this.Zw),t&&Object.assign(this,t)}static LostFocus=1;static MouseDown=2;static Tab=3;static Enter=4;static SingleClick=1;static SingleClickSelected=2;static DoubleClick=3;static StateNone=1;static StateActive=2;static StateEditing=3;static StateValidating=4;static StateInvalid=5;static StateValidated=6;kF(t){if(!bt.isUsingDOM())return;const i=e.fs("textarea");this.MS=i;const n=this;i.addEventListener("input",(function(t){if(null===n.textBlock)return;const e=n.measureTemporaryTextBlock(this.value),i=this.textScale;this.style.width=20+Math.max(n.textBlock.measuredBounds.width,e.measuredBounds.width)*i+"px",this.rows=Math.max(n.textBlock.lineCount,e.lineCount)}),!1),i.addEventListener("keydown",(function(t){if(t.isComposing||null===n.textBlock)return;const e=t.key;return"Enter"===e?(!1===n.textBlock.isMultiline&&t.preventDefault(),void n.acceptText(4)):"Tab"===e?(n.acceptText(3),void t.preventDefault()):void("Escape"===e&&(n.doCancel(),null!==n.diagram&&n.diagram.doFocus()))}),!1),i.addEventListener("focus",(function(t){n.PF(t)}),!1),i.addEventListener("blur",(function(t){n.SF(t)}),!1),t.valueFunction=()=>i.value,t.mainElement=i,t.show=(t,e,n)=>{if(!(t instanceof ie)||!e||!e.div||!(n instanceof at))return;if(5===n.state)return i.style.border="3px solid red",void i.focus();const s=t.getDocumentPoint(w.Center),o=e.position,r=e.scale;let a=t.getDocumentScale()*r;a<n.minimumEditorScale&&(a=n.minimumEditorScale);const l=t.naturalBounds.width*a+6,h=t.naturalBounds.height*a+2,u=(s.x-o.x)*r,c=(s.y-o.y)*r,d=t.verticalAlignment,f=(t.lineHeight+t.spacingAbove+t.spacingBelow)*t.lineCount*a,g=.5*h-.5*f,m=d.y*h-d.y*f+d.offsetY-g-f/2;i.value=t.text,e.div.style.font=t.font;i.style.position="absolute",i.style.zIndex="100",i.style.font="inherit",i.style.fontSize=100*a+"%",i.style.lineHeight="normal",i.style.width=l+"px",i.style.left=(u-l/2|0)-1+"px",i.style.top=(c+m|0)-1+"px",i.style.textAlign=t.textAlign,i.style.margin="0",i.style.padding="1px",i.style.border="0",i.style.outline="none",i.style.whiteSpace="pre-wrap",i.style.overflow="hidden",i.rows=t.lineCount,i.textScale=a,i.className="goTXarea",e.div.appendChild(i),i.focus(),n.selectsTextOnActivate&&(i.select(),i.setSelectionRange(0,9999))},t.hide=(t,e)=>{t.div&&t.div.removeChild(i)}}get textBlock(){return this.xS}set textBlock(t){this.xS=t}get currentTextEditor(){return this.SS}set currentTextEditor(t){this.SS=t}get defaultTextEditor(){return this.Zw}set defaultTextEditor(t){this.Zw=t}get starting(){return this.bS}set starting(t){this.bS=t}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;if(null===t||t.isReadOnly||at.Ac&&at.Ac!==this&&(at.Ac.acceptText(2),at.Ac&&at.Ac!==this)||!t.lastInput.left||this.isBeyondDragSize())return!1;const e=t.lastInput.documentPoint,i=t.findObjectAt(e);if(null===i||!(i instanceof ie)||!i.editable||null===i.part||!i.part.canEdit())return!1;const n=i.part;return!(null===n||2===this.starting&&!n.isSelected||3===this.starting&&t.lastInput.clickCount<2)}doStart(){at.Ac=this,null!==this.textBlock&&this.doActivate()}doActivate(){if(this.isActive)return;const t=this.diagram;if(null===t)return;let e=this.textBlock;if(null===e&&(e=t.findObjectAt(t.lastInput.documentPoint)),null===e||!(e instanceof ie)||(this.textBlock=e,null===e.part))return;t.animationManager.stopAnimation(),this.isActive=!0,this.jt=2;let i=this.defaultTextEditor;null!==e.textEditor&&(i=e.textEditor),this.Ne=this.textBlock.copy();const n=new b(this.textBlock.getDocumentPoint(w.TopLeft),this.textBlock.getDocumentPoint(w.BottomRight));t.scrollToRect(n),null!==i&&null!==i.show&&i.show(e,t,this),this.currentTextEditor=i}doCancel(){this.stopTool()}doMouseUp(){this.canStart()&&this.doActivate()}doMouseDown(){this.isActive&&this.acceptText(2)}acceptText(t){switch(t){case 2:6===this.jt?this.currentTextEditor instanceof HTMLElement&&this.currentTextEditor.focus():(2===this.jt||5===this.jt||3===this.jt)&&(this.jt=4,this.oL());break;case 1:case 4:case 3:if(4===t&&null!==this.textBlock&&!0===this.textBlock.isMultiline)return;(2===this.jt||5===this.jt||3===this.jt)&&(this.jt=4,this.oL())}}oL(){const t=this.textBlock,e=this.diagram,i=this.currentTextEditor;if(null!==t&&null!==i){const n=t.text;let s="";if(null!==i.valueFunction&&(s=i.valueFunction()),!this.isValidText(t,n,s))return this.jt=5,void this.doError(n,s);this.startTransaction(this.name),this.jt=6,this.transactionResult=this.name,t.text=s,this.doSuccess(n,s),null!==e&&e.v("TextEdited",t,n),this.stopTransaction(),this.stopTool(),null!==e&&e.doFocus()}}doError(t,e){const i=this.textBlock;if(null===i)return;null!==i.errorFunction&&i.errorFunction(this,t,e);const n=this.currentTextEditor;null!==n&&null!==n.show&&n.show(i,this.diagram,this)}doSuccess(t,e){const i=this.textBlock;null!==i&&null!==i.textEdited&&i.textEdited(i,t,e)}doDeactivate(){const t=this.diagram;if(null!==t){if(this.jt=1,null!==this.currentTextEditor){const e=this.currentTextEditor;null!==e&&null!==e.hide&&e.hide(t,this)}this.textBlock=null,this.isActive=!1}}doStop(){at.Ac=null}PF(t){if(null===this.currentTextEditor||1===this.state)return;const i=this.MS;2===this.jt&&(this.jt=3),e.ot(i.select)&&this.selectsTextOnActivate&&(i.select(),i.setSelectionRange(0,9999))}SF(t){if(null===this.currentTextEditor||1===this.state)return;const i=this.MS;e.ot(i.focus)&&i.focus(),e.ot(i.select)&&this.selectsTextOnActivate&&(i.select(),i.setSelectionRange(0,9999))}isValidText(t,e,i){const n=this.textValidation;if(null!==n&&!n(t,e,i))return!1;const s=t.textValidation;return!(null!==s&&!s(t,e,i))}get textValidation(){return this.Il}set textValidation(t){null!==t&&e.S(t,at,"textValidation"),this.Il=t}get minimumEditorScale(){return this.kS}set minimumEditorScale(t){null!==t&&e.s(t,"number",at,"minimumEditorScale"),this.kS=t}get selectsTextOnActivate(){return this.PS}set selectsTextOnActivate(t){null!==t&&e.s(t,"boolean",at,"selectsTextOnActivate"),this.PS=t}get state(){return this.jt}set state(t){this.jt!==t&&(this.jt=t)}measureTemporaryTextBlock(t){const e=this.Ne;return e.text=t,null!==this.textBlock&&e.ut(this.textBlock.El,1/0),e}static Ac=null}var lt=(t=>(t[t.Default=1]="Default",t[t.AnimateLocations=2]="AnimateLocations",t[t.None=3]="None",t))(lt||{});class ht{L;Ci;Bi;Nr;Jn;Fo;NS;CS;Am;xi;Tc;gn;Tm;$h;Qw;Dm;_w;Dc;ku;Fm;constructor(t){this.L=bt.ym(),this.Ci=!1,this.Am=!1,this.xi=!1,this.Tc=!1,this._w=!0,this.Dc=1,this.ku=!1,this.Bi=!0,this.Nr=!0,this.Fo=600,this.NS=!1,this.CS=!1,this.Jn=new u,this.gn=new ut,this.Tm=new ut,this.gn.ps=this,this.$h=new u,this.Qw=new u,this.Dm=new u,this.Fm=new u,t&&Object.assign(this,t)}Ro(t){this.L=t}wE(){return this.L}canStart(t){return!0}Bl(t){return!(!this.Bi||!this.canStart(t))&&(this.Jn.add(t),this.defaultAnimation.isAnimating&&this.stopAnimation(),this.L.Li(),this.xi=!0,!0)}getBundleAnimation(){return this.Tm}LS(){if(!this.Bi||(this.Tm.de.count>0&&this.Tm.start(),!this.xi))return;const e=this.gn,i=this.L,n=this.Jn.has("Model");if(n&&(this.Tc=!0,1===this.Dc?(e.isViewportUnconstrained=!0,e.de.clear(),e.add(i,"position",i.position.copy().offset(0,-200),i.position),e.add(i,"opacity",0,1)):3===this.Dc&&e.de.clear(),2===this.Dc&&i.tx.equals(i.dt)?this._w=!0:this._w=!1,i.v("InitialAnimationStarting",this)),n&&!this.Nr||0===e.de.count)return this.Jn.clear(),this.xi=!1,e.de.clear(),e.ix(i),this.Tc=!1,void i.C();this.Jn.clear(),i.Cr=!1;const s=e.de.get(i);1!==i.autoScale&&null!==s&&(delete s.oi.scale,delete s.ys.scale);const o=this;t.requestAnimationFrame((()=>{!1===o.xi||e.Ci||(i.getRenderingHint("temporaryPixelRatio")&&i.Ew(),i.AS(),o.xi=!1,e.start(),e.Ci&&(o.Mu(),i.invalidateDocumentBounds(),e.rL(0),i.br(!0),o.Nu(),i.v("AnimationStarting",o)))}))}TS(){return this.Jn.has("Trigger")&&1===this.Jn.count}lL(t,e,i,n){this.isTicking||this.TS()||t instanceof ve&&(null!==t.fromNode||null!==t.toNode)||this.gn.add(t,"position",e,i,n)}ex(t){return this.gn.ex(t)}DS(t){return this.gn.DS(t)}MF(e){const i=this.$h,n=this;function s(){if(n.Dm.count>0&&(i.addAll(n.Dm),n.Dm.clear(),n.Ci=!0),!1===n.Ci||0===i.count)return;n.Qw.addAll(i);const e=n.Qw.iterator;for(;e.next();){const t=e.value;!1!==t.Ci&&(t.NF()?t.hL(!1):t.Fc=!0)}n.Qw.clear(),!1!==n.Ci?(n.Mu(),n.L.br(),n.Nu(),t.requestAnimationFrame(s)):t.requestAnimationFrame(s)}this.Ci?this.CF(e):(this.Ci=!0,i.add(e),t.requestAnimationFrame((()=>s())))}CF(t){this.Dm.add(t)}LF(){const t=this.$h.iterator;for(;t.next();)t.value.Fc=!1}Mu(){if(this.Am)return;const t=this.L;this.NS=t.skipsUndoManager,this.CS=t.ge,t.skipsUndoManager=!0,t.ge=!0,this.Am=!0}Nu(){const t=this.L;t.skipsUndoManager=this.NS,t.ge=this.CS,this.Am=!1}stopAnimation(t){const e=this.gn;if(!0===this.xi&&(this.xi=!1,this.Tc=!1,this.Jn.clear(),e.AF()&&this.L.requestUpdate()),!this.Ci)return e.de.clear(),void e.ix(this.L);if(e.Cu(!0),e.ix(null),!0===t){const t=this.$h.toArray();for(let e=0;e<t.length;e++)t[e].Cu(!0)}}Cu(t){this.$h.delete(t),0===this.$h.count&&(this.Ci=!1,this.L.requestUpdate()),t===this.defaultAnimation&&this.L.v("AnimationFinished",this)}Rc(t,e){this.xi&&(!this.Jn.has("Expand Tree")&&!this.Jn.has("Expand SubGraph")||(this.gn.Rc(t,e),this.aL(t)))}vc(t,e){this.xi&&(!this.Jn.has("Collapse Tree")&&!this.Jn.has("Collapse SubGraph")||(this.gn.vc(t,e),this.gn.FS(e,"position",e.position,e.position),this.aL(t)))}cL(t,e){!this.xi||t.equals(e)||this.TS()||(this.L.Kh||(t=e.copy()),this.gn.FS(this.L,"position",t,e))}fL(t,e){this.xi&&(this.TS()||this.gn.add(this.L,"scale",t,e))}RS(t,e){t.Ce&&(t.Lr=e,this.Fm.add(t))}aL(t){const e=t.findLinksConnected();for(;e.next();){const t=e.value;t.Ce&&(t.Lr=t.points.copy(),this.Fm.add(t))}}get isEnabled(){return this.Bi}set isEnabled(t){e.s(t,"boolean",ht,"isEnabled"),this.Bi=t,t&&this.$h.each((t=>{!t.isAnimating&&t.runCount===1/0&&t.start()}))}get duration(){return this.Fo}set duration(t){e.s(t,"number",ht,"duration"),t<1&&e._(t,">= 1",ht,"duration"),this.Fo=t}get isAnimating(){return this.Ci}get isTicking(){return this.Am}get isInitial(){return this.Nr}set isInitial(t){e.s(t,"boolean",ht,"isInitial"),this.Nr=t}get defaultAnimation(){return this.gn}get activeAnimations(){return this.$h}get initialAnimationStyle(){return this.Dc}set initialAnimationStyle(t){this.Dc=t}static sx=(()=>new p)();static defineAnimationEffect(t,e){ht.sx.set(t,e)}static vS(t,e,i,n,s){null===t&&(t=[0,0,0,0]),null===e&&(e=[0,0,0,0]);let o=t[0],r=t[1];const a=t[2],l=t[3];let h=e[0],u=e[1];const c=e[2],d=e[3];0===a||100===a?(o=h,r=u):(0===c||100===c)&&(h=o,u=r),Math.abs(h-o)>180&&(h>o?o+=360:h+=360);return"hsla("+s(i,o,h-o,n)%360+", "+s(i,r,u-r,n)+"%, "+s(i,a,c-a,n)+"%, "+s(i,l,d-l,n)+")"}static#t=(()=>{const t=ht.sx,e=(t,e,i,n,s,o)=>{t.position=new y(n(s,e.x,i.x-e.x,o),n(s,e.y,i.y-e.y,o))};t.set("position:diagram",e),t.set("position",e),t.set("position:part",((t,e,i,n,s,o)=>{s<o?t.Cc(n(s,e.x,i.x-e.x,o),n(s,e.y,i.y-e.y,o),!1):t.position=new y(n(s,e.x,i.x-e.x,o),n(s,e.y,i.y-e.y,o))})),t.set("location",((t,e,i,n,s,o)=>{s<o?t.Cc(n(s,e.x,i.x-e.x,o),n(s,e.y,i.y-e.y,o),!0):t.location=new y(n(s,e.x,i.x-e.x,o),n(s,e.y,i.y-e.y,o))})),t.set("position:placeholder",((t,e,i,n,s,o)=>{s<o?t.Cc(n(s,e.x,i.x-e.x,o),n(s,e.y,i.y-e.y,o),!1):t.position=new y(n(s,e.x,i.x-e.x,o),n(s,e.y,i.y-e.y,o))})),t.set("position:nodeCollapse",((t,e,i,n,s,o)=>{const r=t.actualBounds,a=i.actualBounds,l=a.x+a.width/2-r.width/2,h=a.y+a.height/2-r.height/2;s<o?t.Cc(n(s,e.x,l-e.x,o),n(s,e.y,h-e.y,o),!1):t.position=new y(n(s,e.x,l-e.x,o),n(s,e.y,h-e.y,o))})),t.set("desiredSize",((t,e,i,n,s,o)=>{t.desiredSize=new x(n(s,e.width,i.width-e.width,o),n(s,e.height,i.height-e.height,o))})),t.set("width",((t,e,i,n,s,o)=>{t.width=n(s,e,i-e,o)})),t.set("height",((t,e,i,n,s,o)=>{t.height=n(s,e,i-e,o)})),t.set("fill",((t,e,i,n,s,o)=>{t.fill=ht.vS(e,i,s,o,n)})),t.set("stroke",((t,e,i,n,s,o)=>{t.stroke=ht.vS(e,i,s,o,n)})),t.set("strokeWidth",((t,e,i,n,s,o)=>{t.strokeWidth=n(s,e,i-e,o)})),t.set("strokeDashOffset",((t,e,i,n,s,o)=>{t.strokeDashOffset=n(s,e,i-e,o)})),t.set("background",((t,e,i,n,s,o)=>{t.background=ht.vS(e,i,s,o,n)})),t.set("opacity",((t,e,i,n,s,o)=>{t.opacity=n(s,e,i-e,o)})),t.set("scale",((t,e,i,n,s,o)=>{t.scale=n(s,e,i-e,o)})),t.set("angle",((t,e,i,n,s,o)=>{t.angle=n(s,e,i-e,o)}))})();static Default=1;static AnimateLocations=2;static None=3}class ut{nx;Rm;Ci;Lu;Fo;ws;uL;Oc;de;ox;oi;$n;Au;Ic;rx;lx;Fc;OS;hx;ps;L;IS;ES;BS;constructor(t){this.L=null,this.ps=null,this.OS=null,this.hx=null,this.IS=!1,this.Ci=!1,this.Fc=!1,this.oi=0,this.$n=0,this.nx=ut.EaseInOutQuad,this.Rm=ut.EaseInOutQuad,this.Au=!1,this.Ic=!1,this.rx=1,this.lx=0,this.Fo=NaN,this.ws=NaN,this.ES=0,this.Lu=null,this.uL=y.Lo,this.de=new p,this.ox=new p,this.Oc=new u,this.BS=1,t&&Object.assign(this,t)}suspend(){this.Fc=!0}advanceTo(t,e){e&&(this.Fc=!1),this.Au&&t>=this.ws&&(this.Ic=!0,t-=this.ws),this.ES=t,this.hL(!0),this.ps.Mu(),this.L.br(),this.ps.Nu(),this.L.redraw()}ix(t){if(this.ox.clear(),this.Ic=!1,this.lx=0,this.ws=NaN,this.Oc.count>0&&this.Oc.clear(),null!==t){const e=t.links;for(;e.next();)e.value.Lr=null}}AF(){return this.de.count>0}start(){if(0===this.de.count)return this;if(this.Ci)return this;let t=this.L;const e=this.de.iterator;for(;e.next();){const i=e.key;null===t&&(i instanceof bt?t=i:i instanceof At&&(t=i.diagram))}if(null===t)return this;this.L=t,this.ps=t.animationManager;const i=this.ps;return!1===i.isEnabled||(this.ws=isNaN(this.Fo)?i.duration:this.Fo,this.Rm=this.nx,i.Tc&&1===i.Dc&&this===i.defaultAnimation&&(this.Rm=ut.EaseOutExpo,this.ws=isNaN(this.Fo)?600===i.duration?900:i.duration:this.Fo),this.BS=t.scrollMode,this.isViewportUnconstrained&&(t.Zh=2),i.Mu(),this.Oc.each((e=>{e.data=null,t.add(e)})),i.Nu(),this.Ci=!0,this.oi=+new Date,this.$n=this.oi+this.ws,i.MF(this)),this}addTemporaryPart(t,e){return t.Me()?(this.Oc.add(t),this.L=e,this):this}add(t,e,i,n,s){if(null===this.L&&(t instanceof bt?this.L=t:t instanceof At&&null!==t.diagram&&(this.L=t.diagram)),t instanceof ce){if(!t.isAnimated)return this;"position"===e&&(e="position:part")}return this.FS(t,e,i,n,s),this}FS(t,e,i,n,s){const o=this.de;let r,a,l;if(t instanceof bt&&"position"===e&&(e="position:diagram"),("fill"===e||"stroke"===e||"background"===e)&&(Ut.vo(i),Ut.US(),i=[Ut.Ui.n0,Ut.Ui.n1,Ut.Ui.n2,Ut.Ui.n3],Ut.vo(n),Ut.US(),n=[Ut.Ui.n0,Ut.Ui.n1,Ut.Ui.n2,Ut.Ui.n3]),o.has(t))r=o.get(t),a=r.oi,l=r.ys,void 0===a[e]&&(a[e]=this.Tu(i)),l[e]=this.Tu(n);else{if("position"===e&&i.equalsApprox(n))return;a={},l={},a[e]=this.Tu(i),l[e]=this.Tu(n),r=new ct(a,l,s),o.set(t,r)}const h=a[e];h instanceof y&&!h.isReal()&&h.a(this.uL),s&&0===e.indexOf("position:")&&t instanceof ce?r.ax.location=this.Tu(t.location):s&&(r.ax[e]=this.Tu(i))}Tu(t){return t instanceof y||t instanceof x?t.copy():t}TF(t){const e=this.de;if(e.has(t)){e.get(t).cx=!0}}ex(t){if(!this.Ci)return!1;const e=this.de.get(t);return null!==e&&e.cx}DS(t){if(!this.Ci)return!1;const e=this.de.get(t);return null!==e&&!!(e.oi.position||e.oi["position:part"]||e.oi.location)}NF(){if(this.Oc.count>0)return!0;const t=this.de.iterator;for(;t.next();){const e=t.key;if(e instanceof At&&null!==e.diagram||e instanceof bt)return!0}return!1}hL(t){if(this.Fc&&!t)return;const e=this.ps;if(!1===this.Ci)return;const i=+new Date;let n=i>this.$n?this.ws:i-this.oi;t&&(n=this.ES,n<this.ws?(this.oi=+new Date-n,this.$n=this.oi+this.ws):n=this.ws),e.Mu(),this.rL(n),this.L.br(!0),e.Nu(),i>this.$n&&(this.Au&&!this.Ic?(this.oi=+new Date,this.$n=this.oi+this.ws,this.Ic=!0):this.Cu(!1))}rL(t){const e=this.ws,i=this.de.iterator,n=this.Ic;for(;i.next();){const s=i.key;if(s instanceof At&&null===s.diagram)continue;const o=i.value,r=n?o.ys:o.oi,a=n?o.oi:o.ys,l=ht.sx;for(const i in a)"position"===i&&(a["position:placeholder"]||a["position:nodeCollapse"])||null!==l.get(i)&&l.get(i)(s,r[i],a[i],this.Rm,t,e,this)}}stop(){return this.Ci?(this.Cu(!0),this):this}Cu(t){if(null!==this.hx&&this.hx.DF(this.OS),!this.Ci)return;const e=this.L,i=this.ps;i.Tc=!1,this.Ci=!1,this.Fc=!1,i.Mu();const n=this.de,s=this.Oc.iterator;for(;s.next();)e.remove(s.value);const o=this.Au,r=n.iterator,a=ht.sx;for(;r.next();){const t=r.key,e=r.value,i=o?e.ys:e.oi,n=o?e.oi:e.ys,s=e.ax;for(const o in n)if(null!==a.get(o)){let r=o;e.fx&&("position:nodeCollapse"===r||"position:placeholder"===r)&&(r="position"),a.get(r)(t,i[o],void 0!==s[o]?s[o]:e.fx?i[o]:n[o],this.Rm,this.ws,this.ws,this)}e.fx&&void 0!==s.location&&t instanceof ce&&(t.location=s.location),e.cx&&t instanceof ce&&t.Vi(!1)}this.lx++;const l=!t&&this.rx>this.lx;if(!l&&(this===i.Tm||this===i.defaultAnimation)&&this.de.clear(),e.ux.clear(),e.xP(!1),e.invalidateDocumentBounds(),e.C(),e.br(!0),i.defaultAnimation===this){const t=i.Fm.iterator;for(;t.next();)t.value.FF();i.Fm.clear()}if(e.br(!0),this.isViewportUnconstrained&&(e.scrollMode=this.BS),i.Nu(),l)return this.Ic=!1,void this.start();this.ix(null),e.dL(),i.Cu(this),this.Lu&&this.Lu(this),e.requestUpdate()}Rc(t,e){const i=e.actualBounds;let n=null;if(e instanceof Ne&&(n=e.placeholder),null!==n&&n.visible){const e=n.getDocumentPoint(w.TopLeft),i=n.padding;e.x+=i.left,e.y+=i.top,this.add(t,"position",e,t.position,!1)}else this.add(t,"position",new y(i.x+i.width/2,i.y+i.height/2),t.position,!1);this.add(t,"scale",.01,t.scale,!1),t instanceof Ne&&this.RF(t,e)}RF(t,e){const i=t.memberParts;for(;i.next();){const t=i.value;t instanceof me&&this.Rc(t,e)}}vc(t,e){if(!t.isVisible())return;let i=null;if(e instanceof Ne&&(i=e.placeholder),null!==i&&i.visible){const e=i.getDocumentPoint(w.TopLeft),n=i.padding;e.x+=n.left,e.y+=n.top,this.add(t,"position:placeholder",t.position,e,!0)}else this.add(t,"position:nodeCollapse",t.position,e,!0);this.add(t,"scale",t.scale,.01,!0),this.TF(t),t instanceof Ne&&this.vF(t,e)}vF(t,e){const i=t.memberParts;for(;i.next();){const t=i.value;t instanceof me&&this.vc(t,e)}}get duration(){return this.Fo}set duration(t){e.s(t,"number",ut,"duration"),t<1&&e._(t,">= 1",ut,"duration"),this.Fo=t}get reversible(){return this.Au}set reversible(t){this.Au=t}get runCount(){return this.rx}set runCount(t){t>0?this.rx=t:e.o("Animation.runCount value must be a positive integer.")}get finished(){return this.Lu}set finished(t){this.Lu!==t&&(null!==t&&e.S(t,ut,"finished"),this.Lu=t)}get easing(){return this.nx}set easing(t){this.nx=t}get isViewportUnconstrained(){return this.IS}set isViewportUnconstrained(t){this.IS=t}get isAnimating(){return this.Ci}getTemporaryState(t){let e=this.ox.get(t);return null===e&&(e={},this.ox.set(t,e)),e}static EaseLinear=(t,e,i,n)=>i*t/n+e;static EaseInOutQuad=(t,e,i,n)=>(t/=n/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e;static EaseInQuad=(t,e,i,n)=>i*(t/=n)*t+e;static EaseOutQuad=(t,e,i,n)=>-i*(t/=n)*(t-2)+e;static EaseInExpo=(t,e,i,n)=>0===t?e:i*Math.pow(2,10*(t/n-1))+e;static EaseOutExpo=(t,e,i,n)=>t===n?e+i:i*(1-Math.pow(2,-10*t/n))+e}class ct{oi;ys;ax;fx;cx;constructor(t,e,i){this.oi=t,this.ys=e,this.ax={},this.fx=i,this.cx=!1}}var dt=(t=>(t[t.Default=1]="Default",t[t.Immediate=2]="Immediate",t[t.Bundled=3]="Bundled",t))(dt||{});class ft{Se;fn;Du;Ec;constructor(t,e,i){this.Se=null,this.fn=t,this.Du=i||1,this.Ec=null,void 0!==e&&(this.Ec=e,void 0===i&&(this.Du=2))}copy(){const t=new ft(this.fn);t.Du=this.Du;const e=this.Ec;if(null!==e){const i={};void 0!==e.duration&&(i.duration=e.duration),void 0!==e.finished&&(i.finished=e.finished),void 0!==e.easing&&(i.easing=e.easing),t.Ec=i}return t}get propertyName(){return this.fn}set propertyName(t){this.fn=t}get animationSettings(){return this.Ec}set animationSettings(t){this.Ec=t}OF(t){const e=this.Ec;null!==e&&(e.duration&&(t.duration=e.duration),e.finished&&(t.finished=e.finished),e.easing&&(t.easing=e.easing))}get startCondition(){return this.Du}set startCondition(t){this.Du=t}static Default=1;static Immediate=2;static Bundled=3}class gt{L;Nt;_t;Ar;Ul;Vl;zl;Xl;Yl;Kl;Gl;Hl;jl;ql;Wl;Jl;Lc;$l;gx;vm;Fu;Tt;constructor(t){u.qi(this),this.L=null,this.Tt=new l,this.Nt="",this._t=1,this.Ar=!1,this.Ul=!0,this.Vl=!0,this.zl=!0,this.Xl=!0,this.Yl=!0,this.Kl=!0,this.Gl=!0,this.Hl=!0,this.jl=!0,this.ql=!0,this.Wl=!0,this.Jl=!0,this.Lc=!0,this.$l=!0,this.gx=!0,this.vm=!1,this.Fu=[],t&&Object.assign(this,t)}IF(){const t=this.Tt;for(let e=0;e<t.length;e++)t.r[e].VS(null);t.clear(),this.Fu.length=0}Ro(t){this.L=t}toString(t){void 0===t&&(t=0);const i='Layer "'+this.name+'"';if(t<=0)return i;let n=0,s=0,o=0,r=0,a=0;const l=this.Tt.iterator;for(;l.next();){const t=l.value;t instanceof Ne?o++:t instanceof me?s++:t instanceof ve?r++:t instanceof fe?a++:n++}let h="";if(n>0&&(h+=n+" Parts "),s>0&&(h+=s+" Nodes "),o>0&&(h+=o+" Groups "),r>0&&(h+=r+" Links "),a>0&&(h+=a+" Adornments "),t>1){const t=this.Tt.iterator;for(;t.next();){const i=t.value;h+="\n    "+i.toString();const n=i.data;null!==n&&u.us(n)&&(h+=" #"+u.us(n)),i instanceof me?h+=" "+e.toString(n):i instanceof ve&&(h+=" "+e.toString(i.fromNode)+" "+e.toString(i.toNode))}}return i+" "+this.Tt.count+": "+h}findObjectAt(t,e,i){if(void 0===e&&(e=null),void 0===i&&(i=null),!1===this.$l)return null;let n=!1;null!==this.diagram&&this.diagram.viewportBounds.containsPoint(t)&&(n=!0);const s=y.l(),o=this.Tt.r;for(let r=o.length;r--;){const a=o[r];if(!0===n&&!1===a.Fl()||!a.isVisible())continue;s.a(t),s.Be(a.Ys);let l=a.gL(s,e,i);if(null!==l&&(null!==e&&(l=e(l)),null!==l&&(null===i||i(l))))return y.e(s),l}return y.e(s),null}findObjectsAt(t,e,i,n){if(void 0===e&&(e=null),void 0===i&&(i=null),!(n instanceof l)&&!(n instanceof u)&&(n=new u),!1===this.$l)return n;let s=!1;null!==this.diagram&&this.diagram.viewportBounds.containsPoint(t)&&(s=!0);const o=y.l(),r=this.Tt.r;for(let a=r.length;a--;){const l=r[a];if(!0===s&&!1===l.Fl()||!l.isVisible())continue;o.a(t),o.Be(l.Ys);let h=l;l.mL(o,e,i,n)&&(null!==e&&(h=e(h)),null!==h&&(null===i||i(h))&&n.add(h))}return y.e(o),n}findObjectsIn(t,e,i,n,s){if(void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=!1),!(s instanceof l)&&!(s instanceof u)&&(s=new u),!1===this.$l)return s;let o=!1;null!==this.diagram&&this.diagram.viewportBounds.containsRect(t)&&(o=!0);const r=this.Tt.r;for(let a=r.length;a--;){const l=r[a];if(!0===o&&!1===l.Fl()||!l.isVisible())continue;let h=l;l.Om(t,e,i,n,s)&&(null!==e&&(h=e(h)),null!==h&&(null===i||i(h))&&s.add(h))}return s}LP(t,e,i,n,s,o,r){if(!1===this.$l)return s;const a=this.Tt.r;for(let l=a.length;l--;){const h=a[l];if(!0===r&&!1===h.Fl()||!o(h)||!h.isVisible())continue;let u=h;h.Om(t,e,i,n,s)&&(null!==e&&(u=e(u)),null!==u&&(null===i||i(u))&&s.add(u))}return s}findObjectsNear(t,e,i,n,s,o){if(void 0===i&&(i=null),void 0===n&&(n=null),void 0===s&&(s=!0),!1!==s&&!0!==s&&((s instanceof l||s instanceof u)&&(o=s),s=!0),!(o instanceof l)&&!(o instanceof u)&&(o=new u),!1===this.$l)return o;let r=!1;null!==this.diagram&&this.diagram.viewportBounds.containsPoint(t)&&(r=!0);const a=y.l(),h=y.l(),c=this.Tt.r;for(let l=c.length;l--;){const u=c[l];if(!0===r&&!1===u.Fl()||!u.isVisible())continue;a.a(t),a.Be(u.Ys),h.i(t.x+e,t.y),h.Be(u.Ys);let d=u;u.pL(a,h,i,n,s,o)&&(null!==i&&(d=i(d)),null!==d&&(null===n||n(d))&&o.add(d))}return y.e(a),y.e(h),o}zS(){return this.Tt.r}xs(t,i){if(!this.visible)return;const n=this.Tt.r,s=n.length;if(0===s)return;const o=e.rt(),r=e.rt();for(let e=0;e<s;e++){const t=n[e];if(t.XS=e,t instanceof ve){if(!1===t.Ce)continue}else if(t instanceof fe&&null!==t.adornedPart)continue;const s=t.actualBounds;t.isVisible()&&s.intersectsRectPlus(i,10)?(t.xs(!0),o.push(t)):(t.xs(!1),null!==t.adornments&&t.adornments.count>0&&r.push(t))}for(let e=0;e<o.length;e++){const t=o[e];t.YS();const i=t.adornments;for(;i.next();){const t=i.value;t.ut(1/0,1/0),t.Yt(),t.xs(!0)}}for(let e=0;e<r.length;e++)r[e].YS();e.tt(o),e.tt(r)}Ru(t){let e=1;return 1!==this._t&&(e=t.globalAlpha,t.globalAlpha=e*this._t),e}yL(t,e){for(let i=0;i<e;i++)t[i].vu()}zi(t,e,i){if(!this.visible||0===this._t||(void 0===i&&(i=!0),!i&&this.isTemporary))return;const n=this.Tt.r,s=n.length;if(0===s)return;t.Ar&&this.yL(n,s);const o=this.Ru(t),r=this.Fu;r.length=0;const a=e.scale,l=b.l();for(let h=0;h<s;h++){const i=n[h];this.Im(t,i,e,r,a,l,!0)}b.e(l),t.Ar&&this.yL(n,s),t.globalAlpha=o}xE(t,e,i){if(!this.visible||0===this._t)return;const n=this.Tt.r,s=n.length;if(0===s)return;const o=this.Ru(t),r=this.Fu;r.length=0;const a=e.scale,l=b.l();for(let h=0;h<s;h++){const s=n[h];i.has(s)||this.Im(t,s,e,r,a,l,!0)}b.e(l),t.globalAlpha=o}EF(t,e,i,n){if(!this.visible||0===this._t||!n&&this.isTemporary)return;const s=this.Tt.r,o=s.length;if(0===o)return;const r=this.Ru(t),a=this.Fu;a.length=0;const l=e.scale,h=b.l();for(let u=0;u<o;u++){const n=s[u];i.has(n)&&this.Im(t,n,e,a,l,h,!1)}b.e(h),t.globalAlpha=r}BF(t,e,i,n,s){if(!this.visible||0===this.opacity)return;const o=this.diagram.grid.part;if(!n&&this.isTemporary){if(s&&o.layer===this){const e=this.Ru(t);o.zi(t,i),t.globalAlpha=e}}else{const e=this.Ru(t),n=i.scale,r=b.l(),a=this.Tt.r,l=a.length;for(let h=0;h<l;h++){const e=a[h];!s&&e===o||this.Im(t,e,i,null,n,r,!1)}b.e(r),t.globalAlpha=e}}bE(t,e,i){if(!this.visible||0===this._t)return;const n=this.Ru(t),s=this.Fu;s.length=0;const o=e.scale,r=b.l(),a=this.Tt.r,l=a.length,h=i.length;for(let u=0;u<l;u++){const n=a[u],l=n.Qh(n.actualBounds);this.UF(l,i,h,o)&&this.Im(t,n,e,s,o,r,!0)}b.e(r),t.globalAlpha=n}Im(t,e,i,n,s,o,r){if(r&&!e.Fl())return void t.removePartFromView(e);if(null!==n&&e instanceof ve&&(e.isOrthogonal&&n.push(e),!1===e.Ce))return void t.removePartFromView(e);let a=!1,l=e.containingGroup;for(;null!==l;)a?null!==l.ri&&o.intersectRect(l.ri):null!==l.ri&&(a=!0,o.a(l.ri)),l=l.containingGroup;const h=e.actualBounds;let u=!1;if(a&&e.isVisible()){if(!o.intersectsRect(h))return void t.removePartFromView(e);u=!o.containsRect(h)}u&&(t.save(),t instanceof Et?t.partClipRect=o.copy():(t.beginPath(),t.rect(o.x,o.y,o.width,o.height),t.clip())),h.width*s>i.Em||h.height*s>i.Em?e.zi(t,i):this.VF(t,e,i),u&&(t.restore(),t.clearContextCache(!0))}VF(t,e,i){if(t instanceof Et)return void e.zi(t,i);const n=e.actualBounds,s=e.naturalBounds;if(0===n.width||0===n.height||isNaN(n.x)||isNaN(n.y)||!e.isVisible())return;const o=e.F;if(null===e.background)return e.mn(t,"rgba(0,0,0,0.3)",!0,!1,s,n),void t.fillRect(n.x,n.y,n.width,n.height);if(t.transform(o.m11,o.m12,o.m21,o.m22,o.dx,o.dy),e.mn(t,e.background,!0,!1,s,n),t.fillRect(0,0,s.width/2,s.height/2),!o.Ik()){const e=1/(o.m11*o.m22-o.m12*o.m21);t.transform(o.m22*e,-o.m12*e,-o.m21*e,o.m11*e,e*(o.m21*o.dy-o.m22*o.dx),e*(o.m12*o.dx-o.m11*o.dy))}}UF(t,e,i,n){const s=2/n,o=4/n;for(let r=0;r<i;r++){const i=e[r];if(0!==i.width&&0!==i.height&&t.intersects(i.x-s,i.y-s,i.width+o,i.height+o))return!0}return!1}t(t,e,i,n,s){const o=this.diagram;null!==o&&o.raiseChangedEvent(2,t,this,e,i,n,s)}_h(t,e,i){const n=this.Tt;if(e.VS(this),t>=n.count)t=n.count;else if(n.elt(t)===e)return-1;n.insertAt(t,e),e.Bm(i);const s=this.diagram;return null!==s&&(i?s.C():s._h(e)),this.mx(t,e),t}se(t,e,i){if(!i&&e.layer!==this&&null!==e.layer)return e.layer.se(t,e,i);const n=this.Tt;if(t<0||t>=n.length){if((t=n.indexOf(e))<0)return-1}else if(n.elt(t)!==e&&(t=n.indexOf(e))<0)return-1;e.Um(i),n.removeAt(t);const s=this.diagram;return null!==s&&(i?s.C():s.se(e)),e.VS(null),t}mx(t,e){t=this.zF(t,e),e instanceof Ne&&this.XF(t,e),null!==e.svg&&e.svg.remove()}zF(t,e){const i=e.zOrder;if(isNaN(i))return t;const n=this.Tt,s=n.count;if(s<=1)return t;if(t<0&&(t=n.indexOf(e)),t<0)return-1;let o=t-1,r=NaN;for(;o>=0&&(r=n.elt(o).zOrder,isNaN(r));)o--;let a=t+1,l=NaN;for(;a<s&&(l=n.elt(a).zOrder,isNaN(l));)a++;if(!isNaN(r)&&r>i)for(;;){if(-1===o||r<=i)return o++,o===t?t:(n.removeAt(t),n.insertAt(o,e),o);for(r=NaN;--o>=0&&(r=n.elt(o).zOrder,isNaN(r)););}else if(!isNaN(l)&&l<i)for(;;){if(a===s||l>=i)return a--,a===t?t:(n.removeAt(t),n.insertAt(a,e),a);for(l=NaN;++a<s&&(l=n.elt(a).zOrder,isNaN(l)););}return t}XF(t,e){if(null===e||!isNaN(e.zOrder))return;this.YF(t,e);const i=e.containingGroup;null!==i&&this.mx(-1,i)}YF(t,e){if(0===e.memberParts.count)return;let i=-1;const n=this.Tt.r,s=n.length;for(let o=0;o<s;o++){const s=n[o];if(s===e&&(t=o,i>=0)||i<0&&s.containingGroup===e&&(i=o,t>=0))break}if(!(i<0)&&i<t){const n=this.Tt;n.removeAt(t),n.insertAt(i,e)}}get parts(){return this.Tt.iterator}get partsBackwards(){return this.Tt.iteratorBackwards}get diagram(){return this.L}get name(){return this.Nt}set name(t){e.s(t,"string",gt,"name");const i=this.Nt;if(i!==t){const n=this.diagram;if(null!==n){""===i&&e.o("Cannot rename default Layer to: "+t);const s=n.layers;for(;s.next();)s.value.name===t&&e.o("Layer.name is already present in this diagram: "+t)}this.Nt=t,this.t("name",i,t);const s=this.Tt.iterator;for(;s.next();){s.value.layerName=this.Nt}}}get opacity(){return this._t}set opacity(t){const i=this._t;if(i!==t){e.s(t,"number",gt,"opacity"),(t<0||t>1)&&e._(t,"0 <= value <= 1",gt,"opacity"),this._t=t;const n=this.diagram;null!==n&&n.C(),this.t("opacity",i,t)}}get isViewportAligned(){return this.vm}set isViewportAligned(t){const e=this.vm;e!==t&&(this.vm=t,this.diagram&&(this.wL(),this.diagram.C()),this.t("isViewportAligned",e,t),t&&(this.isInDocumentBounds=!1))}wL(){if(!this.vm)return;const t=this.diagram,e=this.Tt.r,i=e.length,n=t.Pt,s=t.St;for(let o=0;o<i;o++){const i=e[o],r=i.naturalBounds.width,a=i.naturalBounds.height;let l=i.alignment;(l.isDefault()||!l.isSpot())&&(l=w.BottomRight);let h=i.alignmentFocus;h.isDefault()&&(h=new w(l.x,l.y));const u=l.x*n+l.offsetX-(h.x*r+h.offsetX),c=l.y*s+l.offsetY-(h.y*a+h.offsetY),d=y.X(u,c);t.KF(d),i.Cc(d.x,d.y,!0),y.e(d),i.nt=1/t.scale}}get isTemporary(){return this.Ar}set isTemporary(t){const i=this.Ar;i!==t&&(e.s(t,"boolean",gt,"isTemporary"),this.Ar=t,this.t("isTemporary",i,t))}get visible(){return this.Lc}set visible(t){const i=this.Lc;if(i!==t){e.s(t,"boolean",gt,"visible"),this.Lc=t;const n=this.Tt.iterator;for(;n.next();)n.value.Vi(t);const s=this.diagram;null!==s&&s.C(),this.t("visible",i,t)}}get pickable(){return this.$l}set pickable(t){const i=this.$l;i!==t&&(e.s(t,"boolean",gt,"pickable"),this.$l=t,this.t("pickable",i,t))}get isInDocumentBounds(){return this.gx}set isInDocumentBounds(t){const e=this.gx;e!==t&&(this.gx=t,null!==this.diagram&&this.diagram.invalidateDocumentBounds(),this.t("isInDocumentBounds",e,t))}get allowCopy(){return this.Ul}set allowCopy(t){const i=this.Ul;i!==t&&(e.s(t,"boolean",gt,"allowCopy"),this.Ul=t,this.t("allowCopy",i,t))}get allowDelete(){return this.Vl}set allowDelete(t){const i=this.Vl;i!==t&&(e.s(t,"boolean",gt,"allowDelete"),this.Vl=t,this.t("allowDelete",i,t))}get allowTextEdit(){return this.zl}set allowTextEdit(t){const i=this.zl;i!==t&&(e.s(t,"boolean",gt,"allowTextEdit"),this.zl=t,this.t("allowTextEdit",i,t))}get allowGroup(){return this.Xl}set allowGroup(t){const i=this.Xl;i!==t&&(e.s(t,"boolean",gt,"allowGroup"),this.Xl=t,this.t("allowGroup",i,t))}get allowUngroup(){return this.Yl}set allowUngroup(t){const i=this.Yl;i!==t&&(e.s(t,"boolean",gt,"allowUngroup"),this.Yl=t,this.t("allowUngroup",i,t))}get allowLink(){return this.Kl}set allowLink(t){const i=this.Kl;i!==t&&(e.s(t,"boolean",gt,"allowLink"),this.Kl=t,this.t("allowLink",i,t))}get allowRelink(){return this.Gl}set allowRelink(t){const i=this.Gl;i!==t&&(e.s(t,"boolean",gt,"allowRelink"),this.Gl=t,this.t("allowRelink",i,t))}get allowMove(){return this.Hl}set allowMove(t){const i=this.Hl;i!==t&&(e.s(t,"boolean",gt,"allowMove"),this.Hl=t,this.t("allowMove",i,t))}get allowReshape(){return this.jl}set allowReshape(t){const i=this.jl;i!==t&&(e.s(t,"boolean",gt,"allowReshape"),this.jl=t,this.t("allowReshape",i,t))}get allowResize(){return this.ql}set allowResize(t){const i=this.ql;i!==t&&(e.s(t,"boolean",gt,"allowResize"),this.ql=t,this.t("allowResize",i,t))}get allowRotate(){return this.Wl}set allowRotate(t){const i=this.Wl;i!==t&&(e.s(t,"boolean",gt,"allowRotate"),this.Wl=t,this.t("allowRotate",i,t))}get allowSelect(){return this.Jl}set allowSelect(t){const i=this.Jl;i!==t&&(e.s(t,"boolean",gt,"allowSelect"),this.Jl=t,this.t("allowSelect",i,t))}}var mt=(t=>(t[t.None=1]="None",t[t.Uniform=2]="Uniform",t[t.UniformToFill=3]="UniformToFill",t))(mt||{}),pt=(t=>(t[t.All=1]="All",t[t.NotDirected=2]="NotDirected",t[t.NotDirectedFast=3]="NotDirectedFast",t[t.NotUndirected=4]="NotUndirected",t[t.DestinationTree=5]="DestinationTree",t[t.SourceTree=6]="SourceTree",t))(pt||{}),yt=(t=>(t[t.Document=1]="Document",t[t.Infinite=2]="Infinite",t))(yt||{}),xt=(t=>(t[t.TreeParent=1]="TreeParent",t[t.AllParents=2]="AllParents",t[t.AnyParents=3]="AnyParents",t))(xt||{});class bt{ps;Zt;KS;px;Tr;Ou;yx;wx;xx;bx;kx;Px;ta;Zh;Sx;Mx;Nx;Zl;Bc;Dr;Vm;Cx;Lx;Iu;Zn;Fr;ia;Oo;zm;Uc;Xm;Vc;Eu;Rr;Qn;GS;HS;Ax;Tx;jS;Dx;qS;WS;JS;Fx;Ym;vr;Or;Ir;Er;Br;Ur;Rx;Vr;vx;zr;Xr;Yr;Kr;Ox;$S;Io;ZS;Ix;Ex;QS;Mi;_S;tM;iM;Vs;Eo;Bi;Bx;Ul;Vl;Ux;Vx;zl;Xl;Yl;zx;Kl;Gl;Hl;jl;ql;Wl;Jl;Xx;Yx;eM;Bu;Uu;Kx;Gx;Hx;jx;Km;qx;Wx;Jx;ti;sM;$x;nM;Vu;pn;_n;ne;to;xL;Ql;oM;rM;Gm;Zx;zu;Hm;Qx;Gr;_l;ea;lM;hM;jm;_x;tb;ts;Xu;qm;Yu;th;zc;Wm;Hr;sa;aM;Jm;Jt;F;ze;Cr;Xi;bs;cM;ih;jr;Cl;qr;na;Xc;fM;Ku;oa;Gu;Gt;eh;dt;nt;Hu;Pt;St;mt;Yc;Iw;ib;ra;Kc;eb;sb;nb;GF;HF;Yi;Al;Em;$m;uM;dM;bL;Zm;jF;qF;WF;ob;JF;$F;ZF;la;kL;sh;ha;aa;ca;fa;bu;Jh;ii;Ct;Gc;Jk;$k;xc;_t;static rb=null;static PL=(()=>new p)();static gM;static mM=null;xu;lb;hb;ab;cb;fb;Qm;pM;_m;t0;i0;tx;yM;wM;Hc;constructor(e,i){if(bt.uw||(bt.Ek(),bt.uw=!0),u.qi(this),bt.SL(this),this.Jt=!0,this.Ct=null,this.Pt=0,this.St=0,this.mt=null,bt.isUsingDOM()){const e=this,i=()=>{e.Ni(t.document,"DOMContentLoaded",i,!1),e.setRTL()};null!==t.document.body?this.setRTL():e.Xt(t.document,"DOMContentLoaded",i,!1)}this.Yc=null,bt.xM("Model",Ie);const n=this;return this._S=t=>n.partManager.doModelDataChanged(t),this.tM=t=>n.partManager.doModelChanged(t),this.eb=null,this.sb=null,this.ML(),this.model=Ue.bM(),this.themeManager=new Ci,this.Io=!0,this.NL(),this.layout=new Le,this.Io=!1,this.jF=null,this.qF=null,this.WF=null,this.ob=null,this.JF=null,this.$F=null,this.ZF=null,this.la=null,this.kL=null,this.sh=null,this.ha=null,this.aa=null,this.ca=null,this.fa=null,this.bu=()=>{},this.Jh=null,this.Yu=!1,this.Gc=new vt(this),void 0!==e&&("string"==typeof e||t.Element&&e instanceof Element?this.kM(e):i=e),i&&this.setProperties(i),this.Jt=!1,this.requestUpdate(),this}hF(){return null!==this.mt}get renderer(){return this.zc}set renderer(e){if(this instanceof Pt)return;""===e&&(e="default");const i=e.toLowerCase();if(i===this.zc)return;this.zc=i;let n=null;"default"===i||"canvas"===i?(n=this.th.get("svg"),null!==n&&n.Rt.remove(),this.mt&&(this.ii=this.mt.ci),this.ii.clearContextCache(!0)):"svg"===i?(this.th.has("svg")?n=this.th.get("svg"):(n=new Rt(this,t.document),this.addRenderer("svg",n)),null!==this.div&&this.div.appendChild(n.Rt),this.ii=n.ci,this.mt&&(this.mt.ci.setTransform(this.Yi,0,0,this.Yi,0,0),this.mt.ci.clearRect(0,0,this.Pt,this.St))):"debug"===i&&(this.th.has("SVG")||(n=new Rt(this,t.document),this.addRenderer("SVG",n),n.Rt.style.backgroundColor="whitesmoke",null!==this.div&&this.div.after(n.Rt))),this.Jt||this.redraw()}ML(){this.Hc=new l,this.setupRouters(),this.ps=new ht,this.ps.Ro(this),this.Zt=17,this.KS=!1,this.Hu=!1,this.px="default",this.Gt=new l,this.th=new p,this.zc="default",this.resetRenderingHints(),this.QF(),this._t=1,this.dt=new y(NaN,NaN).u(),this.tx=new y(NaN,NaN),this.nt=1,this.Jm=1,this.yx=new y(NaN,NaN).u(),this.wx=NaN,this.xx=1e-4,this.bx=100,this.F=new k,this.kx=new y(NaN,NaN).u(),this.Px=new b(NaN,NaN,NaN,NaN).u(),this.ta=new v(0,0,0,0).u(),this.Zh=1,this.Sx=!1,this.Mx=null,this.Nx=null,this.Zl=1,this.Bc=w.Default,this.Dr=1,this.Vm=w.Default,this.Cx=w.None,this.Lx=w.None,this.ze=!0,this.Iu=!1,this.Zn=new Set,this.Fr=new u,this.ia=new u,this.Oo=!1,this.eh=new p,this.Ku=!0,this.zm=250,this.Uc=-1,this.Xm=new v(16,16,16,16).u(),this.Cr=!1,this.Vc=!1,this.Eu=!0,this.Wm=new D,this.Wm.diagram=this,this.Hr=new D,this.Hr.diagram=this,this.sa=new D,this.sa.diagram=this,this.Rr=null,this.Qn=null,this.Iw=!1,this._F(),this.qr=new u,this.Ax=!0,this.Tx=1,this.jS=!1,this.Dx=1,this.Fx="auto",this.Ym="auto",this.vr=null,this.Or=null,this.Ir=null,this.Er=null,this.Br=null,this.Ur=null,this.Rx=null,this.Vr=null,this.vx=!1,this.zr=null,this.Xr=null,this.Yr=null,this.Kr=null,this.Ox=!1,this.ib={},this.ra=[null,null],this.Io=!1,this.ZS=!1,this.Ix=!1,this.Ex=!1,this.QS=!0,this.bs=!1,this.oa=!1,this.iM=!0,this.Vs=-2,this.ih=new p,this.Gu=new l,this.Eo=!1,this.Bi=!0,this.Bx=!0,this.Ul=!0,this.Vl=!0,this.Ux=!1,this.Vx=!0,this.zl=!0,this.Xl=!0,this.Yl=!0,this.zx=!0,this.Kl=!0,this.Gl=!0,this.Hl=!0,this.jl=!0,this.ql=!0,this.Wl=!0,this.Jl=!0,this.Xx=!0,this.Yx=!0,this.eM=!1,this.Kc=!1,this.Bu=!0,this.Uu=!0,this.Kx=!0,this.Gx=!0,this.Hx=16,this.jx=16,this.Km=!1,this.qx=!1,this.Wx=0,this.Jx=0,this.ti=new v(5).u(),this.sM=(new u).u(),this.$x=999999999,this.nM=(new u).u(),this.na=!0,this.Vu=!0,this.Xc=!0,this.pn=!1,this._n=!1,this.jr=!0,this.Cl=!1,this.to=!1,this.xL=new u,this.fM=new u,this.Ql=null,this.oM=new x(8,8),this.rM=999,this.Gm=!1,this.Jk=1,this.$k=0,this.Xi={scale:1,position:new y,bounds:new b,canvasSize:new x,newCanvasSize:new x,isScroll:!1},this.Xi.canvasSize=this.Xi.canvasSize,this.Xi.newCanvasSize=this.Xi.newCanvasSize,this.Xi.isScroll=!1,this.Zx=new b(NaN,NaN,NaN,NaN).u(),this.zu=new x(NaN,NaN).u(),this.Hm=new b(NaN,NaN,NaN,NaN).u(),this.Qx=!1,this.tR(),this.ts=null,this.Xu=!1,this.xc=null,this.partManager=new Ie,this.toolManager=new j,this.toolManager.initializeStandardTools(),this.defaultTool=this.toolManager,this.currentTool=this.defaultTool,this.hb=null,this.ab=new St,this.cb=null,this.fb=null,this.lb=!1,this.xu=!1,this.commandHandler=new Ct,this.t0=null,this.i0=y.Ak,this.yM=!1,this.Yi=1,this.Al=null,this.Em=1,this.Qm=0,this.pM=[0,0,0,0,0],this._m=0,this.$m=1,this.uM=0,this.dM=new y,this.bL=500,this.qm=new y,this.Zm=!1}static CL=(()=>void 0!==t.document)();static isUsingDOM(){return bt.CL}static useDOM(e){bt.CL=!!e&&void 0!==t.document}static is=(()=>new WeakMap)();clear(){this.animationManager.stopAnimation(),this.model.clear(),bt.LL(),this.AL(!1),this.Gu.clear(),this.TL(),this.Ql=null,this.invalidateDocumentBounds(),this.ensureBounds(),this.C()}AL(t){this.animationManager.stopAnimation(!0),this.sM=(new u).u(),this.nM=(new u).u();const i=this.skipsUndoManager,n=null!==this.Mi&&void 0!==this.Mi;n&&(this.skipsUndoManager=!0);let s=null;null!==this.ts&&(s=this.ts.part,null!==s&&this.remove(s));const o=[],r=this.Gt.length;if(t){for(let t=0;t<r;t++){const e=this.Gt.r[t].parts;for(;e.next();){const t=e.value;t!==s&&null===t.data&&o.push(t)}}for(let t=0;t<o.length;t++){const e=o[t];this.remove(e)}}for(let e=0;e<r;e++)this.Gt.r[e].IF();return this.partManager.clear(),this.Zn.clear(),this.Fr.clear(),this.ia.clear(),this.eh.clear(),this.qr.clear(),this.xc=null,this.Gu.clear(),this.TL(),e.Ck=[],null!==s&&(this.add(s),this.partManager.parts.delete(s)),n&&(this.skipsUndoManager=i),o}static e0=null;static ub="";static LL(){bt.e0=null,bt.ub=""}static kE(){return null}reset(){this.clear(),this.Jt=!0,this.ML(),this.themeManager=new Ci,this.nh(),this.Io=!0,this.NL(),this.layout=new Le,this.Io=!1,this.model=Ue.bM(),this.model.undoManager=new B,this.Yu=!1,this.Jt=!1,this.C()}tR(){this.Gr=new p,this.lM=(new me).add(new ie({stroke:"black",font:"10pt sans-serif"}).bind("text","",e.toString).theme("stroke","text").theme("font","normal")),this.Gr.set("",this.lM),this.Gr.set("Comment",(new me).add(new ie({stroke:"brown",font:"10pt sans-serif"}).bind("text","",e.toString).theme("stroke","comment").theme("font","normal"))),this.Gr.set("LinkLabel",new me({selectable:!1,avoidable:!1}).add(new Jt("Ellipse",{fill:"black",stroke:null,desiredSize:new x(3,3).it()}).theme("fill","link"))),this.ea=new p,this.cM=new Ne(Yt.Vertical,{selectionObjectName:"GROUPPANEL"}).add(new ie({stroke:"black",font:"bold 12pt sans-serif"}).bind("text","",e.toString).theme("stroke","text").theme("font","bold"),new Yt(Yt.Auto,{name:"GROUPPPANEL"}).add(new Jt({fill:"rgba(128,128,128,0.2)",stroke:"black",strokeWidth:1}).theme("fill","group").theme("stroke","outline").theme("strokeWidth","group"),new Te({padding:5}).theme("padding","group"))),this.ea.set("",this.cM),this._l=new p,this.hM=(new ve).add(new Jt({isPanelMain:!0,stroke:"black"}).theme("stroke","link"),new Jt({toArrow:"Standard",fill:"black",stroke:null,strokeWidth:0}).theme("toArrow").theme("fill","link")),this._l.set("",this.hM),this._l.set("Comment",(new ve).add(new Jt({isPanelMain:!0,stroke:"brown"}).theme("stroke","comment"))),this.jm=new fe(Yt.Auto).add(new Jt({fill:null,stroke:"dodgerblue",strokeWidth:3}).theme("stroke","selection").theme("strokeWidth","selection"),new Te({margin:1.5}).theme("margin","selection","numbers",null,(t=>t?new v(t/2):1.5))),this._x=this.jm,this.tb=new fe(Yt.Link).add(new Jt({isPanelMain:!0,fill:null,stroke:"dodgerblue",strokeWidth:3}).theme("stroke","selection").theme("strokeWidth","selection"))}setRTL(i){let n=void 0===i?this.div:i;null===n&&(n=t.document.body);const s=e.fs("div");s.dir="rtl",s.style.cssText="font-size: 14px; width: 1px; height: 1px; position: absolute; top: -1000px; overflow: scroll;",s.textContent="A",n.appendChild(s);let o="reverse";s.scrollLeft>0?o="default":(s.scrollLeft=1,0===s.scrollLeft&&(o="negative")),n.removeChild(s),this.px=o}setScrollWidth(i){let n=void 0===i?this.div:i;null===n&&(n=t.document.body);let s=0;if(bt.isUsingDOM()){let t=bt.mM,i=bt.gM;null===t&&(bt.mM=e.fs("p"),t=bt.mM,t.style.width="100%",t.style.height="200px",t.style.boxSizing="content-box",bt.gM=e.fs("div"),i=bt.gM,i.style.position="absolute",i.style.visibility="hidden",i.style.width="200px",i.style.height="150px",i.style.boxSizing="content-box",i.appendChild(t)),i.style.overflow="hidden",n.appendChild(i);const o=t.offsetWidth;i.style.overflow="scroll";let r=t.offsetWidth;o===r&&(r=i.clientWidth),n.removeChild(i),s=o-r,0===s&&!e.hr&&(s=11)}this.Zt=s,this.KS=!0}hi(t){t in mt?this.autoScale=t:e.cr(this,t)}toString(t){void 0===t&&(t=0);let e="";this.div&&this.div.id&&(e=this.div.id);let i='Diagram "'+e+'"';if(t<=0)return i;const n=this.Gt.iterator;for(;n.next();){i+="\n  "+n.value.toString(t-1)}return i}static SL(t){bt.rb=t}static ym(){return bt.rb}static fromDiv(e){let i=e;if("string"==typeof e&&(i=t.document.getElementById(e)),i instanceof HTMLDivElement){const t=bt.is.get(i);if(t)return t}return null}get div(){return this.Ct}set div(e){if(this.Ct!==e){const i=this.Ct;if(null!==i){if(bt.is.delete(i),i.goDiagram=void 0,i.go=void 0,i.innerHTML="",null!==this.mt){const t=this.mt.Rt;this.Ni(t,"pointermove",this.ha,!1),this.Ni(t,"pointerdown",this.sh,!1),this.Ni(t,"pointerup",this.aa,!1),this.Ni(t,"pointerout",this.ca,!1),this.Ni(t,"pointercancel",this.fa,!1),this.mt.dispose()}this.Yc&&(this.Yc.disconnect(),this.Yc=null);const e=this.toolManager;null!==e&&(e.mouseDownTools.each((t=>t.cancelWaitAfter())),e.mouseMoveTools.each((t=>t.cancelWaitAfter())),e.mouseUpTools.each((t=>t.cancelWaitAfter()))),e.cancelWaitAfter(),this.currentTool.doCancel(),this.mt=null,this.Ni(t,"resize",this.ob,!1),this.Ni(t,"wheel",this.la,!0),bt.ym()===this&&bt.SL(null)}else null===this.sh&&(this.to=!1);if(this.Ct=null,null!==e){const t=bt.is.get(e);t&&(t.div=null),this.kM(e),this.bu(),this.themeManager&&this.themeManager.iR()}else this.themeManager&&this.themeManager.eR()}}setupRouters(){this.Hc.push(new Ti)}kM(i){const n=this;if(!bt.isUsingDOM())return;null==i&&e.o("Diagram setup requires an argument DIV."),null!==n.Ct&&e.o("Diagram has already completed setup."),"string"==typeof i?n.Ct=t.document.getElementById(i):i instanceof HTMLDivElement?n.Ct=i:e.o("No DIV or DIV id supplied: "+i),null===n.Ct&&e.o("Invalid DIV id; could not get element with id: "+i);const s=bt.is.get(n.Ct);if(s&&s!==this&&e.o("Invalid div id; div already has a Diagram associated with it."),!n.Yc&&t.ResizeObserver){const i=t.ResizeObserver,s=e.Nk((()=>n.requestUpdate()),250,!1);n.Yc=new i((()=>s())),n.Yc.observe(n.Ct)}"static"===t.getComputedStyle(n.Ct,null).position&&(n.Ct.style.position="relative");let o=5;const r="rgba(2"+o+"5, 255, 255, 0)";o--,n.Ct.style["-webkit-tap-highlight-color"]=r,n.Ct.innerHTML="",bt.is.set(n.Ct,n),n.Ct.goDiagram=n,n.Ct.go=t.go;const a=new Bt(n);void 0!==a.style&&(a.style.position="absolute",a.style.top="0px",a.style.left="0px","rtl"===t.getComputedStyle(n.Ct,null).getPropertyValue("direction")&&(n.Hu=!0),a.style.zIndex="2",a.style.userSelect="none",a.style.MozUserSelect="none",a.style.touchAction="none",a.style.letterSpacing="normal !important",a.style.wordSpacing="normal !important",a.style.lang="unknown"),n.mt=a,n.ii=a.ci;const l=n.ii;n.Yi=n.computePixelRatio(),n.viewSize.isReal()||(n.Pt=n.Ct.clientWidth||1,n.St=n.Ct.clientHeight||1),n.DL(n.Pt,n.St);const h=n;n.Ct.insertBefore(a.Rt,n.Ct.firstChild);const u=new Bt(null);if(u.width=1,u.height=1,n.GF=u,n.HF=u.ci,bt.isUsingDOM()){const t=e.fs("div"),i=e.fs("div");t.style.position="absolute",t.style.overflow="auto",t.style.width=n.Pt+"px",t.style.height=n.St+"px",t.style.zIndex="1",i.style.position="absolute",i.style.width="1px",i.style.height="1px",n.Ct.appendChild(t),t.appendChild(i),t.onscroll=bt.sR,t.addEventListener("pointerdown",bt.nR),t.L=n,t.oR=!0,t.rR=!0,n.eb=t,n.sb=i}n.bu=e.Nk((()=>{n.Al=null,n.C()}),300,!1),n.ob=e.Nk((()=>{n.AS()}),250,!1),n.Jh=t=>(t.preventDefault(),!1),n.la=t=>{if(!h.isEnabled)return;const e=h.jc(t,!0);e.bubbles=!0;let i=0,n=0;e.delta=0,void 0!==t.deltaX?(0!==t.deltaX&&(i=t.deltaX>0?1:-1),0!==t.deltaY&&(n=t.deltaY>0?1:-1),e.delta=Math.abs(t.deltaX)>Math.abs(t.deltaY)?-i:-n):void 0!==t.wheelDeltaX?(0!==t.wheelDeltaX&&(i=t.wheelDeltaX>0?-1:1),0!==t.wheelDeltaY&&(n=t.wheelDeltaY>0?-1:1),e.delta=Math.abs(t.wheelDeltaX)>Math.abs(t.wheelDeltaY)?-i:-n):void 0!==t.wheelDelta&&0!==t.wheelDelta&&(e.delta=t.wheelDelta>0?1:-1),h.doMouseWheel(),h.ua(e,t)},n.kL=t=>{if(!h.isEnabled)return;n.Kc=!1,h.jc(t,!0);const e=h.currentTool;e.cancelWaitAfter(),e.standardMouseOver()},n.sh=t=>{if(!h.isEnabled)return;n.Kc=!0;const e=h.ib;void 0===e[t.pointerId]&&(e[t.pointerId]=t);const i=h.ra;let s=!1;if(null===i[0]||i[0].pointerId!==t.pointerId&&i[0].pointerType===t.pointerType)if(null!==i[1]&&i[1].pointerId===t.pointerId)i[1]=t,s=!0;else if(null===i[0])i[0]=t;else{if(null!==i[1])return void t.preventDefault();i[1]=t,s=!0}else i[0]=t;const o="touch"===t.pointerType||"pen"===t.pointerType;o&&(h.Iw=!1,h.Zm=!0);const r=h.lR(t,t,s),a=h.dM,l=o?25:10;t.timeStamp-h.uM<h.bL&&!(Math.abs(a.x-t.screenX)>l||Math.abs(a.y-t.screenY)>l)?h.$m++:h.$m=1,r.clickCount=h.$m,h.uM=t.timeStamp,h.dM.setTo(t.screenX,t.screenY),h.doMouseDown(),1!==t.button?h.ua(r,t):t.preventDefault()},n.ha=t=>{if(!h.isEnabled)return;n.Kc=!0;const e=h.ra;if(null===e[0]||e[0].pointerId!==t.pointerId&&e[0].pointerType===t.pointerType){if(null!==e[1]&&e[1].pointerId===t.pointerId)return void(e[1]=t);if(null!==e[0])return;e[0]=t}else e[0]=t;if(e[0].pointerId!==t.pointerId)return;const i=h.hR(t,t,null!==e[1]);h.doMouseMove(),h.ua(i,t)},n.aa=e=>{if(!h.isEnabled)return;n.Kc=!0;const i="touch"===e.pointerType||"pen"===e.pointerType,s=h.ib;if(i&&h.Iw)return delete s[e.pointerId],void e.preventDefault();const o=h.ra;if(null===o[0]||o[0].pointerId!==e.pointerId&&o[0].pointerType===e.pointerType)return null!==o[1]&&o[1].pointerId===e.pointerId?void(o[1]=null):void 0;o[0]=null;const r=h.PM(e,!1,!0,!1,!0,!1);let a=t.document.elementFromPoint(e.clientX,e.clientY)||null;null!==a&&void 0!==a.shadowRoot&&null!==a.shadowRoot&&(a=a.shadowRoot.elementFromPoint(e.clientX,e.clientY)),null!==a&&a.L instanceof bt&&a.L!==h&&a.L.s0(e,r),null===a&&(a=e.target),h.s0(e,r),r.clickCount=h.$m,r.targetDiagram=h.db(e,a),r.targetObject=null,h.doMouseUp(),h.ua(r,e),i&&(h.Zm=!1)},n.ca=t=>{if(!h.isEnabled)return;n.Kc=!1;const e=h.ib;e[t.pointerId]&&delete e[t.pointerId];const i=h.ra;if(null!==i[0]&&i[0].pointerId===t.pointerId&&(i[0]=null),null!==i[1]&&i[1].pointerId===t.pointerId&&(i[1]=null),"touch"===t.pointerType||"pen"===t.pointerType)return;const s=h.currentTool;s.cancelWaitAfter(),s.standardMouseOver()},n.fa=t=>{const e=h.ra;null!==e[0]&&e[0].pointerId===t.pointerId?(e[0]=null,h.Zm=!1):null!==e[1]&&e[1].pointerId===t.pointerId&&(e[1]=null)};const c=l;if(n.nb=c.U[e.Rs("7eba17a4ca3b1a8346")][e.Rs("78a118b7")](c.U,bt.ju,o,o),l.clearContextCache(!0),n.aR(),"svg"===this.zc){const t=this.th.get("svg");this.Ct&&this.Ct.appendChild(t.Rt),this.ii=t.ci}}addEventListener(t,e,i,n){t.addEventListener(e,i,{capture:n,passive:!1})}Xt(t,e,i,n){t.addEventListener(e,i,{capture:n,passive:!1})}removeEventListener(t,e,i,n){t.removeEventListener(e,i,{capture:n})}Ni(t,e,i,n){t.removeEventListener(e,i,{capture:n})}aR(){const e=this;let i=this.mt.Rt;i instanceof HTMLCanvasElement||(i=e.div),this.Xt(i,"pointerdown",e.sh,!1),this.Xt(i,"pointermove",e.ha,!1),this.Xt(i,"pointerup",e.aa,!1),this.Xt(i,"pointerout",e.ca,!1),this.Xt(i,"pointercancel",e.fa,!1),this.Xt(i,"pointerenter",e.cR,!1),this.Xt(i,"pointerleave",e.fR,!1),this.Xt(i,"wheel",e.la,!1),this.Xt(i,"keydown",e.uR,!1),this.Xt(i,"keyup",e.dR,!1),this.Xt(i,"blur",e.gR,!1),this.Xt(i,"focus",e.mR,!1),this.Xt(i,"selectstart",(t=>(t.preventDefault(),!1)),!1),this.Xt(i,"contextmenu",(t=>(t.preventDefault(),!1)),!1),this.Xt(t,"resize",e.ob,!1)}Ew(){this.Qm>30&&(this.Al=1)}xP(t){null!==this.Al&&(this.Al=null,t&&this.bu(),this.Qm=0,this.pM=[0,0,0,0,0],this._m=0)}computePixelRatio(){return null!==this.Al?this.Al:t.devicePixelRatio||1}get avgSpf(){return this.Qm}doMouseDown(){this.currentTool.doMouseDown()}doMouseMove(){this.currentTool.doMouseMove()}doMouseUp(){this.currentTool.doMouseUp()}doMouseWheel(){this.currentTool.doMouseWheel()}doKeyDown(){this.currentTool.doKeyDown()}doKeyUp(){this.currentTool.doKeyUp()}doFocus(){this.focus()}focus(){if(this.mt)if(this.scrollsPageOnFocus)this.mt.focus();else{const e=t.scrollX,i=t.scrollY;this.mt.focus(),t.scrollTo(e,i)}}mR(t){const e=bt.is.get(this);e&&e.v("GainedFocus")}gR(t){const e=bt.is.get(this);e&&e.v("LostFocus")}AS(){if(null===this.mt)return;const t=this.Ct;if(null===t||0===t.clientWidth||0===t.clientHeight)return;this.KS||this.setScrollWidth();const e=this._n?this.Zt:0,i=this.pn?this.Zt:0,n=this.Yi;if(this.Yi=this.computePixelRatio(),this.Yi!==n&&(this.Iu=!0,this.requestUpdate()),t.clientWidth!==this.Pt+e||t.clientHeight!==this.St+i){this.da(),this.ze=!0;const t=this.layout;null!==t&&t.isViewportSized&&1===this.autoScale&&(this.Vc=!0,t.invalidateLayout()),this.bs||this.requestUpdate()}}NL(){let t=0,e=new gt;e.name="Grid",e.allowSelect=!1,e.pickable=!1,e.isTemporary=!0,e.isInDocumentBounds=!1,this.Wr(e,t++),e=new gt,e.name="ViewportBackground",e.isViewportAligned=!0,e.isTemporary=!0,e.isInDocumentBounds=!1,this.Wr(e,t++),e=new gt,e.name="Background",this.Wr(e,t++),e=new gt,e.name="",this.Wr(e,t++),e=new gt,e.name="Foreground",this.Wr(e,t++),e=new gt,e.name="ViewportForeground",e.isViewportAligned=!0,e.isTemporary=!0,e.isInDocumentBounds=!1,this.Wr(e,t++),e=new gt,e.name="Adornment",e.isTemporary=!0,e.isInDocumentBounds=!1,this.Wr(e,t++),e=new gt,e.name="Tool",e.isTemporary=!0,e.isInDocumentBounds=!0,this.Wr(e,t++)}FL(){const t=new Yt(Yt.Grid,{name:"GRID"}).add(new Jt("LineH",{stroke:"lightgray",strokeWidth:.5,interval:1}).theme("stroke","gridMinor"),new Jt("LineV",{stroke:"lightgray",strokeWidth:.5,interval:1}).theme("stroke","gridMinor"),new Jt("LineH",{stroke:"gray",strokeWidth:.5,interval:5}).theme("stroke","gridMajor"),new Jt("LineV",{stroke:"gray",strokeWidth:.5,interval:5}).theme("stroke","gridMajor"),new Jt("LineH",{stroke:"gray",strokeWidth:1,interval:10}).theme("stroke","gridMajor"),new Jt("LineV",{stroke:"gray",strokeWidth:1,interval:10}).theme("stroke","gridMajor")),e=new ce({layerName:"Grid",zOrder:0,isInDocumentBounds:!1,isAnimated:!1,pickable:!1,locationObjectName:"GRID"}).add(t);return this.add(e),this.partManager.parts.delete(e),t.visible=!1,t}static sR(){const t=bt.is.get(this.parentElement||this);if(t){if(t.qx)return void(t.qx=!1);if(!t.isEnabled)return void t.RL();t.diagramScroll(this)}}static nR(t){this.L.isEnabled?(this.L.Wx=t.target.scrollTop,this.L.Jx=t.target.scrollLeft):this.L.updateScroll()}diagramScroll(t){if(null===this.mt)return;const e=this.eb,i=this.sb;this.Km=!0;let n=this.documentBounds,s=this.viewportBounds;const o=this.ta;let r=n.x-o.left,a=n.y-o.top;const l=n.width+o.left+o.right,h=n.height+o.top+o.bottom;let u=n.right+o.right,c=n.bottom+o.bottom,d=s.x,f=s.y;const g=s.width,m=s.height;let p=s.right,x=s.bottom;const b=this.scale;let v,w=t.scrollLeft;if(this.Hu)switch(this.px){case"negative":w=w+t.scrollWidth-t.clientWidth;break;case"reverse":w=t.scrollWidth-w-t.clientWidth}const k=w;if(g<l||m<h)return v=y.X(this.position.x,this.position.y),this.allowHorizontalScroll&&this.Jx!==k&&(v.x=k/b+r,this.Jx=k),this.allowVerticalScroll&&this.Wx!==t.scrollTop&&(v.y=t.scrollTop/b+a,this.Wx=t.scrollTop),this.position=v,y.e(v),this.Km=!1,void(this.Vu=!1);if(v=y.l(),t.oR&&this.allowHorizontalScroll&&(r<d&&(this.position=v.i(k+r,this.position.y)),u>p)){const t=e.scrollWidth-this.Pt;this.position=v.i(-t+k-this.Pt/b+u,this.position.y)}if(t.rR&&this.allowVerticalScroll&&(a<f&&(this.position=v.i(this.position.x,t.scrollTop+a)),c>x)){const i=e.scrollHeight-this.St;this.position=v.i(this.position.x,-i+t.scrollTop-this.St/b+c)}y.e(v),this.oh(),this.Km=!1,this.Vu=!1,n=this.documentBounds,s=this.viewportBounds,u=n.right,p=s.right,c=n.bottom,x=s.bottom,r=n.x,d=s.x,a=n.y,f=s.y,g>=l&&r>=d&&u<=p&&(i.style.width="1px"),m>=h&&a>=f&&c<=x&&(i.style.height="1px")}computeBounds(t){return void 0===t&&(t=new b),this.Li(),this.vL(t)}vL(t){if(this.fixedBounds.isReal())return t.a(this.fixedBounds),t.addMargin(this.ti),t;let e=!0;const i=this.Gt.r,n=i.length;for(let s=0;s<n;s++){const n=i[s];if(!n.visible||!n.isInDocumentBounds)continue;const o=n.Tt.r,r=o.length;for(let i=0;i<r;i++){const n=o[i];if(!n.isInDocumentBounds||!n.isVisible())continue;const s=n.actualBounds;s.isReal()&&(e?(e=!1,t.a(s)):t.unionRect(s))}}return e&&t.i(0,0,0,0),t.addMargin(this.ti),t}computePartsBounds(t,e){void 0===e&&(e=!1);let i=null;if(Array.isArray(t))for(let n=0;n<t.length;n++){const s=t[n];!e&&s instanceof ve||(s.ensureBounds(),null===i?i=s.actualBounds.copy():i.unionRect(s.actualBounds))}else{const n=t.iterator;for(;n.next();){const t=n.value;!e&&t instanceof ve||(t.ensureBounds(),null===i?i=t.actualBounds.copy():i.unionRect(t.actualBounds))}}return null===i?new b(NaN,NaN,0,0):i}Ks(t){if(!t&&!this.to||this.Jt||null===this.mt||!this.documentBounds.isReal())return;if(this.Jt=!0,t){const t=this.initialPosition;if(t.isReal())return this.Jt=!1,void(this.position=t);let e=this.initialDocumentSpot,i=this.initialViewportSpot;e.isNoSpot()&&(e=w.TopLeft),i.isNoSpot()&&(i=w.TopLeft);const n=y.l();n.setRectSpot(this.documentBounds,e);const s=this.viewportBounds,o=b.X(0,0,s.width,s.height),r=y.l();r.setRectSpot(o,i),r.i(n.x-r.x,n.y-r.y),this.Jt=!1,this.position=r,b.e(o),y.e(r)}let e=this.Zl;t&&1!==this.Dr&&(e=this.Dr);const i=1!==e?this.qu(e):this.scale,n=this.dt.x,s=this.dt.y,o=this.Pt/i,r=this.St/i;let a=this.Bc;const l=this.Vm;if(t&&!a.isSpot()&&(l.isSpot()||l.isDefault())){const t=this.initialDocumentSpot.isSpot()&&this.initialViewportSpot.isSpot();a=l.isDefault()&&!t?w.Center:l}this.SM(this.documentBounds,o,r,a,t);const h=this.scale;this.scale=i,this.Jt=!1;const u=this.viewportBounds;u.equalsApproxTo(n,s,o,r)||this.onViewportBoundsChanged(new b(n,s,o,r),u,h,!1)}qu(t){const e=this.Jm;if(null===this.mt)return e;if(1===t)return this.scale;this.ensureBounds();const i=this.documentBounds;if(!i.isReal())return e;const n=i.width,s=i.height,o=this.Pt+(this._n?this.Zt:0),r=this.St+(this.pn?this.Zt:0);let a=o/n,l=r/s;const h=this.ta,u=h.left+h.right!==0,c=h.top+h.bottom!==0;(u||c)&&(l===a?(l=(r-this.Zt)/s,a=(o-this.Zt)/n):l>a?l=(r-this.Zt)/s:a=(o-this.Zt)/n);let d=0;return 2===t?d=Math.min(l,a):3===t&&(d=l>a?(r-this.Zt)/s:(o-this.Zt)/n),d>e&&(d=e),d<this.minScale&&(d=this.minScale),d>this.maxScale&&(d=this.maxScale),d}zoomToFit(){const t=this.Zh;this.Zh=1,this.scale=this.qu(2),this.alignDocument(w.Center,w.Center),1!==t&&(this.Ks(!1),this.SM(this.documentBounds,this.Pt/this.nt,this.St/this.nt,this.Bc,!1)),this.Zh=t}zoomToRect(t,e){void 0===e&&(e=2);const i=t.width,n=t.height;if(0===i||0===n||isNaN(i)&&isNaN(n))return;let s=1;if(2===e||3===e)if(isNaN(i))s=this.viewportBounds.height*this.scale/n;else if(isNaN(n))s=this.viewportBounds.width*this.scale/i;else{const t=this.Pt,o=this.St;s=3===e?o/n>t/i?(o-(this.pn?this.Zt:0))/n:(t-(this._n?this.Zt:0))/i:Math.min(o/n,t/i)}this.scale=s,this.position=new y(t.x,t.y)}get pR(){return this.Jt}set pR(t){this.Jt=t}alignDocument(t,e){this.ensureBounds();const i=this.documentBounds,n=this.viewportBounds;this.position=new y(i.x+(t.x*i.width+t.offsetX)-(e.x*n.width-e.offsetX),i.y+(t.y*i.height+t.offsetY)-(e.y*n.height-e.offsetY))}focusObject(t){if(t instanceof At){this.t0=t;const e=y.l();this.i0=this.transformDocToView(t.getDocumentPoint(w.TopLeft,e)),y.e(e)}else this.t0=null,this.i0=y.Ak}SM(t,e,i,n,s){const o=y.X(this.dt.x,this.dt.y);let r=o.x,a=o.y;if(null!==this.t0){let t=y.l();t=this.t0.getDocumentPoint(w.TopLeft,t),r=t.x-this.i0.x/this.scale,a=t.y-this.i0.y/this.scale,n=w.None,y.e(t)}if(s||1===this.scrollMode){n.isSpot()&&(e>t.width&&(r=t.x+(n.x*t.width+n.offsetX)-(n.x*e-n.offsetX)),i>t.height&&(a=t.y+(n.y*t.height+n.offsetY)-(n.y*i-n.offsetY)));const s=this.ta,o=e-t.width;if(e<t.width+s.left+s.right){let i=r+e/2;i=Math.min(i,t.right+Math.max(o,s.right)-e/2),i=Math.max(i,t.left-Math.max(o,s.left)+e/2),r=i-e/2}else r>t.left?r=t.left:r<t.right-e&&(r=t.right-e);const l=i-t.height;if(i<t.height+s.top+s.bottom){let e=a+i/2;e=Math.min(e,t.bottom+Math.max(l,s.bottom)-i/2),e=Math.max(e,t.top-Math.max(l,s.top)+i/2),a=e-i/2}else a>t.top?a=t.top:a<t.bottom-i&&(a=t.bottom-i)}if(o.x=isFinite(r)?r:-this.ti.left,o.y=isFinite(a)?a:-this.ti.top,null!==this.positionComputation){const t=this.positionComputation(this,o);o.x=t.x,o.y=t.y}this.ps.cL(this.dt,o),this.dt.i(o.x,o.y),this.gb(),this.nh(),this.yR(),y.e(o)}findPartAt(t,e){if(void 0===e&&(e=!0),e){const e=this.MP(t,(t=>t.part),(t=>t.canSelect()));if(e instanceof ce)return e}else{const e=this.MP(t,(t=>t.part));if(e instanceof ce)return e}return null}findObjectAt(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null),this.Li();const n=this.Gt.iteratorBackwards;for(;n.next();){const s=n.value;if(!s.visible)continue;const o=s.findObjectAt(t,e,i);if(null!==o)return o}return null}MP(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null),this.Li();const n=this.Gt.iteratorBackwards;for(;n.next();){const s=n.value;if(!s.visible||s.isTemporary)continue;const o=s.findObjectAt(t,e,i);if(null!==o)return o}return null}findPartsAt(t,e,i){return void 0===e&&(e=!0),this.wR(t,(t=>t.part),e?t=>t instanceof ce&&t.canSelect():null,i)}wR(t,e,i,n){void 0===e&&(e=null),void 0===i&&(i=null),!(n instanceof l)&&!(n instanceof u)&&(n=new u),this.Li();const s=this.Gt.iteratorBackwards;for(;s.next();){const o=s.value;!o.visible||o.isTemporary||o.findObjectsAt(t,e,i,n)}return n}findObjectsAt(t,e,i,n){void 0===e&&(e=null),void 0===i&&(i=null),!(n instanceof l)&&!(n instanceof u)&&(n=new u),this.Li();const s=this.Gt.iteratorBackwards;for(;s.next();){const o=s.value;o.visible&&o.findObjectsAt(t,e,i,n)}return n}findPartsIn(t,e,i,n){return void 0===e&&(e=!1),void 0===i&&(i=!0),this.xR(t,null,(t=>t instanceof ce&&(!i||t.canSelect())),e,n)}findObjectsIn(t,e,i,n,s){void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=!1),!(s instanceof l)&&!(s instanceof u)&&(s=new u),this.Li();const o=this.Gt.iteratorBackwards;for(;o.next();){const r=o.value;r.visible&&r.findObjectsIn(t,e,i,n,s)}return s}LP(t,e,i,n,s,o){const r=new u;this.Li();const a=this.Gt.iteratorBackwards;for(;a.next();){const l=a.value;l.visible&&l.LP(t,e,i,n,r,s,o)}return r}xR(t,e,i,n,s){void 0===e&&(e=null),void 0===i&&(i=null),void 0===n&&(n=!1),!(s instanceof l)&&!(s instanceof u)&&(s=new u),this.Li();const o=this.Gt.iteratorBackwards;for(;o.next();){const r=o.value;!r.visible||r.isTemporary||r.findObjectsIn(t,e,i,n,s)}return s}findPartsNear(t,e,i,n,s){return void 0===i&&(i=!0),void 0===n&&(n=!0),this.bR(t,e,null,(t=>t instanceof ce&&(!n||t.canSelect())),i,s)}findObjectsNear(t,e,i,n,s,o){void 0===i&&(i=null),void 0===n&&(n=null),void 0===s&&(s=!0),!1!==s&&!0!==s&&((s instanceof l||s instanceof u)&&(o=s),s=!0),!(o instanceof l)&&!(o instanceof u)&&(o=new u),this.Li();const r=this.Gt.iteratorBackwards;for(;r.next();){const a=r.value;a.visible&&a.findObjectsNear(t,e,i,n,s,o)}return o}bR(t,e,i,n,s,o){void 0===i&&(i=null),void 0===n&&(n=null),void 0===s&&(s=!0),!1!==s&&!0!==s&&((s instanceof l||s instanceof u)&&(o=s),s=!0),!(o instanceof l)&&!(o instanceof u)&&(o=new u),this.Li();const r=this.Gt.iteratorBackwards;for(;r.next();){const a=r.value;!a.visible||a.isTemporary||a.findObjectsNear(t,e,i,n,s,o)}return o}acceptEvent(t){return this.jc(t,t instanceof MouseEvent)}jc(t,i){const n=this.Hr;this.Hr=this.sa,this.sa=n,n.diagram=this,n.event=t,i?this.s0(t,n):(n.viewPoint=this.Hr.viewPoint,n.documentPoint=this.Hr.documentPoint);let s=0;const o=t;return o.ctrlKey&&(s+=1),o.altKey&&(s+=2),o.shiftKey&&(s+=4),o.metaKey&&(s+=8),n.modifiers=s,n.button=o.button,void 0!==o.buttons&&(n.buttons=o.buttons),e.hr&&0===o.button&&o.ctrlKey&&(n.button=2),n.down=!1,n.up=!1,n.clickCount=1,n.delta=0,n.handled=!1,n.bubbles=!1,n.timestamp=t.timeStamp,n.isMultiTouch=!1,n.targetDiagram=this.db(t,t.target),n.targetObject=null,n}db(t,i){if(null===i)return null;const n=bt.is.get(i);if(n)return n;let s=t.path;if(!s&&e.ot(t.composedPath)&&(s=t.composedPath()),s&&s[0]){const t=bt.is.get(s[0]);if(t)return t}return null}lR(t,e,i){const n=this.PM(t,!0,!1,!1,!0,i);return this.s0(e,n),n.targetDiagram=this.db(t,t.target),n.targetObject=null,i||n.clone(this.Wm),n}hR(e,i,n){const s=this.PM(e,!1,!1,!1,!1,n);let o=t.document.elementFromPoint(i.clientX,i.clientY)||null;null!==o&&void 0!==o.shadowRoot&&null!==o.shadowRoot&&(o=o.shadowRoot.elementFromPoint(i.clientX,i.clientY));let r=this,a=e;if(o){const t=this.db(e,o);t&&(a=i,r=t)}return s.targetDiagram=r,this.s0(a,s),s.targetObject=null,s}PM(t,i,n,s,o,r){const a=this.Hr;this.Hr=this.sa,this.sa=a,a.diagram=this,a.clickCount=1,a.delta=0;let l=0;return t.ctrlKey&&(l+=1),t.altKey&&(l+=2),t.shiftKey&&(l+=4),t.metaKey&&(l+=8),a.modifiers=l,a.event=t,a.timestamp=t.timeStamp,a.button=n?this.firstInput.button:t.button,a.buttons=t.buttons,e.hr&&0===t.button&&t.ctrlKey&&(a.button=2),a.down=i,a.up=n,a.handled=s,a.bubbles=o,a.isMultiTouch=r,a}ua(t,e){return!!t.bubbles||(void 0!==e.stopPropagation&&e.stopPropagation(),!1!==e.cancelable&&e.preventDefault(),e.cancelBubble=!0,!1)}uR(t){const e=bt.is.get(this);if(!e||!e.isEnabled)return!1;const i=e.jc(t,!1);return i.key=t.key,i.code=t.code,i.down=!0,e.doKeyDown(),e.ua(i,t)}dR(t){const e=bt.is.get(this);if(!e||!e.isEnabled)return!1;const i=e.jc(t,!1);return i.key=t.key,i.code=t.code,i.up=!0,e.doKeyUp(),e.ua(i,t)}cR(t){const e=bt.is.get(this);if(!e||!e.isEnabled)return!1;const i=e.jc(t,!0);return null!==e.mouseEnter&&e.mouseEnter(i),e.currentTool.standardMouseOver(),e.ua(i,t)}fR(t){const e=bt.is.get(this);if(!e||!e.isEnabled)return!1;const i=e.jc(t,!0);return null!==e.mouseLeave&&e.mouseLeave(i),e.ua(i,t)}getMouse(t){const e=this.mt;if(null===e)return new y(0,0);const i=e.getBoundingClientRect(),n=(t.clientX-i.left)*(this.Pt/i.width),s=(t.clientY-i.top)*(this.St/i.height);return new y(n,s).Be(this.F)}s0(t,e){const i=this.mt;let n=0,s=0;if(null!==i){const e=i.getBoundingClientRect();n=(t.clientX-e.left)*(this.Pt/e.width),s=(t.clientY-e.top)*(this.St/e.height)}e.viewPoint.i(n,s);const o=y.X(n,s);this.F._e(o),e.documentPoint.a(o),y.e(o)}RC(t,e,i){let n;if(null===this.ra[0])return;n=this.ra[e];const s=this.mt;if(null!==s){const t=s.getBoundingClientRect();i.i((n.clientX-t.left)*(this.Pt/t.width),(n.clientY-t.top)*(this.St/t.height))}}invalidateDocumentBounds(){this.na||(this.na=!0,this.requestUpdate(!1))}kR(){this.bs||this.Li(),this.ensureBounds()}redraw(){this.Jt||this.bs||(this.C(),this.maybeUpdate())}isUpdateRequested(){return this.Cr}delayInitialization(t){void 0===t&&(t=null);const i=this.animationManager,n=i.isEnabled;i.stopAnimation(),i.isEnabled=!1,this.br(),this.to=!1,this.tx=new y(NaN,NaN),i.isEnabled=n,this.bs=!0;const s=this;null!==t&&e.ar((()=>{s.bs=!1,i.Bl("Model"),t(s)}),1)}requestUpdate(e){if(void 0===e&&(e=!1),!0===this.Cr||this.Jt||!1===e&&this.bs)return;this.Cr=!0;const i=this;t.requestAnimationFrame((()=>{i.Cr&&i.maybeUpdate()}))}maybeUpdate(){this.Eu&&!this.Cr||(this.Eu&&(this.Eu=!1),this.br())}MM(t,e){!this.Vu||this.Jt||this.animationManager.defaultAnimation.isAnimating||this.RL()||(t&&this.Li(),e&&this.Ks(!1))}br(t){if(this.bs||(this.Cr=!1,null===this.Ct&&!this.zu.isReal()))return;this.bs=!0;const e=this.animationManager,i=this.Gu;if(!e.isAnimating&&0!==i.length){const t=i.r,e=t.length;for(let i=0;i<e;i++){const e=t[i];e.me(!1),e.c()}i.clear()}const n=this.fM;n.count>0&&(n.each((t=>t.NM())),n.clear());let s=!1,o=!1;e.defaultAnimation.isAnimating&&(o=!0,s=this.skipsUndoManager,this.skipsUndoManager=!0),e.xi||this.AS(),t||this.MM(!1,!0);const r=!this.undoManager.isUndoingRedoing&&(this.Cl||0!==this.Hc.count&&0!==this.Fr.size),a=!this.to||this.jr;this.Li(!0);let l=!1;(a||r)&&(this.to?this.CM(!this.Vc,r):(this.startTransaction("Initial Layout"),!1===e.isEnabled&&e.stopAnimation(),this.CM(!1,r)),l=a),this.Vc=!1,this.Cl=!1,this.Li(),null!==this.ts&&(this.ts.visible&&!this.Xu&&(this.rh(),this.Xu=!0),!this.ts.visible&&this.Xu&&(this.Xu=!1)),this.Ix||this.kR(),t||this.MM(!0,!1);let h=!1;if(l){const e=b.l();e.a(this.viewportBounds),this.to||(this.to=!0,h=!0,this.skipsUndoManager||(this.undoManager.vw=!0),this.undoManager.Ow=!0,this.PR()),this.SR(),this.Li(!1),t||this.MM(!0,!0),b.e(e)}else if(e.Tc&&e._w){if(1!==this.Dr)this.scale=this.qu(this.Dr);else if(1!==this.Zl)this.scale=this.qu(this.Zl);else{const t=this.initialScale;isFinite(t)&&t>0&&(this.scale=t)}this.Ks(!0)}l&&h&&this.commitTransaction("Initial Layout"),t||this.zi(this.ii),o&&(this.skipsUndoManager=s),this.bs=!1}get Kh(){return this.to}PR(){if(1!==this.Dr)this.scale=this.qu(this.Dr);else if(1!==this.Zl)this.scale=this.qu(this.Zl);else{const t=this.initialScale;isFinite(t)&&t>0&&(this.scale=t)}this.Ks(!0);const t=this.Gt.r;this.xs(t,t.length,this,this.viewportBounds),this.v("InitialLayoutCompleted"),this.tx.a(this.dt),this.rh()}SR(){this.v("LayoutCompleted")}o0(t){this.Zn.add(t)}addInvalidRoute(t){this.Oo?this.ia.add(t):this.Fr.add(t)}Li(t){if(0!==this.Zn.size&&(this.bs||!this.animationManager.isTicking)){if(this.bs||(this.Cl=!0),t)return void this.OL(this.Zn);for(let t=0;t<23&&0!==this.Zn.size;t++){const t=new Set(this.Zn);this.Zn.clear(),this.NM(t,this.Zn)}this.nodes.each((t=>{t instanceof Ne&&t.IL(!1)}))}}OL(t,e){for(const i of t)!i.Me()||i instanceof Ne||(i.Jr()?(i.ut(1/0,1/0),i.Yt()):e&&e.add(i));for(const i of t)if(i instanceof Ne){if(!i.isVisible())continue;this.mb(i)}}NM(t,e){this.OL(t,e);for(const i of t){if(!(i instanceof ve))continue;const t=i;t.isVisible()&&(t.Jr()?(t.ut(1/0,1/0),t.Yt()):e.add(t))}for(const i of t)i instanceof fe&&i.isVisible()&&(i.Jr()?(i.ut(1/0,1/0),i.Yt()):e.add(i))}r0(t){const e=t instanceof bt,i=e?t.links:t.memberParts,n=this.Zn;if(e)this.Li(!0);else{for(;i.next();){const t=i.value;n.has(t)&&(!t.Me()||t instanceof Ne||t.Jr()&&(t.ut(1/0,1/0),t.Yt()))}for(i.reset();i.next();){const t=i.value;if(n.has(t)&&t instanceof Ne){if(!t.isVisible())continue;this.mb(t)}}i.reset()}for(;i.next();){const t=i.value;t instanceof ve&&n.has(t)&&t.isVisible()&&t.Jr()&&(t.ut(1/0,1/0),t.Yt())}}mb(t){const i=e.rt(),n=e.rt(),s=t.memberParts;for(;s.next();){const e=s.value;e.isVisible()&&(e instanceof Ne?(e.Bo()||e.es()||e.lh())&&this.mb(e):e instanceof ve?e.fromNode===t||e.toNode===t?n.push(e):i.push(e):(e.ut(1/0,1/0),e.Yt()))}let o=i.length;for(let e=0;e<o;e++){const t=i[e];t.ut(1/0,1/0),t.Yt()}e.tt(i),t.ut(1/0,1/0),t.Yt(),o=n.length;for(let e=0;e<o;e++){const t=n[e];t.ut(1/0,1/0),t.Yt()}e.tt(n)}xs(t,e,i,n){if(this.Xc||this.animationManager.isAnimating){for(let s=0;s<e;s++)t[s].xs(i,n);this.Li()}}zi(t){null!==this.Ct&&(null===this.mt&&e.o("No canvas specified"),"svg"===this.zc?this.MR(t):this.NR(t))}NR(t){const e=this.animationManager;if(e.xi||e.isAnimating&&!e.isTicking)return;const i=new Date;if(this.l0(),this.Ct&&"0"===this.Ct.style.opacity)return;const n=t!==this.ii,s=this.Gt.r,o=s.length,r=this;if(this.xs(s,o,r,r.viewportBounds),n)t.clearContextCache(!0),this.oh();else if(!this.ze&&!e.isAnimating)return;const a=this.F,l=this.Yi;t.setTransform(l,0,0,l,0,0),t.clearRect(0,0,this.Pt,this.St),1!==this._t&&(t.globalAlpha=this._t),this.LM(t);for(let f=0;f<o;f++)t.setTransform(l,0,0,l,0,0),t.transform(a.m11,a.m12,a.m21,a.m22,a.dx,a.dy),t.commitTransform(),s[f].zi(t,r);let h=!1;this.Gc?this.Gc.ju(this)&&(h=this.nb()):h=!0,h&&(k.prototype._e=k.prototype.ww),n?(this.ii.clearContextCache(!0),this.oh()):(this.Xc=!1,this.ze=!1);const u=+new Date-+i,c=!1,d=this.pM;if(null===this.Al){d[this._m]=u,this._m=(this._m+1)%d.length;let t=0;for(let e=0;e<d.length;e++)t+=d[e];this.Qm=t/d.length}1!==this._t&&(t.globalAlpha=1)}MR(t){if(null===this.Ct)return;const e=this.animationManager;if(e.xi||e.isAnimating&&!e.isTicking)return;this.l0();const i=this.Pt,n=this.St;t.surface.resize(i,n,i,n);const s=this.Gt.r,o=s.length,r=this;if(this.xs(s,o,r,r.viewportBounds),!this.ze&&!e.isAnimating)return;const a=this.F;t.lastDrawnPart=null,t.setDiagramPosScale(a.m11,a.m12,a.m21,a.m22,a.dx,a.dy),1!==this._t&&(t.globalAlpha=this._t),this.LM(t);const l=this.Yi;this.mt.ci.setTransform(l,0,0,l,0,0),this.mt.ci.clearRect(0,0,this.Pt,this.St);for(let u=0;u<o;u++)s[u].zi(t,r);let h=!1;this.Gc?this.Gc.ju(this)&&(h=this.nb()):h=!0,h&&(k.prototype._e=k.prototype.ww),this.Xc=!1,this.ze=!1}pb(t,i,n,s,o,r,a,l,h){if(null===this.Ct)return;null===this.mt&&e.o("No canvas specified"),void 0===r&&(r=null),void 0===a&&(a=null),void 0===l&&(l=!1),void 0===h&&(h=!1),this.l0(),this.ii.clearContextCache(!0),this.oh(),this.oa=!0;const c=this.nt;this.nt=s;const d=this,f=this.Gt.r,g=f.length;try{const e=new b(o.x,o.y,n.width/s,n.height/s),c=e.copy();c.addMargin(i),this.rh(c),this.Li(),this.xs(f,g,d,e),t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,n.width,n.height),null!==a&&""!==a&&(t.fillStyle=a,t.fillBackground(0,0,n.width,n.height));const m=this.Yi;t.scale(m,m);const p=k.l();p.Ii(),p.Es(i.left,i.top),p.nt(s),(0!==o.x||0!==o.y)&&p.Es(-o.x,-o.y),t.setTransform(p.m11,p.m12,p.m21,p.m22,p.dx,p.dy),t.commitTransform(),t instanceof Et&&t.setDiagramPosScale(p.m11,p.m12,p.m21,p.m22,p.dx,p.dy),k.e(p),this.LM(t),t.globalAlpha=this._t;const y=this.findLayer("Grid");if(r){const e=new u,i=r.iterator;for(i.reset();i.next();){const t=i.value;t instanceof ce&&(!h&&t.layer===y||(t.vu(),e.add(t)))}for(let n=0;n<g;n++)f[n].EF(t,d,e,l);e.each((t=>t.vu()))}else for(let i=0;i<g;i++){const e=f[i];e===y?h&&e.zi(t,d,!0):e.zi(t,d,l)}this.oa=!1,this.Gc&&this.Gc.ju(this)&&this.nb()}finally{this.nt=c,this.ii.clearContextCache(!0),this.oh(),this.xs(f,g,d,d.viewportBounds),this.rh(),this.ii instanceof Et&&(this.ii.diagramGroup.replaceChildren(),this.redraw())}}getRenderingHint(t){return this.Tr[t]}setRenderingHint(t,e){"minDrawingLength"===t&&(this.Em=e),this.Tr[t]=e,this.redraw()}resetRenderingHints(){this.Tr=new n,this.Tr.drawShadows=!0,this.Tr.textGreeking=!0,this.Tr.viewportOptimizations=!e.hr,this.Tr.temporaryPixelRatio=!0,this.Tr.pictureRatioOptimization=!0,this.Tr.minDrawingLength=1,this.Em=1}LM(t){const e=this.Tr;if(null===e)return;if(void 0!==e.imageSmoothingEnabled){const i=!!e.imageSmoothingEnabled;t.setImageSmoothingEnabled(i)}const i=e.defaultFont;null!=i&&(t.font=i)}getInputOption(t){return this.Ou[t]}setInputOption(t,e){this.Ou[t]=e}QF(){this.Ou=new n,this.Ou.extraTouchArea=10,this.Ou.extraTouchThreshold=10,this.Ou.hasGestureZoom=!0}set(t){return Object.assign(this,t),this}attach(t){return this.setProperties(t)}setProperties(t){return bt.h0(this,t),this}static h0(t,i){const n=t instanceof Yt,s=t instanceof bt;for(const o in i){""===o&&e.o("Setting properties requires non-empty property names");let r=t,a=o;if(n||s){const i=o.indexOf(".");if(i>0){const s=o.substring(0,i);n?r=t.findObject(s):(r=t[s],null==r&&(r=t.toolManager[s])),e.H(r)?a=o.substring(i+1):e.o("Unable to find object named: "+s+" in "+t.toString()+" when trying to set property: "+o)}}if("_"!==a[0]&&!e.fw(r,a)){if(s&&"ModelChanged"===a){t.addModelChangedListener(i[a]);continue}if(s&&"Changed"===a){t.addChangedListener(i[a]);continue}if(s&&e.fw(t.toolManager,a))r=t.toolManager;else{if(s&&t.EL(a)){t.addDiagramListener(a,i[a]);continue}if(t instanceof Ue&&"Changed"===a){t.addChangedListener(i[a]);continue}e.o('Trying to set undefined property "'+a+'" on object: '+r.toString())}}const l=i[o];r[a]=l,"_"===a[0]&&r instanceof At&&r.addCopyProperty(a)}}dL(){if(0!==this.eh.count&&!(this.undoManager.transactionLevel>1)){for(;this.eh.count>0;){const t=this.eh;this.eh=new p;const e=t.iterator;for(;e.next();){const t=e.key;t.invalidateOtherJumpOvers(e.value),t.oe()}}this.C()}}C(t){if(void 0===t)this.ze=!0,this.requestUpdate();else{const e=this.viewportBounds;t.isReal()&&e.intersectsRect(t)&&(this.ze=!0,this.requestUpdate())}this.v("InvalidateDraw")}invalidateViewport(t,e){!0!==this.ze&&(this.ze=!0,"svg"!==this.zc&&!0===this.getRenderingHint("temporaryPixelRatio")?(this.Ew(),this.maybeUpdate(),this.xP(!0)):this.maybeUpdate())}da(){this.Vu=!0}oh(){this.Xc=!0}l0(){!1!==this.Iu&&(this.Iu=!1,this.DL(this.Pt,this.St))}DL(t,e){this.nh();const i=this.Yi,n=t*i,s=e*i;this.mt.resize(n,s,t,e)&&(this.ze=!0,this.ii.clearContextCache(!0))}RL(){const t=this.mt;if(null===t||this.zu.isReal())return!0;const e=this.Pt,i=this.St,n=this.Ct;let s=!1,o=this._n?this.Zt:0,r=this.pn?this.Zt:0,a=n.clientWidth||e+o,l=n.clientHeight||i+r;const h=this.viewportBounds,u=h.x,c=h.y,d=h.width,f=h.height;if((a!==e+o||l!==i+r)&&(this._n=!1,this.pn=!1,o=0,r=0,this.Pt=a,this.St=l,this.Iu=!0,s=!0,this.nh()),!this.to||!this.viewportBounds.isReal())return!0;const g=this.eb,m=this.sb;if(this.Vu=!1,!s&&!this._n&&!this.pn&&!this.Bu&&!this.Uu)return!0;const p=this.documentBounds;let x=0,v=0,w=0,k=0;const S=h.width,P=h.height,M=this.ta;this.contentAlignment.isSpot()?(p.width>S&&(x=M.left,v=M.right),p.height>P&&(w=M.top,k=M.bottom)):(x=M.left,v=M.right,w=M.top,k=M.bottom);const C=p.width+x+v,N=p.height+w+k,T=this.scale,L=T;let A=C>a/T,D=N>l/T;if(!s&&!this._n&&!this.pn&&!A&&!D)return!0;const F=p.x-x,O=h.x,R=p.right+v;let E=h.right+o;const B=p.y-w,I=h.y,z=p.bottom+k;let V=h.bottom+r,j="1px",U="1px";if(1===this.scrollMode&&(A||D)){if(A&&this.hasHorizontalScrollbar&&this.allowHorizontalScroll){let t=1;F+1<O&&(t=Math.max((O-F)*T+this.Pt,t)),R>E+1&&(t=Math.max((R-E)*T+this.Pt,t)),S+o+1<C&&(t=Math.max((C-S)*T+this.Pt,t)),j=t.toString()+"px"}if(D&&this.hasVerticalScrollbar&&this.allowVerticalScroll){let t=1;B+1<I&&(t=Math.max((I-B)*T+this.St,t)),z>V+1&&(t=Math.max((z-V)*T+this.St,t)),P+r+1<N&&(t=Math.max((N-P)*T+this.St,t)),U=t.toString()+"px"}}let G="1px"!==j,K="1px"!==U;if((!G||!K)&&(G||K)){if(A=!(C<S+o),D=!(N<P+r),K&&(E-=this.Zt),G&&(V-=this.Zt),A&&this.hasHorizontalScrollbar&&this.allowHorizontalScroll){let t=1;F+1<O&&(t=Math.max((O-F)*T+this.Pt,t)),R>E+1&&(t=Math.max((R-E)*T+this.Pt,t)),S+1<C&&(t=Math.max((C-S)*T+this.Pt,t)),j=t.toString()+"px"}G="1px"!==j;let t=this.St;if(G!==this.pn&&(t=G?this.St-this.Zt:this.St+this.Zt),D&&this.hasVerticalScrollbar&&this.allowVerticalScroll){let e=1;B+1<I&&(e=Math.max((I-B)*T+t,e)),z>V+1&&(e=Math.max((z-V)*T+t,e)),P+1<N&&(e=Math.max((N-P)*T+t,e)),U=e.toString()+"px"}K="1px"!==U}if(this.Km&&G===this.pn&&K===this._n)return(e!==this.Pt||i!==this.St)&&this.maybeUpdate(),!1;if(G!==this.pn&&(this.St="1px"===j?this.St+this.Zt:Math.max(this.St-this.Zt,1),s=!0),this.pn=G,m.style.width=j,K!==this._n&&(this.Pt="1px"===U?this.Pt+this.Zt:Math.max(this.Pt-this.Zt,1),s=!0,this.Hu)){const e=y.l();K?(t.style.left=this.Zt+"px",this.position=e.i(this.dt.x+this.Zt/this.scale,this.dt.y)):(t.style.left="0px",this.position=e.i(this.dt.x-this.Zt/this.scale,this.dt.y)),y.e(e)}s&&this.nh(),this._n=K,m.style.height=U,this.qx=!0,s&&(this.Iu=!0);let X=g.scrollLeft;if(this.hasHorizontalScrollbar&&this.allowHorizontalScroll&&(S+1<C?X=(this.position.x-F)*T:F+1<O?X=g.scrollWidth-g.clientWidth:R>E+1&&(X=this.position.x*T)),this.Hu)switch(this.px){case"negative":X=-(g.scrollWidth-X-g.clientWidth);break;case"reverse":X=g.scrollWidth-X-g.clientWidth}if(g.scrollLeft=X,this.hasVerticalScrollbar&&this.allowVerticalScroll&&(P+1<N?g.scrollTop=(this.position.y-B)*T:B+1<I?g.scrollTop=g.scrollHeight-g.clientHeight:z>V+1&&(g.scrollTop=this.position.y*T)),a=this.Pt,l=this.St,g.style.width=a+(this._n?this.Zt:0)+"px",g.style.height=l+(this.pn?this.Zt:0)+"px",e!==a||i!==l||this.animationManager.xi){const t=b.X(u,c,d,f);return this.onViewportBoundsChanged(t,this.viewportBounds,L,s),b.e(t),!1}return!0}add(t){const i=t.diagram;if(i===this)return;null!==i&&e.o("Cannot add part "+t.toString()+" to "+this.toString()+". It is already a part of "+i.toString());let n=this.findLayer(t.layerName);if(null===n&&(n=this.findLayer("")),null===n&&e.o('Cannot add a Part when unable find a Layer named "'+t.layerName+'" and there is no default Layer'),t.layer===n)return;const s=n._h(99999999,t,t.diagram===this);s>=0&&this.raiseChangedEvent(3,"parts",n,null,t,null,s),n.isTemporary||this.invalidateDocumentBounds(),t.invalidateLayout(1);const o=t.layerChanged;null!==o&&o(t,null,n)}_h(t){this.partManager._h(t);const e=this;t.$r((t=>e.BL(t))),t.data||t.Uo(),t.hasPlaceholder()&&t.c(),null!==t.data&&t.$r((t=>e.partManager.AM(t,null))),(!0===t.es()||!0===t.lh())&&this.o0(t),t.UL(!0,this),t.VL()?(t.actualBounds.isReal()&&this.C(t.Qh(t.actualBounds)),this.invalidateDocumentBounds()):t.isVisible()&&t.actualBounds.isReal()&&this.C(t.Qh(t.actualBounds)),this.requestUpdate()}se(t){t.clearAdornments(),this.partManager.se(t);const e=this;null!==t.data&&t.$r((t=>e.partManager.TM(t,e))),this.Zn.delete(t),t instanceof ve&&this.Fr.delete(t),t.VL()?(t.actualBounds.isReal()&&this.C(t.Qh(t.actualBounds)),this.invalidateDocumentBounds()):t.isVisible()&&t.actualBounds.isReal()&&this.C(t.Qh(t.actualBounds)),this.requestUpdate()}remove(t){this.DM(t,!0)}DM(t,e){const i=t.layer;if(null===i||i.diagram!==this)return;t.isSelected=!1,t.isHighlighted=!1,t.invalidateLayout(2),e&&t.qc();const n=i.se(-1,t,!1);n>=0&&this.raiseChangedEvent(4,"parts",i,t,null,n,null);const s=t.layerChanged;null!==s&&s(t,i,null)}removeParts(t,e){if(void 0===e&&(e=!1),Array.isArray(t)){const i=t.length;for(let n=0;n<i;n++){const i=t[n];e&&!i.canDelete()||this.remove(i)}}else{const i=new u;i.addAll(t);const n=i.iterator;for(;n.next();){const t=n.value;e&&!t.canDelete()||this.remove(t)}}}copyParts(t,e,i){void 0===i&&(i=!1);let n=null;const s=e||this,o=s.model;let r=!1,a=!1;try{o.km()&&(r=o.copiesParentKeyOfNodeData,o.copiesParentKeyOfNodeData=s.commandHandler.copiesParentKey),(o.bm()||o.yb())&&(a=o.copiesGroupKeyOfNodeData,o.copiesGroupKeyOfNodeData=s.commandHandler.copiesGroupKey),n=this.partManager.copyParts(t,e,i)}finally{o.km()&&(o.copiesParentKeyOfNodeData=r),(o.bm()||o.yb())&&(o.copiesGroupKeyOfNodeData=a)}return n}moveParts(t,e,i,n){if(void 0===i&&(i=!1),void 0===n&&(n=this.a0()),null===this.toolManager)return;const s=new p;if(null!==t)if(Array.isArray(t))for(let o=0;o<t.length;o++)this.Zr(s,t[o],i,n);else{const e=t.iterator;for(;e.next();)this.Zr(s,e.value,i,n)}else{let t=this.parts;for(;t.next();){const e=t.value;this.Zr(s,e,i,n)}for(t=this.nodes;t.next();){const e=t.value;this.Zr(s,e,i,n)}for(t=this.links;t.next();){const e=t.value;this.Zr(s,e,i,n)}}this.PP(s,e,n,i)}Zr(t,e,i,n,s){if(!t.has(e)&&(void 0===s&&(s=!1),!i||s||e.canMove()||e.canCopy()))if(void 0===n&&(n=this.a0()),e instanceof me){if(t.set(e,this.Xs(n,e,e.location)),e instanceof Ne&&(e.hasPlaceholder()||n.dragsMembers)){const s=e.memberParts;for(;s.next();){const e=s.value;this.Zr(t,e,i,n,n.groupsAlwaysMove)}}const s=e.linksConnected;for(;s.next();){const e=s.value;if(t.has(e))continue;const o=e.fromNode,r=e.toNode;null!==o&&t.has(o)&&null!==r&&t.has(r)&&this.Zr(t,e,i,n)}if(n.dragsTree){const s=e.findTreeChildrenNodes();for(;s.next();){const e=s.value;this.Zr(t,e,i,n)}}}else if(e instanceof ve){t.set(e,this.Xs(n,e));const s=e.labelNodes;for(;s.next();){const e=s.value;this.Zr(t,e,i,n)}}else e instanceof fe||t.set(e,this.Xs(n,e,e.location))}PP(t,i,n,s){if(null===t||0===t.count)return;const o=y.l(),r=y.l();r.a(i),isNaN(r.x)&&(r.x=0),isNaN(r.y)&&(r.y=0);const a=this.lb;a||this.YC(t);const l=e.rt(),h=e.rt(),u=t.iterator;let c=y.l();for(;u.next();){const e=u.key,i=u.value;if(e.Me()){const a=this.zL(e,t);if(null!==a)l.push(new kt(e,i,a));else if(!s||e.canMove()){const t=i.point;o.a(t),this.computeMove(e,o.add(r),n,c),e.location=c,void 0===i.shifted&&(i.shifted=new y),i.shifted.a(c.subtract(t))}}else u.key instanceof ve&&h.push(new g(u.key,u.value))}y.e(c);const d=l.length;for(let e=0;e<d;e++){const t=l[e],i=t.XL.point;o.a(i),void 0===t.wb.shifted&&(t.wb.shifted=new y),t.Le.location=o.add(t.wb.shifted)}const f=y.l(),m=y.l(),p=h.length;for(let e=0;e<p;e++){const i=h[e],s=i.key;if(s instanceof ve)if(s.suspendsRouting){s.Lr=null;const e=s.fromNode,a=s.toNode;if(null!==this.draggedLink&&n.dragsLink){const e=i.value.point;if(null===s.dragComputation){t.set(s,this.Xs(n,s,r));const i=r.x-e.x,o=r.y-e.y;s.xr(i,o)}else{const i=y.X(0,0),o=s.getPoint(0);o&&o.isReal()&&i.a(o),c=y.l().a(i).add(r);let a=c;n.isGridSnapEnabled&&(n.isGridSnapRealtime||this.lastInput.up)&&(a=y.l(),this.cS(s,c,a,n)),c.a(s.dragComputation(s,c,a)).subtract(i),t.set(s,this.Xs(n,s,c));const l=c.x-e.x,h=c.y-e.y;s.xr(l,h),y.e(i),y.e(c),a!==c&&y.e(a)}}else{if(null!==e){f.a(e.location);const i=t.get(e);null!==i&&f.subtract(i.point)}if(null!==a){m.a(a.location);const e=t.get(a);null!==e&&m.subtract(e.point)}if(null!==e&&null!==a)if(f.equalsApprox(m)){const e=i.value.point,r=o;r.a(f),r.subtract(e),t.set(s,this.Xs(n,s,f)),s.xr(r.x,r.y)}else s.suspendsRouting=!1,s.invalidateRoute();else{const o=i.value.point;let l;l=null!==e?f:null!==a?m:r,t.set(s,this.Xs(n,s,l));const h=l.x-o.x,u=l.y-o.y;s.xr(h,u)}}}else if(null===s.fromNode||null===s.toNode){const e=i.value.point;t.set(s,this.Xs(n,s,r));const o=r.x-e.x,a=r.y-e.y;s.xr(o,a)}}y.e(o),y.e(r),y.e(f),y.e(m),e.tt(l),e.tt(h),a||(this.Li(),this.wP(t))}computeMove(t,e,i,n){if(void 0===n&&(n=new y),n.a(e),null===t)return n;let s=e;const o=i.isGridSnapEnabled;o&&(i.isGridSnapRealtime||this.lastInput.up)&&(s=y.l(),this.cS(t,e,s,i));const r=null!==t.dragComputation?t.dragComputation(t,e,s):s,a=t.minLocation;let l=a.x;isNaN(l)&&(l=o?Math.round(1e3*t.location.x)/1e3:t.location.x);let h=a.y;isNaN(h)&&(h=o?Math.round(1e3*t.location.y)/1e3:t.location.y);const u=t.maxLocation;let c=u.x;isNaN(c)&&(c=o?Math.round(1e3*t.location.x)/1e3:t.location.x);let d=u.y;return isNaN(d)&&(d=o?Math.round(1e3*t.location.y)/1e3:t.location.y),n.i(Math.max(l,Math.min(r.x,c)),Math.max(h,Math.min(r.y,d))),s!==e&&y.e(s),n}a0(){const t=this.toolManager.findTool("Dragging");return t instanceof U?t.dragOptions:this.ab}cS(t,e,i,n){if(void 0===n&&(n=this.a0()),i.a(e),null===t)return i;const s=this.grid,o=n.gridSnapCellSize;let r=o.width,a=o.height;const l=n.gridSnapOrigin;let h=l.x,u=l.y;const c=n.gridSnapCellSpot;if(null!==s){const t=s.gridCellSize;isNaN(r)&&(r=t.width),isNaN(a)&&(a=t.height);const e=s.gridOrigin;isNaN(h)&&(h=e.x),isNaN(u)&&(u=e.y)}const d=y.X(0,0);return d.setSpot(0,0,r,a,c),S.Ig(e.x,e.y,h+d.x,u+d.y,r,a,i),y.e(d),i}YC(t){if(null===t)return;this.lb=!0;const e=t.iterator;for(;e.next();){const t=e.key;t instanceof ve&&(t.suspendsRouting=!0)}}wP(t){if(null===t)return;const e=t.iterator;for(;e.next();){const t=e.key;t instanceof ve&&(t.suspendsRouting=!1,t.YL()&&t.invalidateRoute())}this.lb=!1}get draggedLink(){return this.hb}set draggedLink(t){this.hb!==t&&(this.hb=t,null!==t&&(this.cb=t.fromPort,this.fb=t.toPort))}get NP(){return this.cb}set NP(t){this.cb=t}get CP(){return this.fb}set CP(t){this.fb=t}zL(t,e){const i=t.containingGroup;if(null!==i){let t=this.zL(i,e);if(null!==t||(t=e.get(i),null!==t))return t}return null}Xs(t,e,i){if(void 0===i)return new wt(y.Lo);let n=t.isGridSnapEnabled;return!t.groupsSnapMembers&&null!==e.containingGroup&&(n=!1),new wt(n?new y(Math.round(1e3*i.x)/1e3,Math.round(1e3*i.y)/1e3):i.copy())}FM(t,i){if(null!==t.diagram&&t.diagram!==this&&e.o("Cannot share a Layer with another Diagram: "+t+" of "+t.diagram),null===i?null!==t.diagram&&e.o("Cannot add an existing Layer to this Diagram again: "+t):(i.diagram!==this&&e.o("Existing Layer must be in this Diagram: "+i+" not in "+i.diagram),t===i&&e.o("Cannot move a Layer before or after itself: "+t)),t.diagram===this)return;const n=t.name,s=this.Gt,o=s.count;for(let r=0;r<o;r++)s.elt(r).name===n&&e.o("Cannot add Layer with the name '"+n+"'; a Layer with the same name is already present in this Diagram.")}addLayer(t){this.FM(t,null),t.Ro(this);const e=this.Gt;let i=e.count-1;if(!t.isTemporary)for(;i>=0&&e.elt(i).isTemporary;)i--;return e.insertAt(i+1,t),null!==this.Mi&&this.raiseChangedEvent(3,"layers",this,null,t,null,i+1),this.C(),this.invalidateDocumentBounds(),this}addLayerBefore(t,e){this.FM(t,e),t.Ro(this);const i=this.Gt,n=i.indexOf(t);n>=0&&(i.delete(t),null!==this.Mi&&this.raiseChangedEvent(4,"layers",this,t,null,n,null));const s=i.count;let o;for(o=0;o<s;o++)if(i.elt(o)===e){i.insertAt(o,t);break}return null!==this.Mi&&this.raiseChangedEvent(3,"layers",this,null,t,null,o),this.C(),n<0&&this.invalidateDocumentBounds(),this}addLayerAfter(t,e){this.FM(t,e),t.Ro(this);const i=this.Gt,n=i.indexOf(t);n>=0&&(i.delete(t),null!==this.Mi&&this.raiseChangedEvent(4,"layers",this,t,null,n,null));const s=i.count;let o;for(o=0;o<s;o++)if(i.elt(o)===e){i.insertAt(o+1,t);break}return null!==this.Mi&&this.raiseChangedEvent(3,"layers",this,null,t,null,o+1),this.C(),n<0&&this.invalidateDocumentBounds(),this}Wr(t,e){t.Ro(this),this.Gt.insertAt(e,t)}KL(t){this.Gt.removeAt(t)}removeLayer(t){if(t.diagram!==this&&e.o("Cannot remove a Layer from another Diagram: "+t+" of "+t.diagram),""===t.name)return;const i=this.Gt,n=i.indexOf(t);if(i.delete(t)){const e=t.Tt.copy().iterator;for(;e.next();){const i=e.value,n=i.layerName;n!==t.name?i.layerName=n:i.layerName=""}null!==this.Mi&&this.raiseChangedEvent(4,"layers",this,t,null,n,null),this.C(),this.invalidateDocumentBounds()}}findLayer(t){const e=this.layers;for(;e.next();){const i=e.value;if(i.name===t)return i}return null}findRouter(t){for(const e of this.Hc)if(e.name===t)return e;return null}addModelChangedListener(t){return e.S(t,bt,"addModelChangedListener:listener"),null===this.Qn&&(this.Qn=new l),this.Qn.add(t),this.model.addChangedListener(t),this}removeModelChangedListener(t){e.S(t,bt,"removeModelChangedListener:listener"),null!==this.Qn&&(this.Qn.delete(t),0===this.Qn.count&&(this.Qn=null)),this.model.removeChangedListener(t)}addChangedListener(t){return e.S(t,bt,"addChangedListener:listener"),null===this.Rr&&(this.Rr=new l),this.Rr.add(t),this}removeChangedListener(t){e.S(t,bt,"removeChangedListener:listener"),null!==this.Rr&&(this.Rr.delete(t),0===this.Rr.count&&(this.Rr=null))}RM(t){if(!this.skipsUndoManager&&!this.model.skipsUndoManager&&this.model.undoManager.handleChanged(t),1!==t.change&&(this.isModified=!0),null!==this.Rr){const e=this.Rr,i=e.length;for(let n=0;n<i;n++)e.elt(n)(t)}}raiseChangedEvent(t,e,i,n,s,o,r){void 0===o&&(o=null),void 0===r&&(r=null);const a=new R;a.diagram=this,a.change=t,a.propertyName=e,a.object=i,a.oldValue=n,a.oldParam=o,a.newValue=s,a.newParam=r,this.RM(a)}raiseChanged(t,e,i,n,s){this.raiseChangedEvent(2,t,this,e,i,n,s)}t(t,e,i,n,s){this.raiseChangedEvent(2,t,this,e,i,n,s)}get animationManager(){return this.ps}get undoManager(){return this.Mi.undoManager}get skipsUndoManager(){return this.Io}set skipsUndoManager(t){e.s(t,"boolean",bt,"skipsUndoManager"),this.Io=t,this.Mi.skipsUndoManager=t}get delaysLayout(){return this.Ex}set delaysLayout(t){this.Ex=t}vC(t,i){if(null===t||t.diagram!==this)return;const n=this.ge;try{this.ge=!0;const n=t.change;if(2===n){const e=t.object,n=t.propertyName,s=t.getValue(i);if(t.diagram.model.et(e,n,s),e instanceof At){const t=e.part;null!==t&&t.invalidateAdornments()}this.isModified=!0}else if(3===n){const n=t.object,s=t.newParam,o=t.newValue;if(n instanceof Yt)if("number"==typeof s&&o instanceof At){i?n.se(s):n.insertAt(s,o);const t=n.part;null!==t&&t.invalidateAdornments()}else"number"==typeof s&&o instanceof $t&&(o.isRow?n.GL(s,i?void 0:o):n.HL(s,i?void 0:o));else if(n instanceof gt){const e=!0===t.oldParam;"number"==typeof s&&o instanceof ce&&(i?(e||(o.isSelected=!1,o.isHighlighted=!1,o.invalidateAdornments()),n.se(e?s:-1,o,e)):n._h(s,o,e))}else n instanceof bt?"number"==typeof s&&o instanceof gt&&(i?this.KL(s):this.Wr(o,s)):e.o("unknown ChangeType.Insert object: "+t.toString());this.isModified=!0}else if(4===n){const n=t.object,s=t.oldParam,o=t.oldValue;if(n instanceof Yt)"number"==typeof s&&o instanceof At?i?n.insertAt(s,o):n.se(s):"number"==typeof s&&o instanceof $t&&(o.isRow?n.GL(s,i?o:void 0):n.HL(s,i?o:void 0));else if(n instanceof gt){const e=!0===t.newParam;"number"==typeof s&&o instanceof ce&&(i?n.Tt.indexOf(o)<0&&n._h(s,o,e):(e||(o.isSelected=!1,o.isHighlighted=!1,o.invalidateAdornments()),n.se(e?s:-1,o,e)))}else n instanceof bt?"number"==typeof s&&o instanceof gt&&(i?this.Wr(o,s):this.KL(s)):e.o("unknown ChangeType.Remove object: "+t.toString());this.isModified=!0}else 1===n||e.o("unknown ChangedEvent: "+t.toString())}finally{this.ge=n}}startTransaction(t){return this.undoManager.startTransaction(t)}commitTransaction(t){return this.undoManager.commitTransaction(t)}rollbackTransaction(){return this.undoManager.rollbackTransaction()}commit(t,e){let i=e;void 0===i&&(i="");const n=this.skipsUndoManager;null===i&&(this.skipsUndoManager=!0,i=""),this.undoManager.startTransaction(i);let s=!1;try{t(this),s=!0}finally{s?this.undoManager.commitTransaction(i):this.undoManager.rollbackTransaction(),this.skipsUndoManager=n}}updateAllTargetBindings(t){this.partManager.updateAllTargetBindings(t)}updateAllThemeBindings(){if(this.partManager.updateAllThemeBindings(),null!==this.ts){const t=this.ts.part;null!==t&&t.Uo()}}setDivBackground(t){this.div&&(this.div.style.backgroundColor=t)}updateAllRelationshipsFromData(){this.partManager.updateAllRelationshipsFromData()}gb(){const t=this.F,e=this.nt,i=this.dt;t.Ii(),1!==e&&t.nt(e),(0!==i.x||0!==i.y)&&t.Es(-i.x,-i.y)}jL(t,e){const i=this.animationManager;if(this.Jt||this.bs)return this.nt=e,this.nh(),this.C(),this.da(),i.fL(t,this.nt),void this.gb();if(null===this.mt)return this.nt=e,void this.gb();this.Jt=!0;const n=this.viewportBounds.copy(),s=this.Pt,o=this.St;let r=this.zoomPoint.x,a=this.zoomPoint.y;const l=this.contentAlignment;isNaN(r)&&(l.isSide()?l.includesSide(w.LeftSide)?r=0:l.includesSide(w.RightSide)&&(r=s-1):r=l.isSpot()?l.x*(s-1):s/2),isNaN(a)&&(l.isSide()?l.includesSide(w.TopSide)?a=0:l.includesSide(w.BottomSide)&&(a=o-1):a=l.isSpot()?l.y*(o-1):o/2),null!==this.scaleComputation&&!this.animationManager.defaultAnimation.isAnimating&&(e=this.scaleComputation(this,e)),e<this.minScale&&(e=this.minScale),e>this.maxScale&&(e=this.maxScale);const h=y.X(this.dt.x+r/t-r/e,this.dt.y+a/t-a/e);this.position=h,y.e(h),this.nt=e,this.nh(),this.Jt=!1,this.onViewportBoundsChanged(n,this.viewportBounds,t,!1),this.Ks(!1),i.fL(t,this.nt),this.C()}yR(){const t=this.Gt.r;for(let e=0;e<t.length;e++)t[e].wL()}onViewportBoundsChanged(t,e,i,n){if(t.equals(e))return;void 0===n&&(n=!1),n||this.da(),this.oh();const s=this.layout;null!==s&&s.isViewportSized&&1===this.autoScale&&(t.width!==e.width||t.height!==e.height)&&s.invalidateLayout();const o=this.currentTool;!0===this.Kc&&o instanceof j&&!this.animationManager.isTicking&&(this.lastInput.documentPoint=this.transformViewToDoc(this.lastInput.viewPoint),o.standardMouseActivity(this)),this.Jt||this.invalidateViewport(t,e),this.rh(),this.Xi.scale=i,this.Xi.position.x=t.x,this.Xi.position.y=t.y,this.Xi.bounds.a(t),this.Xi.canvasSize.width=Math.round(t.width*i),this.Xi.canvasSize.height=Math.round(t.height*i),this.Xi.newCanvasSize.width=this.Pt,this.Xi.newCanvasSize.height=this.St,this.Xi.isScroll=n,this.v("ViewportBoundsChanged",this.Xi,t),this.isVirtualized&&this.links.each((t=>{t.isAvoiding&&t.actualBounds.intersectsRect(e)&&t.invalidateRoute()}))}rh(t){const e=this.ts;if(null===e||!e.visible||null===e.part||null===e.layer)return;const i=void 0!==t?t:this.Zx;if(!i.isReal())return;const n=i.width,s=i.height;if(e.scale=1,e.angle=0,e.layer.isViewportAligned)e.width=n*this.scale,e.height=s*this.scale,e.part.alignment=w.TopLeft;else{null===e.bi&&(e.bi=new Ht);const t=e.bi.Wc;if(!t.isReal())return;e.width=n+2*t.width,e.height=s+2*t.height;const o=y.l();S.Ig(i.x,i.y,0,0,t.width,t.height,o),o.offset(-t.width,-t.height),e.part.location=o,y.e(o)}}clearSelection(t){void 0===t&&(t=!1);const e=this.selection;if(0===e.count)return;t||this.v("ChangingSelection",e);const i=e.toArray(),n=i.length;for(let s=0;s<n;s++){i[s].isSelected=!1}e.At(),e.clear(),e.u(),t||this.v("ChangedSelection",e)}select(t){null!==t&&t.diagram===this&&(!t.isSelected||this.selection.count>1)&&(this.v("ChangingSelection",this.selection),this.clearSelection(!0),t.isSelected=!0,this.v("ChangedSelection",this.selection))}selectCollection(t){if(this.v("ChangingSelection",this.selection),this.clearSelection(!0),Array.isArray(t)){const i=t.length;for(let n=0;n<i;n++){const i=t[n];i instanceof ce||e.o("Diagram.selectCollection given something that is not a Part: "+i),i.isSelected=!0}}else{const i=t.iterator;for(;i.next();){const t=i.value;t instanceof ce||e.o("Diagram.selectCollection given something that is not a Part: "+t),t.isSelected=!0}}this.v("ChangedSelection",this.selection)}clearHighlighteds(){const t=this.highlighteds;if(t.count>0){const e=t.toArray(),i=e.length;for(let t=0;t<i;t++){e[t].isHighlighted=!1}t.At(),t.clear(),t.u()}}highlight(t){null!==t&&t.diagram===this&&(!t.isHighlighted||this.highlighteds.count>1)&&(this.clearHighlighteds(),t.isHighlighted=!0)}highlightCollection(t){const i=(new u).addAll(t),n=this.highlighteds.copy().removeAll(i).iterator;for(;n.next();){n.value.isHighlighted=!1}const s=i.iterator;for(;s.next();){const t=s.value;t instanceof ce||e.o("Diagram.highlightCollection given something that is not a Part: "+t),t.isHighlighted=!0}}scroll(t,i,n){void 0===n&&(n=1);const s="up"===i||"down"===i;let o=0;const r=y.l();if("pixel"===t)o=n;else if("line"===t)o=n*(s?this.scrollVerticalLineChange:this.scrollHorizontalLineChange);else if("page"===t){let t=s?this.viewportBounds.height:this.viewportBounds.width;if(t*=this.scale,0!==t){o=n*Math.max(t-(s?this.scrollVerticalLineChange:this.scrollHorizontalLineChange),0)}}else{if("document"===t){const t=this.documentBounds,e=this.viewportBounds;return"up"===i?this.position=r.i(e.x,t.y):"left"===i?this.position=r.i(t.x,e.y):"down"===i?this.position=r.i(e.x,t.bottom-e.height):"right"===i&&(this.position=r.i(t.right-e.width,e.y)),void y.e(r)}e.o("scrolling unit must be 'pixel', 'line', 'page', or 'document', not: "+t)}o/=this.scale;const a=this.position;"up"===i?this.position=r.i(a.x,a.y-o):"down"===i?this.position=r.i(a.x,a.y+o):"left"===i?this.position=r.i(a.x-o,a.y):"right"===i?this.position=r.i(a.x+o,a.y):e.o("scrolling direction must be 'up', 'down', 'left', or 'right', not: "+i),y.e(r)}scrollToRect(t){const e=this.viewportBounds;if(e.containsRect(t))return;const i=t.center;i.x-=e.width/2,i.y-=e.height/2,this.position=i}centerRect(t){const e=this.viewportBounds,i=t.center;i.x-=e.width/2,i.y-=e.height/2,this.position=i}transformDocToView(t){return t.copy().F(this.F)}transformViewToDoc(t){return t.copy().Be(this.F)}KF(t){return t.Be(this.F)}static None=1;static Uniform=2;static UniformToFill=3;static CycleAll=1;static CycleNotDirected=2;static CycleNotDirectedFast=3;static CycleNotUndirected=4;static CycleDestinationTree=5;static CycleSourceTree=6;static DocumentScroll=1;static InfiniteScroll=2;static TreeParentCollapsed=1;static AllParentsCollapsed=2;static AnyParentsCollapsed=3;get opacity(){return this._t}set opacity(t){const i=this._t;i!==t&&(e.s(t,"number",bt,"opacity"),(t<0||t>1)&&e._(t,"0 <= value <= 1",bt,"opacity"),this._t=t,this.t("opacity",i,t),this.C())}get validCycle(){return this.Dx}set validCycle(t){const e=this.Dx;e!==t&&(this.Dx=t,this.t("validCycle",e,t))}get layers(){return this.Gt.iterator}get isModelReadOnly(){const t=this.Mi;return null!==t&&t.isReadOnly}set isModelReadOnly(t){const e=this.Mi;null!==e&&(e.isReadOnly=t)}get isReadOnly(){return this.Eo}set isReadOnly(t){const i=this.Eo;i!==t&&(e.s(t,"boolean",bt,"isReadOnly"),this.Eo=t,this.t("isReadOnly",i,t))}get isEnabled(){return this.Bi}set isEnabled(t){const i=this.Bi;i!==t&&(e.s(t,"boolean",bt,"isEnabled"),this.Bi=t,this.t("isEnabled",i,t))}get allowClipboard(){return this.Bx}set allowClipboard(t){const i=this.Bx;i!==t&&(e.s(t,"boolean",bt,"allowClipboard"),this.Bx=t,this.t("allowClipboard",i,t))}get allowCopy(){return this.Ul}set allowCopy(t){const i=this.Ul;i!==t&&(e.s(t,"boolean",bt,"allowCopy"),this.Ul=t,this.t("allowCopy",i,t))}get allowDelete(){return this.Vl}set allowDelete(t){const i=this.Vl;i!==t&&(e.s(t,"boolean",bt,"allowDelete"),this.Vl=t,this.t("allowDelete",i,t))}get allowDragOut(){return this.Ux}set allowDragOut(t){const i=this.Ux;i!==t&&(e.s(t,"boolean",bt,"allowDragOut"),this.Ux=t,this.t("allowDragOut",i,t))}get allowDrop(){return this.Vx}set allowDrop(t){const i=this.Vx;i!==t&&(e.s(t,"boolean",bt,"allowDrop"),this.Vx=t,this.t("allowDrop",i,t))}get allowTextEdit(){return this.zl}set allowTextEdit(t){const i=this.zl;i!==t&&(e.s(t,"boolean",bt,"allowTextEdit"),this.zl=t,this.t("allowTextEdit",i,t))}get allowGroup(){return this.Xl}set allowGroup(t){const i=this.Xl;i!==t&&(e.s(t,"boolean",bt,"allowGroup"),this.Xl=t,this.t("allowGroup",i,t))}get allowUngroup(){return this.Yl}set allowUngroup(t){const i=this.Yl;i!==t&&(e.s(t,"boolean",bt,"allowUngroup"),this.Yl=t,this.t("allowUngroup",i,t))}get allowInsert(){return this.zx}set allowInsert(t){const i=this.zx;i!==t&&(e.s(t,"boolean",bt,"allowInsert"),this.zx=t,this.t("allowInsert",i,t))}get allowLink(){return this.Kl}set allowLink(t){const i=this.Kl;i!==t&&(e.s(t,"boolean",bt,"allowLink"),this.Kl=t,this.t("allowLink",i,t))}get allowRelink(){return this.Gl}set allowRelink(t){const i=this.Gl;i!==t&&(e.s(t,"boolean",bt,"allowRelink"),this.Gl=t,this.t("allowRelink",i,t))}get allowMove(){return this.Hl}set allowMove(t){const i=this.Hl;i!==t&&(e.s(t,"boolean",bt,"allowMove"),this.Hl=t,this.t("allowMove",i,t))}get allowReshape(){return this.jl}set allowReshape(t){const i=this.jl;i!==t&&(e.s(t,"boolean",bt,"allowReshape"),this.jl=t,this.t("allowReshape",i,t))}get allowResize(){return this.ql}set allowResize(t){const i=this.ql;i!==t&&(e.s(t,"boolean",bt,"allowResize"),this.ql=t,this.t("allowResize",i,t))}get allowRotate(){return this.Wl}set allowRotate(t){const i=this.Wl;i!==t&&(e.s(t,"boolean",bt,"allowRotate"),this.Wl=t,this.t("allowRotate",i,t))}get allowSelect(){return this.Jl}set allowSelect(t){const i=this.Jl;i!==t&&(e.s(t,"boolean",bt,"allowSelect"),this.Jl=t,this.t("allowSelect",i,t))}get allowUndo(){return this.Xx}set allowUndo(t){const i=this.Xx;i!==t&&(e.s(t,"boolean",bt,"allowUndo"),this.Xx=t,this.t("allowUndo",i,t))}get allowZoom(){return this.Yx}set allowZoom(t){const i=this.Yx;i!==t&&(e.s(t,"boolean",bt,"allowZoom"),this.Yx=t,this.t("allowZoom",i,t))}get hasVerticalScrollbar(){return this.Uu}set hasVerticalScrollbar(t){const i=this.Uu;i!==t&&(e.s(t,"boolean",bt,"hasVerticalScrollbar"),this.Uu=t,this.da(),this.C(),this.t("hasVerticalScrollbar",i,t),this.Ks(!1))}get hasHorizontalScrollbar(){return this.Bu}set hasHorizontalScrollbar(t){const i=this.Bu;i!==t&&(e.s(t,"boolean",bt,"hasHorizontalScrollbar"),this.Bu=t,this.da(),this.C(),this.t("hasHorizontalScrollbar",i,t),this.Ks(!1))}get allowHorizontalScroll(){return this.Kx}set allowHorizontalScroll(t){const i=this.Kx;i!==t&&(e.s(t,"boolean",bt,"allowHorizontalScroll"),this.Kx=t,this.t("allowHorizontalScroll",i,t),this.Ks(!1))}get allowVerticalScroll(){return this.Gx}set allowVerticalScroll(t){const i=this.Gx;i!==t&&(e.s(t,"boolean",bt,"allowVerticalScroll"),this.Gx=t,this.t("allowVerticalScroll",i,t),this.Ks(!1))}get scrollHorizontalLineChange(){return this.Hx}set scrollHorizontalLineChange(t){const i=this.Hx;i!==t&&(e.s(t,"number",bt,"scrollHorizontalLineChange"),t<0&&e._(t,">= 0",bt,"scrollHorizontalLineChange"),this.Hx=t,this.t("scrollHorizontalLineChange",i,t))}get scrollVerticalLineChange(){return this.jx}set scrollVerticalLineChange(t){const i=this.jx;i!==t&&(e.s(t,"number",bt,"scrollVerticalLineChange"),t<0&&e._(t,">= 0",bt,"scrollVerticalLineChange"),this.jx=t,this.t("scrollVerticalLineChange",i,t))}get lastInput(){return this.sa}set lastInput(t){this.sa=t}get previousInput(){return this.Hr}set previousInput(t){this.Hr=t}get firstInput(){return this.Wm}set firstInput(t){this.Wm=t}get currentCursor(){return this.Fx}set currentCursor(t){if(""===t&&(t=this.Ym),this.Fx!==t){e.s(t,"string",bt,"currentCursor");const i=this.mt,n=this.Ct;if(null===i||null===n)return;this.Fx=t;const s=i.style.cursor;i.style.cursor=t,n.style.cursor=t,i.style.cursor===s&&(i.style.cursor="-webkit-"+t,n.style.cursor="-webkit-"+t,i.style.cursor===s&&(i.style.cursor="-moz-"+t,n.style.cursor="-moz-"+t,i.style.cursor===s&&(i.style.cursor=t,n.style.cursor=t)))}}get defaultCursor(){return this.Ym}set defaultCursor(t){""===t&&(t="auto");const i=this.Ym;i!==t&&(e.s(t,"string",bt,"defaultCursor"),this.Ym=t,this.t("defaultCursor",i,t))}get click(){return this.vr}set click(t){const i=this.vr;i!==t&&(null!==t&&e.S(t,bt,"click"),this.vr=t,this.t("click",i,t))}get doubleClick(){return this.Or}set doubleClick(t){const i=this.Or;i!==t&&(null!==t&&e.S(t,bt,"doubleClick"),this.Or=t,this.t("doubleClick",i,t))}get contextClick(){return this.Ir}set contextClick(t){const i=this.Ir;i!==t&&(null!==t&&e.S(t,bt,"contextClick"),this.Ir=t,this.t("contextClick",i,t))}get mouseOver(){return this.Er}set mouseOver(t){const i=this.Er;i!==t&&(null!==t&&e.S(t,bt,"mouseOver"),this.Er=t,this.t("mouseOver",i,t))}get mouseHover(){return this.Br}set mouseHover(t){const i=this.Br;i!==t&&(null!==t&&e.S(t,bt,"mouseHover"),this.Br=t,this.t("mouseHover",i,t))}get mouseHold(){return this.Ur}set mouseHold(t){const i=this.Ur;i!==t&&(null!==t&&e.S(t,bt,"mouseHold"),this.Ur=t,this.t("mouseHold",i,t))}get mouseDragOver(){return this.Rx}set mouseDragOver(t){const i=this.Rx;i!==t&&(null!==t&&e.S(t,bt,"mouseDragOver"),this.Rx=t,this.t("mouseDragOver",i,t))}get mouseDrop(){return this.Vr}set mouseDrop(t){const e=this.Vr;e!==t&&(this.Vr=t,this.t("mouseDrop",e,t))}get handlesDragDropForTopLevelParts(){return this.vx}set handlesDragDropForTopLevelParts(t){const i=this.vx;i!==t&&(e.s(t,"boolean",bt,"handlesDragDropForTopLevelParts"),this.vx=t,this.t("handlesDragDropForTopLevelParts",i,t))}get mouseEnter(){return this.zr}set mouseEnter(t){const i=this.zr;i!==t&&(null!==t&&e.S(t,bt,"mouseEnter"),this.zr=t,this.t("mouseEnter",i,t))}get mouseLeave(){return this.Xr}set mouseLeave(t){const i=this.Xr;i!==t&&(null!==t&&e.S(t,bt,"mouseLeave"),this.Xr=t,this.t("mouseLeave",i,t))}get toolTip(){return this.Yr}set toolTip(t){const e=this.Yr;e!==t&&(this.Yr=t,this.t("toolTip",e,t))}get contextMenu(){return this.Kr}set contextMenu(t){const e=this.Kr;e!==t&&(this.Kr=t,this.t("contextMenu",e,t))}get commandHandler(){return this.$S}set commandHandler(t){this.$S!==t&&(this.$S=t,t.Ro(this))}get toolManager(){return this.qS}set toolManager(t){this.qS!==t&&(this.qS=t,t.diagram=this)}get defaultTool(){return this.WS}set defaultTool(t){const e=this.WS;e!==t&&(this.WS=t,t.diagram=this,this.currentTool===e&&(this.currentTool=t))}get currentTool(){return this.JS}set currentTool(t){const e=this.JS;e&&(e.isActive&&e.doDeactivate(),e.cancelWaitAfter(),e.doStop()),null===t&&(t=this.defaultTool),null!==t&&(this.JS=t,t.diagram=this,t.doStart())}get selection(){return this.sM}get maxSelectionCount(){return this.$x}set maxSelectionCount(t){const i=this.$x;if(i!==t)if(e.s(t,"number",bt,"maxSelectionCount"),t>=0&&!isNaN(t)){if(this.$x=t,this.t("maxSelectionCount",i,t),!this.undoManager.isUndoingRedoing){const e=this.selection.count-t;if(e>0){this.v("ChangingSelection",this.selection);const t=this.selection.toArray();for(let i=0;i<e;i++)t[i].isSelected=!1;this.v("ChangedSelection",this.selection)}}}else e._(t,">= 0",bt,"maxSelectionCount")}get nodeSelectionAdornmentTemplate(){return this.jm}set nodeSelectionAdornmentTemplate(t){const e=this.jm;e!==t&&(this.jm=t.zt(),this.t("nodeSelectionAdornmentTemplate",e,t))}get groupSelectionAdornmentTemplate(){return this._x}set groupSelectionAdornmentTemplate(t){const e=this._x;e!==t&&(this._x=t.zt(),this.t("groupSelectionAdornmentTemplate",e,t))}get linkSelectionAdornmentTemplate(){return this.tb}set linkSelectionAdornmentTemplate(t){const e=this.tb;e!==t&&(this.tb=t.zt(),this.t("linkSelectionAdornmentTemplate",e,t))}get highlighteds(){return this.nM}get isModified(){const t=this.undoManager;return t.isEnabled?null!==t.currentTransaction||this.Yu&&this.Vs!==t.historyIndex:this.Yu}set isModified(t){if(this.Yu!==t){e.s(t,"boolean",bt,"isModified"),this.Yu=t;const i=this.undoManager;!t&&i.isEnabled&&(this.Vs=i.historyIndex),t||this.qL()}}qL(){const t=this.isModified;this.iM!==t&&(this.iM=t,this.v("Modified"))}get model(){return this.Mi}set model(t){const i=this.Mi;if(i!==t){this.currentTool.doCancel(),i&&i.undoManager!==t.undoManager&&i.undoManager.isInTransaction&&e.o("Do not replace a Diagram.model while a transaction is in progress."),this.animationManager.stopAnimation(!0);const n=this.AL(!0);this.to=!1,this.Eu=!0,this.Vs=-2,this.Cr=!1;const s=this.Jt;this.Jt=!0,this.animationManager.Bl("Model"),i&&(null!==this.Qn&&this.Qn.each((t=>i.removeChangedListener(t))),i.removeChangedListener(this.tM)),this.Mi=t,this.partManager=this.CR(this.Mi.type),this.initializePartManager(this.partManager);for(let t=0;t<n.length;t++)this.add(n[t]);t.addChangedListener(this._S),this.partManager.vM(),t.removeChangedListener(this._S),t.addChangedListener(this.tM),null!==this.Qn&&this.Qn.each((e=>t.addChangedListener(e))),this.Jt=s,this.invalidateDocumentBounds(),this.Jt||this.C(),i&&t.undoManager.copyProperties(i.undoManager)}}get themeManager(){return this.wM}set themeManager(t){const e=this.wM;e!==t&&(e&&e.removeDiagram(this),this.wM=t,null!==t&&t.addDiagram(this))}initializePartManager(t){}static xM(t,e){bt.PL.set(t,e)}static get licenseKey(){return bt.OM.last()}static set licenseKey(t){bt.OM.add(t.replace(/\s/g,""))}static get version(){return bt.LR}static OM=(()=>new l)();static LR="3.0.19";CR(t){const e=bt.PL.get(t);return null!==e?new e:new Ie}get K(){return this.QS}set K(t){this.QS=t}get ux(){return this.xL}AR(t){if(t.model!==this.model)return;const i=t.change,n=t.propertyName;if(1!==i||"S"!==n[0]){if(this.K){this.K=!1;try{if(""===t.modelChange&&1===i){("FinishedUndo"===n||"FinishedRedo"===n)&&(this.v("ChangedSelection",this.selection),this.Li());const i=this.animationManager;"RolledBackTransaction"===n&&i.stopAnimation(),this.dL(),this.Vc=!0,this.maybeUpdate(),(0===this.undoManager.transactionLevel||1===this.undoManager.transactionLevel)&&i.LS(),"CommittedTransaction"===n&&this.undoManager.isJustDiscarded&&(this.Vs=Math.min(this.Vs,this.undoManager.historyIndex-1)),("CommittedTransaction"===n||"RolledBackTransaction"===n)&&this.undoManager.Ow&&e.ar((()=>{this.isModified=!1}),1);const s=t.isTransactionFinished;if(s&&(this.qL(),this.ux.clear(),this.animationManager.LF()),!this.Ox&&s&&this.lastInput.targetDiagram){this.Ox=!0;const t=this;e.ar((()=>{t.currentTool.standardMouseOver(),t.Ox=!1}),10)}}}finally{this.K=!0}}}else if("StartingFirstTransaction"===n){const t=this,e=this.toolManager;e.mouseDownTools.each((e=>e.diagram=t)),e.mouseMoveTools.each((e=>e.diagram=t)),e.mouseUpTools.each((e=>e.diagram=t)),this.routers.each((e=>e.diagram=t)),!this.bs&&!this.to&&(this.Vc=!0,this.Eu&&(this.Cr=!0))}else if("StartingUndo"===n||"StartingRedo"===n){const t=this.animationManager;this.skipsUndoManager||(t.defaultAnimation.isAnimating&&t.stopAnimation(),t.getBundleAnimation().isAnimating&&t.getBundleAnimation().stop()),this.v("ChangingSelection",this.selection)}else if("StartedTransaction"===n){const t=this.animationManager;t.defaultAnimation.isAnimating&&!this.skipsUndoManager&&t.stopAnimation()}}get ge(){return this.ZS}set ge(t){this.ZS=t}get kc(){return this.Ix}set kc(t){this.Ix=t}BL(t){const e=t.T.r;for(const i of e)i instanceof re&&this.IM(i)}IM(t){const e=t.element;if(null===e||!(e instanceof HTMLImageElement)||(e.ss instanceof u&&e.ss.add(this),t.TR(),!e.c0))return;const i=e.getAttribute("src")||"",n=this.ih.get(i);if(null===n){re.WL(t,e);const n=[];n.push(t),this.ih.set(i,n)}else{for(let e=0;e<n.length;e++)if(n[e]===t)return;n.push(t)}}DR(t){const e=t.T.r,i=e.length;for(let n=0;n<i;n++)this.EM(e[n])}EM(t){if(!(t instanceof re))return;const e=t.element;if(null===e||!(e instanceof HTMLImageElement)||!e.c0)return;const i=e.getAttribute("src")||"",n=this.ih.get(i);if(null!==n)for(let s=0;s<n.length;s++)if(n[s]===t)return n.splice(s,1),void(0===n.length&&(this.ih.delete(i),re.FR(e),e.ss instanceof u&&e.ss.delete(this),re.clearCache(i)))}TL(){re.clearCache(),this.ih.clear()}rebuildParts(){this.partManager.rebuildParts()}vc(t,e){this.ps.vc(t,e)}Rc(t,e){this.ps.Rc(t,e)}findPartForKey(t){return this.partManager.findPartForKey(t)}findNodeForKey(t){return this.partManager.findNodeForKey(t)}findLinkForKey(t){return this.partManager.findLinkForKey(t)}findPartForData(t){return this.partManager.findPartForData(t)}findNodeForData(t){return this.partManager.findNodeForData(t)}findLinkForData(t){return this.partManager.findLinkForData(t)}findNodesByExample(){return this.partManager.findNodesByExample(...arguments)}findLinksByExample(){return this.partManager.findLinksByExample(...arguments)}get nodeTemplate(){return this.Gr.get("")}set nodeTemplate(t){const e=this.Gr.get("");e!==t&&(this.Gr.set("",t),this.t("nodeTemplate",e,t),this.undoManager.isUndoingRedoing||this.rebuildParts())}get nodeTemplateMap(){return this.Gr}set nodeTemplateMap(t){const e=this.Gr;e!==t&&(this.Gr=t,this.t("nodeTemplateMap",e,t),this.undoManager.isUndoingRedoing||this.rebuildParts())}get groupTemplate(){return this.ea.get("")}set groupTemplate(t){const e=this.ea.get("");e!==t&&(this.ea.set("",t),this.t("groupTemplate",e,t),this.undoManager.isUndoingRedoing||this.rebuildParts())}get groupTemplateMap(){return this.ea}set groupTemplateMap(t){const e=this.ea;e!==t&&(this.ea=t,this.t("groupTemplateMap",e,t),this.undoManager.isUndoingRedoing||this.rebuildParts())}get linkTemplate(){return this._l.get("")}set linkTemplate(t){const e=this._l.get("");e!==t&&(this._l.set("",t),this.t("linkTemplate",e,t),this.undoManager.isUndoingRedoing||this.rebuildParts())}get linkTemplateMap(){return this._l}set linkTemplateMap(t){const e=this._l;e!==t&&(this._l=t,this.t("linkTemplateMap",e,t),this.undoManager.isUndoingRedoing||this.rebuildParts())}get isMouseCaptured(){return this.eM}set isMouseCaptured(e){const i=this.mt;if(null===i)return;const n=i.Rt;n instanceof SVGElement||(e?(this.lastInput.bubbles=!1,this.Ni(n,"pointermove",this.ha,!1),this.Ni(n,"pointerdown",this.sh,!1),this.Ni(n,"pointerup",this.aa,!1),this.Ni(n,"pointerout",this.ca,!1),this.Ni(n,"pointercancel",this.fa,!1),this.Xt(t,"pointermove",this.ha,!0),this.Xt(t,"pointerdown",this.sh,!0),this.Xt(t,"pointerup",this.aa,!0),this.Xt(t,"pointerout",this.ca,!0),this.Xt(t,"pointercancel",this.fa,!0),this.Ni(n,"wheel",this.la,!1),this.Xt(t,"wheel",this.la,!0),this.Xt(t,"selectstart",this.Jh,!1)):(this.Ni(t,"pointermove",this.ha,!0),this.Ni(t,"pointerdown",this.sh,!0),this.Ni(t,"pointerup",this.aa,!0),this.Ni(t,"pointerout",this.ca,!0),this.Ni(t,"pointercancel",this.fa,!0),this.Xt(n,"pointermove",this.ha,!1),this.Xt(n,"pointerdown",this.sh,!1),this.Xt(n,"pointerup",this.aa,!1),this.Xt(n,"pointerout",this.ca,!1),this.Xt(n,"pointercancel",this.fa,!1),this.Ni(t,"wheel",this.la,!0),this.Ni(t,"selectstart",this.Jh,!1),this.Xt(n,"wheel",this.la,!1)),this.eM=e)}get position(){return this.dt}set position(t){if(this.dt.equals(t))return;const e=y.l().a(this.dt),i=this.viewportBounds.copy();if(this.dt.a(t),this.animationManager.cL(e,this.dt),this.Jt||null===this.mt&&!this.zu.isReal())this.nh(),this.gb();else{this.Jt=!0;const t=this.scale,e=this.Pt/t,i=this.St/t;this.SM(this.Hm,e,i,this.Bc,!1),this.Jt=!1}if(!this.Jt){const t=this.viewportBounds;this.onViewportBoundsChanged(i,t,this.nt,!1)}y.e(e)}get initialPosition(){return this.yx}set initialPosition(t){this.yx.equals(t)||(this.yx=t.N())}get initialScale(){return this.wx}set initialScale(t){this.wx!==t&&(e.s(t,"number",bt,"initialScale"),this.wx=t)}get grid(){return null===this.ts&&(this.ts=this.FL()),this.ts}set grid(t){let i=this.ts;if(i!==t){null===i&&(this.ts=this.FL(),i=this.ts),t.type!==Yt.Grid&&e.o("Diagram.grid must be a Panel of type Panel.Grid");const n=i.panel;null!==n&&n.remove(i),this.ts=t,t.name="GRID",null!==n&&n.add(t),this.Xu=!1,this.C(),this.t("grid",i,t)}}get viewportBounds(){return this.Zx}nh(){const t=this.Zx,e=this.dt,i=this.nt;t.i(e.x,e.y,Math.max(this.Pt,0)/i,Math.max(this.St,0)/i),this.oh()}get viewSize(){return this.zu}set viewSize(t){const e=this.viewSize;if(!e.equals(t)){t=t.N(),this.zu=t;let i=0,n=0;t.isReal()?(i=t.width,n=t.height):null!==this.Ct&&(i=this.Ct.clientWidth||1,n=this.Ct.clientHeight||1),this.Pt=i,this.St=n,this.nh(),this.invalidateDocumentBounds(),this.t("viewSize",e,t),this.C()}}get fixedBounds(){return this.Px}set fixedBounds(t){const i=this.Px;i.equals(t)||((t.width===-1/0||t.height===1/0||t.height===-1/0)&&e.o("fixedBounds width/height must not be Infinity"),t=t.N(),this.Px=t,this.invalidateDocumentBounds(),this.t("fixedBounds",i,t))}get scrollMargin(){return this.ta}set scrollMargin(t){"number"==typeof t&&(t=new v(t));const e=this.ta;e.equals(t)||(t=t.N(),this.ta=t,this.t("scrollMargin",e,t),this.bu())}get scrollMode(){return this.Zh}set scrollMode(t){const e=this.Zh;e!==t&&(this.Zh=t,1===t&&this.Ks(!1),this.t("scrollMode",e,t),this.da(),this.C())}get scrollsPageOnFocus(){return this.Sx}set scrollsPageOnFocus(t){const i=this.Sx;i!==t&&(e.s(t,"boolean",bt,"scrollsPageOnFocus"),this.Sx=t,this.t("scrollsPageOnFocus",i,t))}get positionComputation(){return this.Mx}set positionComputation(t){const i=this.Mx;i!==t&&(null!==t&&e.S(t,bt,"positionComputation"),this.Mx=t,this.Ks(!1),this.t("positionComputation",i,t))}get scaleComputation(){return this.Nx}set scaleComputation(t){const i=this.Nx;i!==t&&(null!==t&&e.S(t,bt,"scaleComputation"),this.Nx=t,this.jL(this.scale,this.scale),this.t("scaleComputation",i,t))}get documentBounds(){return this.Hm}JL(t){this.na=!1;let e=this.Hm;e.equals(t)||(e=e.copy(),this.Hm.a(t),this.Ks(!1),this.v("DocumentBoundsChanged",void 0,e),this.da(),this.C())}ensureBounds(){if(this.na){const t=b.l();this.JL(this.computeBounds(t)),b.e(t)}}get isVirtualized(){return this.Qx}set isVirtualized(t){const i=this.Qx;i!==t&&(e.s(t,"boolean",bt,"isVirtualized"),this.Qx=t,this.t("isVirtualized",i,t))}get scale(){return this.nt}set scale(t){const e=this.nt;e!==t&&this.jL(e,t)}get defaultScale(){return this.Jm}set defaultScale(t){this.Jm=t}get autoScale(){return this.Zl}set autoScale(t){const e=this.Zl;e!==t&&(this.Zl=t,this.t("autoScale",e,t),1!==t&&this.Ks(!1))}get initialAutoScale(){return this.Dr}set initialAutoScale(t){const e=this.Dr;e!==t&&(this.Dr=t,this.t("initialAutoScale",e,t))}get initialViewportSpot(){return this.Lx}set initialViewportSpot(t){const i=this.Lx;i!==t&&(t.isSpot()||e.o("initialViewportSpot must be a specific Spot: "+t),this.Lx=t,this.t("initialViewportSpot",i,t))}get initialDocumentSpot(){return this.Cx}set initialDocumentSpot(t){const i=this.Cx;i!==t&&(t.isSpot()||e.o("initialViewportSpot must be a specific Spot: "+t),this.Cx=t,this.t("initialDocumentSpot",i,t))}get minScale(){return this.xx}set minScale(t){const i=this.xx;i!==t&&(t>0?(this.xx=t,this.t("minScale",i,t),t>this.scale&&(this.scale=t)):e._(t,"> 0",bt,"minScale"))}get maxScale(){return this.bx}set maxScale(t){const i=this.bx;i!==t&&(t>0?(this.bx=t,this.t("maxScale",i,t),t<this.scale&&(this.scale=t)):e._(t,"> 0",bt,"maxScale"))}get zoomPoint(){return this.kx}set zoomPoint(t){this.kx.equals(t)||(t=t.N(),this.kx=t)}get contentAlignment(){return this.Bc}set contentAlignment(t){const e=this.Bc;e.equals(t)||(t=t.N(),this.Bc=t,this.t("contentAlignment",e,t),this.Ks(!1))}get initialContentAlignment(){return this.Vm}set initialContentAlignment(t){const e=this.Vm;e.equals(t)||(t=t.N(),this.Vm=t,this.t("initialContentAlignment",e,t))}get padding(){return this.ti}set padding(t){"number"==typeof t&&(t=new v(t));const e=this.ti;e.equals(t)||(t=t.N(),this.ti=t,this.invalidateDocumentBounds(),this.t("padding",e,t))}get partManager(){return this.aM}set partManager(t){const i=this.aM;i!==t&&(null!==t.diagram&&e.o("Cannot share PartManagers between Diagrams: "+t.toString()),i&&i.Ro(null),this.aM=t,t.Ro(this))}get nodes(){return this.partManager.nodes.iterator}get links(){return this.partManager.links.iterator}get parts(){return this.partManager.parts.iterator}findTopLevelNodesAndLinks(){const t=new u,e=this.nodes;for(;e.next();){const i=e.value;i.isTopLevel&&t.add(i)}const i=this.links;for(;i.next();){const e=i.value;e.isTopLevel&&t.add(e)}return t.iterator}findTopLevelGroups(){return this.qr.iterator}get routers(){return this.Hc}doLinkRouting(t){this.Oo=!0;const e=this.Hc.r;for(let i=0;i<e.length;i++)e[i].canRoute(t)&&e[i].routeLinks(this.Fr,t);this.Oo=!1}get layout(){return this.ne}set layout(t){const e=this.ne;e!==t&&(this.ne=t,t.diagram=this,t.group=null,this.jr=!0,this.t("layout",e,t),this.requestUpdate())}layoutDiagram(t){this.Li(),t&&this.xb(!0),this.bs?this.CM(!1,this.Cl||0!==this.Hc.count&&0!==this.Zn.size):(this.Vc=!0,this.br())}xb(t){const e=this.qr.iterator;for(;e.next();)this.$L(e.value,t);this.layout&&(t?this.layout.isValidLayout=!1:this.layout.invalidateLayout())}$L(t,e){if(null===t)return;const i=t.ga.iterator;for(;i.next();){const t=i.value;this.$L(t,e)}null!==t.layout&&(e?t.layout.isValidLayout=!1:t.layout.invalidateLayout())}CM(t,e){if(this.Ex)return;const i=this.K;this.K=!0;const n="Layout",s=this.undoManager.transactionLevel,o=this.layout,r=this.animationManager;try{0===s&&(this.undoManager.Ml=!0,this.startTransaction(n)),s<=1&&!r.defaultAnimation.isAnimating&&!r.xi&&(t||r.Bl(n)),this.jr=!1;let i=this.qr.iterator;for(;i.next();)this.ZL(i.value,t,s,e);let a=!1;if(o.isValidLayout||(!t||o.isRealtime||null===o.isRealtime||0===s?(o.doLayout(this),this.r0(this),a=!0,o.isValidLayout=!0):this.jr=!0),a||this.r0(this),this.doLinkRouting(this),this.Fr.clear(),0!==this.ia.size){for(let t=0;t<23&&0!==this.ia.size;t++){for(i=this.qr.iterator;i.next();)this.QL(i.value);const t=this.Fr;this.Fr=this.ia,this.ia=t,this.r0(this),this.doLinkRouting(this)}this.Fr.clear(),this.ia.clear()}}finally{const t=this.undoManager.Ml;0===s&&(this.commitTransaction(n),this.undoManager.Ml=!1),t&&(0===s||1===s)&&r.LS(),this.jr&&(this.jr=!o.isValidLayout),this.K=i}}ZL(t,e,i,n){const s=t.ga.iterator;for(;s.next();)this.ZL(s.value,e,i,n);const o=t.layout;null===o||o.isValidLayout?n&&this.doLinkRouting(t):!e||o.isRealtime||0===i?(t.ma=!t.location.isReal(),o.doLayout(t),t.invalidateLayout(32),this.mb(t),this.r0(t),this.doLinkRouting(t),o.isValidLayout=!0):(this.doLinkRouting(t),this.jr=!0)}QL(t){const e=t.ga.iterator;for(;e.next();)this.QL(e.value);this.r0(t),this.doLinkRouting(t)}get isTreePathToChildren(){return this.Ax}set isTreePathToChildren(t){const i=this.Ax;if(i!==t&&(e.s(t,"boolean",bt,"isTreePathToChildren"),this.Ax=t,this.t("isTreePathToChildren",i,t),!this.undoManager.isUndoingRedoing)){const t=this.nodes;for(;t.next();)t.value.f0()}}findTreeRoots(){const t=new l,e=this.nodes;for(;e.next();){const i=e.value;i.isTopLevel&&null===i.findTreeParentLink()&&t.add(i)}return t.iterator}get treeCollapsePolicy(){return this.Tx}set treeCollapsePolicy(t){const i=this.Tx;i!==t&&(1!==t&&2!==t&&3!==t&&e.o("Unknown Diagram.treeCollapsePolicy: "+t),this.Tx=t,this.t("treeCollapsePolicy",i,t))}get isCollapsingExpanding(){return this.jS}set isCollapsingExpanding(t){this.jS=t}_F(){const t=new p,e=new p;function i(i){const n=i.toLowerCase(),s=new l;t.set(i,s),t.set(n,s),e.set(i,i),e.set(n,i)}i("InitialAnimationStarting"),i("AnimationStarting"),i("AnimationFinished"),i("BackgroundSingleClicked"),i("BackgroundDoubleClicked"),i("BackgroundContextClicked"),i("ClipboardChanged"),i("ClipboardPasted"),i("DocumentBoundsChanged"),i("ExternalObjectsDropped"),i("GainedFocus"),i("InitialLayoutCompleted"),i("LayoutCompleted"),i("LinkDrawn"),i("LinkRelinked"),i("LinkReshaped"),i("LostFocus"),i("Modified"),i("ObjectSingleClicked"),i("ObjectDoubleClicked"),i("ObjectContextClicked"),i("PartCreated"),i("PartResized"),i("PartRotated"),i("SelectionMoved"),i("SelectionCopied"),i("SelectionDeleting"),i("SelectionDeleted"),i("SelectionGrouped"),i("SelectionUngrouped"),i("ChangingSelection"),i("ChangedSelection"),i("SubGraphCollapsed"),i("SubGraphExpanded"),i("TextEdited"),i("ThemeChanged"),i("TreeCollapsed"),i("TreeExpanded"),i("ViewportBoundsChanged"),i("InvalidateDraw"),this.GS=t,this.HS=e}EL(t){const e=this.HS.get(t);return null!==e?e:this.HS.get(t.toLowerCase())}BM(t){let i=this.GS.get(t);if(null!==i)return i;const n=t.toLowerCase();if(i=this.GS.get(n),null!==i)return i;e.o("Unknown DiagramEvent name: "+t)}addDiagramListener(t,i){e.s(t,"string",bt,"addDiagramListener:name"),e.S(i,bt,"addDiagramListener:listener");const n=this.BM(t);return null!==n&&n.add(i),this}removeDiagramListener(t,i){e.s(t,"string",bt,"removeDiagramListener:name"),e.S(i,bt,"addDiagramListener:listener");const n=this.BM(t);null!==n&&n.delete(i)}raiseDiagramEvent(t,e,i){this.v(t,e,i)}v(t,e,i){const n=this.BM(t),s=new F;s.diagram=this;const o=this.EL(t);null!==o&&(s.name=o),void 0!==e&&(s.subject=e),void 0!==i&&(s.parameter=i);const r=n.length;if(1===r)n.elt(0)(s);else if(0!==r){const t=n.toArray();for(let e=0;e<r;e++){(0,t[e])(s)}}}isUnoccupied(t,e){return this.getPositions(!1,null,e||null).isUnoccupied(t.x,t.y,t.width,t.height)}computeOccupiedArea(t){return this.isVirtualized?this.viewportBounds.copy():this.na?this.vL(t):t.a(this.documentBounds)}getPositions(t,e,i){let n=this.Ql;null===n&&(this.Ql=n=new ke(this.avoidanceCellSize));let s=e;if(n.Vo||n.pa!==s||n.UM!==i){if(n.VM=Math.max(n.Jc+1,Math.floor(this.avoidanceLimit/this.avoidanceCellSize.width)),n.zM=Math.max(n.Jc+1,Math.floor(this.avoidanceLimit/this.avoidanceCellSize.height)),null!==s&&(s=this._L(s)),null===s){const t=b.l();this.computeOccupiedArea(t),t.inflate(100,100),n.bb(t);const e=this.nodes;for(;e.next();){const n=e.value,s=n.layer;null===s||!s.visible||s.isTemporary||this.XM(n,i,t)}b.e(t)}else{if(s.memberParts.count>0){const t=this.computePartsBounds(s.memberParts,!1);t.inflate(20,20),n.bb(t)}const t=b.l(),e=s.memberParts;for(;e.next();){const n=e.value;n instanceof me&&this.XM(n,i,t)}b.e(t)}n.pa=s,n.UM=i,n.Vo=!1}else t&&n.tA();return n}get avoidanceCellSize(){return this.oM}set avoidanceCellSize(t){this.Ql=null,this.oM=new x(Math.max(1,t.width),Math.max(1,t.height))}get avoidanceLimit(){return this.rM}set avoidanceLimit(t){this.rM=Math.max(1,t)}_L(t){return t.canAvoid()?t:null!==t.containingGroup?this._L(t.containingGroup):null}XM(t,e,i){if(t===e||!t.isVisible())return;const n=t.canAvoid();if(n){const e=t.getAvoidableRect(i);this.Ql.RR(e.x,e.y,e.width,e.height)}if(t instanceof Ne&&(!n||t.avoidableMembers)){const n=t.memberParts;for(;n.next();){const t=n.value;t instanceof me&&this.XM(t,e,i)}}}YM(t){null!==this.Ql&&!this.Ql.Vo&&(void 0===t||t.canAvoid())&&(this.Ql.Vo=!0)}get autoScrollInterval(){return this.zm}set autoScrollInterval(t){const e=this.zm;e!==t&&(this.zm=t,this.t("autoScrollInterval",e,t))}get autoScrollRegion(){return this.Xm}set autoScrollRegion(t){"number"==typeof t&&(t=new v(t));const e=this.Xm;e.equals(t)||(t=t.N(),this.Xm=t,this.invalidateDocumentBounds(),this.t("autoScrollRegion",e,t))}doAutoScroll(t){this.qm.a(t),this.computeAutoScrollPosition(this.qm).equalsApprox(this.position)?this.stopAutoScroll():this.iA()}iA(){if(-1!==this.Uc)return;const t=this.zm,i=this;this.Uc=e.ar((()=>{if(-1===i.Uc||(i.stopAutoScroll(),null===i.lastInput.event))return;const t=i.computeAutoScrollPosition(i.qm);if(t.equalsApprox(i.position))return;i.position=t,i.lastInput.documentPoint=i.transformViewToDoc(i.qm),i.doMouseMove(),i.na=!0;const e=b.l();i.computeBounds(e),e.unionRect(i.documentBounds),i.JL(e),b.e(e),i.ze=!0,i.maybeUpdate(),i.iA()}),t)}stopAutoScroll(){-1!==this.Uc&&(e.Og(this.Uc),this.Uc=-1)}computeAutoScrollPosition(t){let e=this.position;const i=this.Xm;if(i.top<=0&&i.left<=0&&i.right<=0&&i.bottom<=0)return e;const n=this.viewportBounds,s=this.scale,o=b.X(0,0,n.width*s,n.height*s),r=y.X(0,0);if(t.x>=o.x&&t.x<o.x+i.left&&this.allowHorizontalScroll){let e=Math.max(this.scrollHorizontalLineChange,1);e|=0,r.x-=e,t.x<o.x+i.left/2&&(r.x-=e),t.x<o.x+i.left/4&&(r.x-=4*e)}else if(t.x<=o.x+o.width&&t.x>o.x+o.width-i.right&&this.allowHorizontalScroll){let e=Math.max(this.scrollHorizontalLineChange,1);e|=0,r.x+=e,t.x>o.x+o.width-i.right/2&&(r.x+=e),t.x>o.x+o.width-i.right/4&&(r.x+=4*e)}if(t.y>=o.y&&t.y<o.y+i.top&&this.allowVerticalScroll){let e=Math.max(this.scrollVerticalLineChange,1);e|=0,r.y-=e,t.y<o.y+i.top/2&&(r.y-=e),t.y<o.y+i.top/4&&(r.y-=4*e)}else if(t.y<=o.y+o.height&&t.y>o.y+o.height-i.bottom&&this.allowVerticalScroll){let e=Math.max(this.scrollVerticalLineChange,1);e|=0,r.y+=e,t.y>o.y+o.height-i.bottom/2&&(r.y+=e),t.y>o.y+o.height-i.bottom/4&&(r.y+=4*e)}return r.equalsApprox(y.Lo)||(e=new y(e.x+r.x/s,e.y+r.y/s)),b.e(o),y.e(r),e}makeSvg(i){this.th.has("SVG")||this.addRenderer("SVG",new Rt(this,t.document));const n=new Rt(this,t.document,!0);void 0===i&&(i={});const s=this;return this.sA((function(t,i){const o=s.eA(t,"SVG",n),r=null!==o?o.svg:null;return e.ot(i)?(i(r),null):r}),i)}makeSVG(t){return this.makeSvg(t)}addRenderer(t,e){this.th.set(t,e)}removeRenderer(t){this.th.delete(t)}cacheGroupExternalLinks(t){this.yM=t,t||this.nodes.each((t=>{t instanceof Ne&&(t.u0=null)}))}sA(i,n){const s=n.callback;let o=!0;const r=this.ih.iterator;for(;r.next();)if(!r.value[0].yn){o=!1;break}if(!e.ot(s)||o)return i(n,s,this);const a=this;function l(){const e=+new Date;for(o=!0,r.reset();r.next();)if(!r.value[0].yn){o=!1;break}o||e-u>h?i(n,s,a):t.requestAnimationFrame(l)}const h=n.callbackTimeout||300,u=+new Date;return t.requestAnimationFrame((()=>l())),null}makeImage(t){return bt.isUsingDOM()?(void 0===t&&(t={}),t.returnType="Image",this.makeImageData(t)):null}makeImageData(t){return void 0===t&&(t={}),this.sA(this.vR,t)}static img="image";vR(t,i,n){const s=n.eA(t,"canvas",null);if(null===s)return null;const o=s.U.canvas;let r=null;if(null!==o){let n=t.returnType;switch(n=void 0===n?"string":n.toLowerCase(),n){case bt.img+"data":r=s.getImageData(0,0,o.width,o.height);break;case bt.img:const n=(t.document||document).createElement("img");n.src=o.toDataURL(t.type,t.details),r=n;break;case"blob":{const n=o;return e.ot(i)||(r="",e.o('Error: Diagram.makeImageData called with "returnType: toBlob", but no required "callback" function property defined.')),e.ot(n.toBlob)?(n.toBlob(i,t.type,t.details),"toBlob"):(i(null),null)}default:r=o.toDataURL(t.type,t.details)}}return e.ot(i)?(i(r),null):r}static OR=!1;eA(t,i,n){if(this.animationManager.stopAnimation(),this.maybeUpdate(),null===this.mt)return null;e.H(t)||e.o("properties argument must be an Object.");let s=!1,o=t.size||null,r=t.scale||null;void 0!==t.scale&&isNaN(t.scale)&&(r="NaN");let a=t.maxSize;void 0===t.maxSize&&(s=!0,a="SVG"===i?new x(1/0,1/0):new x(2e3,2e3));const h=t.position||null;let u=t.parts||null;Array.isArray(u)&&(u=new l(u));let c=void 0===t.padding?1:t.padding;const d=t.background||null;let f=t.omitTemporary;void 0===f&&(f=!0);const g=t.document||document,m=t.elementFinished||null;let p=t.showTemporary;void 0===p&&(p=!f);let w=t.showGrid;void 0===w&&(w=p),null!==o&&isNaN(o.width)&&isNaN(o.height)&&(o=null),"number"==typeof c?c=new v(c):c instanceof v||e.o("MakeImage padding must be a Margin or a number."),c.left=Math.max(c.left,0),c.right=Math.max(c.right,0),c.top=Math.max(c.top,0),c.bottom=Math.max(c.bottom,0),this.ii.clearContextCache(!0);const k=new Bt(null,g,void 0,!0),S=k.ci;if(!(o||r||u||h))return k.width=this.Pt+Math.ceil(c.left+c.right),k.height=this.St+Math.ceil(c.top+c.bottom),"SVG"===i?null===n?null:(n.resize(k.width,k.height,k.width,k.height),n.ya=g,n.Wu=m,this.pb(n.ci,c,new x(k.width,k.height),this.nt,this.dt,u,d,p,w),n.ci):(this.Ku=!1,this.pb(S,c,new x(k.width,k.height),this.nt,this.dt,u,d,p,w),this.Ku=!0,k.ci);const P=this.Jm,M=this.documentBounds.copy();if(M.subtractMargin(this.ti),p){const t=this.Gt.r,e=t.length;for(let i=0;i<e;i++){const e=t[i];if(!e.visible||!e.isTemporary)continue;const n=e.Tt.r,s=n.length;for(let t=0;t<s;t++){const e=n[t];if(!e.isInDocumentBounds||!e.isVisible())continue;const i=e.actualBounds;i.isReal()&&M.unionRect(i)}}}let C=new y(M.x,M.y);if(null!==u){const t=new b(0,0,0,0);let e=!0;const i=u.iterator;for(i.reset();i.next();){const n=i.value;if(!(n instanceof ce))continue;const s=n.layer;if(null!==s&&!s.visible||null!==s&&!p&&s.isTemporary||!n.isVisible())continue;const o=n.actualBounds;o.isReal()&&(e?(e=!1,t.a(o)):t.unionRect(o))}M.width=t.width,M.height=t.height,C.x=t.x,C.y=t.y}null!==h&&h.isReal()&&(C=h,r||(r=P));let N=0,T=0;null!==c&&(N=c.left+c.right,T=c.top+c.bottom);let L=0,A=0;null!==o&&(L=o.width,A=o.height,isFinite(L)&&(L=Math.max(0,L-N)),isFinite(A)&&(A=Math.max(0,A-T)));let D=0,F=0;if(null!==o&&null!==r?("NaN"===r&&(r=P),o.isReal()?(D=L,F=A):isNaN(A)?(D=L,F=M.height*r):(D=M.width*r,F=A)):null!==o?o.isReal()?(r=Math.min(L/M.width,A/M.height),D=L,F=A):isNaN(A)?(r=L/M.width,D=L,F=M.height*r):(r=A/M.height,D=M.width*r,F=A):null!==r?"NaN"===r&&a.isReal()?(r=Math.min((a.width-N)/M.width,(a.height-T)/M.height),r>P?(r=P,D=M.width,F=M.height):(D=a.width,F=a.height)):(D=M.width*r,F=M.height*r):(r=P,D=M.width,F=M.height),null!==c?(D+=N,F+=T):c=new v(0),null!==a){let t=a.width,e=a.height;"SVG"!==i&&s&&bt.OR,isNaN(t)&&(t=2e3),isNaN(e)&&(e=2e3),isFinite(t)&&(D=Math.min(D,t)),isFinite(e)&&(F=Math.min(F,e))}return k.width=Math.ceil(D),k.height=Math.ceil(F),"SVG"===i?null===n?null:(n.resize(k.width,k.height,k.width,k.height),n.ya=g,n.Wu=m,this.pb(n.ci,c,new x(Math.ceil(D),Math.ceil(F)),r,C,u,d,p,w),n.ci):(this.Ku=!1,this.pb(S,c,new x(Math.ceil(D),Math.ceil(F)),r,C,u,d,p,w),this.Ku=!0,k.ci)}static ju=null;static nA="5da73c80a36555d4038e4972187c3cae51fd22";static uw=!1;static Ek=()=>{if(void 0===bt.nA[5]&&(k.prototype._e=k.prototype.ww),!bt.isUsingDOM())return;const t=e.fs("canvas"),i=t.getContext("2d"),n=e.Rs("7ca11abfd022028846");i[n]=e.Rs("398c3597c01238");const s="7ca11abfd7330390",o=[bt.nA,e.uw+"4ae6247590da4bb21c324ba3a84e385776",k.Ek+"fb236cdfda5de14c134ba1a95a2d4c7cc6f93c1387",S.za];for(let r=1;r<5;r++)i[e.Rs(s)](e.Rs(o[r-1]),10,15*r+0);i[n]=e.Rs("39f046ebb36e4b");for(let r=1;r<5;r++)i[e.Rs(s)](e.Rs(o[r-1]),10,15*r+0);(4!==o.length||"5"!==o[0][0]||"7"!==o[3][0])&&(k.prototype._e=k.prototype.ww),bt.ju=t}}class vt{oA;rA;KM;Ae;constructor(t){if(this.oA=null,this.rA="63ad05bbe23a1786468a4c741b6d2",this.KM="@onz",this.rA===this._tk)return this.KM=!0,void(this.Ae=this.KM);this.Ae=null}IR(i,n){let s="f";const o=t[e.Rs("76a715b2f73f148a")][e.Rs("72ba13b5")]||"",r=e.Rs;if(this.Ae=!0,!bt.isUsingDOM())return;let a=bt[r("76a115b6ed251eaf4692")];if(!a){const t=o[r("76ad18b4f73e")];for(let i=o[r("73a612b6fb191d")](r("35e7"))+2;i<t;i++)s+=o[i];const e=s[r("73a612b6fb191d")](r("7da71ca0ad381e90"));return void(this.Ae=!(e>=0&&e<s[r("73a612b6fb191d")](r("35"))))}const l=bt.OM.iterator;for(;l.next();){a=l.value;const i=r(a).split(r("39e9"));if(i.length<6)return;const h=r(i[1]).split(".");if("7da71ca0"!==i[4])return;const u=r(e[r("6cae19")]).split(".");if(!(h[0]>u[0]||h[0]===u[0]&&h[1]>=u[1]))continue;const c="73a612b6fb191d",d=t[r("74a900bae4370f8b51")][r("6fbb13a1c2311e8a57")].toLowerCase(),f=d[r(c)](r("3aad1ab6e022098b4dc4")),g=r(i[2]);if(f>-1){const t=d[r(c)](g.toLowerCase()+"/");if(this.Ae=!(t>-1&&t<f),!this.Ae)return}const m=o[r("76ad18b4f73e")];for(let t=o[r(c)](r("35e7"))+2;t<m;t++)s+=o[t];let p=s[r(c)](g);if(p<0&&g!==r("7da71ca0ad381e90")&&(p=s[r(c)](r("76a715b2ef3e149757"))),p<0&&(p=s[r(c)](r("76a715b2ef3e149757"))),p<0&&(p=s[r(c)](r("2bfa41fdb3784bca12"))),p<0&&(p=o[r(c)](r("7baa19a6f76c1988428554"))),this.Ae=!(p>=0&&p<s[r(c)](r("35"))||-1===s[r(c)](r("35"))),!this.Ae||o[r(c)](r("7fb002b6ed25128b4da25b2e"))&&(this.Ae=!(o[r(c)](g)>-1),!this.Ae))return;const y=t[e.Rs("76a715b2f73f148a")][e.Rs("69ad17a1e03e")],x=y[r(c)](r("7fb002b6ed25128b4da25b2e"));if(x>-1&&(this.Ae=!(y[r(c)](g)>x),!this.Ae))return;const b=g;if("#"!==b[0])continue;const v=e.fs("div");let w=i[0].replace(/[A-Za-z]/g,"");for(;w.length<4;)w+="9";const k=w;w=w.substring(w.length-4);let S="";const P=["Header","Background","Display","Feedback"];if(S+=["gsh","gsf"][parseInt(w.substring(0,1),10)%2],S+=P[parseInt(w.substring(0,1),10)%4],v[r("79a417a0f0181a8946")]=S,t.document[r("78a712aa")]){t.document[r("78a712aa")][r("7bb806b6ed32388c4a875b")](v);const e=t.getComputedStyle(v).getPropertyValue(r("78a704b7e62456904c9b12701b6532a8")),i=t.getComputedStyle(v).getPropertyValue(r("75b817b0ea2202"));if(t.document[r("78a712aa")][r("68ad1bbcf533388c4a875b")](v),!e)continue;const n=t[r("77a902b0eb1b1e804a8a")];if(i==="0."+parseInt(k,10)%100||-1!==e.indexOf(parseInt(b[1]+b[2],16))&&-1!==e.indexOf(parseInt(b[3]+b[4],16)))return void(this.Ae=!1);if(n&&n(r("32ae19a1e0331fc94084537c067a67fa59f1386b89d006")).matches){S="."+S;for(let t=0;t<document.styleSheets.length;t++){const e=document.styleSheets[t].rules||document.styleSheets[t].cssRules;for(const t in e)if(S===e[t].selectorText)return void(this.Ae=!1)}}}else this.Ae=null,n&&(this.Ae=!1)}}ju(t){return t.ii.setTransform(t.Yi,0,0,t.Yi,0,0),t.ii.commitTransform(),null===this.Ae&&this.IR(t,!0),0<this.Ae&&this!==this.oA}}class wt{GM;HM;constructor(t){this.GM=void 0===t?new y:t,this.HM=new y}get point(){return this.GM}set point(t){this.GM=t}get shifted(){return this.HM}set shifted(t){this.HM=t}}class kt{Le;XL;wb;constructor(t,e,i){this.Le=t,this.XL=e,this.wb=i}}class St{isGridSnapEnabled;isGridSnapRealtime;gridSnapCellSize;gridSnapCellSpot;gridSnapOrigin;dragsLink;dragsTree;groupsSnapMembers;groupsAlwaysMove;dragsMembers;constructor(t){this.Ii(),t&&Object.assign(this,t)}Ii(){this.isGridSnapEnabled=!1,this.isGridSnapRealtime=!0,this.gridSnapCellSize=new x(NaN,NaN).u(),this.gridSnapCellSpot=w.TopLeft,this.gridSnapOrigin=new y(NaN,NaN).u(),this.dragsLink=!1,this.dragsTree=!1,this.groupsSnapMembers=!1,this.groupsAlwaysMove=!0,this.dragsMembers=!0}}class Pt extends bt{kb;Pb;Sb;Mb;d0;$c;Ol;jM;qM;Nb;WM;constructor(i,n){let s;return void 0===i||"string"==typeof i||t.Element&&i instanceof Element?s=i:e.H(i)&&(n=i),super(s),this.animationManager.isEnabled=!1,this.Jt=!0,this.kb=null,this.Bu=!1,this.Uu=!1,this.Pb=!0,this.Sb=!0,this.Mb=0,this.d0=!1,this.$c=null,this.setRenderingHint("drawShadows",!1),this.Ol=new ce({selectable:!0,selectionAdorned:!1,selectionObjectName:"BOXSHAPE",locationObjectName:"BOXSHAPE",resizeObjectName:"BOXSHAPE",cursor:"move"}).add(new Jt({name:"BOXSHAPE",fill:"transparent",stroke:"magenta",strokeWidth:2}).theme("stroke","overviewBox")).zt(),this.allowCopy=!1,this.allowDelete=!1,this.allowDrop=!1,this.allowSelect=!0,this.autoScrollRegion=new v(0,0,0,0),this.dt.i(0,0),this.toolManager.Qt("Dragging",new Mt,this.toolManager.mouseMoveTools),this.click=()=>{const t=this.observed;if(null===t)return;const e=t.viewportBounds,i=this.lastInput.documentPoint;t.position=new y(i.x-e.width/2,i.y-e.height/2)},this.jM=t=>{this.invalidateDocumentBounds(),this.g0()},this.qM=t=>{null!==this.observed&&(this.invalidateDocumentBounds(),this.C())},this.Nb=t=>{this.updateDelay<1?this.C():this.d0||(this.d0=!0,e.ar((()=>this.redraw()),this.updateDelay))},this.WM=t=>{null!==this.observed&&this.g0()},this.autoScale=2,this.Jt=!1,n&&Object.assign(this,n),this}setupRouters(){}computePixelRatio(){return 1}redraw(){this.d0&&this.updateDelay>=1&&(this.d0=!1,this.ER()),super.redraw()}zi(){if(null===this.Ct&&e.o("No div specified"),null===this.mt&&e.o("No canvas specified"),this.mt instanceof Rt||(this.box.YS(),!this.ze))return;const t=this.observed;if(null===t||t.animationManager.defaultAnimation.isAnimating||!t.Kh)return;this.l0();const i=this.mt,n=this.ii;if(n.clearContextCache(!0),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,i.width,i.height),this.updateDelay<1)this.hA();else if(null!==this.$c){n.drawImage(this.$c.Rt,0,0);const t=this.F;n.scale(this.Yi,this.Yi),n.transform(t.m11,t.m12,t.m21,t.m22,t.dx,t.dy),n.commitTransform()}const s=this.Gt.r,o=s.length;for(let e=0;e<o;e++)s[e].zi(n,this);this.Xc=!1,this.ze=!1}ER(){const t=this.mt,e=this.ii;if(null!==t&&null!==e){if(this.l0(),null===this.$c){const e=new Bt(null);e.width=t.width,e.height=t.height,this.$c=e}try{this.mt=this.$c,this.ii=this.mt.ci,this.ii.clearContextCache(!0),this.ii.setTransform(1,0,0,1,0,0),this.ii.clearRect(0,0,this.mt.width,this.mt.height),this.hA()}finally{this.mt=t,this.ii=e}}}hA(){const t=this.observed;if(null===t)return;const e=this.drawsTemporaryLayers,i=this.drawsGrid&&e,n=t.grid;if(i&&null!==n&&n.visible&&!isNaN(n.width)&&!isNaN(n.height)){const e=b.l().a(this.viewportBounds).unionRect(t.viewportBounds);t.rh(e),b.e(e),t.Li()}const s=this.F,o=this.ii;o.scale(this.Yi,this.Yi),o.transform(s.m11,s.m12,s.m21,s.m22,s.dx,s.dy),o.commitTransform();const r=this.viewportBounds,a=t.Gt.r,l=a.length,h=this.Gt.r;this.xs(h,h.length,this,this.viewportBounds);for(let u=0;u<l;u++)a[u].BF(o,r,this,e,i)}get observed(){return this.kb}set observed(t){const i=this.kb;if(t instanceof Pt&&e.o("Overview.observed Diagram may not be an Overview itself: "+t),i!==t){if(null!==i&&this.BR(i),this.kb=t,null!==t&&this.UR(t),this.invalidateDocumentBounds(),null===t){this.$c=null;const t=this.mt,e=this.ii;t&&e&&(e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t.width,t.height))}else this.Nb(null),this.g0(),this.C();this.t("observed",i,t)}}get box(){return this.Ol}set box(t){const e=this.Ol;e!==t&&(t.zt(),this.Ol=t,this.remove(e),this.add(this.Ol),this.g0(),this.t("box",e,t))}get drawsTemporaryLayers(){return this.Pb}set drawsTemporaryLayers(t){this.Pb!==t&&(this.Pb=t,this.redraw())}get drawsGrid(){return this.Sb}set drawsGrid(t){this.Sb!==t&&(this.Sb=t,this.redraw())}get updateDelay(){return this.Mb}set updateDelay(t){t<0&&(t=0),this.Mb!==t&&(this.Mb=t)}UR(t){null!==t&&(t.addDiagramListener("ViewportBoundsChanged",this.jM),t.addDiagramListener("DocumentBoundsChanged",this.qM),t.addDiagramListener("InvalidateDraw",this.Nb),t.addDiagramListener("AnimationFinished",this.WM),this.add(this.box))}BR(t){null!==t&&(this.remove(this.box),t.removeDiagramListener("ViewportBoundsChanged",this.jM),t.removeDiagramListener("DocumentBoundsChanged",this.qM),t.removeDiagramListener("InvalidateDraw",this.Nb),t.removeDiagramListener("AnimationFinished",this.WM))}g0(){const t=this.box,e=this.observed;if(null===e)return;this.ze=!0;const i=e.viewportBounds,n=t.selectionObject,s=x.l();s.i(i.width,i.height),n.desiredSize=s,x.e(s);const o=2/this.scale;n instanceof Jt&&(n.strokeWidth=o),t.location=new y(i.x-o/2,i.y-o/2),t.isSelected=!0}computeBounds(){const t=this.observed;if(null===t)return b.Eg;const e=t.documentBounds.copy();return e.unionRect(t.viewportBounds),e}invalidateViewport(t,e){!0!==this.ze&&(this.ze=!0,this.requestUpdate())}onViewportBoundsChanged(t,e,i,n){this.Jt||(this.oh(),this.C(),this.da(),this.invalidateDocumentBounds(),this.g0(),this.Xi.scale=i,this.Xi.position.x=t.x,this.Xi.position.y=t.y,this.Xi.bounds.a(t),this.Xi.isScroll=n,this.v("ViewportBoundsChanged",this.Xi,t))}}class Mt extends U{hh;constructor(){super(),this.hh=null}canStart(){if(!this.isEnabled)return!1;const t=this.diagram;if(null===t||!t.allowMove||!t.allowSelect)return!1;const e=t.observed;if(null===e)return!1;const i=t.lastInput;if(!i.left||t.currentTool!==this&&(!this.isBeyondDragSize()||i.isTouchEvent&&i.timestamp-t.firstInput.timestamp<this.delay))return!1;if(null===this.findDraggablePart()){const i=e.viewportBounds;this.hh=new y(i.width/2,i.height/2);const n=t.firstInput.documentPoint;e.position=new y(n.x-this.hh.x,n.y-this.hh.y)}return!0}doActivate(){this.hh=null,super.doActivate()}doUpdateCursor(t){const e=this.diagram,i=e.box;null!==i&&i.cursor&&(e.currentCursor=i.cursor)}moveParts(t,e,i){void 0===i&&(i=!1);const n=this.diagram,s=n.observed;if(null===s)return;const o=n.box;if(null===o)return;if(null===this.hh){const t=n.firstInput.documentPoint,e=o.location;this.hh=new y(t.x-e.x,t.y-e.y)}const r=n.lastInput.documentPoint;s.position=new y(r.x-this.hh.x,r.y-this.hh.y)}}class Ct{L;JM;$M;ZM;QM;_M;t2;i2;e2;ah;s2;Cb;Lb;Ab;Tb;o2;zo;l2;constructor(t){u.qi(this),this.L=bt.ym(),this.JM=!0,this.$M=!0,this.ZM=!0,this.QM=!1,this._M=!1,this.t2=!1,this.i2=!1,this.e2=null,this.ah=null,this.s2=1.05,this.Cb=NaN,this.Lb=null,this.Ab=NaN,this.Tb=b.Eg,this.o2=!1,this.zo=null,this.l2=200,t&&Object.assign(this,t)}toString(){return"CommandHandler"}get diagram(){return this.L}Ro(t){this.L=t}doKeyDown(){const t=this.diagram,i=t.lastInput,n=e.hr?i.meta:i.control,s=i.shift,o=i.alt,r=i.commandKey;!n||"Insert"!==r&&"c"!==r?n&&"x"===r||s&&"Delete"===r?this.canCutSelection()&&this.cutSelection():n&&"v"===r||s&&"Insert"===r?this.canPasteSelection()&&this.pasteSelection():n&&"y"===r||n&&s&&"z"===r||o&&s&&"Backspace"===r?this.canRedo()&&this.redo():n&&"z"===r||o&&"Backspace"===r?this.canUndo()&&this.undo():"Delete"===r||"Backspace"===r?this.canDeleteSelection()&&this.deleteSelection():n&&"a"===r?this.canSelectAll()&&this.selectAll():"Escape"===r?this.canStopCommand()&&this.stopCommand():"ArrowUp"===r?t.allowVerticalScroll&&(n?t.scroll("pixel","up"):t.scroll("line","up")):"ArrowDown"===r?t.allowVerticalScroll&&(n?t.scroll("pixel","down"):t.scroll("line","down")):"ArrowLeft"===r?t.allowHorizontalScroll&&(n?t.scroll("pixel","left"):t.scroll("line","left")):"ArrowRight"===r?t.allowHorizontalScroll&&(n?t.scroll("pixel","right"):t.scroll("line","right")):"PageUp"===r?s&&t.allowHorizontalScroll?t.scroll("page","left"):t.allowVerticalScroll&&t.scroll("page","up"):"PageDown"===r?s&&t.allowHorizontalScroll?t.scroll("page","right"):t.allowVerticalScroll&&t.scroll("page","down"):"Home"===r?n&&t.allowVerticalScroll?t.scroll("document","up"):!n&&t.allowHorizontalScroll&&t.scroll("document","left"):"End"===r?n&&t.allowVerticalScroll?t.scroll("document","down"):!n&&t.allowHorizontalScroll&&t.scroll("document","right"):"Space"===r?this.canScrollToPart()&&this.scrollToPart():"Minus"===r||"NumpadSubtract"===r?this.canDecreaseZoom()&&this.decreaseZoom():"Equal"===r||"NumpadAdd"===r?this.canIncreaseZoom()&&this.increaseZoom():n&&"Digit0"===r?this.canResetZoom()&&this.resetZoom():s&&"z"===r?this.canZoomToFit()&&this.zoomToFit():n&&!s&&"g"===r?this.canGroupSelection()&&this.groupSelection():n&&s&&"g"===r?this.canUngroupSelection()&&this.ungroupSelection():"F2"===r?this.canEditTextBlock()&&this.editTextBlock():"ContextMenu"===r||s&&"F10"===r||n&&s&&"Backslash"===r?this.canShowContextMenu()&&this.showContextMenu():i.bubbles=!0:this.canCopySelection()&&this.copySelection()}doKeyUp(){this.diagram.lastInput.bubbles=!0}stopCommand(){const t=this.diagram,e=t.currentTool;e instanceof j&&t.allowSelect&&t.clearSelection(),null!==e&&e.doCancel()}canStopCommand(){return!0}selectAll(){const t=this.diagram;t.C();try{t.currentCursor="wait",t.v("ChangingSelection",t.selection);const e=t.parts;for(;e.next();){const t=e.value;t.canSelect()&&!t.layer.isTemporary&&(t.isSelected=!0)}const i=t.nodes;for(;i.next();){const t=i.value;t.canSelect()&&!t.layer.isTemporary&&(t.isSelected=!0)}const n=t.links;for(;n.next();){const t=n.value;t.canSelect()&&!t.layer.isTemporary&&(t.isSelected=!0)}}finally{t.v("ChangedSelection",t.selection),t.currentCursor=""}}canSelectAll(){return this.diagram.allowSelect}deleteSelection(){const t=this.diagram;try{t.currentCursor="wait",t.v("ChangingSelection",t.selection),t.startTransaction("Delete"),t.v("SelectionDeleting",t.selection);const e=new u,i=t.selection.iterator;for(;i.next();){const t=i.value;ce.ch(e,t,!0,this.deletesTree?1/0:0,!!this.deletesConnectedLinks&&null,(t=>t.canDelete()))}t.removeParts(e,!0),t.v("SelectionDeleted",e)}finally{t.commitTransaction("Delete"),t.v("ChangedSelection",t.selection),t.currentCursor=""}}canDeleteSelection(){const t=this.diagram;return!(t.isReadOnly||t.isModelReadOnly||!t.allowDelete||0===t.selection.count)}copySelection(){const t=this.diagram;try{const e=new u,i=t.selection.iterator;for(;i.next();){const t=i.value;ce.ch(e,t,!0,this.copiesTree?1/0:0,this.copiesConnectedLinks,(t=>t.canCopy()))}this.copyToClipboard(e)}finally{}}canCopySelection(){const t=this.diagram;return!(!t.allowCopy||!t.allowClipboard||0===t.selection.count)}cutSelection(){this.copySelection(),this.deleteSelection()}canCutSelection(){const t=this.diagram;return!(t.isReadOnly||t.isModelReadOnly||!t.allowCopy||!t.allowDelete||!t.allowClipboard||0===t.selection.count)}copyToClipboard(t){const e=this.diagram;let i=null;if(null===t)bt.LL();else{let n=null;try{n=e.copyParts(t,null,!0)}finally{i=new l,null!==n&&i.addAll(n.iteratorValues),bt.e0=i,bt.ub=e.model.dataFormat}}e.v("ClipboardChanged",i)}pasteFromClipboard(){const t=new u,e=bt.e0;if(null===e)return t;const i=this.diagram;if(bt.ub!==i.model.dataFormat)return t;let n=null;try{n=i.copyParts(e,i,!1)}finally{if(null!==n){const e=n.iterator;for(;e.next();){const i=e.value,n=e.key;i.location.isReal()||(n.location.isReal()?i.location=n.location:!i.position.isReal()&&n.position.isReal()&&(i.position=n.position)),t.add(i)}}}return t}pasteSelection(t){void 0===t&&(t=null);const e=this.diagram;try{e.currentCursor="wait",e.v("ChangingSelection",e.selection),e.startTransaction("Paste");const i=this.pasteFromClipboard();i.count>0&&e.clearSelection(!0);const n=i.iterator;for(;n.next();){n.value.isSelected=!0}if(null!==t){const i=e.computePartsBounds(e.selection);if(i.isReal()){const n=this.computeEffectiveCollection(e.selection,e.ab);e.PP(n,new y(t.x-i.centerX,t.y-i.centerY),e.ab,!1)}}e.v("ClipboardPasted",i)}finally{e.commitTransaction("Paste"),e.v("ChangedSelection",e.selection),e.currentCursor=""}}canPasteSelection(t){const e=this.diagram;return!(e.isReadOnly||e.isModelReadOnly||!e.allowInsert||!e.allowClipboard||null===bt.e0||0===bt.e0.count||bt.ub!==e.model.dataFormat)}undo(){this.diagram.undoManager.undo()}canUndo(){const t=this.diagram;return!t.isReadOnly&&!t.isModelReadOnly&&(t.allowUndo&&t.undoManager.canUndo())}redo(){this.diagram.undoManager.redo()}canRedo(){const t=this.diagram;return!t.isReadOnly&&!t.isModelReadOnly&&(t.allowUndo&&t.undoManager.canRedo())}decreaseZoom(t){void 0===t&&(t=1/this.zoomFactor);const e=this.diagram;if(1!==e.autoScale)return;const i=e.scale*t;i<e.minScale||i>e.maxScale||(e.scale=i)}canDecreaseZoom(t){void 0===t&&(t=1/this.zoomFactor);const e=this.diagram;if(1!==e.autoScale)return!1;const i=e.scale*t;return!(i<e.minScale||i>e.maxScale)&&e.allowZoom}increaseZoom(t){void 0===t&&(t=this.zoomFactor);const e=this.diagram;if(1!==e.autoScale)return;const i=e.scale*t;i<e.minScale||i>e.maxScale||(e.scale=i)}canIncreaseZoom(t){void 0===t&&(t=this.zoomFactor);const e=this.diagram;if(1!==e.autoScale)return!1;const i=e.scale*t;return!(i<e.minScale||i>e.maxScale)&&e.allowZoom}resetZoom(t){void 0===t&&(t=this.defaultScale);const e=this.diagram;t<e.minScale||t>e.maxScale||(e.scale=t)}canResetZoom(t){void 0===t&&(t=this.defaultScale);const e=this.diagram;return!(t<e.minScale||t>e.maxScale)&&e.allowZoom}zoomToFit(){const t=this.diagram,e=t.animationManager;e.stopAnimation(),t.redraw();const i=t.position,n=t.scale;e.Bl("Zoom To Fit"),this.isZoomToFitRestoreEnabled&&n===this.Ab&&!isNaN(this.Cb)&&null!==this.Lb&&t.documentBounds.equals(this.Tb)?(t.scale=this.Cb,t.position=this.Lb,this.Ab=NaN,this.Tb=b.Eg):(this.Cb=n,this.Lb=i.copy(),t.zoomToFit(),this.Ab=t.scale,this.Tb=t.documentBounds.copy()),e.LS()}canZoomToFit(){return this.diagram.allowZoom}scrollToPart(t){void 0===t&&(t=null);const i=this.diagram;if(i.ensureBounds(),null===t){try{null!==this.zo&&(this.zo.next()?t=this.zo.value:this.zo=null)}catch{this.zo=null}null===t&&(i.highlighteds.count>0?this.zo=i.highlighteds.iterator:i.selection.count>0&&(this.zo=i.selection.iterator),null!==this.zo&&this.zo.next()&&(t=this.zo.value))}if(null!==t){const n=i.animationManager;n.Bl("Scroll To Part");const s=this.scrollToPartPause;if(s>0){const o=this.Zc(t,[t]);if(1===o.length)i.startTransaction(),i.centerRect(t.actualBounds),i.commitTransaction("Scroll To Part");else{const t=()=>{i.startTransaction();let t=o.pop();for(;o.length>0&&t instanceof me&&t.isTreeExpanded&&(!(t instanceof Ne)||t.isSubGraphExpanded);)t=o.pop();o.length>0?(t instanceof ce&&i.scrollToRect(t.actualBounds),t instanceof me&&!t.isTreeExpanded&&(t.isTreeExpanded=!0),t instanceof Ne&&!t.isSubGraphExpanded&&(t.isSubGraphExpanded=!0)):(t instanceof ce&&i.centerRect(t.actualBounds),i.removeDiagramListener("LayoutCompleted",r)),i.commitTransaction("Scroll To Part")},r=()=>{e.ar(t,(n.isEnabled?n.duration:0)+s)};i.addDiagramListener("LayoutCompleted",r),t()}}else{const e=i.position.copy();i.centerRect(t.actualBounds),e.equalsApprox(i.position)&&n.stopAnimation()}}}Zc(t,e){if(t.isVisible())return e;if(t instanceof fe){const i=t.adornedPart;null!==i&&this.Zc(i,e)}else if(t instanceof ve){const i=t.fromNode;null!==i&&this.Zc(i,e);const n=t.toNode;null!==n&&this.Zc(n,e)}else{if(t instanceof me){const i=t.labeledLink;null!==i&&this.Zc(i,e);const n=t.findTreeParentNode();null!==n&&(!n.isTreeExpanded&&!n.wasTreeExpanded&&e.push(n),this.Zc(n,e))}const i=t.containingGroup;null!==i&&(!i.isSubGraphExpanded&&!i.wasSubGraphExpanded&&e.push(i),this.Zc(i,e))}return e}canScrollToPart(t){if(void 0===t&&(t=null),null!==t&&!(t instanceof ce))return!1;const e=this.diagram;return(0!==e.selection.count||0!==e.highlighteds.count)&&(e.allowHorizontalScroll&&e.allowVerticalScroll)}collapseTree(t){void 0===t&&(t=null);const e=this.diagram,i="Collapse Tree";try{e.startTransaction(i),e.animationManager.Bl(i);const n=new l;if(null!==t&&t.isTreeExpanded)t.collapseTree(),n.add(t);else if(null===t){const t=e.selection.iterator;for(;t.next();){const e=t.value;e instanceof me&&e.isTreeExpanded&&(e.collapseTree(),n.add(e))}}e.v("TreeCollapsed",n)}finally{e.commitTransaction(i)}}canCollapseTree(t){void 0===t&&(t=null);const e=this.diagram;if(e.isReadOnly)return!1;if(null!==t){if(!(t instanceof me)||!t.isTreeExpanded)return!1;if(t.findTreeChildrenLinks().count>0)return!0}else{const t=e.selection.iterator;for(;t.next();){const e=t.value;if(e instanceof me){if(!e.isTreeExpanded)continue;if(e.findTreeChildrenLinks().count>0)return!0}}}return!1}expandTree(t){void 0===t&&(t=null);const e=this.diagram,i="Expand Tree";try{e.startTransaction(i),e.animationManager.Bl(i);const n=new l;if(null===t||t.isTreeExpanded){if(null===t){const t=e.selection.iterator;for(;t.next();){const e=t.value;e instanceof me&&(e.isTreeExpanded||(e.expandTree(),n.add(e)))}}}else t.expandTree(),n.add(t);e.v("TreeExpanded",n)}finally{e.commitTransaction(i)}}canExpandTree(t){void 0===t&&(t=null);const e=this.diagram;if(e.isReadOnly)return!1;if(null!==t){if(!(t instanceof me)||t.isTreeExpanded)return!1;if(t.findTreeChildrenLinks().count>0)return!0}else{const t=e.selection.iterator;for(;t.next();){const e=t.value;if(e instanceof me){if(e.isTreeExpanded)continue;if(e.findTreeChildrenLinks().count>0)return!0}}}return!1}groupSelection(){const t=this.diagram,i=t.model;if(!i.Qc())return;const n=this.archetypeGroupData;if(null===n)return;let s=null;try{t.currentCursor="wait",t.v("ChangingSelection",t.selection),t.startTransaction("Group");const o=new l,r=t.selection.iterator;for(;r.next();){const t=r.value;t.Me()&&t.canGroup()&&o.add(t)}const a=new l,h=o.iterator;for(;h.next();){const t=h.value;let e=!1;const i=o.iterator;for(;i.next();){const n=i.value;if(t.isMemberOf(n)){e=!0;break}}e||a.add(t)}const u=a.first();if(null!==u){let o=u.containingGroup;if(null!==o)for(;null!==o;){let t=!1;const e=a.iterator;for(;e.next();)if(!e.value.isMemberOf(o)){t=!0;break}if(!t)break;o=o.containingGroup}if(n instanceof Ne)n.zt(),s=n.copy(),null!==s&&t.add(s);else if(i.isGroupForData(n)){const o=i.copyNodeData(n);e.H(o)&&(i.addNodeData(o),s=t.findNodeForData(o))}if(null!==s){null!==o&&this.isValidMember(o,s)&&(s.containingGroup=o);const e=a.iterator;for(;e.next();){const t=e.value;this.isValidMember(s,t)&&(t.containingGroup=s)}t.clearSelection(!0),s.isSelected=!0}}t.v("SelectionGrouped",s)}finally{t.commitTransaction("Group"),t.v("ChangedSelection",t.selection),t.currentCursor=""}}canGroupSelection(){const t=this.diagram;if(t.isReadOnly||t.isModelReadOnly||!t.allowInsert||!t.allowGroup||!t.model.Qc()||null===this.archetypeGroupData)return!1;const e=t.selection.iterator;for(;e.next();){const t=e.value;if(t.Me()&&t.canGroup())return!0}return!1}h2(t){const i=e.rt();if(Array.isArray(t))t.forEach((t=>{t instanceof ve||t instanceof ce&&i.push(t)}));else{const e=t.iterator;for(;e.next();){const t=e.value;t instanceof ve||t instanceof ce&&i.push(t)}}const n=new u,s=i.length;for(let e=0;e<s;e++){const t=i[e];let o=!0;for(let e=0;e<s;e++)if(t.isMemberOf(i[e])){o=!1;break}o&&n.add(t)}return e.tt(i),n}isValidMember(t,e){if(null===e||t===e||e instanceof ve)return!1;let i;return(null===t||!(t===e||t.isMemberOf(e)||(i=t.memberValidation,null!==i&&!i(t,e))||null===t.data&&null!==e.data||null!==t.data&&null===e.data))&&(i=this.memberValidation,null===i||i(t,e))}ungroupSelection(t){void 0===t&&(t=null);const e=this.diagram,i=e.model;if(i.Qc())try{e.currentCursor="wait",e.v("ChangingSelection",e.selection),e.startTransaction("Ungroup");const n=new l;if(null!==t)n.add(t);else{const t=e.selection.iterator;for(;t.next();){const e=t.value;e instanceof Ne&&e.canUngroup()&&n.add(e)}}const s=new l;if(n.count>0){e.clearSelection(!0);const t=n.iterator;for(;t.next();){const n=t.value;n.expandSubGraph();const o=n.containingGroup,r=null!==o&&null!==o.data?i.getKeyForNodeData(o.data):void 0;s.addAll(n.memberParts);const a=s.iterator;for(;a.next();){const t=a.value;if(t.isSelected=!0,t instanceof ve)continue;const e=t.data;null!==e?i.setGroupForData(e,r):t.containingGroup=o}e.remove(n)}}e.v("SelectionUngrouped",n,s)}finally{e.commitTransaction("Ungroup"),e.v("ChangedSelection",e.selection),e.currentCursor=""}}canUngroupSelection(t){void 0===t&&(t=null);const e=this.diagram;if(e.isReadOnly||e.isModelReadOnly||!e.allowDelete||!e.allowUngroup||!e.model.Qc())return!1;if(null!==t){if(!(t instanceof Ne))return!1;if(t.canUngroup())return!0}else{const t=e.selection.iterator;for(;t.next();){const e=t.value;if(e instanceof Ne&&e.canUngroup())return!0}}return!1}addTopLevelParts(t,e){let i=!0;const n=this.h2(t).iterator;for(;n.next();){const t=n.value;null!==t.containingGroup&&(!e||this.isValidMember(null,t)?t.containingGroup=null:i=!1)}return i}collapseSubGraph(t){void 0===t&&(t=null);const e=this.diagram,i="Collapse SubGraph";try{e.startTransaction(i),e.animationManager.Bl(i);const n=new l;if(null!==t&&t.isSubGraphExpanded)t.collapseSubGraph(),n.add(t);else if(null===t){const t=e.selection.iterator;for(;t.next();){const e=t.value;e instanceof Ne&&e.isSubGraphExpanded&&(e.collapseSubGraph(),n.add(e))}}e.v("SubGraphCollapsed",n)}finally{e.commitTransaction(i)}}canCollapseSubGraph(t){void 0===t&&(t=null);const e=this.diagram;if(e.isReadOnly)return!1;if(null!==t)return!(!(t instanceof Ne)||!t.isSubGraphExpanded);{const t=e.selection.iterator;for(;t.next();){const e=t.value;if(e instanceof Ne&&e.isSubGraphExpanded)return!0}}return!1}expandSubGraph(t){void 0===t&&(t=null);const e=this.diagram,i="Expand SubGraph",n=new l;try{if(e.startTransaction(i),e.animationManager.Bl(i),null===t||t.isSubGraphExpanded){if(null===t){const t=e.selection.iterator;for(;t.next();){const e=t.value;e instanceof Ne&&(e.isSubGraphExpanded||(e.expandSubGraph(),n.add(e)))}}}else t.expandSubGraph(),n.add(t);e.v("SubGraphExpanded",n)}finally{for(const t of n)this.aA(e,t);t&&this.aA(e,t),e.commitTransaction(i)}}aA(t,e){for(const i of e.memberParts)i instanceof me&&t.Rc(i,e)}canExpandSubGraph(t){void 0===t&&(t=null);const e=this.diagram;if(e.isReadOnly)return!1;if(null!==t)return!(!(t instanceof Ne)||t.isSubGraphExpanded);{const t=e.selection.iterator;for(;t.next();){const e=t.value;if(e instanceof Ne&&!e.isSubGraphExpanded)return!0}}return!1}editTextBlock(t){void 0===t&&(t=null);const e=this.diagram,i=e.toolManager.findTool("TextEditing");if(null!==i){if(null===t){let i=null;const n=e.selection.iterator;for(;n.next();){const t=n.value;if(t.canEdit()){i=t;break}}if(null===i)return;t=i.findInVisualTree((t=>t instanceof ie&&t.editable))}null!==t&&(e.currentTool=null,i.textBlock=t,e.currentTool=i)}}canEditTextBlock(t){void 0===t&&(t=null);const e=this.diagram;if(e.isReadOnly||e.isModelReadOnly||!e.allowTextEdit||null===e.toolManager.findTool("TextEditing"))return!1;if(null!==t){if(!(t instanceof ie))return!1;const e=t.part;if(null!==e&&e.canEdit())return!0}else{const i=e.selection.iterator;for(;i.next();){const e=i.value;if(e.canEdit()&&null!==(t=e.findInVisualTree((t=>t instanceof ie&&t.editable))))return!0}}return!1}showContextMenu(t){const e=this.diagram,i=e.toolManager.findTool("ContextMenu");if(null===i)return;void 0===t&&(t=null),null===t&&(t=e.selection.count>0?e.selection.first():e);const n=i.findObjectWithContextMenu(t);if(null!==n){const t=e.lastInput;let s=null;if(n instanceof At)s=n.getDocumentPoint(w.Center);else if(!e.viewportBounds.containsPoint(t.documentPoint)){const t=e.viewportBounds;s=new y(t.x+t.width/2,t.y+t.height/2)}if(null!==s){const t=new D;t.diagram=e,t.viewPoint=e.transformDocToView(s),t.documentPoint=s,t.button=2,t.up=!0,e.lastInput=t}e.currentTool=i,i.openMenu(!1,n)}}canShowContextMenu(t){const e=this.diagram,i=e.toolManager.findTool("ContextMenu");return!(null===i||(void 0===t&&(t=null),null===t&&(t=e.selection.count>0?e.selection.first():e),null===i.findObjectWithContextMenu(t)))}get copiesClipboardData(){return this.JM}set copiesClipboardData(t){e.s(t,"boolean",Ct,"copiesClipboardData"),this.JM=t}get copiesConnectedLinks(){return this.$M}set copiesConnectedLinks(t){e.s(t,"boolean",Ct,"copiesConnectedLinks"),this.$M=t}get deletesConnectedLinks(){return this.ZM}set deletesConnectedLinks(t){e.s(t,"boolean",Ct,"deletesConnectedLinks"),this.ZM=t}get copiesTree(){return this.QM}set copiesTree(t){e.s(t,"boolean",Ct,"copiesTree"),this.QM=t}get deletesTree(){return this._M}set deletesTree(t){e.s(t,"boolean",Ct,"deletesTree"),this._M=t}get copiesParentKey(){return this.t2}set copiesParentKey(t){e.s(t,"boolean",Ct,"copiesParentKey"),this.t2=t}get copiesGroupKey(){return this.i2}set copiesGroupKey(t){e.s(t,"boolean",Ct,"copiesGroupKey"),this.i2=t}get archetypeGroupData(){return this.e2}set archetypeGroupData(t){null!==t&&e.lc(t,Ct,"archetypeGroupData");this.diagram;this.e2=t}get memberValidation(){return this.ah}set memberValidation(t){null!==t&&e.S(t,Ct,"memberValidation"),this.ah=t}get defaultScale(){return this.diagram.defaultScale}set defaultScale(t){this.diagram.defaultScale=t}get zoomFactor(){return this.s2}set zoomFactor(t){t>1||e.o("zoomFactor must be larger than 1.0, not: "+t),this.s2=t}get isZoomToFitRestoreEnabled(){return this.o2}set isZoomToFitRestoreEnabled(t){e.s(t,"boolean",Ct,"isZoomToFitRestoreEnabled"),this.o2=t}get scrollToPartPause(){return this.l2}set scrollToPartPause(t){this.l2=t}computeEffectiveCollection(t,e){const i=this.diagram,n=i.toolManager.findTool("Dragging"),s=i.currentTool===n;void 0===e&&(e=i.a0());const o=new p;if(null===t)return o;let r=t.iterator;for(;r.next();){const t=r.value;i.Zr(o,t,s,e)}if(null!==i.draggedLink&&e.dragsLink)return o;for(r=t.iterator;r.next();){const t=r.value;if(t instanceof ve){const e=t.fromNode;if(null===e||o.has(e)){const e=t.toNode;null!==e&&!o.has(e)&&o.delete(t)}else o.delete(t)}}return o}}var Nt=(t=>(t[t.None=0]="None",t[t.Default=1]="Default",t[t.Vertical=4]="Vertical",t[t.Horizontal=5]="Horizontal",t[t.Fill=2]="Fill",t))(Nt||{}),Tt=(t=>(t[t.None=0]="None",t[t.Along=21]="Along",t[t.Plus90=22]="Plus90",t[t.Minus90=23]="Minus90",t[t.Opposite=24]="Opposite",t[t.Upright=25]="Upright",t[t.Plus90Upright=26]="Plus90Upright",t[t.Minus90Upright=27]="Minus90Upright",t[t.Upright45=28]="Upright45",t))(Tt||{}),Lt=(t=>(t[t.None=0]="None",t[t.Vertical=1]="Vertical",t[t.Horizontal=2]="Horizontal",t[t.Both=3]="Both",t))(Lt||{});class At{n;m0;p0;Qr;b;fh;gt;dt;re;_t;y0;Gs;Dt;ns;_r;uh;ki;wa;nt;Ht;tl;Ai;Ki;Ju;fi;$u;Ut;ri;il;Db;dh;Zu;constructor(){u.qi(this),this.n=30723,this._t=1,this.y0="",this.Gs=null,this.Dt=null,this.dt=new y(NaN,NaN).u(),this.ns=x.mw,this._r=new k,this.uh=new k,this.ki=null,this.wa=1,this.nt=1,this.Ht=0,this.tl=v.Bg,this.re=new b(NaN,NaN,NaN,NaN).u(),this.Ai=new b(NaN,NaN,NaN,NaN).u(),this.Ki=new b(0,0,NaN,NaN).u(),this.Ju=null,this.m0=null,this.gt=null,this.fi=w.Default,this.$u=w.Default,this.p0=0,this.Qr=0,this.Ut=null,this.b=null,this.fh=null,this.ri=null,this.Db=null,this.dh=null,this.il=null,this.Zu=null}cloneProtected(t){t.n=-32769&this.n|6144,t._t=this._t,t.y0=this.y0,t.Dt=this.Dt,t.dt.a(this.dt),t.ns=this.ns.N(),null!==this.ki?t.ki=this.ki.copy():t.ki=null,t.nt=this.nt,t.Ht=this.Ht,t.tl=this.tl.N(),t.re.a(this.re),t.Ai.a(this.Ai),t.Ki.a(this.Ki),t.m0=this.m0,null!==this.gt&&(t.gt=this.gt.copy()),t.fi=this.fi.N(),t.$u=this.$u.N(),t.p0=this.p0,t.Qr=this.Qr,null!==this.Ut&&(t.Ut=this.Ut.copy()),null!==this.b&&(this.b.gi?t.b=this.b:t.b=this.b.copy()),null!==this.fh&&(t.fh=this.fh.slice()),null!==this.ri&&(t.ri=this.ri.copy())}addCopyProperty(t){let e=this.fh;if(Array.isArray(e)){for(let i=0;i<e.length;i++)if(e[i]===t)return}else e=[],this.fh=e;e.push(t)}Xo(t){t.Ju=null,t.il=null,t.c()}clone(){const t=new this.constructor;if(this.cloneProtected(t),null!==this.fh)for(let e=0;e<this.fh.length;e++){const i=this.fh[e];t[i]=this[i]}return t}copy(){return this.clone()}_P(){const t=this.Ti;if(null!==t){this.Ti=null;for(const e of t)e.Qu()&&(e.isToData?this.themeData(e.targetProperty,e.sourceProperty,e.themeSource,e.converter,e.themeConverter):e.isToObject?this.themeObject(e.targetProperty,e.sourceProperty,e.themeSource,e.converter,e.themeConverter,e.sourceName):e.isToModel?this.themeModel(e.targetProperty,e.sourceProperty,e.themeSource,e.converter,e.themeConverter):this.theme(e.targetProperty,e.sourceProperty,e.themeSource,e.converter,e.themeConverter))}return this}hi(t){t in Tt?this.segmentOrientation=t:t in Nt?this.stretch=t:e.cr(this,t)}toString(){return e.Vn(this.constructor)+"#"+u.us(this)}static None=0;static Default=1;static Fill=2;static Vertical;static Horizontal;static Uniform=6;static UniformToFill=7;static FlipVertical=1;static FlipHorizontal=2;static FlipBoth=3;gh(){null!==this.b&&(this.b.gi=!0)}qt(){return null===this.b?this.b=new Dt:this.b.gi&&(this.b=this.b.copy()),this.b}Xe(){if(null===this.gt){const t=new Me;t.xa=w.None,t.ba=w.None,t.ka=10,t.Pa=10,t.Sa=0,t.Ma=0,this.gt=t}return this.gt}raiseChangedEvent(t,e,i,n,s,o,r){const a=this.part;if(null!==a){a._c(t,e,i,n,s,o,r),i===this&&2===t&&this.tf()&&this.Na(a,e);const l=this.diagram;if(null!==this.ks&&null!==l&&l.Kh&&!l.undoManager.isUndoingRedoing&&!l.animationManager.ku){const t=this.ks.get(e);if(null!==t&&l.animationManager.isEnabled&&!l.animationManager.isTicking){null===this.Zu&&(this.Zu=new p);let i=0===l.undoManager.transactionLevel;if(2===t.startCondition?i=!0:3===t.startCondition&&(i=!1),i){const i=new ut;t.OF(i);const o=this.Zu.get(t);null!==o&&o.stop(),this.Zu.set(t,i),i.hx=this,i.OS=t,i.add(this,e,n,s),i.start()}else l.animationManager.getBundleAnimation().add(this,e,n,s)}}if(this instanceof Yt&&i===a&&a.a2()&&null!==a.data){const t=this.T.r,i=t.length;for(let n=0;n<i;n++){const i=t[n];i instanceof Yt&&i.$r((t=>{null!==t.data&&t.a2()&&t.updateTargetBindings(e)}))}}}}DF(t){this.Zu.delete(t)}Uo(){if(null!==this.diagram&&null===this.findBindingPanel()&&null!==this.Ti){const t=this.diagram.model,e=this.Ti.iterator;for(;e.next();){const i=e.value;if(!i.isToTheme)continue;let n=null;const s=i.sourceName;i.isToObject&&(n=this.cA(s));let o=this;const r=i.targetId;-1!==r&&(o=this.w0(r),null===o)||("/"===s?n=o.part:"."===s?n=o:".."===s&&(n=o.panel),i.updateTarget(o,n,void 0,t))}}}Na(t,e){const i=this.findBindingPanel();if(null!==i){const n=t.diagram,s=this.Ti.iterator;for(;s.next();){const t=s.value;let o=null;if(t.isToObject){if(o=t.fA(i,this),null===o)continue;t.updateSource(this,o,e,null)}else if(t.isToModel)null!==n&&!n.ge&&t.updateSource(this,n.model.modelData,e,i);else if(!t.isToTheme){const s=i.data;if(null===s)continue;null!==n&&!n.ge&&t.updateSource(this,s,e,i)}if(o===this){const s=t.targetId,r=i.w0(s);null!==r&&t.updateTarget(r,o,e,n?.model)}}}}w0(t){return this.io===t?this:null}cA(t){let e;return e=""===t||"/"===t||"."===t||".."===t?this:this.part.findObject(t),e}get io(){return null!==this.b?this.b.io:-1}set io(t){this.io!==t&&(null===this.b&&(this.b=new Dt),this.b.io=t)}get Ti(){return null!==this.b?this.b.Ti:null}set Ti(t){this.Ti!==t&&(null===this.b&&(this.b=new Dt),this.b.Ti=t)}get eo(){return null!==this.b?this.b.eo:null}set eo(t){this.eo!==t&&(null===this.b&&(this.b=new Dt),this.b.eo=t)}raiseChanged(t,e,i){this.raiseChangedEvent(2,t,this,e,i)}t(t,e,i){this.raiseChangedEvent(2,t,this,e,i)}so(t,e,i,n){const s=this.re;if(s.i(t,e,i,n),1!==this.nt||0!==this.Ht){null===this.ki&&(this.ki=new k);const o=this.ki;o.Ii(),this.x0(o,t,e,i,n),o.Ug(s)}}uA(t,e,i){return!1!==this.pickable&&(i.ac(this.F),e?this.intersectsRect(t,i):this.containedInRect(t,i))}dA(t,e,i){if(!1===this.pickable)return!1;const n=this.naturalBounds,s=t.distanceSquaredPoint(e);return i?y.distanceLineSegmentSquared(t.x,t.y,0,0,0,n.height)<=s||y.distanceLineSegmentSquared(t.x,t.y,0,n.height,n.width,n.height)<=s||y.distanceLineSegmentSquared(t.x,t.y,n.width,n.height,n.width,0)<=s||y.distanceLineSegmentSquared(t.x,t.y,n.width,0,0,0)<=s:t.distanceSquared(0,0)<=s&&t.distanceSquared(0,n.height)<=s&&t.distanceSquared(n.width,0)<=s&&t.distanceSquared(n.width,n.height)<=s}wn(){return!0}containsPoint(t){const e=y.l();e.a(t),this.F.xt(e);const i=this.actualBounds;if(!i.isReal())return y.e(e),!1;const n=this.diagram;if(null!==n&&n.Zm){const t=n.getInputOption("extraTouchThreshold"),s=n.getInputOption("extraTouchArea"),o=s/2,r=this.naturalBounds,a=this.getDocumentScale()*n.scale,l=1/a;if(r.width*a<t&&r.height*a<t){const t=b.contains(i.x-o*l,i.y-o*l,i.width+s*l,i.height+s*l,e.x,e.y);return y.e(e),t}}let s=!1;return(this instanceof fe||this instanceof Jt?b.contains(i.x-5,i.y-5,i.width+10,i.height+10,e.x,e.y):i.containsPoint(e))&&(s=!(this.ri&&!this.ri.containsPoint(e))&&(!(null===this.Dt||!this.Ki.containsPoint(t))||this.mh(t))),y.e(e),s}mh(t){const e=this.naturalBounds;return b.contains(0,0,e.width,e.height,t.x,t.y)}containsRect(t){if(0===this.angle)return this.actualBounds.containsRect(t);const e=this.naturalBounds,i=b.X(0,0,e.width,e.height),n=this.F;let s=!1;const o=y.X(t.x,t.y);return i.containsPoint(n._e(o))&&(o.i(t.x,t.bottom),i.containsPoint(n._e(o))&&(o.i(t.right,t.bottom),i.containsPoint(n._e(o))&&(o.i(t.right,t.y),i.containsPoint(n._e(o))&&(s=!0)))),y.e(o),b.e(i),s}containedInRect(t,e){if(void 0===e)return t.containsRect(this.actualBounds);const i=this.naturalBounds,n=e;let s=!1;const o=y.X(0,0);return t.containsPoint(n.xt(o))&&(o.i(0,i.height),t.containsPoint(n.xt(o))&&(o.i(i.width,i.height),t.containsPoint(n.xt(o))&&(o.i(i.width,0),t.containsPoint(n.xt(o))&&(s=!0)))),y.e(o),s}intersectsRect(t,e){if(void 0===e&&(e=this.F,0===this.angle))return t.intersectsRect(this.actualBounds);const i=this.naturalBounds,n=e,s=y.X(0,0),o=y.X(0,i.height),r=y.X(i.width,i.height),a=y.X(i.width,0);let l=!1;if(t.containsPoint(n.xt(s))||t.containsPoint(n.xt(o))||t.containsPoint(n.xt(r))||t.containsPoint(n.xt(a)))l=!0;else{const e=b.X(0,0,i.width,i.height),h=y.X(t.x,t.y);e.containsPoint(n._e(h))?l=!0:(h.i(t.x,t.bottom),e.containsPoint(n._e(h))?l=!0:(h.i(t.right,t.bottom),e.containsPoint(n._e(h))?l=!0:(h.i(t.right,t.y),e.containsPoint(n._e(h))&&(l=!0)))),y.e(h),b.e(e),l||(S.kw(t,s,o)||S.kw(t,o,r)||S.kw(t,r,a)||S.kw(t,a,s))&&(l=!0)}return y.e(s),y.e(o),y.e(r),y.e(a),l}getDocumentPoint(t,e){if(void 0===e&&(e=new y),t instanceof w){const i=t,n=this.naturalBounds;return e.i(i.x*n.width+i.offsetX,i.y*n.height+i.offsetY),this.Ys.xt(e),e}return e.set(t),this.Ys.xt(e),e}getDocumentBounds(t){void 0===t&&(t=new b);const e=this.naturalBounds,i=this.Ys,n=y.X(0,0).F(i);return t.i(n.x,n.y,0,0),n.i(e.width,0).F(i),t.unionNoCheck(n.x,n.y,0,0),n.i(e.width,e.height).F(i),t.unionNoCheck(n.x,n.y,0,0),n.i(0,e.height).F(i),t.unionNoCheck(n.x,n.y,0,0),y.e(n),t}getDocumentAngle(){return this.Ys.GD()}getDocumentScale(){if(!1===this.b0())return this.wa;const t=this.nt;return null!==this.panel?t*this.panel.getDocumentScale():t}getLocalPoint(t,e){return void 0===e&&(e=new y),e.a(t),this.Ys._e(e),e}getNearestIntersectionPoint(t,e,i){return this.ef(t.x,t.y,e.x,e.y,i)}ef(t,e,i,n,s){const o=this.F,r=1/(o.m11*o.m22-o.m12*o.m21),a=o.m22*r,l=-o.m12*r,h=-o.m21*r,u=o.m11*r,c=r*(o.m21*o.dy-o.m22*o.dx),d=r*(o.m12*o.dx-o.m11*o.dy),f=t*a+e*h+c,g=t*l+e*u+d,m=i*a+n*h+c,p=i*l+n*u+d;s.i(0,0);const y=this.naturalBounds,x=S.kl(0,0,y.width,y.height,f,g,m,p,s);return s.F(o),x}ut(t,i,n,s){if(!1===this.Bo())return;const o=this.tl,r=o.right+o.left,a=o.top+o.bottom;t=Math.max(t-r,0),i=Math.max(i-a,0),n=n||0,s=s||0,n=Math.max(n-r,0),s=Math.max(s-a,0);const l=this.angle;let h=0;const u=this.desiredSize,c=this.k0();90===l||270===l?(t=isFinite(u.height)?u.height+c:t,i=isFinite(u.width)?u.width+c:i):(t=isFinite(u.width)?u.width+c:t,i=isFinite(u.height)?u.height+c:i);let d=n||0,f=s||0;const g=this instanceof Yt;switch(this.Hs(!0)){case 0:d=0,f=0,g&&(t=1/0,i=1/0);break;case 2:isFinite(t)&&t>n&&(d=t),isFinite(i)&&i>s&&(f=i);break;case 5:isFinite(t)&&t>n&&(d=t),f=0,g&&(i=1/0);break;case 4:isFinite(i)&&i>s&&(f=i),d=0,g&&(t=1/0)}const m=this.maxSize,p=this.minSize;d>m.width&&p.width<m.width&&(d=m.width),f>m.height&&p.height<m.height&&(f=m.height),n=Math.max(d,p.width),s=Math.max(f,p.height),m.width<n&&(n=Math.min(p.width,n)),m.height<s&&(s=Math.min(p.height,s)),t=Math.min(m.width,t),i=Math.min(m.height,i),t=Math.max(n,t),i=Math.max(s,i),(90===l||270===l)&&(h=t,t=i,i=h,h=n,n=s,s=h),this.re.At(),this._u(t,i,n,s),this.re.u(),this.re.isReal()||e.o("Non-real measuredBounds has been set. Object "+this+", measuredBounds: "+this.re.toString()),this.me(!1)}_u(t,e,i,n){}js(){return!1}Yt(t,i,n,s,o){this.sf();const r=b.l();r.a(this.Ai),this.Ai.At(),!1===this.es()?this.Ai.i(t,i,n,s):this.ph(t,i,n,s),this.Ai.u(),this.ri=void 0===o?null:o;let a=!1;if(void 0!==o)a=!0;else{let e=this.panel;if(null!==e&&e.el()&&(e=e.panel),null!==e){const n=e.Ki,s=this.measuredBounds,o=i+s.height,r=t+s.width;if(a=!(0<=t+.05&&r<=n.width+.05&&0<=i+.05&&o<=n.height+.05),this instanceof ie){const t=this.naturalBounds;(this.P0>t.height||this.mi>t.width)&&(a=!0)}}}a?this.n|=256:this.n&=-257,this.Ai.isReal()||e.o("Non-real actualBounds has been set. Object "+this+", actualBounds: "+this.Ai.toString()),this.td(r,this.Ai),this.no(!1),b.e(r)}ph(t,e,i,n){}commonArrange(t,e,i,n){if(this.Ai.i(t,e,i,n),this.desiredSize.isReal())return;const s=this.re,o=this.tl,r=o.right+o.left,a=o.top+o.bottom,l=s.width+r,h=s.height+a;i+=r,n+=a;let u=this.Hs(!0);switch(l===i&&h===n&&(u=0),u){case 0:(l>i||h>n)&&(this.me(!0),this.ut(l>i?i:l,h>n?n:h,0,0));break;case 2:this.me(!0),this.ut(i,n,0,0);break;case 5:this.me(!0),this.ut(i,h,0,0);break;case 4:this.me(!0),this.ut(l,n,0,0)}}td(t,e){const i=this.part;null!==i&&null!==i.diagram&&((i.selectionObject===this||i.resizeObject===this||i.rotateObject===this)&&i.c2(!0),this.C(),!t.equalsApproxClose(e)&&(i.yh(),this.S0(i)))}S0(t){null!==this.portId&&(t.c2(!0),t instanceof me&&t.gA(this))}get shadowVisible(){return null!==this.b?this.b.M0:null}set shadowVisible(t){const e=this.shadowVisible;e!==t&&(this.qt().M0=t,this.Ye(!0),this.C(),this.t("shadowVisible",e,t))}VR(t,e){const i=this.naturalBounds,n=this.uh,s=n.m11,o=n.m21,r=n.dx,a=n.m12,l=n.m22,h=n.dy;let u=0,c=0,d=u,f=c;u=d*s+f*o+r,c=d*a+f*l+h;let g=u,m=c,p=0,y=0;d=i.width+e,f=0,u=d*s+f*o+r,c=d*a+f*l+h;let x=Math.min(g,u),b=Math.min(m,c);p=Math.max(g+p,u)-x,y=Math.max(m+y,c)-b,g=x,m=b,d=i.width+e,f=i.height+e,u=d*s+f*o+r,c=d*a+f*l+h,x=Math.min(g,u),b=Math.min(m,c),p=Math.max(g+p,u)-x,y=Math.max(m+y,c)-b,g=x,m=b,d=0,f=i.height+e,u=d*s+f*o+r,c=d*a+f*l+h,x=Math.min(g,u),b=Math.min(m,c),p=Math.max(g+p,u)-x,y=Math.max(m+y,c)-b,g=x,m=b;const v=t.viewportBounds,w=v.x,k=v.y,S=v.width,P=v.height;return g>S+w||w>p+g||m>P+k||k>y+m}zi(t,e){if(this.zR(t,e)||!this.visible)return;const i=this.opacity;if(0===i)return;let n=1;1!==i&&(n=t.globalAlpha,t.globalAlpha=n*i);let s="";""!==this.filter&&(s=t.filter,t.filter=this.filter);const o=this.F,r=this.panel;!0===this.b0()&&this.Fb();const a=this.part;let l=!1,h=0;if(a&&e.getRenderingHint("drawShadows")&&(l=a.isShadowed,l)){const t=a.shadowOffset;h=Math.max(t.y,t.x)*e.scale*e.Yi}const u=this instanceof Yt&&this.el(),c=this.Ai;if(u&&(this.mA(l,t,!1,r),this.XR(t,e),this.pA(l,t,!1,r),this.yA(l,t,!1)),u||!u&&(0===c.width||0===c.height||isNaN(c.x)||isNaN(c.y)))return 1!==i&&(t.globalAlpha=n),void(""!==this.filter&&(t.filter=s));const d=this.js();if(!e.oa&&d&&this.VR(e,h))return 1!==i&&(t.globalAlpha=n),void(""!==this.filter&&(t.filter=s));let f=0!==(256&this.n);if(t.clipInsteadOfFill&&(f=!1),this instanceof ie&&(t.font=this.font),f){const e=r.wn()?r.naturalBounds:r.actualBounds;let o=Math.max(c.x,e.x),a=Math.max(c.y,e.y),l=Math.min(c.right,e.right)-o,h=Math.min(c.bottom,e.bottom)-a;const u=this.ri;if(null!==u&&(o=u.x,a=u.y,l=u.width,h=u.height),o>c.width+c.x||c.x>e.width+e.x)return 1!==i&&(t.globalAlpha=n),void(""!==this.filter&&(t.filter=s));t.save(),t.beginPath(),t.rect(o,a,l,h),t.clip()}if(d){if(!a.isVisible())return 1!==i&&(t.globalAlpha=n),void(""!==this.filter&&(t.filter=s));if(l){const i=a.shadowOffset;t.shadowsSet(i.x*e.scale*this.scale*e.Yi,i.y*e.scale*this.scale*e.Yi,a.shadowBlur),t.shadowsOn(),t.shadowColor=a.shadowColor}}const g=this.naturalBounds;if(t.transform(o.m11,o.m12,o.m21,o.m22,o.dx,o.dy),this.mA(l,t,d,r),null!==this.Dt&&(t.commitTransform(),this.Rb(t,g,c)),this.pA(l,t,d,r),this.wh(t,e),this.yA(l,t,d),f&&(t.restore(),t.clearContextCache(this instanceof Yt)),!o.Ik()){const e=1/(o.m11*o.m22-o.m12*o.m21);t.transform(o.m22*e,-o.m12*e,-o.m21*e,o.m11*e,e*(o.m21*o.dy-o.m22*o.dx),e*(o.m12*o.dx-o.m11*o.dy))}1!==i&&(t.globalAlpha=n),""!==this.filter&&(t.filter=s)}mA(t,e,i,n){t&&!0===this.shadowVisible?e.shadowsOn():t&&!1===this.shadowVisible&&e.shadowsOff(),t&&this.vb(n)&&null===this.shadowVisible&&e.shadowsOff()}pA(t,e,i,n){t&&(null!==this.Dt||this.vb(n))?(this.Ob(!0),null===this.shadowVisible&&e.shadowsOff()):this.Ob(!1)}yA(t,e,i){t&&!0===this.f2()&&e.shadowsOn(),i&&t&&e.shadowsOff()}YR(t,e,i){const n=this.part;let s=!1;n&&t.getRenderingHint("drawShadows")&&(s=n.isShadowed),e.clipInsteadOfFill&&(s=!1),this.js()&&s&&e.shadowsOn(),s&&!0===this.shadowVisible?e.shadowsOn():s&&!1===this.shadowVisible&&e.shadowsOff();const o=this.panel;if(s&&this.vb(o)&&null===this.shadowVisible&&e.shadowsOff(),e.sl){const n=t.computePixelRatio(),s=`drop-shadow(${e.shadowOffsetX/n}px ${e.shadowOffsetY/n}px ${e.shadowBlur/n/2}px ${e.shadowColor})`;null!==this.background&&i.Dt.setAttributeNS(null,"filter",s)}return s&&(null!==this.Dt||this.vb(o))?(this.Ob(!0),null===this.shadowVisible&&e.shadowsOff()):this.Ob(!1),s}KR(t,e,i,n){if(i.sl){const n=e.computePixelRatio(),s=`drop-shadow(${i.shadowOffsetX/n}px ${i.shadowOffsetY/n}px ${i.shadowBlur/n/2}px ${i.shadowColor})`;this.u2(t,s)}n&&!0===this.f2()&&i.shadowsOn(),this.js()&&i.shadowsOff()}vb(t){return null!==t&&(t.el()&&(t=t.panel),t.f2()||(t.type===Yt.Auto||t.type===Yt.Spot)&&t.findMainElement()!==this)}u2(t,e){}Rb(t,e,i){const n=this.k0(),s=e.x,o=e.y,r=e.width+n,a=e.height+n;this.mn(t,this.Dt,!0,!1,e,i),this.Dt instanceof Ut&&3===this.Dt.type?(t.beginPath(),t.rect(s-n/2,o-n/2,r,a),t.fillContext(this.Dt,!1,null)):t.fillRect(s-n/2,o-n/2,r,a)}wA(t,e){let i=t.GR(this);const n=null!==t.dh?t.dh:t.svg;if(-1!==i)if(0===i)if(n.Dt)n.Dt.after(e);else if(t.type===Yt.Table){const t=n.getElementsByClassName("gojs-ts"),i=0!==t.length?t[0]:null;null!==i&&i.after(e)}else n.prepend(e);else{for(;0!==i&&!t.elt(i-1).isVisibleObject();)i--;if(0===i)n.prepend(e);else{const s=t.elt(i-1).svg;null!==s?s.after(e):n.appendChild(e)}}}zR(t,e){if(!(t instanceof Et))return!1;if(!this.visible||0===this.opacity)return null!==this.svg&&null!==this.svg.parentNode&&this.svg.remove(),!0;const i=this.Ai;if(this.js()&&(!this.isVisible()||0===i.width||0===i.height||isNaN(i.x)||isNaN(i.y)))return null!==this.svg&&null!==this.svg.parentNode&&this.svg.remove(),!0;const n=this.panel,s=this.ed(t);if(this.nf(t,e,s))return this.xA(this.svg),null!==this.svg.parentElement?(this.js()&&(t.lastDrawnPart=this.svg),!0):(this.js()?(null!==t.lastDrawnPart?t.lastDrawnPart.after(this.svg):t.diagramGroup.prepend(this.svg),t.lastDrawnPart=this.svg):n&&this.wA(n,this.svg),!0);if(this.Ye(!1),this.js()&&this.isShadowed){const i=this.shadowOffset;t.shadowsSet(i.x*e.scale*this.scale*e.Yi,i.y*e.scale*this.scale*e.Yi,this.shadowBlur),t.shadowsOn(),t.shadowColor=this.shadowColor}this instanceof ie&&(t.font=this.font),t.currentElement=null;const o=this.F,r=this instanceof Yt,a=this instanceof Yt&&this.el(),l=this.svg;if(!0===this.b0()&&this.Fb(),t.setCurrentTransform(1,0,0,1,0,0),t.outerGroup=!1,s)if(t.outerGroup=!0,r&&a)t.newGroup(1,0,0,1,0,0),this.svg=t.lastCreatedElement;else if(r&&this.isClipping){const e=this.findMainElement();let i=0,n=0;null!==e&&(i=e.actualBounds.x,n=e.actualBounds.y),t.newGroup(o.m11,o.m12,o.m21,o.m22,o.dx+i,o.dy+n),this.svg=t.lastCreatedElement,null!==e&&t.createOrUpdateClipGroup(this,e.actualBounds),t.currentElement=t.lastCreatedElement}else r?(t.newGroup(o.m11,o.m12,o.m21,o.m22,o.dx,o.dy),this.svg=t.lastCreatedElement):t.newGroup(1,0,0,1,0,0);const h=this.naturalBounds;r||t.setCurrentTransform(o.m11,o.m12,o.m21,o.m22,o.dx,o.dy),null!==this.background&&(r?(a&&t.setCurrentTransform(o.m11,o.m12,o.m21,o.m22,o.dx,o.dy),this.Rb(t,h,i),a&&t.setCurrentTransform(1,0,0,1,0,0)):(t.setCurrentTransform(o.m11,o.m12,o.m21,o.m22,o.dx,o.dy),this.Rb(t,h,i)),t.currentElement.Dt=t.lastCreatedElement,t.currentElement.prepend(t.lastCreatedElement));const u=this.YR(e,t,t.currentElement);this.wh(t,e),r&&t.endGroup(),t.outerGroup&&t.endGroup();const c=t.surface.Wu,d=r?this.svg:t.currentElement;if(null!==l&&d!==l&&l.parentNode===this.panel.svg){const e=this.svg.getAttribute("filter");return null!==e&&d.setAttribute("filter",e),l.replaceWith(d),this.svg=d,null!==d&&this.N0(t,n,i,d),!0}if(this.svg=d,null!==c&&null===d&&t.dummyGroup(),null===d)return!0;this.N0(t,n,i,d),this.KR(d,e,t,u);const f=this.js()?this.opacity*t.globalAlpha:this.opacity;if(1!==f&&d.setAttributeNS(null,"opacity",f.toString()),""!==this.filter&&d.setAttributeNS(null,"filter",this.filter),this.js()){if(null!==l&&d!==l&&l.parentNode===t.diagramGroup){const t=l.getAttribute("filter");null!==t&&d.setAttribute("filter",t),l.replaceWith(d)}else t.lastDrawnPart?t.lastDrawnPart.after(d):t.diagramGroup.prepend(d);t.lastDrawnPart=d}else null!==n&&this.wA(n,d);return null!==c&&c(this,d),this.xA(d),!0}xA(t){const i=this,n=t.dataset;i instanceof At&&(null!==i.portId&&(n.portId=i.portId),i instanceof Yt&&(isNaN(i.itemIndex)||(n.itemIndex=i.itemIndex.toString()),i instanceof ce&&(n.className=e.Vn(i),void 0!==i.key&&(n.key=i.key.toString()),null!==i.containingGroup&&(n.group=i.containingGroup.key.toString()),i instanceof ve&&(null!==i.fromNode&&void 0!==i.fromNode.key&&(n.fromKey=i.fromNode.key.toString()),""!==i.fromPortId&&(n.fromPortId=i.fromPortId),null!==i.toNode&&void 0!==i.toNode.key&&(n.toKey=i.toNode.key.toString()),""!==i.toPortId&&(n.toPortId=i.toPortId)))))}N0(t,e,i,n){let s=0!==(256&this.n);if(t.clipInsteadOfFill&&(s=!1),!s)return void n.removeAttributeNS(null,"clip-path");const o=e.wn()?e.naturalBounds:e.actualBounds;let r=Math.max(i.x,o.x),a=Math.max(i.y,o.y),l=Math.min(i.right,o.right)-r,h=Math.min(i.bottom,o.bottom)-a;const u=this.ri;null!==u&&(r=u.x,a=u.y,l=u.width,h=u.height);const c=new b(r,a,Math.max(l,0),Math.max(h,0));this instanceof Yt&&this.F.copy().yw().Ug(c),n.setAttributeNS(null,"clip-path",`path('      M ${c.x},${c.y}       L ${c.width+c.x} ${c.y}       L ${c.width+c.x} ${c.height+c.y}       L ${c.x} ${c.height+c.y} z') view-box`)}HR(){if(null===this.svg)return;const t=this.svg.innerHTML.match(/url\(#((CLIP|GRAD).+?)\)/g),e=this.svg.ownerDocument;if(null!==t)for(const i of t){const t=e.getElementById(i.split("#")[1].slice(0,-1));null!==t&&t.remove()}this.svg.remove()}XR(t,e){const i=this.Ai,n=this.Ki,s=this.Dt;null!==s&&t.commitTransform(),null!==s&&(this.mn(t,s,!0,!1,n,i),s instanceof Ut&&3===s.type?(t.beginPath(),t.rect(i.x,i.y,i.width,i.height),t.fillContext(s,!1,null)):t.fillRect(i.x,i.y,i.width,i.height)),this.wh(t,e)}wh(t,e){}of(){this.Ye(!0)}nf(t,e,i){const n=this.svg;if(this.jR()){if(this.of(),this.Ye(!1),null===n)return!1;const e=n.getAttribute("clip-path");if(null!==e&&e.includes("url")){const i=t.svg.getElementById(e.split("#")[1].slice(0,-1));null!==i&&i.remove()}return n.getAttribute("filter")&&n.removeAttribute("filter"),!1}if(null===n)return!1;if(!this.visible)return n.remove(),!1;if("g"!==n.nodeName&&i||"g"===n.nodeName&&!i)return!1;const s=this.F,o="matrix("+s.m11+", "+s.m12+", "+s.m21+", "+s.m22+", "+s.dx+", "+s.dy+")",r=this instanceof Yt,a=!!r&&this.el();if(!r||!a)if(this instanceof re){const e=this.Ib;t.setCurrentTransform(s.m11,s.m12,s.m21,s.m22,s.dx,s.dy),null!==e&&t.amendImageTransform(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]),i?n.lastElementChild.setAttributeNS(null,"transform",t.getCurrentTransform()):n.setAttributeNS(null,"transform",t.getCurrentTransform())}else if(i&&!r)if(this instanceof Jt){const t=n.getElementsByTagName("path");for(let e=0;e<t.length;e++)t[e].setAttributeNS(null,"transform",o)}else if(this instanceof ie){const t=n.getElementsByTagName("text"),e="string"==typeof this.stroke?this.stroke:null;for(let i=0;i<t.length;i++)t[i].setAttributeNS(null,"transform",o),e&&t[i].setAttributeNS(null,"fill",e)}else(n.lastElementChild||n).setAttributeNS(null,"transform",o);else if(r&&this.isClipping&&this.dh){const t=this.findMainElement(),e=null!==t?t.actualBounds.x:0,i=null!==t?t.actualBounds.y:0;this.dh.setAttributeNS(null,"transform","matrix(1,0,0,1,"+-e+", "+-i+")"),n.setAttributeNS(null,"transform","matrix("+s.m11+", "+s.m12+", "+s.m21+", "+s.m22+", "+(s.dx+e)+", "+(s.dy+i)+")")}else n.setAttributeNS(null,"transform",o);const l=this.js()?this.opacity*t.globalAlpha:this.opacity;1===l?n.removeAttribute("opacity"):n.setAttributeNS(null,"opacity",l.toString()),t.setCurrentTransform(1,0,0,1,0,0);const h=this.dh?this.dh:this.Db;if(null!==this.background||void 0!==h.Dt){const e=h.Dt;if(null===this.background)t.removeOldGradient(this,h.Dt,"fill"),h.Dt.remove(),h.Dt=void 0;else{if((a||i&&!(this instanceof Yt))&&t.setCurrentTransform(s.m11,s.m12,s.m21,s.m22,s.dx,s.dy),this.Rb(t,this.naturalBounds,this.actualBounds),h.Dt){t.removeOldGradient(this,h.Dt,"fill");const e=h.Dt.getAttribute("filter");null!==e&&t.lastCreatedElement.setAttribute("filter",e),h.Dt.replaceWith(t.lastCreatedElement)}else h.prepend(t.lastCreatedElement);h.Dt=t.lastCreatedElement}e&&t.removeOldGradient(this,e,"fill")}return this.N0(t,this.panel,this.actualBounds,n),!0}ed(t){if(null!==this.background)return!0;let e=0!==(256&this.n);return t.clipInsteadOfFill&&(e=!1),!!e}static PE(t,e,i,n,s,o,r){let a=.001;const l=o.length;t.moveTo(e,i);let h=n-e;const u=s-i;0===h&&(h=.001);const c=u/h;let d=Math.sqrt(h*h+u*u),f=0,g=!0;a=o[f%l];let m=0!==r;for(;d>=.1;){if(m){for(a=o[f++%l],a-=r;a<0;)a+=o[f++%l],g=!g;m=!1}else a=o[f++%l];a>d&&(a=d);let n=Math.sqrt(a*a/(1+c*c));h<0&&(n=-n),e+=n,i+=c*n,g?t.lineTo(e,i):t.moveTo(e,i),d-=a,g=!g}}mn(t,i,n,s,o,r){let a,l=1,h=1;if("string"==typeof i)return void(n?t.fillStyle=i:t.strokeStyle=i);if(1===i.type)return void(n?t.fillStyle=i.color:t.strokeStyle=i.color);const u=this.k0();l=o.width,h=o.height,s?(l=r.width,h=r.height):n||(l+=u,h+=u);const c=t instanceof It;if(c&&i.xn&&(4===i.type||i.rf===l&&i.Eb===h))a=i.xn;else{let o=0,d=0,f=0,g=0,m=0,p=0,y=0,x=0;if(s?(y=r.x,x=r.y):n||(y-=u/2,x-=u/2),o=i.start.x*l+i.start.offsetX+y,d=i.start.y*h+i.start.offsetY+x,f=i.end.x*l+i.end.offsetX+y,g=i.end.y*h+i.end.offsetY+x,2===i.type)a=t.createLinearGradient(o,d,f,g);else if(3===i.type)p=isNaN(i.endRadius)?Math.max(l,h)/2:i.endRadius,isNaN(i.startRadius)?(m=0,p=Math.max(l,h)/2):m=i.startRadius,a=t.createRadialGradient(o,d,m,f,g,p);else if(4===i.type)try{a=t.createPattern(i.pattern,"repeat")}catch{a=null}else e.te(i.type,"Brush type");if(4!==i.type){const t=i.colorStops;if(null!==t){const e=t.iterator;for(;e.next();)a.addColorStop(e.key,e.value)}}if(c&&(i.xn=a,null!==a&&(i.rf=l,i.Eb=h),null===a&&4===i.type&&-1!==i.rf)){i.rf=-1;const t=this.diagram;null!==t&&-1===i.rf&&e.ar((()=>{t.redraw()}),600)}}n?t.fillStyle=a:t.strokeStyle=a}isContainedBy(t){return t instanceof Yt&&this.qR(this,t)}qR(t,e){if(t===e||null===e)return!1;let i=t.panel;for(;null!==i;){if(i===e)return!0;i=i.panel}return!1}isVisibleObject(){if(!this.visible)return!1;const t=this.panel;return null===t||t.isVisibleObject()}isEnabledObject(){let t=this instanceof Yt?this:this.panel;for(;null!==t&&t.isEnabled;)t=t.panel;return null===t}get enabledChanged(){return null!==this.b?this.b.C0:null}set enabledChanged(t){const i=this.enabledChanged;i!==t&&(null!==t&&e.S(t,At,"enabledChanged"),this.qt().C0=t,this.t("enabledChanged",i,t))}Fb(){if(!0===this.Bb()){const t=this._r;if(t.Ii(),!this.Ai.isReal()||!this.re.isReal())return void this.sd(!1);if(t.Es(this.Ai.x-this.re.x,this.Ai.y-this.re.y),1!==this.scale||0!==this.angle){const e=this.naturalBounds;this.x0(t,e.x,e.y,e.width,e.height)}this.sd(!1),this.Ca(!0)}if(!0===this.b0()){const t=this.panel;if(null===t)this.uh.set(this._r),this.wa=this.scale;else if(null!==t.Ys){const e=this.uh;e.Ii(),t.wn()?e.ac(t.uh):null!==t.panel&&e.ac(t.panel.uh),e.ac(this._r),this.wa=this.scale*t.wa}this.Ca(!1)}}x0(t,e,i,n,s){if(1!==this.nt&&t.nt(this.nt),0===this.Ht)return;const o=y.l();o.setSpot(e,i,n,s,w.Center),t.ds(this.Ht,o.x,o.y),y.e(o)}c(t){if(this.Bo())return;void 0===t&&(t=!1),this.me(!0),this.no(!0);const e=this.panel;null!==e&&!t&&e.c()}lf(){this.Bo()||(this.me(!0),this.no(!0))}hf(t){if(this.es())return;const e=this.panel;!t&&null!==e&&e.c(),this.no(!0)}sf(){!1===this.Bb()&&(this.sd(!0),this.Ca(!0))}d2(){this.Ca(!0)}C(){const t=this.part;null!==t&&t.C()}Hs(t){const e=this.stretch,i=this.panel;if(null===i)return this.Yo(1===e?0:e,t);if(i.type===Yt.Table)return this.L0(i.getRowDefinition(this.row),i.getColumnDefinition(this.column),t);if(i.type===Yt.Auto&&i.findMainElement()===this)return this.Yo(2,t);if(1===e){if(i.type===Yt.Spot&&i.findMainElement()===this)return this.Yo(2,t);const e=i.defaultStretch;return 1===e?this.Yo(0,t):this.Yo(e,t)}return this.Yo(e,t)}L0(t,e,i){const n=this.stretch;if(1!==n)return this.Yo(n,i);let s=null,o=null;switch(t.stretch){case 1:case 5:break;case 4:case 2:o=!0}switch(e.stretch){case 1:case 4:break;case 5:case 2:s=!0}const r=this.panel.defaultStretch;return null===s&&(s=5===r||2===r),null===o&&(o=4===r||2===r),!0===s&&!0===o?this.Yo(2,i):!0===s?this.Yo(5,i):!0===o?this.Yo(4,i):this.Yo(0,i)}Yo(t,e){if(e)return t;if(0===t)return 0;const i=this.desiredSize;if(i.isReal())return 0;const n=!isNaN(i.width),s=!isNaN(i.height),o=this.angle;if(n)if(90!==o&&270!==o){if(5===t)return 0;if(2===t)return 4}else{if(4===t)return 0;if(2===t)return 5}if(s)if(90!==o&&270!==o){if(4===t)return 0;if(2===t)return 5}else{if(5===t)return 0;if(2===t)return 4}return t}get segmentOrientation(){return null!==this.Ut?this.Ut.A0:0}set segmentOrientation(t){const e=this.segmentOrientation;e!==t&&(null===this.Ut&&(this.Ut=new Ce),this.Ut.A0=t,this.c(),this.t("segmentOrientation",e,t),0===t&&(this.angle=0))}WR(){this.segmentOrientation=21}get segmentIndex(){return null!==this.Ut?this.Ut.T0:-1/0}set segmentIndex(t){t=Math.round(t);const e=this.segmentIndex;e!==t&&(null===this.Ut&&(this.Ut=new Ce),this.Ut.T0=t,this.c(),this.t("segmentIndex",e,t))}get segmentFraction(){return null!==this.Ut?this.Ut.D0:0}set segmentFraction(t){t<0?t=0:t>1&&(t=1);const e=this.segmentFraction;e!==t&&(null===this.Ut&&(this.Ut=new Ce),this.Ut.D0=t,this.c(),this.t("segmentFraction",e,t))}get segmentOffset(){return null!==this.Ut?this.Ut.F0:y.Lo}set segmentOffset(t){const e=this.segmentOffset;e.equals(t)||(t=t.N(),null===this.Ut&&(this.Ut=new Ce),this.Ut.F0=t,this.c(),this.t("segmentOffset",e,t))}get stretch(){return null!==this.b?this.b.oo:1}set stretch(t){const e=this.stretch;e!==t&&(this.qt().oo=t,this.c(),this.t("stretch",e,t))}get name(){return null!==this.b?this.b.Nt:""}set name(t){const e=this.name;e!==t&&(this.qt().Nt=t,null!==this.part&&this.part.R0(),this.t("name",e,t))}get opacity(){return this._t}set opacity(t){t<0?t=0:t>1&&(t=1);const e=this.opacity;if(e!==t){this._t=t,this.t("opacity",e,t);const i=this.diagram,n=this.part;null!==i&&null!==n&&i.C(n.Qh(n.actualBounds))}}get filter(){return this.y0}set filter(t){const e=this.filter;if(e!==t){this.y0=t,this.Ye(!0),this.t("filter",e,t);const i=this.diagram,n=this.part;null!==i&&null!==n&&i.C(n.Qh(n.actualBounds))}}get visible(){return 0!==(1&this.n)}set visible(t){const e=0!==(1&this.n);if(e!==t){this.n=1^this.n,this.of(),this.t("visible",e,t);const i=this.panel;null!==i?i.c():this.js()&&this.Vi(t),this.C(),this.bA()}}get pickable(){return 0!==(2&this.n)}set pickable(t){const e=0!==(2&this.n);e!==t&&(this.n=2^this.n,this.t("pickable",e,t))}get fromLinkableDuplicates(){return 0!==(4&this.n)}set fromLinkableDuplicates(t){const e=0!==(4&this.n);e!==t&&(this.n=4^this.n,this.t("fromLinkableDuplicates",e,t))}get fromLinkableSelfNode(){return 0!==(8&this.n)}set fromLinkableSelfNode(t){const e=0!==(8&this.n);e!==t&&(this.n=8^this.n,this.t("fromLinkableSelfNode",e,t))}get toLinkableDuplicates(){return 0!==(16&this.n)}set toLinkableDuplicates(t){const e=0!==(16&this.n);e!==t&&(this.n=16^this.n,this.t("toLinkableDuplicates",e,t))}get toLinkableSelfNode(){return 0!==(32&this.n)}set toLinkableSelfNode(t){const e=0!==(32&this.n);e!==t&&(this.n=32^this.n,this.t("toLinkableSelfNode",e,t))}get isPanelMain(){return 0!==(64&this.n)}set isPanelMain(t){const e=0!==(64&this.n);e!==t&&(this.n=64^this.n,this.c(),this.t("isPanelMain",e,t))}get isActionable(){return 0!==(128&this.n)}set isActionable(t){const e=0!==(128&this.n);e!==t&&(this.n=128^this.n,this.t("isActionable",e,t))}get background(){return this.Dt}set background(t){const e=this.background;e!==t&&(null!==t&&Ut.nd(t,"GraphObject.background"),t instanceof Ut&&t.u(),this.Dt=t,this.C(),this.t("background",e,t))}f2(){return 0!==(512&this.n)}Ob(t){t?this.n|=512:this.n&=-513}tf(){return 0!==(1024&this.n)}g2(t){t?this.n|=1024:this.n&=-1025}Bb(){return 0!==(2048&this.n)}sd(t){t?this.n|=2048:this.n&=-2049}b0(){return 0!==(4096&this.n)}Ca(t){t?this.n|=4096:this.n&=-4097}Bo(){return 0!==(8192&this.n)}me(t){t?this.n|=8192:this.n&=-8193}es(){return 0!==(16384&this.n)}no(t){t?this.n|=16384:this.n&=-16385}jR(){return 0!==(32768&this.n)}Ye(t){t?this.n|=32768:this.n&=-32769}get part(){if(this.js())return this;if(null!==this.il)return this.il;let t=this;for(t=t.panel;t;){if(t instanceof ce)return this.il=t,t;t=t.panel}return null}get svg(){return this.Db}set svg(t){this.Db=t}vu(){this.svg=null}get panel(){return this.Gs}La(t){this.Gs=t,null!==this.svg&&this.svg.remove()}get layer(){const t=this.part;return null!==t?t.layer:null}get diagram(){const t=this.part;return null!==t?t.diagram:null}get position(){return this.dt}set position(t){const e=t.x,i=t.y,n=this.position,s=n.x,o=n.y;(s===e||isNaN(s)&&isNaN(e))&&(o===i||isNaN(o)&&isNaN(i))?this.p2():(t=t.copy(),this.m2(t,s,o)&&this.t("position",new y(s,o),t.copy()))}p2(){}m2(t,e,i){return this.dt=t,this.hf(),!0}Cc(t,e,i){this.dt.x===t&&this.dt.y===e||(this.dt.i(t,e),this.sf())}get actualBounds(){return this.Ai}get scale(){return this.nt}set scale(t){const i=this.scale;i!==t&&(t<=0&&e.o("GraphObject.scale for "+this+" must be greater than zero, not: "+t),this.nt=t,this.c(),this.t("scale",i,t))}get angle(){return this.Ht}set angle(t){const e=this.angle;if(e!==t){if((t%=360)<0&&(t+=360),e===t)return;this.Ht=t,this.bA(),this.c(),this.t("angle",e,t)}}get desiredSize(){return this.ns}set desiredSize(t){const e=t.width,i=t.height,n=this.desiredSize,s=n.width,o=n.height;if((s!==e&&(!isNaN(s)||!isNaN(e))||o!==i&&(!isNaN(o)||!isNaN(i)))&&(t=t.N(),this.ns=t,this.c(),this instanceof Jt&&this.oe(),this.t("desiredSize",n,t),this.tf())){const t=this.part;null!==t&&(this.Na(t,"width"),this.Na(t,"height"))}}get width(){return this.ns.width}set width(t){const e=this.ns.width;if(e!==t&&(!isNaN(e)||!isNaN(t))){const e=this.ns,i=new x(t,this.ns.height).u();if(this.ns=i,this.c(),this instanceof Jt&&this.oe(),this.t("desiredSize",e,i),this.tf()){const t=this.part;null!==t&&this.Na(t,"width")}}}get height(){return this.ns.height}set height(t){const e=this.ns.height;if(e!==t&&(!isNaN(e)||!isNaN(t))){const e=this.ns,i=new x(this.ns.width,t).u();if(this.ns=i,this.c(),this instanceof Jt&&this.oe(),this.t("desiredSize",e,i),this.tf()){const t=this.part;null!==t&&this.Na(t,"height")}}}get minSize(){return null!==this.b?this.b.Sr:x.hc}set minSize(t){const e=this.minSize;e.equals(t)||(t=t.copy(),isNaN(t.width)&&(t.width=0),isNaN(t.height)&&(t.height=0),t.u(),this.qt().Sr=t,this.c(),this.t("minSize",e,t))}get maxSize(){return null!==this.b?this.b.Mr:x.Fk}set maxSize(t){const e=this.maxSize;e.equals(t)||(t=t.copy(),isNaN(t.width)&&(t.width=1/0),isNaN(t.height)&&(t.height=1/0),t.u(),this.qt().Mr=t,this.c(),this.t("maxSize",e,t))}get measuredBounds(){return this.re}get naturalBounds(){return this.Ki}k0(){return 0}get margin(){return this.tl}set margin(t){"number"==typeof t&&(t=new v(t));const e=this.tl;e.equals(t)||(t=t.N(),this.tl=t,this.c(),this.t("margin",e,t))}get F(){return!0===this.Bb()&&this.Fb(),this._r}get Ys(){return!0===this.b0()&&this.Fb(),this.uh}trigger(t,e,i){let n=null;return n="string"==typeof t?new ft(t,e,i):t,n.Se=this,null===this.ks&&(this.ks=new p),this.ks.set(n.propertyName,n),this}get ks(){return null!==this.b?this.b.ks:null}set ks(t){this.ks!==t&&(this.qt().ks=t)}get Pr(){return null!==this.b?this.b.Pr:0}set Pr(t){this.Pr!==t&&(this.qt().Pr=t)}get alignment(){return this.fi}set alignment(t){const i=this.alignment;i.equals(t)||(t.isNoSpot()&&!t.isDefault()&&e.o("GraphObject.alignment for "+this+" must be a real Spot or Spot.Default, not: "+t),t=t.N(),this.fi=t,this.hf(),this.t("alignment",i,t))}get column(){return this.Qr}set column(t){t=Math.round(t);const i=this.column;i!==t&&(t<0&&e._(t,">= 0",At,"column"),this.Qr=t,this.c(),this.t("column",i,t),null!==this.svg&&this.svg.remove())}get columnSpan(){return null!==this.b?this.b.v0:1}set columnSpan(t){t=Math.round(t);const i=this.columnSpan;i!==t&&(t<1&&e._(t,">= 1",At,"columnSpan"),this.qt().v0=t,this.c(),this.t("columnSpan",i,t))}get row(){return this.p0}set row(t){t=Math.round(t);const i=this.row;i!==t&&(t<0&&e._(t,">= 0",At,"row"),this.p0=t,this.c(),this.t("row",i,t),null!==this.svg&&this.svg.remove())}get rowSpan(){return null!==this.b?this.b.O0:1}set rowSpan(t){t=Math.round(t);const i=this.rowSpan;i!==t&&(t<1&&e._(t,">= 1",At,"rowSpan"),this.qt().O0=t,this.c(),this.t("rowSpan",i,t))}get spanAllocation(){return null!==this.b?this.b.I0:null}set spanAllocation(t){const i=this.spanAllocation;i!==t&&(null!==t&&e.S(t,At,"spanAllocation"),this.qt().I0=t,this.c(),this.t("spanAllocation",i,t))}get alignmentFocus(){return this.$u}set alignmentFocus(t){const e=this.alignmentFocus;e.equals(t)||(t=t.N(),this.$u=t,this.c(),this.t("alignmentFocus",e,t))}get portId(){return this.m0}set portId(t){const i=this.portId;if(i!==t){const n=this.part;null!==n&&!(n instanceof me)&&e.o("Cannot set portID on a Link: "+t);const s=n;null!==i&&null!==s&&s.w2(this),this.m0=t,null!==t&&null!==s&&(s.bn=!0,s.kA(this)),this.t("portId",i,t)}}Aa(){const t=this.part;if(t instanceof me&&(null!==this.portId||this===t.port)){const e=t.diagram;null!==e&&!e.undoManager.isUndoingRedoing&&t.gA(this)}}bA(){const t=this.diagram;null===t||t.undoManager.isUndoingRedoing||(this instanceof Yt?this instanceof me?this.invalidateConnectedLinks():this.walkVisualTreeFrom(this,(t=>{t.Aa()})):this.Aa())}get toSpot(){return null!==this.gt?this.gt.ba:w.None}set toSpot(t){const e=this.toSpot;e.equals(t)||(t=t.N(),this.Xe().ba=t,this.t("toSpot",e,t),this.Aa())}get toEndSegmentLength(){return null!==this.gt?this.gt.Pa:10}set toEndSegmentLength(t){const i=this.toEndSegmentLength;i!==t&&(t<0&&e._(t,">= 0",At,"toEndSegmentLength"),this.Xe().Pa=t,this.t("toEndSegmentLength",i,t),this.Aa())}get toShortLength(){return null!==this.gt?this.gt.Ma:0}set toShortLength(t){const e=this.toShortLength;e!==t&&(this.Xe().Ma=t,this.t("toShortLength",e,t),this.Aa())}get toLinkable(){return null!==this.gt?this.gt.E0:null}set toLinkable(t){const e=this.toLinkable;e!==t&&(this.Xe().E0=t,this.t("toLinkable",e,t))}get toMaxLinks(){return null!==this.gt?this.gt.B0:1/0}set toMaxLinks(t){const i=this.toMaxLinks;i!==t&&(t<0&&e._(t,">= 0",At,"toMaxLinks"),this.Xe().B0=t,this.t("toMaxLinks",i,t))}get fromSpot(){return null!==this.gt?this.gt.xa:w.None}set fromSpot(t){const e=this.fromSpot;e.equals(t)||(t=t.N(),this.Xe().xa=t,this.t("fromSpot",e,t),this.Aa())}get fromEndSegmentLength(){return null!==this.gt?this.gt.ka:10}set fromEndSegmentLength(t){const i=this.fromEndSegmentLength;i!==t&&(t<0&&e._(t,">= 0",At,"fromEndSegmentLength"),this.Xe().ka=t,this.t("fromEndSegmentLength",i,t),this.Aa())}get fromShortLength(){return null!==this.gt?this.gt.Sa:0}set fromShortLength(t){const e=this.fromShortLength;e!==t&&(this.Xe().Sa=t,this.t("fromShortLength",e,t),this.Aa())}get fromLinkable(){return null!==this.gt?this.gt.U0:null}set fromLinkable(t){const e=this.fromLinkable;e!==t&&(this.Xe().U0=t,this.t("fromLinkable",e,t))}get fromMaxLinks(){return null!==this.gt?this.gt.V0:1/0}set fromMaxLinks(t){const i=this.fromMaxLinks;i!==t&&(t<0&&e._(t,">= 0",At,"fromMaxLinks"),this.Xe().V0=t,this.t("fromMaxLinks",i,t))}get cursor(){return null!==this.b?this.b.Tl:""}set cursor(t){const i=this.cursor;i!==t&&(e.s(t,"string",At,"cursor"),this.qt().Tl=t,this.t("cursor",i,t))}get click(){return null!==this.b?this.b.vr:null}set click(t){const i=this.click;i!==t&&(null!==t&&e.S(t,At,"click"),this.qt().vr=t,this.t("click",i,t))}get doubleClick(){return null!==this.b?this.b.Or:null}set doubleClick(t){const i=this.doubleClick;i!==t&&(null!==t&&e.S(t,At,"doubleClick"),this.qt().Or=t,this.t("doubleClick",i,t))}get contextClick(){return null!==this.b?this.b.Ir:null}set contextClick(t){const i=this.contextClick;i!==t&&(null!==t&&e.S(t,At,"contextClick"),this.qt().Ir=t,this.t("contextClick",i,t))}get mouseEnter(){return null!==this.b?this.b.zr:null}set mouseEnter(t){const i=this.mouseEnter;i!==t&&(null!==t&&e.S(t,At,"mouseEnter"),this.qt().zr=t,this.t("mouseEnter",i,t))}get mouseLeave(){return null!==this.b?this.b.Xr:null}set mouseLeave(t){const i=this.mouseLeave;i!==t&&(null!==t&&e.S(t,At,"mouseLeave"),this.qt().Xr=t,this.t("mouseLeave",i,t))}get mouseOver(){return null!==this.b?this.b.Er:null}set mouseOver(t){const i=this.mouseOver;i!==t&&(null!==t&&e.S(t,At,"mouseOver"),this.qt().Er=t,this.t("mouseOver",i,t))}get mouseHover(){return null!==this.b?this.b.Br:null}set mouseHover(t){const i=this.mouseHover;i!==t&&(null!==t&&e.S(t,At,"mouseHover"),this.qt().Br=t,this.t("mouseHover",i,t))}get mouseHold(){return null!==this.b?this.b.Ur:null}set mouseHold(t){const i=this.mouseHold;i!==t&&(null!==t&&e.S(t,At,"mouseHold"),this.qt().Ur=t,this.t("mouseHold",i,t))}get mouseDragEnter(){return null!==this.b?this.b.z0:null}set mouseDragEnter(t){const i=this.mouseDragEnter;i!==t&&(null!==t&&e.S(t,At,"mouseDragEnter"),this.qt().z0=t,this.t("mouseDragEnter",i,t))}get mouseDragLeave(){return null!==this.b?this.b.X0:null}set mouseDragLeave(t){const i=this.mouseDragLeave;i!==t&&(null!==t&&e.S(t,At,"mouseDragLeave"),this.qt().X0=t,this.t("mouseDragLeave",i,t))}get mouseDrop(){return null!==this.b?this.b.Vr:null}set mouseDrop(t){const i=this.mouseDrop;i!==t&&(null!==t&&e.S(t,At,"mouseDrop"),this.qt().Vr=t,this.t("mouseDrop",i,t))}get actionDown(){return null!==this.b?this.b.Y0:null}set actionDown(t){const i=this.actionDown;i!==t&&(null!==t&&e.S(t,At,"actionDown"),this.qt().Y0=t,this.t("actionDown",i,t))}get actionMove(){return null!==this.b?this.b.K0:null}set actionMove(t){const i=this.actionMove;i!==t&&(null!==t&&e.S(t,At,"actionMove"),this.qt().K0=t,this.t("actionMove",i,t))}get actionUp(){return null!==this.b?this.b.G0:null}set actionUp(t){const i=this.actionUp;i!==t&&(null!==t&&e.S(t,At,"actionUp"),this.qt().G0=t,this.t("actionUp",i,t))}get actionCancel(){return null!==this.b?this.b.H0:null}set actionCancel(t){const i=this.actionCancel;i!==t&&(null!==t&&e.S(t,At,"actionCancel"),this.qt().H0=t,this.t("actionCancel",i,t))}get toolTip(){return null!==this.b?this.b.Yr:null}set toolTip(t){const e=this.toolTip;e!==t&&(this.qt().Yr=t,this.t("toolTip",e,t))}get contextMenu(){return null!==this.b?this.b.Kr:null}set contextMenu(t){const e=this.contextMenu;e!==t&&(this.qt().Kr=t,this.t("contextMenu",e,t))}findBindingPanel(){let t=this instanceof Yt?this:this.panel;for(;null!==t;){if(t.b2())return t;t=t.panel}return null}bind(t,e,i,n){return this.af(t,e,i,n),this}bindTwoWay(t,e,i,n){return this.af(t,e,i,n).makeTwoWay(),this}bindModel(t,e,i,n){return this.af(t,e,i,n).ofModel(),this}bindObject(t,e,i,n,s){return this.af(t,e,i,n).ofObject(s),this}theme(t,e,i,n,s){return this.xh(t,e,i,n,s),this}themeData(t,e,i,n,s){return this.xh(t,e,i,n,s).ofData(),this}themeObject(t,e,i,n,s,o){return this.xh(t,e,i,n,s).ofObject(o),this}themeModel(t,e,i,n,s){return this.xh(t,e,i,n,s).ofModel(),this}af(t,e,i,n){let s=null;return s="string"==typeof t?new Ve(t,e,i,n):t,this.j0(s),s}xh(t,e,i,n,s){let o=null;return o="string"==typeof t?new je(t,e,i,n,s):t,this.j0(o),o}j0(t){t.Se=this;const i=this.findBindingPanel();null!==i&&i.PA()&&e.o("Cannot add a Binding to a template that has already been copied: "+t),null===this.Ti&&(this.Ti=new l),this.Ti.add(t)}set(t){return Object.assign(this,t),this}attach(t){return At.k2(this,t),this}apply(t){return t(this),this}setProperties(t){return bt.h0(this,t),this}static make(i){for(var n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];let r=arguments,a=null,l=null;if(e.ot(i))l=i;else if("string"==typeof i){const n=At.Ub.get(i);e.ot(n)?(r=Array.prototype.slice.call(r),a=n(r),e.H(a)||e.o('GraphObject.make invoked object builder "'+i+'", but it did not return an Object')):l=t.go[i]}null===a&&((null==l||!l.constructor)&&e.o("GraphObject.make requires a class function or GoJS class name or name of an object builder, not: "+i),a=new l);let h=1;if(a instanceof bt&&r.length>1){const t=a,e=r[1];("string"==typeof e||e instanceof HTMLDivElement)&&(t.kM(e),h++)}for(let t=h;t<r.length;t++){const i=r[t];void 0===i?e.o("Undefined value at argument "+t+" for object being constructed by GraphObject.make: "+a):At.k2(a,i)}return a}static k2(t,i){if("number"==typeof i)At.JR(t,i);else if("string"==typeof i)At.$R(t,i);else if(i instanceof At)t instanceof Yt||e.o("A GraphObject can only be added to a Panel, not to: "+t),t.add(i);else if(i instanceof $t){let n;i.isRow&&e.ot(t.getRowDefinition)?n=t.getRowDefinition(i.index):!i.isRow&&e.ot(t.getColumnDefinition)&&(n=t.getColumnDefinition(i.index)),n instanceof $t?n.Vb(i):e.o("A RowColumnDefinition can only be added to an object that implements getRowDefinition/getColumnDefinition, not to: "+t)}else if(i instanceof Gt){t.type=i}else if(i instanceof Ve)t instanceof At||t instanceof $t?t.bind(i):e.o("A Binding can only be applied to a GraphObject or RowColumnDefinition, not to: "+t);else if(i instanceof ft)t instanceof At?t.trigger(i):e.o("An AnimationTrigger can only be applied to a GraphObject, not to: "+t);else if(i instanceof T)t instanceof N&&4===t.type?t.figures.add(i):e.o("A PathFigure can only be added to a Path Geometry, not to: "+t);else if(i instanceof A)t instanceof T?t.segments.add(i):e.o("A PathSegment can only be added to a PathFigure, not to: "+t);else if(i instanceof Le)t instanceof bt||t instanceof Ne?t.layout=i:e.o("A Layout can only be assigned to a Diagram or a Group, not to: "+t);else if(Array.isArray(i))for(let e=0;e<i.length;e++){const n=i[e];At.k2(t,n)}else e.H(i)?At.ZR(t,i):e.o('Unknown initializer "'+i+'" for object being constructed by GraphObject.make: '+t)}static $R(t,i){if(t instanceof ie)t.text=i;else if(t instanceof Jt)t.figure=i;else if(t instanceof re)t.source=i;else if(t instanceof Yt){const e=Gt.os.get(i);null!==e&&(t.type=e)}else if(t instanceof Ut){const n=e.Xh(zt,i);null!==n?t.type=n:e.o("Unknown Brush type as an argument to GraphObject.make: "+i)}else if(t instanceof N){const n=e.Xh(M,i);null!==n&&(t.type=n)}else if(t instanceof A){const n=e.Xh(L,i);null!==n&&(t.type=n)}}static JR(t,i){e.ot(t.hi)?t.hi(i):e.cr(t,i)}static ZR(t,i){if(t instanceof Ut){const e=new n;for(const n in i){const s=parseFloat(n);isNaN(s)?e[n]=i[n]:t.addColorStop(s,i[n])}bt.h0(t,e)}else if(t instanceof $t){if(void 0!==i.row){const n=i.row;(null==n||n===1/0||isNaN(n)||n<0)&&e.o("Must specify non-negative integer row for RowColumnDefinition "+i+", not: "+n),t.isRow=!0,t.index=n}else if(void 0!==i.column){const n=i.column;(null==n||n===1/0||isNaN(n)||n<0)&&e.o("Must specify non-negative integer column for RowColumnDefinition "+i+", not: "+n),t.isRow=!1,t.index=n}const s=new n;for(const t in i)"row"===t||"column"===t||(s[t]=i[t]);bt.h0(t,s)}else bt.h0(t,i)}static build(t,i){const n=At.Ub.get(t);if(e.ot(n)){for(var s=arguments.length,o=new Array(s>2?s-2:0),r=2;r<s;r++)o[r-2]=arguments[r];const e=n([t].concat(o));if(e instanceof At)return i&&e.setProperties(i),e}e.o('GraphObject.build invoked object builder "'+t+'", but it did not return an Object')}static defineBuilder(t,i){e.s(t,"string",At,"defineBuilder:name"),e.S(i,At,"defineBuilder:func");t.toLowerCase();At.Ub.set(t,i)}static isBuilderDefined(t){return At.Ub.has(t)}static takeBuilderArgument(t,i,n){void 0===n&&(n=null);const s=t[1];return(e.ot(n)?n(s):"string"==typeof s)?(t.splice(1,1),s):(void 0===i&&e.o("no "+(e.ot(n)?"satisfactory":"string")+" argument for GraphObject builder "+t[0]),i)}static Ub=(()=>new p)();static#t=(()=>(At.Vertical=4,At.Horizontal=5,At.defineBuilder("Button",(t=>{const e=2.76142374915397,i=2.761423749153969,n=new Yt(Yt.Auto,{isActionable:!0,enabledChanged:(t,e)=>{if(t instanceof Yt){const i=t.findObject("ButtonBorder");if(null!==i)if(void 0===t._buttonFillNormal&&(t._buttonFillNormal=i.fill),e){let e=null;null!==t.layer&&null!==t.diagram&&t.isVisibleObject()&&(e=t.layer.findObjectAt(t.diagram.lastInput.documentPoint)),e===t||null!==e&&e.isContainedBy(t)?i.fill=t._buttonFillOver:i.fill=t._buttonFillNormal}else i.fill=t._buttonFillDisabled}},cursor:"pointer"}).attach({_buttonFillNormal:void 0,_buttonStrokeNormal:void 0,_buttonFillOver:"#d4d4d4",_buttonStrokeOver:"#737373",_buttonFillDisabled:"#a3a3a3"}).add(new Jt("RoundedRectangle",{name:"ButtonBorder",spot1:new w(0,0,e,i),spot2:new w(1,1,-e,-i),parameter1:2,fill:"#f5f5f5",stroke:"#737373"}));return n.mouseEnter=(t,e,i)=>{if(!e.isEnabledObject()||!(e instanceof Yt))return;const n=e.findObject("ButtonBorder");n instanceof Jt&&(void 0===e._buttonFillNormal&&(e._buttonFillNormal=n.fill),n.fill=e._buttonFillOver,void 0===e._buttonStrokeNormal&&(e._buttonStrokeNormal=n.stroke),n.stroke=e._buttonStrokeOver)},n.mouseLeave=(t,e,i)=>{if(!e.isEnabledObject()||!(e instanceof Yt))return;const n=e.findObject("ButtonBorder");n instanceof Jt&&(void 0!==e._buttonFillNormal&&(n.fill=e._buttonFillNormal),void 0!==e._buttonStrokeNormal&&(n.stroke=e._buttonStrokeNormal))},n})),At.defineBuilder("TreeExpanderButton",(t=>{const e=At.build("Button");return e.attach({_treeExpandedFigure:"MinusLine",_treeCollapsedFigure:"PlusLine",visible:!1}),e.add(new Jt("MinusLine",{name:"ButtonIcon",stroke:"#0a0a0a",strokeWidth:2,desiredSize:x.cu}).bindObject("figure","isTreeExpanded",((t,e)=>{const i=e.panel;return t?i._treeExpandedFigure:i._treeCollapsedFigure}))),e.bindObject("visible","isTreeLeaf",(t=>!t)),e.click=(t,e)=>{let i=e.part;if(i instanceof fe&&(i=i.adornedPart),!(i instanceof me))return;const n=i.diagram;if(null===n)return;const s=n.commandHandler;if(i.isTreeExpanded){if(!s.canCollapseTree(i))return}else if(!s.canExpandTree(i))return;t.handled=!0,i.isTreeExpanded?s.collapseTree(i):s.expandTree(i)},e})),At.defineBuilder("SubGraphExpanderButton",(t=>{const e=At.build("Button");return e.attach({_subGraphExpandedFigure:"MinusLine",_subGraphCollapsedFigure:"PlusLine"}),e.add(new Jt("MinusLine",{name:"ButtonIcon",stroke:"#0a0a0a",strokeWidth:2,desiredSize:x.cu}).bindObject("figure","isSubGraphExpanded",((t,e)=>{const i=e.panel;return t?i._subGraphExpandedFigure:i._subGraphCollapsedFigure}))),e.click=(t,e)=>{let i=e.part;if(i instanceof fe&&(i=i.adornedPart),!(i instanceof Ne))return;const n=i.diagram;if(null===n)return;const s=n.commandHandler;if(i.isSubGraphExpanded){if(!s.canCollapseSubGraph(i))return}else if(!s.canExpandSubGraph(i))return;t.handled=!0,i.isSubGraphExpanded?s.collapseSubGraph(i):s.expandSubGraph(i)},e})),At.defineBuilder("ToolTip",(t=>new fe(Yt.Auto,{isShadowed:!0,shadowColor:"rgba(0, 0, 0, .4)",shadowOffset:new y(0,2)}).add(new Jt("RoundedRectangle",{name:"Border",parameter1:1,fill:"#f5f5f5",strokeWidth:0,spot1:new w(0,0,4,6),spot2:new w(1,1,-4,-4)})))),At.defineBuilder("ContextMenu",(t=>new fe(Yt.Vertical,{background:"#f5f5f5",isShadowed:!0,shadowColor:"rgba(0, 0, 0, .4)",shadowOffset:new y(0,2)}).bindObject("background","",(t=>null!==t.adornedPart&&t.hasPlaceholder()?null:"#f5f5f5")))),At.defineBuilder("ContextMenuButton",(t=>{const e=At.build("Button");e.stretch=5;const i=e.findObject("ButtonBorder");return i instanceof Jt&&(i.figure="Rectangle",i.strokeWidth=0,i.spot1=new w(0,0,4,6),i.spot2=new w(1,1,-4,-4)),e})),At.defineBuilder("PanelExpanderButton",(t=>{const e=At.takeBuilderArgument(t,"COLLAPSIBLE"),i=At.build("Button");i.attach({_buttonExpandedFigure:"M0 0 M0 6 L4 2 8 6 M8 8",_buttonCollapsedFigure:"M0 0 M0 2 L4 6 8 2 M8 8","ButtonBorder.fill":"rgba(0, 0, 0, 0)",_buttonFillNormal:"rgba(0, 0, 0, 0)","ButtonBorder.stroke":null,_buttonStrokeNormal:null,_buttonFillOver:"rgba(0, 0, 0, .2)",_buttonStrokeOver:null}),i.add(new Jt({name:"ButtonIcon",strokeWidth:2}).bindObject("geometryString","visible",(t=>t?i._buttonExpandedFigure:i._buttonCollapsedFigure),void 0,e));const n=i.findObject("ButtonBorder");return n instanceof Jt&&(n.stroke=null,n.fill="rgba(0, 0, 0, 0)"),i.click=(t,i)=>{if(!(i instanceof Yt))return;const n=i.diagram;if(null===n||n.isReadOnly)return;let s=i.findBindingPanel();if(null===s&&(s=i.part),null!==s){const i=s.findObject(e);null!==i&&(t.handled=!0,n.startTransaction("Collapse/Expand Panel"),i.visible=!i.visible,n.commitTransaction("Collapse/Expand Panel"))}},i})),At.defineBuilder("CheckBoxButton",(t=>{const i=At.takeBuilderArgument(t),n=At.build("Button",{desiredSize:new x(14,14)});n.attach({"ButtonBorder.spot1":new w(0,0,1,1),"ButtonBorder.spot2":new w(1,1,-1,-1)});const s=new Jt({name:"ButtonIcon",geometryString:"M0 0 M0 8.85 L4.9 13.75 16.2 2.45 M16.2 16.2",strokeWidth:2,stretch:2,geometryStretch:6,visible:!1});return""!==i&&s.bindTwoWay("visible",i),n.add(s),n.click=(t,n)=>{if(!(n instanceof Yt))return;const s=t.diagram;if(null===s||s.isReadOnly||""!==i&&s.model.isReadOnly)return;t.handled=!0;const o=n.findObject("ButtonIcon");s.startTransaction("checkbox"),null!==o&&(o.visible=!o.visible),e.ot(n._doClick)&&n._doClick(t,n),s.commitTransaction("checkbox")},n})),At.defineBuilder("CheckBox",(t=>{const e=At.takeBuilderArgument(t),i=At.build("CheckBoxButton",{name:"Button",isActionable:!1,margin:new v(0,1,0,0)},e),n=new Yt("Horizontal",{isActionable:!0,cursor:i.cursor,margin:new v(1),mouseEnter:i.mouseEnter,mouseLeave:i.mouseLeave,click:i.click}).attach({_buttonFillNormal:i._buttonFillNormal,_buttonStrokeNormal:i._buttonStrokeNormal,_buttonFillOver:i._buttonFillOver,_buttonStrokeOver:i._buttonStrokeOver,_buttonFillDisabled:i._buttonFillDisabled,_buttonClick:i.click});return n.add(i),i.mouseEnter=null,i.mouseLeave=null,i.click=null,n}))))()}class Dt{gi;Nt;io;Ti;eo;qs;Tl;vr;Or;Ir;zr;Xr;Er;Br;Ur;z0;X0;Vr;Y0;K0;G0;H0;Yr;Kr;C0;I0;ks;Sr;Mr;oo;O0;v0;Pr;M0;q0;W0;constructor(){this.gi=!1,this.Nt="",this.io=-1,this.Ti=null,this.eo=null,this.qs=null,this.Tl="",this.vr=null,this.Or=null,this.Ir=null,this.zr=null,this.Xr=null,this.Er=null,this.Br=null,this.Ur=null,this.z0=null,this.X0=null,this.Vr=null,this.Y0=null,this.K0=null,this.G0=null,this.H0=null,this.Yr=null,this.Kr=null,this.C0=null,this.I0=null,this.ks=null,this.Sr=x.hc,this.Mr=x.Fk,this.oo=1,this.O0=1,this.v0=1,this.Pr=0,this.M0=null,this.q0=null,this.W0="category"}copy(){const t=new Dt;return t.Nt=this.Nt,t.io=this.io,t.Ti=this.Ti,t.qs=this.qs,t.Tl=this.Tl,t.vr=this.vr,t.Or=this.Or,t.Ir=this.Ir,t.zr=this.zr,t.Xr=this.Xr,t.Er=this.Er,t.Br=this.Br,t.Ur=this.Ur,t.z0=this.z0,t.X0=this.X0,t.Vr=this.Vr,t.Y0=this.Y0,t.K0=this.K0,t.G0=this.G0,t.H0=this.H0,t.Yr=this.Yr,t.Kr=this.Kr,t.C0=this.C0,t.I0=this.I0,t.ks=this.ks,t.Sr=this.Sr.N(),t.Mr=this.Mr.N(),t.oo=this.oo,t.O0=this.O0,t.v0=this.v0,t.Pr=this.Pr,t.M0=this.M0,t.q0=this.q0,t.W0=this.W0,t}}class Ft{m;constructor(){this.m=[1,0,0,1,0,0]}copy(){const t=new Ft;return t.m[0]=this.m[0],t.m[1]=this.m[1],t.m[2]=this.m[2],t.m[3]=this.m[3],t.m[4]=this.m[4],t.m[5]=this.m[5],t}translate(t,e){this.m[4]+=this.m[0]*t+this.m[2]*e,this.m[5]+=this.m[1]*t+this.m[3]*e}scale(t,e){this.m[0]*=t,this.m[1]*=t,this.m[2]*=e,this.m[3]*=e}rotate(t,e,i){if(t>=360?t-=360:t<0&&(t+=360),0===t)return;this.translate(e,i);let n=0,s=0;if(90===t)n=0,s=1;else if(180===t)n=-1,s=0;else if(270===t)n=0,s=-1;else{const e=t*Math.PI/180;n=Math.cos(e),s=Math.sin(e)}const o=this.m[0]*n+this.m[2]*s,r=this.m[1]*n+this.m[3]*s,a=this.m[0]*-s+this.m[2]*n,l=this.m[1]*-s+this.m[3]*n;this.m[0]=o,this.m[1]=r,this.m[2]=a,this.m[3]=l,this.translate(-e,-i)}}class Ot{type;x1;y1;r1;x2;y2;r2;colors;pattern;constructor(t){this.type=t,this.x1=0,this.y1=0,this.r1=0,this.x2=0,this.y2=0,this.r2=0,this.colors=[],this.pattern=null}addColorStop(t,e){this.colors.push({offset:t,color:e})}}class Rt{Rt;ci;ya;Wu;P2;constructor(e,i,n){const s=void 0===i?t.document:i;this.ya=s,this.P2="http://www.w3.org/2000/svg";const o="http://www.w3.org/2000/xmlns/";void 0!==s&&(this.Rt=this.makeElement("svg",{width:"1px",height:"1px",viewBox:"0 0 1 1"}),this.style.display="block",this.style.letterSpacing="normal",this.style.wordSpacing="normal",n||(this.style.position="absolute"),this.Rt.setAttributeNS(o,"xmlns",this.P2),this.Rt.setAttributeNS(o,"xmlns:xlink","http://www.w3.org/1999/xlink")),this.Wu=null,this.ci=new Et(this,n)}resize(t,e,i,n){return(this.width!==t||this.height!==e)&&(this.width=t,this.height=e,this.style.width=i+"px",this.style.height=n+"px",this.Rt.setAttributeNS(null,"width",i+"px"),this.Rt.setAttributeNS(null,"height",n+"px"),this.Rt.setAttributeNS(null,"viewBox","0 0 "+i+" "+n),this.ci.S2.firstElementChild.setAttributeNS(null,"width",i+"px"),this.ci.S2.firstElementChild.setAttributeNS(null,"height",n+"px"),!0)}makeElement(t,i,n){const s=this.ya.createElementNS(this.P2,t);if(e.H(i))for(const e in i)s.setAttributeNS("href"===e?"http://www.w3.org/1999/xlink":"",e,i[e]);return void 0!==n&&(s.textContent=n),s}getBoundingClientRect(){return this.Rt.getBoundingClientRect()}focus(){this.Rt.focus()}get width(){return this.Rt.width.baseVal.value}set width(t){this.Rt.setAttribute("width",t+"px")}get height(){return this.Rt.height.baseVal.value}set height(t){this.Rt.setAttribute("height",t+"px")}dispose(){this.ya=null}get style(){return this.Rt.style}}class Et{cf;ff;kn;Di;Ke;fillStyle;font;globalAlpha;lineCap;lineDashOffset;lineJoin;lineWidth;miterLimit;shadowBlur;shadowColor;shadowOffsetX;shadowOffsetY;strokeStyle;textAlign;imageSmoothingEnabled;clipInsteadOfFill;lastCreatedElement;uf;df;surface;svg;S2;SA;zb;Ko;bh;Ta;currentElement;clipPathGroup;diagramGroup;lastDrawnPart;currentPath;outerGroup;pathAttributes;sl;Ar;filter;partClipRect;constructor(t,e){this.surface=t,this.svg=t.Rt,this.uf=[],this.df=[],this.fillStyle="#000000",this.font="10px sans-serif",this.globalAlpha=1,this.lineCap="butt",this.lineDashOffset=0,this.lineJoin="miter",this.lineWidth=1,this.miterLimit=10,this.shadowBlur=0,this.shadowColor="rgba(0, 0, 0, 0)",this.shadowOffsetX=0,this.shadowOffsetY=0,this.sl=!1,this.strokeStyle="#000000",this.textAlign="start",this.clipInsteadOfFill=!1,this.cf=0,this.ff=0,this.kn=0,this.lastCreatedElement=null,this.currentElement=null,this.Di=[],this.pathAttributes={},this.zb=!1,this.Ko=null,this.bh=0,this.Ke=new Ft,this.clipPathGroup=this.newGroup2(),this.diagramGroup=this.newGroup2("gojs-diagram"),this.lastDrawnPart=null,this.currentPath=null;const i=u.dw++,n=this.makeElement("clipPath",{id:"mainClip"+i}),s={x:0,y:0,width:t.width,height:t.height};n.appendChild(this.makeElement("rect",s)),this.S2=n,this.svg.appendChild(this.clipPathGroup),this.clipPathGroup.appendChild(this.diagramGroup),this.svg.appendChild(n),this.clipPathGroup.setAttributeNS(null,"clip-path","url(#mainClip"+i+")"),this.SA={},this.Ar=!!e,this.filter="",this.partClipRect=null}setDiagramPosScale(t,e,i,n,s,o){void 0===this.diagramGroup?this.newGroup(t,e,i,n,s,o):this.diagramGroup.setAttribute("transform","matrix("+t+", "+e+", "+i+", "+n+", "+s+", "+o+")")}resetInnerSVG(){null!==this.diagramGroup&&(this.diagramGroup.innerHTML="")}arc(t,e,i,n,s,o,r,a){const l=2*Math.PI,h=1e-6,u=l-h,c=i*Math.cos(n),d=i*Math.sin(n),f=t+c,g=e+d,m=o?0:1;let p=o?n-s:s-n;(Math.abs(r-f)>h||Math.abs(a-g)>h)&&this.Di.push(["L",f,+g]),p<0&&(p=p%l+l),p>u?(this.Di.push(["A",i,i,0,1,m,t-c,e-d]),this.Di.push(["A",i,i,0,1,m,f,g])):p>h&&this.Di.push(["A",i,i,0,+(p>=Math.PI),m,t+i*Math.cos(s),e+i*Math.sin(s)])}beginPath(){this.Di=[],this.pathAttributes={stroke:"none",fill:"none"}}endPath(t){this.QR(this.Di,this.Ke,t||0)}bezierCurveTo(t,e,i,n,s,o){this.Di.push(["C",t,e,i,n,s,o])}clearRect(t,e,i,n){}clip(){this.pathAttributes.clipPath=!0}closePath(){this.Di.push(["z"])}createLinearGradient(t,e,i,n){const s=new Ot("linear");return s.x1=t,s.y1=e,s.x2=i,s.y2=n,s}createPattern(t,e){let i="";t instanceof HTMLCanvasElement&&(i=t.toDataURL()),t instanceof HTMLImageElement&&(i=t.getAttribute("src"));const n=this.SA;if(n[i])return"url(#"+n[i]+")";const s="PATTERN"+u.dw++,o={width:t.width,height:t.height,id:s,patternUnits:"userSpaceOnUse"},r={x:0,y:0,width:t.width,height:t.height,href:i},a=this.makeElement("pattern",o);return a.appendChild(this.makeElement(bt.img,r)),this.svg.appendChild(a),n[i]=s,"url(#"+s+")"}createRadialGradient(t,e,i,n,s,o){const r=new Ot("radial");return r.x1=t,r.y1=e,r.r1=i,r.x2=n,r.y2=s,r.r2=o,r}amendImageTransform(t,e,i,n,s,o,r,a){const l=r/i,h=a/n;(0!==s||0!==o)&&this.Ke.translate(s,o),(1!==l||1!==h)&&this.Ke.scale(l,h),(0!==t||0!==e)&&this.Ke.translate(-t,-e)}drawImage(t,e,i,n,s,o,r,a,l){let h="";t instanceof HTMLCanvasElement&&(h=t.toDataURL()),t instanceof HTMLImageElement&&(h=t.getAttribute("src"));const u=t instanceof HTMLImageElement?t.naturalWidth:t.width,c=t instanceof HTMLImageElement?t.naturalHeight:t.height;void 0===n&&(o=e,r=i,a=n=u,l=s=c),n=n||0,s=s||0,o=o||0,r=r||0,a=a||0,l=l||0,this.amendImageTransform(e,i,n,s,o,r,a,l);const d={x:0,y:0,width:u||n,height:c||s,href:h};S.Y(n,a)&&S.Y(s,l)?-1===h.toLowerCase().indexOf(".svg")&&-1===h.toLowerCase().indexOf("data:image/svg")&&(d.preserveAspectRatio="xMidYMid slice"):d.preserveAspectRatio="none",(0!==e||0!==i||n!==u||s!==c)&&(n+=e,s+=i,d["clip-path"]=`path('M ${e},${i} L ${n} ${i} L ${n} ${s} L ${e} ${s} z')`),this.processCommon(bt.img,d,this.Ke),this.od(bt.img,d)}fill(t,e){t&&(this.pathAttributes["fill-rule"]="evenodd"),this.setFill(this.pathAttributes)}fillContext(t,e,i){this.clipInsteadOfFill?this.clip():this.fill(e,i)}createOrUpdateClipGroup(t,e){const i=this.newGroup(1,0,0,1,-e.x,-e.y);i.setAttributeNS(null,"class","spotClip"),t.dh=i}fillRect(t,e,i,n){this.addRect("fill",[t,e,i,n],this.Ke)}fillBackground(t,e,i,n){const s={x:t,y:e,width:i,height:n};this.processCommon("fill",s,this.Ke),this.setFill(s),this.svg.prepend(this.makeElement("rect",s))}fillText(t,e,i){this.addText("fill",[t,e,i],this.Ke)}lineTo(t,e){this.Di.push(["L",t,e])}moveTo(t,e){this.Di.push(["M",t,e])}quadraticCurveTo(t,e,i,n){this.Di.push(["Q",t,e,i,n])}rect(t,e,i,n){this.Di.push(["M",t,e],["L",t+i,e],["L",t+i,e+n],["L",t,e+n],["z"])}restore(){this.Ke=this.uf.pop(),this.Di=this.uf.pop();const t=this.uf.pop();this.fillStyle=t.fillStyle,this.font=t.font,this.globalAlpha=t.globalAlpha,this.lineCap=t.lineCap,this.lineDashOffset=t.lineDashOffset,this.lineJoin=t.lineJoin,this.lineWidth=t.lineWidth,this.miterLimit=t.miterLimit,this.shadowBlur=t.shadowBlur,this.shadowColor=t.shadowColor,this.shadowOffsetX=t.shadowOffsetX,this.shadowOffsetY=t.shadowOffsetY,this.strokeStyle=t.strokeStyle,this.textAlign=t.textAlign,this.partClipRect=t.partClipRect}save(){const t={fillStyle:this.fillStyle,font:this.font,globalAlpha:this.globalAlpha,lineCap:this.lineCap,lineDashOffset:this.lineDashOffset,lineJoin:this.lineJoin,lineWidth:this.lineWidth,miterLimit:this.miterLimit,shadowBlur:this.shadowBlur,shadowColor:this.shadowColor,shadowOffsetX:this.shadowOffsetX,shadowOffsetY:this.shadowOffsetY,strokeStyle:this.strokeStyle,textAlign:this.textAlign,partClipRect:this.partClipRect};this.uf.push(t);const e=[];for(let i=0;i<this.Di.length;i++)e.push(this.Di[i]);this.uf.push(e),this.uf.push(this.Ke.copy())}setTransform(t,e,i,n,s,o){1===t&&0===e&&0===i&&1===n&&0===s&&0===o||this.newGroup(t,e,i,n,s,o)}setCurrentTransform(t,e,i,n,s,o){this.Ke.m=[t,e,i,n,s,o]}getCurrentTransform(){const t=this.Ke.m;return"matrix("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}scale(t,e){this.Ke.scale(t,e)}translate(t,e){this.Ke.translate(t,e)}transform(t,e,i,n,s,o){}commitTransform(){}stroke(){this.setStroke(this.pathAttributes)}strokeContext(){this.clipInsteadOfFill||this.stroke()}strokeRect(t,e,i,n){this.addRect("stroke",[t,e,i,n],this.Ke)}makeElement(t,e,i){return this.surface.makeElement(t,e,i)}od(t,e,i){const n=this.makeElement(t,e,i);return null!==this.currentElement?this.currentElement.appendChild(n):this.currentElement=n,this.lastCreatedElement=n,n}processCommon(t,e,i){if("fill"===t?this.setFill(e):"stroke"===t&&this.setStroke(e),null!==i){const t=i.m;e.transform="matrix("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}}setFill(t){if(this.fillStyle instanceof Ot)t.fill=this.addGradient(this.fillStyle,!0);else if(/^rgba\(/.test(this.fillStyle)){const e=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(this.fillStyle);t.fill="rgb("+e[1]+","+e[2]+","+e[3]+")",t["fill-opacity"]=e[4]}else t.fill=this.fillStyle}setFillOrStrokeInPlace(t,e){const i=e?"fill":"stroke";if(this.fillStyle instanceof Ot)t.setAttributeNS(null,"fill",this.addGradient(this.fillStyle,!0));else if(/^rgba\(/.test(this.fillStyle)){const e=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(this.fillStyle);t.setAttributeNS(null,i,"rgb("+e[1]+","+e[2]+","+e[3]+")"),t.setAttributeNS(null,i+"-opacity",e[4])}else t.setAttributeNS(null,i,this.fillStyle)}setStroke(t){if(this.strokeStyle instanceof Ot)t.stroke=this.addGradient(this.strokeStyle,!1);else if(/^rgba\(/.test(this.strokeStyle)){const e=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(this.strokeStyle);t.stroke="rgb("+e[1]+","+e[2]+","+e[3]+")",t["stroke-opacity"]=e[4]}else t.stroke=this.strokeStyle;t["stroke-width"]=this.lineWidth,t["stroke-linecap"]=this.lineCap,t["stroke-linejoin"]=this.lineJoin,t["stroke-miterlimit"]=this.miterLimit,this.zb&&(t["stroke-dasharray"]=this.Ko.toString(),t["stroke-dashoffset"]=this.bh)}addGradient(t,i){let n="";const s=null!==this.currentPath?this.currentPath.getAttribute(i?"fill":"stroke"):null;if(null!==s&&-1!==s.indexOf("GRAD")){n=s.split("#")[1].slice(0,-1);const t=this.svg.getElementById(n);null!==t&&t.remove()}else n="GRAD"+u.dw++;let o;if("linear"===t.type){const e={x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2,id:n,gradientUnits:"userSpaceOnUse"};o=this.makeElement("linearGradient",e)}else if("radial"===t.type){const e={x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2,r1:t.r1,r2:t.r2,id:n};o=this.makeElement("radialGradient",e)}else e.o("invalid gradient");const r=t.colors,a=r.length,l=[];for(let e=0;e<a;e++){const t=r[e],i=t.color,n={offset:t.offset,"stop-color":i};if(/^rgba\(/.test(i)){const t=/^\s*rgba\s*\(([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\s*,\s*([^,\s]+)\)\s*$/i.exec(i);n["stop-color"]="rgb("+t[1]+","+t[2]+","+t[3]+")",n["stop-opacity"]=t[4]}l.push(n)}l.sort(((t,e)=>t.offset>e.offset?1:-1));for(let e=0;e<a;e++)o.appendChild(this.makeElement("stop",l[e]));return this.svg.appendChild(o),"url(#"+n+")"}addRect(t,e,i){const n={x:e[0],y:e[1],width:e[2],height:e[3]};this.processCommon(t,n,i),this.od("rect",n)}addText(t,e,i){let n=this.textAlign;"left"===n?n="start":"right"===n?n="end":"center"===n&&(n="middle");const s={x:e[1],y:e[2],style:"font: "+this.font,"text-anchor":n};this.processCommon(t,s,i),this.od("text",s,e[0])}QR(t,e,i){const n=this._R(t),s=this.pathAttributes;if(s.clipPath)this.df.length>1&&this.df[this.df.length-2].setAttributeNS(null,"clip-path",'path("'+n+'") view-box');else if(s.d=n,this.processCommon("",s,e),null!==this.currentPath){const t=this.currentPath;if("g"!==t.nodeName)for(const e in s)"transform"!==e&&t.setAttributeNS(null,e,s[e]);else{const e=t.getElementsByTagName("path");for(const t in s)"transform"!==t&&e[i].setAttributeNS(null,t,s[t])}}else this.od("path",s)}_R(t){const e=[];for(let i=0;i<t.length;i++){const n=t[i].slice(),s=[n.shift()];if("A"===s[0])s.push(n.shift()+","+n.shift(),n.shift(),n.shift()+","+n.shift(),n.shift()+","+n.shift());else for(;n.length;)s.push(n.shift()+","+n.shift());e.push(s.join(" "))}return e.join(" ")}newGroup(t,e,i,n,s,o){const r=new Ft;r.m=[t,e,i,n,s,o];const a={};this.processCommon("g",a,r);const l=this.od("g",a);return this.df.push(l),l}newGroup2(t){const e={};t&&(e.class=t);const i=this.od("g",e);return this.df.push(i),i}endGroup(){return this.df.pop()}dummyGroup(){return this.newGroup2(),this.endGroup()}shadowsSet(t,e,i){this.cf=t,this.ff=e,this.kn=i}shadowsOff(){this.sl=!1,this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowBlur=0}shadowsOn(){this.sl=!0,this.shadowOffsetX=this.cf,this.shadowOffsetY=this.ff,this.shadowBlur=this.kn}enableDash(t,e){this.zb=!0,this.Ko=t,this.bh=e}disableDash(){this.zb=!1}clearContextCache(t){}setImageSmoothingEnabled(t){}rotate(t){this.Ke.rotate(57.2958*t,0,0)}getImageData(t,e,i,n){return null}measureText(t){return null}removeOldGradient(t,e,i){const n=e.getAttribute(i);if(null===n)return;const s=n.split("#");if(1===s.length)return;const o=this.svg.getElementById(s[1].slice(0,-1));if(null!==o){const t=new RegExp(o.id,"g");1===this.svg.innerHTML.match(t).length&&o.remove()}}removePartFromView(t){null!==t.svg&&t.svg.parentNode===this.diagramGroup&&t.svg.remove()}}class Bt{Rt;ci;ya;Wu;constructor(e,i,n,s){const o=void 0===i?t.document:i;this.ya=o,this.Wu=null;const r=o.createElement("canvas");r.tabIndex=0,this.Rt=r,this.ci=new It(r,n,s),bt.is.set(r,e)}resize(t,e,i,n){return(this.width!==t||this.height!==e)&&(this.width=t,this.height=e,this.style.width=i+"px",this.style.height=n+"px",!0)}toDataURL(t,e){return this.Rt.toDataURL(t,e)}getBoundingClientRect(){return this.Rt.getBoundingClientRect()}focus(){this.Rt.focus()}get width(){return this.Rt.width}set width(t){this.Rt.width=t}get height(){return this.Rt.height}set height(t){this.Rt.height=t}dispose(){bt.is.delete(this.Rt),this.ya=null}get style(){return this.Rt.style}}class It{U;Xb;Yb;Kb;clipInsteadOfFill;cf;ff;kn;Ta;sl;Ar;constructor(t,i,n){this.U=t.getContext?t.getContext("2d",i):null,null===this.U&&e.o("Browser does not support HTML Canvas Element"),this.Xb="",this.Yb="",this.Kb="",this.clipInsteadOfFill=!1,this.cf=0,this.ff=0,this.kn=0,this.sl=!1,this.Ta=new k,this.Ar=!!n}createOrUpdateClipGroup(t,e){}setImageSmoothingEnabled(t){this.U.imageSmoothingEnabled=t}get fillStyle(){return this.U.fillStyle}set fillStyle(t){this.Kb!==t&&(this.U.fillStyle=t,this.Kb=t)}get font(){return this.U.font}set font(t){this.Xb!==t&&(this.U.font=t,this.Xb=t)}get globalAlpha(){return this.U.globalAlpha}set globalAlpha(t){this.U.globalAlpha=t}get lineCap(){return this.U.lineCap}set lineCap(t){this.U.lineCap=t}get lineDashOffset(){return this.U.lineDashOffset}set lineDashOffset(t){this.U.lineDashOffset=t}get lineJoin(){return this.U.lineJoin}set lineJoin(t){this.U.lineJoin=t}get lineWidth(){return this.U.lineWidth}set lineWidth(t){this.U.lineWidth=t}get miterLimit(){return this.U.miterLimit}set miterLimit(t){this.U.miterLimit=t}get shadowBlur(){return this.U.shadowBlur}set shadowBlur(t){this.U.shadowBlur=t}get shadowColor(){return this.U.shadowColor}set shadowColor(t){this.U.shadowColor=t}get shadowOffsetX(){return this.U.shadowOffsetX}set shadowOffsetX(t){this.U.shadowOffsetX=t}get shadowOffsetY(){return this.U.shadowOffsetY}set shadowOffsetY(t){this.U.shadowOffsetY=t}get strokeStyle(){return this.U.strokeStyle}set strokeStyle(t){this.Yb!==t&&(this.U.strokeStyle=t,this.Yb=t)}get textAlign(){return this.U.textAlign}set textAlign(t){this.U.textAlign=t}get imageSmoothingEnabled(){return this.U.imageSmoothingEnabled}set imageSmoothingEnabled(t){this.U.imageSmoothingEnabled=t}get filter(){return this.U.filter}set filter(t){this.U.filter=""===t?"none":t}arc(t,e,i,n,s,o,r,a){this.U.arc(t,e,i,n,s,o)}beginPath(){this.U.beginPath()}endPath(){}bezierCurveTo(t,e,i,n,s,o){this.U.bezierCurveTo(t,e,i,n,s,o)}clearRect(t,e,i,n){this.commitTransform(),this.U.clearRect(t,e,i,n)}clip(t){t?this.U.clip(t):this.U.clip()}closePath(){this.U.closePath()}createLinearGradient(t,e,i,n){return this.U.createLinearGradient(t,e,i,n)}createPattern(t,e){return this.U.createPattern(t,e)}createRadialGradient(t,e,i,n,s,o){return this.U.createRadialGradient(t,e,i,n,s,o)}drawImage(t,e,i,n,s,o,r,a,l){void 0===n?this.U.drawImage(t,e,i):this.U.drawImage(t,e,i,n,s,o,r,a,l)}fill(t,e){e?this.U.fill(e,t?"evenodd":"nonzero"):this.U.fill(t?"evenodd":"nonzero")}fillRect(t,e,i,n){this.U.fillRect(t,e,i,n)}fillBackground(t,e,i,n){this.U.fillRect(t,e,i,n)}fillText(t,e,i){this.U.fillText(t,e,i)}getImageData(t,e,i,n){return this.U.getImageData(t,e,i,n)}lineTo(t,e){this.U.lineTo(t,e)}measureText(t){return this.U.measureText(t)}moveTo(t,e){this.U.moveTo(t,e)}quadraticCurveTo(t,e,i,n){this.U.quadraticCurveTo(t,e,i,n)}rect(t,e,i,n){this.U.rect(t,e,i,n)}restore(){this.U.restore()}save(){this.commitTransform(),this.U.save()}rotate(t){this.Ta.ds(57.2958*t,0,0)}setTransform(t,e,i,n,s,o){this.Ta.setTo(t,e,i,n,s,o)}scale(t,e){this.Ta.nt(t,e)}translate(t,e){this.Ta.Es(t,e)}stroke(t){t?this.U.stroke(t):this.U.stroke()}transform(t,e,i,n,s,o){if(1===t&&0===e&&0===i&&1===n&&0===s&&0===o)return;const r=this.Ta,a=r.m11*t+r.m21*e,l=r.m12*t+r.m22*e,h=r.m11*i+r.m21*n,u=r.m12*i+r.m22*n;r.dx=r.m11*s+r.m21*o+r.dx,r.dy=r.m12*s+r.m22*o+r.dy,r.m11=a,r.m12=l,r.m21=h,r.m22=u}commitTransform(){const t=this.Ta;this.U.setTransform(t.m11,t.m12,t.m21,t.m22,t.dx,t.dy)}fillContext(t,e,i){this.radialFill(t,e,i)||this.fillOrClip(e,i)}radialFill(t,e,i){if(!(t instanceof Ut)||3!==t.type)return!1;const n=t.rf,s=t.Eb;return s>n?(this.scale(n/s,1),this.translate((s-n)/2,0)):n>s&&(this.scale(1,s/n),this.translate(0,(n-s)/2)),this.fillOrClip(e,i),s>n?(this.translate(-(s-n)/2,0),this.scale(1/(n/s),1)):n>s&&(this.translate(0,-(n-s)/2),this.scale(1,1/(s/n))),!0}strokeContext(){this.clipInsteadOfFill||this.stroke()}fillOrClip(t,e){this.clipInsteadOfFill?this.clip(e):this.fill(t,e)}shadowsSet(t,e,i){this.cf=t,this.ff=e,this.kn=i}shadowsOff(){this.sl=!1,this.shadowOffsetX=0,this.shadowOffsetY=0,this.shadowBlur=0}shadowsOn(){this.sl=!0,this.shadowOffsetX=this.cf,this.shadowOffsetY=this.ff,this.shadowBlur=this.kn}enableDash(t,e){const i=this.U;void 0!==i.setLineDash&&(i.setLineDash(t),i.lineDashOffset=e)}disableDash(){const t=this.U;void 0!==t.setLineDash&&(t.setLineDash(It.EmptyArray),t.lineDashOffset=0)}clearContextCache(t){t&&(this.Xb=""),this.Yb="",this.Kb=""}removePartFromView(t){}static EmptyArray=(()=>Object.freeze([]))()}var zt=(t=>(t[t.Solid=1]="Solid",t[t.Linear=2]="Linear",t[t.Radial=3]="Radial",t[t.Pattern=4]="Pattern",t))(zt||{}),Vt=(t=>(t[t.Lab=1]="Lab",t[t.HSL=2]="HSL",t[t.Oklch=3]="Oklch",t))(Vt||{});class jt{n0;n1;n2;n3;constructor(){this.n0=0,this.n1=0,this.n2=0,this.n3=0}}class Ut{h;$;Da;oi;ys;J0;$0;Go;Z0;xn;rf;Eb;constructor(t,i){if(u.qi(this),this.h=!1,void 0===t)this.$=1,this.Da="black";else if("string"==typeof t){const i=e.Xh(zt,t);null!==i?(this.$=i,this.Da="black"):(this.$=1,this.Da=t)}else this.$=t,this.Da="black";const n=this.$;if(2===n?(this.oi=w.TopCenter,this.ys=w.BottomCenter):3===n?(this.oi=w.Center,this.ys=w.Center):(this.oi=w.None,this.ys=w.None),this.J0=0,this.$0=NaN,this.Go=null,this.Z0=null,this.xn=null,this.rf=0,this.Eb=0,i){const t={};for(const e in i)isFinite(parseFloat(e))?this.addColorStop(parseFloat(e),i[e]):t[e]=i[e];Object.assign(this,t)}}copy(){const t=new Ut;return t.$=this.$,t.Da=this.Da,t.oi=this.oi.N(),t.ys=this.ys.N(),t.J0=this.J0,t.$0=this.$0,null!==this.Go&&(t.Go=this.Go.copy()),t.Z0=this.Z0,t}u(){return this.h=!0,null!==this.Go&&this.Go.u(),this}hi(t){t in zt?this.type=t:e.cr(this,t)}toString(){let t="Brush(";if(1===this.type)t+=this.color;else if(2===this.type?t+="Linear ":3===this.type?t+="Radial ":4===this.type?t+="Pattern ":t+="(unknown) ",t+=this.start+" "+this.end,null!==this.colorStops){const e=this.colorStops.iterator;for(;e.next();){t+=" "+e.key+":"+e.value}}return t+=")",t}addColorStop(t,i){return this.h&&e.D(this),("number"!=typeof t||!isFinite(t)||t>1||t<0)&&e._(t,"0 <= loc <= 1",Ut,"addColorStop:loc"),e.s(i,"string",Ut,"addColorStop:color"),null===this.Go&&(this.Go=new p),this.Go.set(t,i),1===this.$&&(this.type=2),this.xn=null,this}get type(){return this.$}set type(t){this.h&&e.D(this,t),this.$=t,this.start.isNoSpot()&&(2===t?this.start=w.TopCenter:3===t&&(this.start=w.Center)),this.end.isNoSpot()&&(2===t?this.end=w.BottomCenter:3===t&&(this.end=w.Center)),this.xn=null}get color(){return this.Da}set color(t){this.h&&e.D(this,t),this.Da=t,this.xn=null}get start(){return this.oi}set start(t){this.h&&e.D(this,t),this.oi=t.N(),this.xn=null}get end(){return this.ys}set end(t){this.h&&e.D(this,t),this.ys=t.N(),this.xn=null}get startRadius(){return this.J0}set startRadius(t){this.h&&e.D(this,t),t<0&&e._(t,">= zero",Ut,"startRadius"),this.J0=t,this.xn=null}get endRadius(){return this.$0}set endRadius(t){this.h&&e.D(this,t),t<0&&e._(t,">= zero",Ut,"endRadius"),this.$0=t,this.xn=null}get colorStops(){return this.Go}set colorStops(t){this.h&&e.D(this,t),this.Go=t,this.xn=null}get pattern(){return this.Z0}set pattern(t){this.h&&e.D(this,t),this.Z0=t,this.xn=null}static randomColor(t,e){void 0===t&&(t=128),void 0===e&&(e=Math.max(t,255));const i=Math.abs(e-t);let n=Math.floor(t+Math.random()*i).toString(16),s=Math.floor(t+Math.random()*i).toString(16),o=Math.floor(t+Math.random()*i).toString(16);return n.length<2&&(n="0"+n),s.length<2&&(s="0"+s),o.length<2&&(o="0"+o),"#"+n+s+o}static isValidColor(e){return!t.CSS||t.CSS.supports("color",e)}static lighten(t){return Ut.lightenBy(t)}lightenBy(t,i){this.h&&e.D(this);const n=void 0===t||"number"!=typeof t?.2:t,s=void 0===i?3:i;if(1===this.type)Ut.vo(this.color),this.color=Ut.rd(n,s);else if((2===this.type||3===this.type)&&null!==this.colorStops){const t=this.colorStops.iterator;for(;t.next();)Ut.vo(t.value),this.addColorStop(t.key,Ut.rd(n,s))}return this}static lightenBy(t,e,i){const n=void 0===e||"number"!=typeof e?.2:e,s=void 0===i?3:i;return Ut.vo(t),Ut.rd(n,s)}static darken(t){return Ut.darkenBy(t)}darkenBy(t,i){this.h&&e.D(this);const n=void 0===t||"number"!=typeof t?.2:t,s=void 0===i?3:i;if(1===this.type)Ut.vo(this.color),this.color=Ut.rd(-n,s);else if((2===this.type||3===this.type)&&null!==this.colorStops){const t=this.colorStops.iterator;for(;t.next();)Ut.vo(t.value),this.addColorStop(t.key,Ut.rd(-n,s))}return this}static darkenBy(t,e,i){const n=void 0===e||"number"!=typeof e?.2:e,s=void 0===i?3:i;return Ut.vo(t),Ut.rd(-n,s)}static mix(t,e,i){Ut.vo(t);const n=Ut.G.n0,s=Ut.G.n1,o=Ut.G.n2,r=Ut.G.n3;Ut.vo(e),void 0===i&&(i=.5);return`rgba(${Math.round((Ut.G.n0-n)*i+n)}, ${Math.round((Ut.G.n1-s)*i+s)}, ${Math.round((Ut.G.n2-o)*i+o)}, ${Math.round((Ut.G.n3-r)*i+r)})`}isDark(){if(1===this.type)return Ut.isDark(this.color);if((2===this.type||3===this.type)&&null!==this.colorStops){const t=this.colorStops;if(3===this.type)return Ut.isDark(t.first().value);if(null!==t.get(.5))return Ut.isDark(t.get(.5));if(2===t.count){const e=t.toArray();return Ut.isDark(Ut.mix(e[0].value,e[1].value))}const e=t.iterator;let i=-1,n=-1,s=1,o=1;for(;e.next();){const t=e.key,r=Math.abs(.5-e.key);s>o&&r<s?(i=t,s=r):o>=s&&r<o&&(n=t,o=r)}if(i>n){let t=i;i=n,n=t,t=s,s=o,o=t}const r=n-i;return Ut.isDark(Ut.mix(t.get(i),t.get(n),1-o/r))}return!1}static isDark(t){return!!t&&(t instanceof Ut?t.isDark():(Ut.vo(t),(299*Ut.G.n0+587*Ut.G.n1+114*Ut.G.n2)/1e3<128))}static rd(t,i){switch(i){case 1:return Ut.tv(),Ut.ro.n0=Math.min(100,Math.max(0,Ut.ro.n0+100*t)),Ut.iv(),"rgba("+Ut.G.n0+", "+Ut.G.n1+", "+Ut.G.n2+", "+Ut.G.n3+")";case 2:return Ut.US(),Ut.Ui.n2=Math.min(100,Math.max(0,Ut.Ui.n2+100*t)),"hsla("+Ut.Ui.n0+", "+Ut.Ui.n1+"%, "+Ut.Ui.n2+"%, "+Ut.Ui.n3+")";case 3:return Ut.ev(),Ut.lo.n0=Math.min(100,Math.max(0,Ut.lo.n0+100*t)),Ut.sv(),"rgba("+Ut.G.n0+", "+Ut.G.n1+", "+Ut.G.n2+", "+Ut.G.n3+")";default:e.o("Unknown color space: "+i)}}static vo(t){const e=Ut.nl;if(null===e)return;e.clearRect(0,0,1,1),e.fillStyle="#000000";const i=e.fillStyle;if(e.fillStyle=t,e.fillStyle!==i){e.fillRect(0,0,1,1);const t=e.getImageData(0,0,1,1).data;Ut.G.n0=t[0],Ut.G.n1=t[1],Ut.G.n2=t[2],Ut.G.n3=t[3]/255}else{e.fillStyle="#FFFFFF";e.fillStyle;e.fillStyle=t,e.fillStyle,Ut.G.n0=0,Ut.G.n1=0,Ut.G.n2=0,Ut.G.n3=1}}static US(){const t=Ut.G.n0/255,e=Ut.G.n1/255,i=Ut.G.n2/255,n=Math.max(t,e,i),s=Math.min(t,e,i),o=n-s;let r,a;const l=(n+s)/2;if(0===o)r=a=0;else{switch(n){case t:r=(e-i)/o%6;break;case e:r=(i-t)/o+2;break;case i:r=(t-e)/o+4}r*=60,r<0&&(r+=360),a=o/(1-Math.abs(2*l-1))}Ut.Ui.n0=Math.round(r),Ut.Ui.n1=Math.round(100*a),Ut.Ui.n2=Math.round(100*l),Ut.Ui.n3=Ut.G.n3}static SE(){const t=Ut.Ui.n0,e=Ut.Ui.n1/100,i=Ut.Ui.n2/100;let n,s,o;const r=(1-Math.abs(2*i-1))*e,a=t/60,l=r*(1-Math.abs(a%2-1));a>=0&&a<1?(n=r,s=l,o=0):a>=1&&a<2?(n=l,s=r,o=0):a>=2&&a<3?(n=0,s=r,o=l):a>=3&&a<4?(n=0,s=l,o=r):a>=4&&a<5?(n=l,s=0,o=r):a>=5&&a<6&&(n=r,s=0,o=l);const h=i-.5*r;n+=h,s+=h,o+=h,Ut.G.n0=Math.round(255*n),Ut.G.n1=Math.round(255*s),Ut.G.n2=Math.round(255*o),Ut.G.n3=Ut.Ui.n3}static tv(){Ut.MA(),Ut.nv()}static iv(){Ut.ov(),Ut.NA()}static M2(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}static N2(t){return t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055}static MA(){const t=Ut.M2(Ut.G.n0),e=Ut.M2(Ut.G.n1),i=Ut.M2(Ut.G.n2);Ut.vt.n0=.4124564*t+.3575761*e+.1804375*i,Ut.vt.n1=.2126729*t+.7151522*e+.072175*i,Ut.vt.n2=.0193339*t+.119192*e+.9503041*i,Ut.vt.n3=Ut.G.n3}static NA(){const t=3.2404542*Ut.vt.n0+-1.5371385*Ut.vt.n1+-.4985314*Ut.vt.n2,e=-.969266*Ut.vt.n0+1.8760108*Ut.vt.n1+.041556*Ut.vt.n2,i=.0556434*Ut.vt.n0+-.2040259*Ut.vt.n1+1.0572252*Ut.vt.n2;Ut.G.n0=255*Ut.N2(t),Ut.G.n1=255*Ut.N2(e),Ut.G.n2=255*Ut.N2(i),Ut.G.n3=Ut.vt.n3,Ut.G.n0=Math.round(Ut.G.n0),Ut.G.n0>255?Ut.G.n0=255:Ut.G.n0<0&&(Ut.G.n0=0),Ut.G.n1=Math.round(Ut.G.n1),Ut.G.n1>255?Ut.G.n1=255:Ut.G.n1<0&&(Ut.G.n1=0),Ut.G.n2=Math.round(Ut.G.n2),Ut.G.n2>255?Ut.G.n2=255:Ut.G.n2<0&&(Ut.G.n2=0)}static C2=216/24389;static Gb=24389/27;static ld=[95.047,100,108.883];static L2(t){return t>Ut.C2?Math.pow(t,1/3):(Ut.Gb*t+16)/116}static nv(){const t=Ut.L2(100*Ut.vt.n0/Ut.ld[0]),e=Ut.L2(100*Ut.vt.n1/Ut.ld[1]),i=Ut.L2(100*Ut.vt.n2/Ut.ld[2]);Ut.ro.n0=116*e-16,Ut.ro.n1=500*(t-e),Ut.ro.n2=200*(e-i),Ut.ro.n3=Ut.vt.n3}static CA(t){const e=t*t*t;return e>Ut.C2?e:(116*t-16)/Ut.Gb}static ov(){const t=(Ut.ro.n0+16)/116,e=Ut.ro.n1/500+t,i=t-Ut.ro.n2/200;Ut.vt.n0=Ut.ld[0]/100*Ut.CA(e),Ut.vt.n1=Ut.ld[1]/100*(Ut.ro.n0>Ut.Gb*Ut.C2?Math.pow(t,3):Ut.ro.n0/Ut.Gb),Ut.vt.n2=Ut.ld[2]/100*Ut.CA(i),Ut.vt.n3=Ut.ro.n3}static rv(){let t=.8190224*Ut.vt.n0+.3619062*Ut.vt.n1+-.1288737*Ut.vt.n2,e=.03298366*Ut.vt.n0+.9292868*Ut.vt.n1+.03614466*Ut.vt.n2,i=.04817719*Ut.vt.n0+.2642395*Ut.vt.n1+.6335478*Ut.vt.n2;t=Math.cbrt(t),e=Math.cbrt(e),i=Math.cbrt(i),Ut.ui.n0=.2104542*t+.7936177*e+-.004072046*i,Ut.ui.n1=1.977998*t+-2.428592*e+.4505937*i,Ut.ui.n2=.02590403*t+.7827717*e+-.8086757*i,Ut.ui.n3=Ut.vt.n3,Ut.ui.n0*=100}static lv(){Ut.ui.n0/=100;let t=.9999999*Ut.ui.n0+.3963377*Ut.ui.n1+.2158037*Ut.ui.n2,e=1.000000009*Ut.ui.n0+-.1055613*Ut.ui.n1+-.06385417*Ut.ui.n2,i=1.00000005*Ut.ui.n0+-.08948418*Ut.ui.n1+-1.291485*Ut.ui.n2;t=t**3,e=e**3,i=i**3,Ut.vt.n0=1.2268798*t+-.5578149*e+.281391*i,Ut.vt.n1=-.04057576*t+1.112286*e+-.07171106*i,Ut.vt.n2=-.07637294*t+-.4214933*e+1.586924*i,Ut.vt.n3=Ut.ui.n3}static hv(){const t=180*Math.atan2(Ut.ui.n2,Ut.ui.n1)/Math.PI;Ut.lo.n0=Ut.ui.n0,Ut.lo.n1=Math.sqrt(Ut.ui.n1**2+Ut.ui.n2**2),Ut.lo.n2=t>=0?t:t+360,Ut.lo.n3=Ut.ui.n3}static av(){Ut.ui.n0=Ut.lo.n0,Ut.ui.n1=Ut.lo.n1*Math.cos(Ut.lo.n2*Math.PI/180),Ut.ui.n2=Ut.lo.n1*Math.sin(Ut.lo.n2*Math.PI/180),Ut.ui.n3=Ut.lo.n3}static ev(){Ut.MA(),Ut.rv(),Ut.hv()}static sv(){Ut.av(),Ut.lv(),Ut.NA()}static nd(t,i){"string"==typeof t||t instanceof Ut||e.o("Value for "+i+" must be a color string or a Brush, not "+t)}static Solid=1;static Linear=2;static Radial=3;static Pattern=4;static Lab=1;static HSL=2;static nl=(()=>bt.isUsingDOM()?new Bt(null,void 0,{willReadFrequently:!0}).ci:null)();static G=(()=>new jt)();static Ui=(()=>new jt)();static vt=(()=>new jt)();static ro=(()=>new jt)();static ui=(()=>new jt)();static lo=(()=>new jt)()}class Gt{Nt="Base";static os=(()=>new p)();static Pn(t,e){e.name=t,Gt.os.set(t,e)}get name(){return this.Nt}set name(t){this.Nt=t}constructor(){}get classType(){return Yt}measure(t,e,i,n,s,o,r){}measureElement(t,e,i,n,s){t.ut(e,i,n,s)}arrange(t,e,i){}arrangeElement(t,e,i,n,s,o){t.Yt(e,i,n,s,o)}remeasureObject(t){t.lf()}zi(t,e,i){}}Gt.Pn("Position",new class extends Gt{constructor(){super()}measure(t,e,i,n,s,o,r){const a=n.length,l=t.Ho();for(let h=0;h<a;h++){const t=n[h];if(!t.visible&&t!==l)continue;const a=t.margin,u=a.right+a.left,c=a.top+a.bottom;t.ut(e,i,o,r);const d=t.measuredBounds,f=Math.max(d.width+u,0),g=Math.max(d.height+c,0);let m=t.position.x,p=t.position.y;if(isFinite(m)||(m=0),isFinite(p)||(p=0),t instanceof Jt&&t.isGeometryPositioned){const e=t.strokeWidth/2;m-=e,p-=e}s.unionNoCheck(m,p,f,g)}}arrange(t,e,i){const n=e.length,s=t.padding,o=i.x-s.left,r=i.y-s.top;for(let a=0;a<n;a++){const t=e[a],i=t.measuredBounds,n=t.margin,s=t.position.x,l=t.position.y;let h=isNaN(s)?-o:s-o,u=isNaN(l)?-r:l-r;if(t instanceof Jt&&t.isGeometryPositioned){const e=t.strokeWidth/2;h-=e,u-=e}t.visible&&t.Yt(h+n.left,u+n.top,i.width,i.height)}}});Gt.Pn("Horizontal",new class extends Gt{constructor(){super()}measure(t,i,n,s,o,r,a){const l=s.length,h=e.rt(),u=t.Ho();for(let e=0;e<l;e++){const t=s[e];if(!t.visible&&t!==u)continue;const i=t.Hs(!1);if(0!==i&&5!==i){h.push(t);continue}t.ut(1/0,n,0,a);const r=t.margin,l=t.measuredBounds,c=Math.max(l.width+r.right+r.left,0),d=Math.max(l.height+r.top+r.bottom,0);o.zn(o.width+c,Math.max(o.height,d))}const c=h.length;t.desiredSize.height?n=Math.min(t.desiredSize.height,t.maxSize.height):0!==o.height&&(n=Math.min(o.height,t.maxSize.height));for(let e=0;e<c;e++){const t=h[e];if(!t.visible&&t!==u)continue;const i=t.margin,s=i.right+i.left,r=i.top+i.bottom;t.ut(1/0,n,0,a);const l=t.measuredBounds,c=Math.max(l.width+s,0),d=Math.max(l.height+r,0);o.width+=c,o.height=Math.max(o.height,d)}e.tt(h)}arrange(t,e,i){const n=e.length,s=t.padding,o=s.top,r=t.isOpposite;let a=r?i.width:s.left;for(let l=0;l<n;l++){const n=o,h=e[l];if(!h.visible)continue;const u=h.measuredBounds,c=h.margin,d=c.top+c.bottom,f=o+s.bottom;let g=u.height;const m=h.Hs(!1);(isNaN(h.desiredSize.height)&&2===m||4===m)&&(g=Math.max(i.height-d-f,0));const p=g+d+f;let y=h.alignment;y.isDefault()&&(y=t.defaultAlignment),y.isSpot()||(y=w.Center),r&&(a-=u.width+c.left+c.right),h.Yt(a+y.offsetX+c.left,n+y.offsetY+c.top+(i.height*y.y-p*y.y),u.width,g),r||(a+=u.width+c.left+c.right)}}});Gt.Pn("Vertical",new class extends Gt{constructor(){super()}measure(t,i,n,s,o,r,a){const l=s.length,h=e.rt(),u=t.Ho();for(let e=0;e<l;e++){const t=s[e];if(!t.visible&&t!==u)continue;const n=t.Hs(!1);if(0!==n&&4!==n){h.push(t);continue}t.ut(i,1/0,r,0);const a=t.margin,l=t.measuredBounds,c=Math.max(l.width+a.right+a.left,0),d=Math.max(l.height+a.top+a.bottom,0);o.zn(Math.max(o.width,c),o.height+d)}const c=h.length;t.desiredSize.width?i=Math.min(t.desiredSize.width,t.maxSize.width):0!==o.width&&(i=Math.min(o.width,t.maxSize.width));for(let e=0;e<c;e++){const t=h[e];if(!t.visible&&t!==u)continue;const n=t.margin,s=n.right+n.left,a=n.top+n.bottom;t.ut(i,1/0,r,0);const l=t.measuredBounds,c=Math.max(l.width+s,0),d=Math.max(l.height+a,0);o.width=Math.max(o.width,c),o.height+=d}e.tt(h)}arrange(t,e,i){const n=e.length,s=t.padding,o=s.left,r=t.isOpposite;let a=r?i.height:s.top;for(let l=0;l<n;l++){const n=o,h=e[l];if(!h.visible)continue;const u=h.measuredBounds,c=h.margin,d=c.left+c.right,f=o+s.right;let g=u.width;const m=h.Hs(!1);(isNaN(h.desiredSize.width)&&2===m||5===m)&&(g=Math.max(i.width-d-f,0));const p=g+d+f;let y=h.alignment;y.isDefault()&&(y=t.defaultAlignment),y.isSpot()||(y=w.Center),r&&(a-=u.height+c.bottom+c.top),h.Yt(n+y.offsetX+c.left+(i.width*y.x-p*y.x),a+y.offsetY+c.top,g,u.height),r||(a+=u.height+c.bottom+c.top)}}});class Kt extends Gt{constructor(){super()}static LA=!1;measure(t,i,n,s,o,r,a){const l=s.length;if(0===l)return;const h=t.findMainElement();let u=h.margin,c=0,d=0;const f=u.right+u.left,g=u.top+u.bottom;h.ut(i,n,r,a);let m=h.measuredBounds,p=m.width,x=m.height,v=Math.max(p+f,0),k=Math.max(x+g,0);const S=t.isClipping;S&&0!==h.k0()&&!Kt.LA&&(Kt.LA=!0,e.li("Main Shape for Spot Panel with isClipping = true must have a zero strokeWidth: "+t.toString()));const P=b.X(-u.left,-u.top,v,k);let M=b.X(0,0,p,x);this.A2(h,M,!0),p=M.width,x=M.height;let C=!0;const N=t.Ho();let T;for(let e=0;e<l;e++){const r=s[e];let a=i,l=n;if(r===h||!r.visible&&r!==N)continue;u=r.margin;let f=u.left,g=u.top;switch(c=u.right+u.left,d=u.top+u.bottom,T=r.Hs(!1),T){case 2:a=p,l=x,c=0,d=0,f=0,g=0;break;case 5:a=p,c=0,f=0;break;case 4:l=x,d=0,g=0}r.ut(a,l,0,0),m=r.measuredBounds,v=Math.max(m.width+c,0),k=Math.max(m.height+d,0);let b=r.alignment;b.isDefault()&&(b=t.defaultAlignment),b.isSpot()||(b=w.Center);let S=r.alignmentFocus;S.isDefault()&&(S=w.Center);let P=null;r instanceof Yt&&""!==r.ho&&(P=r.findObject(r.ho),P===r&&(P=null));let L=M.x-f,A=M.y-g;if(null!==P){r.Yt(0,0,m.width,m.height);const t=P.actualBounds,e=y.X(t.x+(S.x*t.width-S.offsetX),t.y+(S.y*t.height-S.offsetY));for(P=P.panel;P!==r;)P.F.xt(e),P=P.panel;L+=b.x*p+b.offsetX-e.x,A+=b.y*x+b.offsetY-e.y,y.e(e)}else L+=b.x*p+b.offsetX-(S.x*m.width+S.offsetX),A+=b.y*x+b.offsetY-(S.y*m.height+S.offsetY);C?(C=!1,o.i(L,A,v,k)):o.unionNoCheck(L,A,v,k)}switch(C?o.a(P):S?o.intersect(M.x,M.y,M.width,M.height):o.unionNoCheck(P.x,P.y,P.width,P.height),b.e(P),b.e(M),T=h.stretch,1===T&&(T=h.Hs(!1)),T){case 0:return;case 2:if(!isFinite(i)&&!isFinite(n))return;break;case 5:if(!isFinite(i))return;break;case 4:if(!isFinite(n))return}m=h.measuredBounds,p=m.width,x=m.height,v=Math.max(p+f,0),k=Math.max(x+g,0),u=h.margin,M=b.X(-u.left,-u.top,v,k),this.A2(h,M,!0),p=M.width,x=M.height;for(let e=0;e<l;e++){const i=s[e];if(i===h||!i.visible&&i!==N)continue;u=i.margin,c=u.right+u.left,d=u.top+u.bottom,m=i.measuredBounds,v=Math.max(m.width+c,0),k=Math.max(m.height+d,0);let n=i.alignment;n.isDefault()&&(n=t.defaultAlignment),n.isSpot()||(n=w.Center);let r=i.alignmentFocus;r.isDefault()&&(r=w.Center),C?(C=!1,o.i(n.x*p+n.offsetX-(r.x*m.width+r.offsetX)-u.left,n.y*x+n.offsetY-(r.y*m.height+r.offsetY)-u.top,v,k)):o.unionNoCheck(n.x*p+n.offsetX-(r.x*m.width+r.offsetX)-u.left,n.y*x+n.offsetY-(r.y*m.height+r.offsetY)-u.top,v,k)}C?o.a(P):S?o.intersect(M.x,M.y,M.width,M.height):o.unionNoCheck(P.x,P.y,P.width,P.height),b.e(M)}arrange(t,e,i){const n=e.length;if(0===n)return;const s=t.findMainElement(),o=s.measuredBounds,r=o.width,a=o.height,l=t.padding,h=l.left,u=l.top;let c=h-i.x,d=u-i.y;s.Yt(c,d,r,a);const f=b.X(0,0,r,a);this.A2(s,f,!1);for(let g=0;g<n;g++){const n=e[g];if(n===s)continue;const o=n.measuredBounds,r=o.width,a=o.height;let l=n.alignment;l.isDefault()&&(l=t.defaultAlignment),l.isSpot()||(l=w.Center);let m=n.alignmentFocus;m.isDefault()&&(m=w.Center);let p=null;if(n instanceof Yt&&""!==n.ho&&(p=n.findObject(n.ho),p===n&&(p=null)),null!==p){const t=p.actualBounds,e=y.X(t.x+(m.x*t.width-m.offsetX),t.y+(m.y*t.height-m.offsetY));for(p=p.panel;p!==n;)p.F.xt(e),p=p.panel;c=l.x*f.width+l.offsetX-e.x,d=l.y*f.height+l.offsetY-e.y,y.e(e)}else c=l.x*f.width+l.offsetX-(m.x*r+m.offsetX),d=l.y*f.height+l.offsetY-(m.y*a+m.offsetY);c+=f.x-i.x,d+=f.y-i.y,n.visible&&n.Yt(h+c,u+d,r,a)}b.e(f)}A2(t,e,i){let n=null;if(t instanceof Yt&&""!==t.ho&&(n=t.findObject(t.ho),n===t&&(n=null)),null!==n)for(i&&t.Yt(0,0,e.width,e.height),e.a(n.actualBounds),n=n.panel;n!==t;)n.F.Ug(e),n=n.panel}}Gt.Pn("Spot",new Kt);Gt.Pn("Auto",new class extends Gt{constructor(){super()}measure(t,e,i,n,s,o,r){const a=n.length;if(0===a)return;const l=t.findMainElement();let h=l.margin,u=e,c=i;const d=h.right+h.left,f=h.top+h.bottom;l.ut(e,i,o,r);let g=l.measuredBounds,m=0,p=null;l instanceof Jt&&(p=l,m=p.strokeWidth*p.scale);let y=Math.max(g.width+d,0),b=Math.max(g.height+f,0),v=t.T2(l);const w=v.x*y+v.offsetX,k=v.y*b+v.offsetY;let S=t.D2(l);const P=S.x*y+S.offsetX,M=S.y*b+S.offsetY;isFinite(e)&&(u=Math.max(Math.abs(w-P)-m,0)),isFinite(i)&&(c=Math.max(Math.abs(k-M)-m,0));let C=0,N=0;o>0&&(C=Math.max(Math.abs(v.x*o+v.offsetX-(S.x*o+S.offsetX))-m,0)),r>0&&(N=Math.max(Math.abs(v.y*r+v.offsetY-(S.y*r+S.offsetY))-m,0));const T=x.l();T.i(0,0);const L=t.Ho();for(let x=0;x<a;x++){const t=n[x];if(t===l||!t.visible&&t!==L)continue;h=t.margin;const e=h.right+h.left,i=h.top+h.bottom;t.ut(u,c,C,N),g=t.measuredBounds,y=Math.max(g.width+e,0),b=Math.max(g.height+i,0),T.i(Math.max(y,T.width),Math.max(b,T.height))}if(1===a)return g=l.measuredBounds,s.width=y,s.height=b,void x.e(T);v=t.T2(l),S=t.D2(l);let A=0,D=0;S.x!==v.x&&S.y!==v.y&&(A=T.width/Math.abs(S.x-v.x),D=T.height/Math.abs(S.y-v.y)),x.e(T),m=0,null!==p&&(m=p.strokeWidth*p.scale,6===p.eS()&&(A=D=Math.max(A,D))),A+=Math.abs(v.offsetX)+Math.abs(S.offsetX)+m,D+=Math.abs(v.offsetY)+Math.abs(S.offsetY)+m;let F=l.stretch;switch(1===F&&(F=l.Hs(!1)),F){case 0:o=0,r=0;break;case 2:isFinite(e)&&(A=e),isFinite(i)&&(D=i);break;case 5:isFinite(e)&&(A=e),r=0;break;case 4:o=0,isFinite(i)&&(D=i)}l.lf(),l.ut(A,D,o,r),s.width=l.measuredBounds.width+d,s.height=l.measuredBounds.height+f}arrange(t,e,i){const n=e.length;if(0===n)return;const s=t.findMainElement(),o=s.measuredBounds,r=b.l();r.i(0,0,1,1);let a=s.margin;const l=a.left,h=a.top,u=t.padding,c=u.left,d=u.top;let f=l,g=h,m=o.width,p=o.height;s.Yt(c+f,d+g,m,p);const y=t.T2(s),x=t.D2(s),v=0+y.x*o.width+y.offsetX,k=0+y.y*o.height+y.offsetY,S=0+x.x*o.width+x.offsetX,P=0+x.y*o.height+x.offsetY;r.x=v,r.y=k,r.unionNoCheck(S,P,0,0),r.x+=l+c,r.y+=h+d;for(let M=0;M<n;M++){const i=e[M];if(i===s)continue;const n=i.measuredBounds;a=i.margin;const o=Math.max(n.width+a.right+a.left,0),l=Math.max(n.height+a.top+a.bottom,0);let h=i.alignment;h.isDefault()&&(h=t.defaultAlignment),h.isSpot()||(h=w.Center),f=r.width*h.x+h.offsetX-o*h.x+a.left+r.x,g=r.height*h.y+h.offsetY-l*h.y+a.top+r.y,m=r.width,p=r.height,i.visible&&(b.contains(r.x,r.y,r.width,r.height,f,g,n.width,n.height)?i.Yt(f,g,n.width,n.height):i.Yt(f,g,n.width,n.height,new b(r.x,r.y,r.width,r.height)))}b.e(r)}});Gt.Pn("Table",new class extends Gt{constructor(){super(),this.name="Table"}measure(t,i,n,s,o,r,a){let l=s.length;const h=e.rt(),u=e.rt();for(let e=0;e<l;e++){const t=s[e],i=t instanceof Yt?t:null;if(null!==i&&i.el()&&t.visible){u.push(i);const e=i.T.r,n=e.length;for(let s=0;s<n;s++){const n=e[s];i.type===Yt.TableRow?n.row=t.row:i.type===Yt.TableColumn&&(n.column=t.column),h.push(n)}}else h.push(t)}l=h.length,0===l&&(t.getRowDefinition(0),t.getColumnDefinition(0));const c=[];for(let e=0;e<l;e++){const t=h[e];t.visible&&(t.me(!0),t.no(!0),c[t.row]||(c[t.row]=[]),c[t.row][t.column]||(c[t.row][t.column]=[]),c[t.row][t.column].push(t))}e.tt(h);const d=e.rt(),f=e.rt(),g=e.rt(),m={count:0},p={count:0};let y=i,b=n;const v=t.Ge,w=t.He;let k=null;l=v.length;for(let e=0;e<l;e++)k=v[e],void 0!==k&&(k.actual=0,k.Fi=0);l=w.length;for(let e=0;e<l;e++)k=w[e],void 0!==k&&(k.actual=0,k.Fi=0);let S=c.length,P=0;for(let e=0;e<S;e++)c[e]&&(P=Math.max(P,c[e].length));const M=Math.min(t.topIndex,S-1),C=Math.min(t.leftIndex,P-1);let N,T=0;S=c.length;const L=t.Ho();for(let e=0;e<S;e++){if(!c[e])continue;P=c[e].length;const i=t.getRowDefinition(e);i.actual=0,i.Fi=0;for(let n=0;n<P;n++){if(!c[e][n])continue;const s=t.getColumnDefinition(n);void 0===d[n]&&(s.actual=0,s.Fi=0,d[n]=!0);const o=c[e][n],r=o.length;for(let a=0;a<r;a++){const r=o[a];if(!r.visible&&r!==L)continue;const l=r.rowSpan>1,h=r.columnSpan>1;(l||h)&&!(e<M)&&!(n<C)&&f.push(r);const u=r.margin,c=u.right+u.left,d=u.top+u.bottom;N=r.L0(i,s,!1);const x=r.desiredSize,v=!isNaN(x.width),w=!isNaN(x.height);if(0!==N&&!(v&&w)&&!(e<M)&&!(n<C)&&(!h&&void 0===m[n]&&(2===N||5===N)&&(m[n]=-1,m.count++),!l&&void 0===p[e]&&(2===N||4===N)&&(p[e]=-1,p.count++),!l&&!h&&g.push(r)),r.ut(1/0,1/0,0,0),e<M||n<C)continue;const S=r.measuredBounds,P=Math.max(S.width+c,0),A=Math.max(S.height+d,0);if(1===r.rowSpan&&(0===N||5===N)){k=t.getRowDefinition(e);const i=k.computeEffectiveSpacing(),n=0===k.st;T=Math.max(A-k.actual,0),T+(n?i:0)>b&&(T=Math.max(b-i,0)),k.Fi=k.Fi+T,k.actual=k.st+T,b=Math.max(b-(T+(n?i:0)),0)}if(1===r.columnSpan&&(0===N||4===N)){k=t.getColumnDefinition(n);const e=k.computeEffectiveSpacing(),i=0===k.st;T=Math.max(P-k.actual,0),T+(i?e:0)>y&&(T=Math.max(y-e,0)),k.Fi=k.Fi+T,k.actual=k.st+T,y=Math.max(y-(T+(i?e:0)),0)}(l||h)&&r.lf()}}}e.tt(d);let A=0,D=0;l=t.columnCount;for(let e=0;e<l;e++){const t=w[e];void 0!==t&&(A+=isNaN(t.pe)?t.Fi:t.pe,0!==t.Fi&&(A+=t.computeEffectiveSpacing()))}l=t.rowCount;for(let e=0;e<l;e++){const t=v[e];void 0!==t&&(D+=isNaN(t.pe)?t.Fi:t.pe,0!==t.Fi&&(D+=t.computeEffectiveSpacing()))}y=Math.max(i-A,0),b=Math.max(n-D,0);let F=b,O=y;l=g.length;for(let e=0;e<l;e++){const i=g[e],n=t.getRowDefinition(i.row),s=t.getColumnDefinition(i.column),o=i.measuredBounds,r=i.margin,a=r.right+r.left,l=r.top+r.bottom;0===s.Fi&&void 0!==m[i.column]?m[i.column]=Math.max(o.width+a,m[i.column]):m[i.column]=null,0===n.Fi&&void 0!==p[i.row]?p[i.row]=Math.max(o.height+l,p[i.row]):p[i.row]=null}let R,E=0,B=0;for(R in p)"count"!==R&&(E+=p[R]);for(R in m)"count"!==R&&(B+=m[R]);const I=x.l();for(let e=0;e<l;e++){const i=g[e];if(!i.visible&&i!==L)continue;const n=t.getRowDefinition(i.row),s=t.getColumnDefinition(i.column);let o=0;isFinite(s.width)?o=s.width:(o=isFinite(y)&&null!==m[i.column]?0===B?s.actual+y:m[i.column]/B*O:null!==m[i.column]?y:s.actual||y,o=Math.max(0,o-s.computeEffectiveSpacing()));let r=0;switch(isFinite(n.height)?r=n.height:(r=isFinite(b)&&null!==p[i.row]?0===E?n.actual+b:p[i.row]/E*F:null!==p[i.row]?b:n.actual||b,r=Math.max(0,r-n.computeEffectiveSpacing())),I.i(Math.max(s.minimum,Math.min(o,s.maximum)),Math.max(n.minimum,Math.min(r,n.maximum))),N=i.L0(n,s,!1),N){case 5:I.height=Math.max(I.height,n.actual+b);break;case 4:I.width=Math.max(I.width,s.actual+y)}const a=i.margin,l=a.right+a.left,h=a.top+a.bottom;i.lf();let u=s.minimum,c=n.minimum;const d=i.measuredBounds;0===d.width&&null!==m[i.column]&&(u=Math.max(u,m[i.column])),0===d.height&&null!==p[i.row]&&(c=Math.max(u,p[i.row])),i.ut(I.width,I.height,u,c);const f=i.measuredBounds;let x=Math.max(f.width+l,0),v=Math.max(f.height+h,0);isFinite(y)&&(x=Math.min(x,I.width)),isFinite(b)&&(v=Math.min(v,I.height));let w=0;w=n.actual,n.actual=Math.max(n.actual,v),n.Fi=Math.max(n.Fi,v),T=n.actual-w,b=Math.max(b-T,0),null===p[i.row]&&(F=Math.max(F-T,0)),w=s.actual,s.actual=Math.max(s.actual,x),s.Fi=Math.max(s.Fi,x),T=s.actual-w,y=Math.max(y-T,0),null===m[i.column]&&(O=Math.max(O-T,0))}e.tt(g);const z=x.l(),V=e.rt(),j=e.rt();if(l=f.length,0!==l)for(let e=0;e<S;e++){if(!c[e])continue;P=c[e].length;const i=t.getRowDefinition(e);V[e]=i.actual;for(let n=0;n<P;n++){if(!c[e][n])continue;const i=t.getColumnDefinition(n);j[n]=i.actual}}for(let e=0;e<l;e++){const s=f[e];if(!s.visible&&s!==L)continue;const o=t.getRowDefinition(s.row),r=t.getColumnDefinition(s.column);switch(I.i(Math.max(r.minimum,Math.min(i,r.maximum)),Math.max(o.minimum,Math.min(n,o.maximum))),N=s.L0(o,r,!1),N){case 2:0!==j[r.index]&&(I.width=Math.min(I.width,j[r.index])),0!==V[o.index]&&(I.height=Math.min(I.height,V[o.index]));break;case 5:0!==j[r.index]&&(I.width=Math.min(I.width,j[r.index]));break;case 4:0!==V[o.index]&&(I.height=Math.min(I.height,V[o.index]))}isFinite(r.width)&&(I.width=r.width),isFinite(o.height)&&(I.height=o.height),z.i(0,0);let a=r.minimum,l=o.minimum;for(let e=1;e<s.rowSpan&&!(s.row+e>=t.rowCount);e++)k=t.getRowDefinition(s.row+e),T=0,T=2===N||4===N?Math.max(k.minimum,0===V[s.row+e]?k.maximum:Math.min(V[s.row+e],k.maximum)):Math.max(k.minimum,isNaN(k.pe)?k.maximum:Math.min(k.pe,k.maximum)),z.height+=T,l+=k.minimum;for(let e=1;e<s.columnSpan&&!(s.column+e>=t.columnCount);e++)k=t.getColumnDefinition(s.column+e),T=0,T=2===N||5===N?Math.max(k.minimum,0===j[s.column+e]?k.maximum:Math.min(j[s.column+e],k.maximum)):Math.max(k.minimum,isNaN(k.pe)?k.maximum:Math.min(k.pe,k.maximum)),z.width+=T,a+=k.minimum;I.width+=z.width,I.height+=z.height;const h=s.margin,u=h.right+h.left,c=h.top+h.bottom;s.ut(I.width,I.height,a,l);const d=s.measuredBounds,g=Math.max(d.width+u,0),m=Math.max(d.height+c,0);let p=0;for(let e=0;e<s.rowSpan&&!(s.row+e>=t.rowCount);e++)k=t.getRowDefinition(s.row+e),p+=k.total||0;if(p<m){let e=m-p;const i=m-p;if(null!==s.spanAllocation){const n=s.spanAllocation;for(let o=0;o<s.rowSpan&&!(e<=0||s.row+o>=t.rowCount);o++){k=t.getRowDefinition(s.row+o);const r=k.st||0,a=n(s,k,i);k.actual=Math.min(k.maximum,r+a),k.st!==r&&(e-=k.st-r)}}for(;e>0;){const i=k.st||0;if(isNaN(k.height)&&k.maximum>i&&(k.actual=Math.min(k.maximum,i+e),k.st!==i&&(e-=k.st-i)),0===k.index)break;k=t.getRowDefinition(k.index-1)}}let y=0;for(let e=0;e<s.columnSpan&&!(s.column+e>=t.columnCount);e++)k=t.getColumnDefinition(s.column+e),y+=k.total||0;if(y<g){let e=g-y;const i=g-y;if(null!==s.spanAllocation){const n=s.spanAllocation;for(let o=0;o<s.columnSpan&&!(e<=0||s.column+o>=t.columnCount);o++){k=t.getColumnDefinition(s.column+o);const r=k.st||0,a=n(s,k,i);k.actual=Math.min(k.maximum,r+a),k.st!==r&&(e-=k.st-r)}}for(;e>0;){const i=k.st||0;if(isNaN(k.width)&&k.maximum>i&&(k.actual=Math.min(k.maximum,i+e),k.st!==i&&(e-=k.st-i)),0===k.index)break;k=t.getColumnDefinition(k.index-1)}}}e.tt(f),x.e(z),x.e(I),void 0!==V&&e.tt(V),void 0!==j&&e.tt(j);let U=0,G=0;const K=t.desiredSize,X=t.maxSize;N=t.Hs(!0),A=0,D=0;let Y=0,_=0;l=t.columnCount;for(let e=0;e<l;e++)if(void 0!==w[e]){if(k=t.getColumnDefinition(e),isFinite(k.width)){Y+=k.width,Y+=k.computeEffectiveSpacing();continue}if(2===k.Hb()){Y+=k.st,Y+=k.computeEffectiveSpacing();continue}0!==k.st&&(A+=k.st,A+=k.computeEffectiveSpacing())}U=isFinite(K.width)?Math.min(K.width,X.width):0!==N&&isFinite(i)?i:A,U=Math.max(U,isFinite(i)?Math.min(r,i):r),U=Math.max(U-Y,0);const H=0===A?1:Math.max(U/A,1);for(let e=0;e<l;e++)void 0!==w[e]&&(k=t.getColumnDefinition(e),!isFinite(k.width)&&2!==k.Hb()&&(k.actual=k.st*H),k.position=o.width,0!==k.st&&(o.width+=k.st,o.width+=k.computeEffectiveSpacing()));l=t.rowCount;for(let e=0;e<l;e++)if(void 0!==v[e]){if(k=t.getRowDefinition(e),isFinite(k.height)){_+=k.height,_+=k.computeEffectiveSpacing();continue}if(2===k.Hb()){_+=k.st,_+=k.computeEffectiveSpacing();continue}0!==k.st&&(D+=k.st,D+=k.computeEffectiveSpacing())}G=isFinite(K.height)?Math.min(K.height,X.height):0!==N&&isFinite(n)?n:D,G=Math.max(G,isFinite(n)?Math.min(a,n):a),G=Math.max(G-_,0);const q=0===D?1:Math.max(G/D,1);for(let e=0;e<l;e++)void 0!==v[e]&&(k=t.getRowDefinition(e),!isFinite(k.height)&&2!==k.Hb()&&(k.actual=k.st*q),k.position=o.height,0!==k.st&&(o.height+=k.st,o.height+=k.computeEffectiveSpacing()));l=u.length;for(let e=0;e<l;e++){const i=u[e];let n=0,s=0;i.type===Yt.TableRow?(n=o.width,k=t.getRowDefinition(i.row),s=k.actual):(k=t.getColumnDefinition(i.column),n=k.actual,s=o.height),i.measuredBounds.i(0,0,n,s),i.me(!1)}e.tt(u),t.kh=c}arrange(t,e,i){const n=e.length,s=t.padding,o=s.left,r=s.top,a=t.kh;if(null===a)return;let l=0,h=0;const u=a.length;let c=0;for(let x=0;x<u;x++)a[x]&&(c=Math.max(c,a[x].length));const d=t.Ge,f=t.He;let g=0,m=0,p=Math.min(t.topIndex,u-1);if(d.length>0){for(;p!==u&&(void 0===d[p]||0===d[p].st);)p++;p=Math.max(Math.min(p,u-1),0),g=-d[p].position}let y=Math.min(t.leftIndex,c-1);if(f.length>0){for(;y!==c&&(void 0===f[y]||0===f[y].st);)y++;y=Math.max(Math.min(y,c-1),0),m=-f[y].position}let v=0,k=0;for(;v!==u&&void 0===d[v];)v++;for(;k!==u&&void 0===f[k];)k++;const S=t.part;let P=t.getRowDefinition(v),M=t.getColumnDefinition(k);for(let x=0;x<e.length;x++){const i=e[x];if(!(i instanceof Yt&&i.visible&&i.el()))continue;i.type===Yt.TableRow?(P=t.getRowDefinition(i.row),M=t.getColumnDefinition(k)):(P=t.getRowDefinition(v),M=t.getColumnDefinition(i.column)),h=P.position+g+r,0!==P.st&&(h+=P.computeEffectiveSpacingTop(Math.max(v,p))),l=M.position+m+o,0!==M.st&&(l+=M.computeEffectiveSpacingTop(Math.max(k,y)));const n=i.measuredBounds;i.sf(),i.actualBounds.At();const s=i.actualBounds,a=b.X(s.x,s.y,s.width,s.height);(s.x=i.type===Yt.TableRow?o:l,s.y=i.type===Yt.TableColumn?r:h,s.width=n.width,s.height=n.height,i.actualBounds.u(),i.no(!1),a.equalsApproxClose(s))?b.e(a):(null!==S&&(S.yh(),i.S0(S)),b.e(a))}const C=x.l();for(let x=0;x<u;x++){if(!a[x])continue;c=a[x].length;const e=t.getRowDefinition(x);h=e.position+g+r,0!==e.st&&(h+=e.computeEffectiveSpacingTop(Math.max(v,p)));for(let n=0;n<c;n++){if(!a[x][n])continue;const s=t.getColumnDefinition(n);l=s.position+m+o,0!==s.st&&(l+=s.computeEffectiveSpacingTop(Math.max(k,y)));const r=a[x][n],u=r.length;for(let o=0;o<u;o++){const a=r[o],u=a.measuredBounds;C.i(0,0);for(let e=1;e<a.rowSpan&&!(x+e>=t.rowCount);e++){const i=t.getRowDefinition(x+e);0!==i.st&&(C.height+=i.total)}for(let e=1;e<a.columnSpan&&!(n+e>=t.columnCount);e++){const i=t.getColumnDefinition(n+e);0!==i.st&&(C.width+=i.total)}const c=s.st+C.width,d=e.st+C.height;let f=l,g=h;const m=c,p=d,y=l,v=h;let k=c,S=d;l+c>i.width&&(k=Math.max(i.width-l,0)),h+d>i.height&&(S=Math.max(i.height-h,0));let P=a.alignment,M=0,N=0,T=0,L=0;if(P.isDefault()){P=t.defaultAlignment,P.isSpot()||(P=w.Center),M=P.x,N=P.y,T=P.offsetX,L=P.offsetY;const i=s.alignment,n=e.alignment;i.isSpot()&&(M=i.x,T=i.offsetX),n.isSpot()&&(N=n.y,L=n.offsetY)}else M=P.x,N=P.y,T=P.offsetX,L=P.offsetY;(isNaN(M)||isNaN(N))&&(M=.5,N=.5,T=0,L=0);let A=u.width,D=u.height;const F=a.margin,O=F.left+F.right,R=F.top+F.bottom,E=a.L0(e,s,!1);isNaN(a.desiredSize.width)&&(2===E||5===E)&&(A=Math.max(c-O,0)),isNaN(a.desiredSize.height)&&(2===E||4===E)&&(D=Math.max(d-R,0));const B=a.maxSize,I=a.minSize;A=Math.min(B.width,A),D=Math.min(B.height,D),A=Math.max(I.width,A),D=Math.max(I.height,D);const z=D+R;f+=m*M-(A+O)*M+T+F.left,g+=p*N-z*N+L+F.top,a.visible&&(b.contains(y,v,k,S,f,g,u.width,u.height)?a.Yt(f,g,A,D):a.Yt(f,g,A,D,new b(y,v,k,S)))}}}x.e(C);for(let x=0;x<n;x++){const t=e[x],i=t instanceof Yt?t:null;if(null!==i&&i.el()){const e=t.actualBounds;t.naturalBounds.At(),t.naturalBounds.i(0,0,e.width,e.height),t.naturalBounds.u()}}}});Gt.Pn("TableRow",new class extends Gt{constructor(){super()}measure(t,e,i,n,s,o,r){}arrange(t,e,i){}});Gt.Pn("TableColumn",new class extends Gt{constructor(){super()}measure(t,e,i,n,s,o,r){}arrange(t,e,i){}});Gt.Pn("Viewbox",new class extends Gt{constructor(){super()}measure(t,i,n,s,o,r,a){1!==s.length&&e.o("Viewbox Panel must contain exactly one GraphObject.");const l=s[0];l.nt=1,l.lf(),l.ut(1/0,1/0,r,a);let h=l.measuredBounds;const u=l.margin,c=u.right+u.left,d=u.top+u.bottom;if(isFinite(i)||isFinite(n)){const e=l.scale,s=h.width,o=h.height,u=Math.max(i-c,0),f=Math.max(n-d,0);let g=1;6===t.viewboxStretch?(0!==s&&0!==o&&(g=Math.min(u/s,f/o)),0===g&&(g=1e-4),l.nt*=g):(0!==s&&0!==o&&(g=Math.max(u/s,f/o)),0===g&&(g=1e-4),l.nt*=g),e!==l.scale&&(l.me(!0),l.ut(1/0,1/0,r,a))}h=l.measuredBounds,o.width=isFinite(i)?i:Math.max(h.width+c,0),o.height=isFinite(n)?n:Math.max(h.height+d,0)}arrange(t,e,i){const n=e[0],s=n.measuredBounds,o=n.margin,r=o.right+o.left,a=o.top+o.bottom,l=Math.max(s.width+r,0),h=Math.max(s.height+a,0);let u=n.alignment;u.isDefault()&&(u=t.defaultAlignment),u.isSpot()||(u=w.Center),n.Yt(i.width*u.x-l*u.x+u.offsetX,i.height*u.y-h*u.y+u.offsetY,s.width,s.height)}});Gt.Pn("Grid",new class extends Gt{constructor(){super()}measure(t,e,i,n,s,o,r){null===t.bi&&(t.bi=new Ht),this.cv(t),this.fv(t)}arrange(t,e,i){}zi(t,e,i){const n=t.naturalBounds,s=n.width,o=n.height;e.save(),e.beginPath(),e.rect(0,0,s,o),e.clip(),e.endPath(),this.uv(t,e,i),e.restore(),e.clearContextCache(!1)}uv(t,e,i){let n=t.getDocumentScale()*i.scale;n<=0&&(n=1);const s=t.gridCellSize,o=s.width,r=s.height,a=t.naturalBounds,l=t.actualBounds,h=a.width,u=a.height,c=Math.ceil(h/o),d=Math.ceil(u/r),f=t.gridOrigin,g=f.x,m=f.y,p=t.bi.Q0,y=t.T.r,x=y.length;for(let b=0;b<x;b++){const i=y[b];if(!i.visible)continue;const s=i.interval||1,f=Math.abs(s);if(o*f*n<2)continue;let x=i.segmentIndex;(!isFinite(x)||isNaN(x))&&(x=0),x<0&&(x=f-Math.min(-x,f)),x=Math.round(x%f);const v=i.opacity;let w=1;if(1!==v){if(0===v)continue;w=e.globalAlpha,e.globalAlpha=w*v}const k=p[b];let S=!1;const P=i.strokeDashArray;if(null!==P&&(S=!0,e.enableDash(P,i.strokeDashOffset)),null!==i.stroke&&i.strokeWidth>0&&("LineV"===i.figure||"LineH"===i.figure)){if(e.lineWidth=i.strokeWidth,t.mn(e,i.stroke,!1,!1,a,l),e.beginPath(),"LineV"===i.figure){const t=Math.floor((g-o)/o);for(let i=t;i<=t+c;i++){const t=i*o+g;0<=t&&t<=h&&this.jb(i,s,x,k)&&(e.moveTo(t,0),e.lineTo(t,u))}}else if("LineH"===i.figure){const t=Math.floor((m-r)/r);for(let i=t;i<=t+d;i++){const t=i*r+m;0<=t&&t<=u&&this.jb(i,s,x,k)&&(e.moveTo(0,t),e.lineTo(h,t))}}e.stroke(),e.endPath()}else if(null!==i.fill)if(t.mn(e,i.fill,!0,!1,a,l),"BarV"===i.figure){let t=i.width;isNaN(t)&&(t=o);const n=Math.floor((g-o)/o);for(let i=n;i<=n+c;i++){const n=i*o+g;0<=n+t&&n<=h&&this.jb(i,s,x,k)&&e.fillRect(n,0,t,u)}}else if("BarH"===i.figure){let t=i.height;isNaN(t)&&(t=r);const n=Math.floor((m-r)/r);for(let i=n;i<=n+d;i++){const n=i*r+m;0<=n+t&&n<=u&&this.jb(i,s,x,k)&&e.fillRect(0,n,h,t)}}S&&e.disableDash(),1!==v&&(e.globalAlpha=w)}}jb(t,e,i,n){if(e<0)return t%e===i;if(t%e!==i)return!1;const s=n.length;for(let o=0;o<s;o++){if(t%n[o]===i)return!1}return!0}fv(t){const e=[],i=t.T.r,n=i.length;for(let s=0;s<n;s++){const t=i[s],o=[];if(e.push(o),!t.visible)continue;const r=t.interval;if(r<0)continue;const a=t.figure,l=this.F2(a);for(let e=0;e<n;e++){if(e===s)continue;const t=i[e];if(!t.visible)continue;const n=t.figure;if(this.F2(n)!==l)continue;const a=t.interval;a>r&&o.push(a)}}t.bi.Q0=e}F2(t){return"LineV"===t||"BarV"===t}cv(t){let e=1,i=1;const n=t.T.r,s=n.length;for(let a=0;a<s;a++){const t=n[a],s=Math.abs(t.interval);s<2||(this.F2(t.figure)?i=i*s/S.MC(i,s):e=e*s/S.MC(e,s))}const o=t.gridCellSize,r=t.bi;r.Wc.isReal()?r.Wc.i(i*o.width,e*o.height):r.Wc=new x(i*o.width,e*o.height)}});Gt.Pn("Link",new class extends Gt{constructor(){super()}measure(t,i,n,s,o,r,a){const l=s.length;if(!(t instanceof fe||t instanceof ve))return;let h=null,u=null;if(t instanceof ve&&(h=t),t instanceof fe&&(u=t,h=u.adornedPart,null===t.gf&&(t.gf=[])),!(h instanceof ve))return;const c=h;if(0===l)return t.naturalBounds.zn(0,0),void t.measuredBounds.i(0,0,0,0);const d=t instanceof fe?null:h.path,f=h.routeBounds,g=t.jo;g.i(0,0,f.width,f.height);const m=c.points,p=h.pointsCount;null!==u?u.hd(!1):null!==h&&h.hd(!1);const x=f.width,v=f.height,S=t.gf;if(S.length=0,null!==d){this.measureLinkPath(t,x,v,d);const e=d.measuredBounds;g.unionRect(e),S.push(e)}const P=k.l(),M=y.l(),C=y.l();for(let k=0;k<l;k++){const i=s[k];if(i===d)continue;let n=i.measuredBounds;if(i.isPanelMain&&i instanceof Jt){this.measureLinkPath(t,x,v,i),n=i.measuredBounds,g.unionRect(n),S.push(n);continue}if(p<2){i.ut(1/0,1/0,0,0),n=i.measuredBounds,g.unionRect(n),S.push(n);continue}const o=i.segmentIndex,r=i.segmentFraction;let a=i.alignmentFocus;a.isNoSpot()&&(a=w.Center);const l=i.segmentOrientation,h=i.segmentOffset;let u=0,N=0,T=0,L=0;if(isNaN(o)){const t=c.at,n=e.rt();t.getPointAndAngleAlongPath(r,n);const s=y.X(n[0],n[1]);L=n[2],0!==l&&(T=c.computeAngle(i,l,L),i.Ht=T,i.me(!0),i.no(!0)),u=s.x,N=s.y,y.e(s),e.tt(n)}else if(o<-p||o>=p){const t=y.l();c.AA(t),L=c.midAngle,0!==l&&(T=c.computeAngle(i,l,L),i.Ht=T,i.me(!0),i.no(!0)),u=t.x-f.x,N=t.y-f.y,y.e(t)}else{let t,e,n=0;if(o>=0?(t=m.elt(o),e=o<p-1?m.elt(o+1):t):(n=p+o,t=m.elt(n),e=n>0?m.elt(n-1):t),L=0,t.equalsApprox(e)){let i,s;o>=0?(i=o>0?m.elt(o-1):t,s=o<p-2?m.elt(o+2):e):(i=n<p-1?m.elt(n+1):t,s=n>1?m.elt(n-2):e);const r=i.distanceSquaredPoint(t),a=e.distanceSquaredPoint(s);L=r>a+10?o>=0?i.directionPoint(t):t.directionPoint(i):a>r+10?o>=0?e.directionPoint(s):s.directionPoint(e):o>=0?i.directionPoint(s):s.directionPoint(i)}else L=o>=0?t.directionPoint(e):e.directionPoint(t);0!==l&&(T=c.computeAngle(i,l,L),i.Ht=T,i.me(!0),i.no(!0)),u=t.x+(e.x-t.x)*r-f.x,N=t.y+(e.y-t.y)*r-f.y}i.ut(1/0,1/0,0,0),n=i.measuredBounds;const A=i.naturalBounds;let D=0;i instanceof Jt&&(D=i.strokeWidth);const F=A.width+D,O=A.height+D;P.Ii(),P.Es(-n.x,-n.y),P.nt(i.scale,i.scale),P.ds(0===l?i.angle:L,F/2,O/2),(22===l||26===l)&&P.ds(90,F/2,O/2),(23===l||27===l)&&P.ds(-90,F/2,O/2),28===l&&(L>45&&L<135||L>225&&L<315)&&P.ds(-L,F/2,O/2);const R=new b(0,0,F,O);M.setRectSpot(R,a),P.xt(M);const E=-M.x+D/2*i.scale,B=-M.y+D/2*i.scale;C.a(h);const I=isNaN(h.x),z=isNaN(h.y);if(I||z){const t=F/2+3,e=O/2+3,i=L>=45&&L<=135,n=L>=225&&L<=315;0===l&&(i||n)?(C.x=z?t:h.y,C.y=I?e:h.x,i?o>=0||isNaN(o)&&r<.5||I&&(C.y=-e):n&&((o>=0||isNaN(o)&&r<.5)&&I&&(C.y=-e),z&&(C.x=-t))):(I&&(o>=0||isNaN(o)&&r<.5?C.x=t:C.x=-t),z&&(C.y=-e),C.rotate(L))}else C.rotate(L);u+=C.x,N+=C.y,R.i(u+E,N+B,n.width,n.height),S.push(R),g.unionRect(R)}if(null!==h){const t=h.labelNodes;for(;t.next();)t.value.ut(1/0,1/0)}t.jo=g,t.position.i(f.x+g.x,f.y+g.y),o.zn(g.width||0,g.height||0),k.e(P),y.e(M),y.e(C)}arrange(t,e,i){const n=e.length;if(!(t instanceof fe||t instanceof ve))return;let s=t,o=null;t instanceof fe&&(o=t,s=o.adornedPart);const r=t,a=t instanceof fe?null:s.path,l=t.gf;if(0!==l.length){let t=0;if(null!==a&&t<l.length){const e=l[t];t++,a.Yt(e.x-r.jo.x,e.y-r.jo.y,e.width,e.height)}for(let i=0;i<n;i++){const n=e[i];if(n!==a&&t<l.length){const e=l[t];t++,n.Yt(e.x-r.jo.x,e.y-r.jo.y,e.width,e.height)}}}const h=s.points,u=h.count;if(u>=2&&r instanceof ve){const t=r.labelNodes;for(;t.next();){const e=t.value;r.dv(e,u,h)}}null!==o?o.hd(!1):s.hd(!1);const c=t.TA(y.l());t.location.i(t.position.x+c.x,t.position.y+c.y),y.e(c)}measureLinkPath(t,e,i,n){if(!1===n.Bo())return;let s=n.strokeWidth;if(0===s&&t instanceof fe&&t.type===Yt.Link&&t.adornedObject instanceof Jt&&(s=t.adornedObject.strokeWidth),s*=n.nt,t instanceof ve&&null!==t.at){const e=t.geometry.bounds;n.so(e.x-s/2,e.y-s/2,e.width+s,e.height+s)}else if(t instanceof fe&&null!==t.adornedPart.at){const e=t.adornedPart.at.bounds;n.so(e.x-s/2,e.y-s/2,e.width+s,e.height+s)}else n.so(-s/2,-s/2,e+s,i+s);n.gv(),n.me(!1)}});Gt.Pn("Graduated",new class extends Gt{constructor(){super()}measure(t,e,i,n,s,o,r){const a=t.findMainElement();t.je=[];const l=a.margin,h=l.right+l.left,u=l.top+l.bottom;a.ut(e,i,o,r);const c=a.measuredBounds,d=c.width,f=c.height,g=Math.max(d+h,0),m=Math.max(f+u,0),p=new b(-l.left,-l.top,g,m);t.je.push(p),s.a(p),this.determineGraduatedMarks(t,a);const y=t.Ps;if(null===y)return;const x=n.length;for(let b=0;b<x;b++){const e=n[b],i=y[b];!e.visible||e===a||0===i.length||(e instanceof Jt?this.measureGraduatedTicks(t,e,i,s):e instanceof ie&&this.measureGraduatedLabels(t,e,i,s),e.me(!1))}}arrange(t,e,i){if(null===t.je)return;const n=t.findMainElement(),s=t.Ps;if(null===s)return;const o=t.je;let r=0,a=o[r];r++,null!==n&&n.Yt(a.x-i.x,a.y-i.y,a.width,a.height);const l=e.length;for(let h=0;h<l;h++){const t=e[h],l=s[h];!t.visible||t===n||0===l.length||(a=o[r],r++,t.Yt(a.x-i.x,a.y-i.y,a.width,a.height))}t.je=null}measureGraduatedTicks(t,e,i,n){let s=e.alignmentFocus;s.isNoSpot()&&(s=w.TopCenter);const o=e.angle;e.Ht=0,e.ut(1/0,1/0,0,0),e.Ht=o;const r=e.measuredBounds,a=r.width,l=r.height,h=b.X(0,0,a,l),u=y.l();u.setRectSpot(h,s),b.e(h);const c=-u.x,d=-u.y,f=new b,g=i.length;for(let m=0;m<g;m++){const t=i[m],n=t.pt.x,s=t.pt.y,o=t.angle;for(let i=0;i<4;i++){switch(i){case 0:u.i(c,d);break;case 1:u.i(c+a,d);break;case 2:u.i(c,d+l);break;case 3:u.i(c+a,d+l)}u.rotate(o+e.angle),u.offset(n,s),0===m&&0===i?f.i(u.x,u.y,0,0):f.unionPoint(u),u.offset(-n,-s),u.rotate(-o-e.angle)}}y.e(u),null!==t.je&&t.je.push(f),n.unionNoCheck(f.x,f.y,f.width,f.height)}measureGraduatedLabels(t,e,i,n){null===t.Ne&&(t.Ne=new ie);const s=t.Ne;this.DA(e,s);let o=e.alignmentFocus;o.isNoSpot()&&(o=w.TopCenter);const r=e.segmentOrientation,a=e.segmentOffset,l=new b;let h=0,u=0,c=0,d=0,f=0;const g=i.length;for(let m=0;m<g;m++){const t=i[m];h=t.pt.x,u=t.pt.y,c=t.angle,d=e.angle,f=e.angle,0!==r&&(f=21===r||25===r?c+e.angle:c,d=ve.computeAngle(r,f)),s.Ht=d,s.text=t.text||"",s.ut(1/0,1/0,0,0);const n=s.measuredBounds,g=s.naturalBounds,p=g.width,x=g.height,v=k.l();v.Ii(),v.Es(-n.x,-n.y),v.nt(s.scale,s.scale),v.ds(f,p/2,x/2),(22===r||26===r)&&v.ds(90,p/2,x/2),(23===r||27===r)&&v.ds(-90,p/2,x/2),28===r&&(c>45&&c<135||c>225&&c<315)&&v.ds(-c,p/2,x/2);const w=b.X(0,0,p,x),S=y.l();S.setRectSpot(w,o),v.xt(S);const P=-S.x,M=-S.y,C=y.l();C.a(a),isNaN(C.x)&&(C.x=p/2+3),isNaN(C.y)&&(C.y=-(x/2+3)),C.rotate(c),h+=C.x+P,u+=C.y+M;const N=new b(h,u,n.width,n.height),T=new b(n.x,n.y,n.width,n.height),L=new b(g.x,g.y,g.width,g.height);t.labelAngle=d,t.lineCount=s.lineCount,t.lines=s.getMetrics(),t.actualBounds=N,t.measuredBounds=T,t.naturalBounds=L,0===m?l.a(N):l.unionRect(N),y.e(C),y.e(S),b.e(w),k.e(v)}null!==t.je&&t.je.push(l),n.unionNoCheck(l.x,l.y,l.width,l.height)}determineGraduatedMarks(t,i){const n=i.geometry,s=i.strokeWidth,o=n.flattenedSegments,r=n.flattenedLengths,a=n.flattenedTotalLength,l=o.length;let h=0,u=0;const c=e.rt();for(let e=0;e<l;e++){const t=o[e],i=[];h=0,u=0;const n=t.length;for(let e=0;e<n;e+=2){const n=t[e],s=t[e+1];if(0===e){h=n,u=s;continue}let o=180*Math.atan2(s-u,n-h)/Math.PI;o<0&&(o+=360),i.push(o),h=n,u=s}c.push(i)}const d=this.mv(t),f=t.T.r,g=f.length;let m,p=0,x=0,b=a;t.Ps=[];for(let e=0;e<g;e++){const l=f[e];if(m=[],!l.visible||l===i){t.Ps.push(m);continue}const h=Math.abs(l.interval),u=t.graduatedTickUnit;if(u*h*a/t.graduatedRange<2&&null===l.graduatedSkip){t.Ps.push(m);continue}let g=r[0][0],v=0,w=0;x=a*l.graduatedStart-1e-4,b=a*l.graduatedEnd+1e-4;const k=u*h;let S=t.graduatedTickBase;if(S<t.graduatedMin){let e=(t.graduatedMin-S)/k;e=e%1===0?e:Math.floor(e+1),S+=e*k}else if(S>t.graduatedMin+k){S-=Math.floor((S-t.graduatedMin)/k)*k}const P=d[e],M=S,C=1e-6*t.graduatedMax;for(let e=1;S<=t.graduatedMax+C;e++){if(this.pv(t,S-t.graduatedTickBase,P)&&(S>t.graduatedMax&&(S=t.graduatedMax),(null===l.graduatedSkip||l instanceof ie&&!l.graduatedSkip(S,l)||l instanceof Jt&&!l.graduatedSkip(S,l))&&(p=(S-t.graduatedMin)*a/t.graduatedRange,p>a&&(p=a),x<=p&&p<=b))){let t=c[v][w],e=r[v][w];for(;v<r.length;){for(;p>g&&w<r[v].length-1;)w++,t=c[v][w],e=r[v][w],g+=e;if(p<=g)break;v++,w=0,t=c[v][w],e=r[v][w],g+=e}const a=o[v],h=a[2*w],u=a[2*w+1],d=a[2*w+2],f=a[2*w+3],x=(p-(g-e))/e,b=new y(h+(d-h)*x+s/2-n.bounds.x,u+(f-u)*x+s/2-n.bounds.y);if(b.scale(i.scale,i.scale),t=this.yv(t,x,a,c[v],w),l instanceof ie){let e="";null!==l.graduatedFunction?(e=l.graduatedFunction(S,l),e=null!=e?e.toString():""):e=(+S.toFixed(2)).toString(),""!==e&&m.push({pt:b,angle:t,text:e})}else m.push({pt:b,angle:t})}S=M+e*k}t.Ps.push(m)}e.tt(c)}yv(t,e,i,n,s){if(e<.5005&&e>.4995)return t;let o=t;if(e<.5?s>0?o=n[s-1]:S.Y(i[0],i[i.length-2])&&S.Y(i[1],i[i.length-1])&&(o=n[n.length-1]):e>.5&&(s+1<n.length?o=n[s+1]:S.Y(i[0],i[i.length-2])&&S.Y(i[1],i[i.length-1])&&(o=n[0])),t!==o){let i=Math.abs(t-o);if(i>180&&(t<o?t+=360:o+=360,i=Math.abs(t-o)),e<5e-4||e>.9995)return(t+o)/2%360;if(i<10){const i=1-Math.abs(.5-e);return(t*i+o*(1-i))%360}}return t}mv(t){if(null===t.rs){const e=[],i=t.T.r,n=i.length;for(let t=0;t<n;t++){const s=i[t],o=[];if(e.push(o),!s.visible)continue;const r=s.interval;if(!(r<0))for(let e=0;e<n;e++){if(e===t)continue;const n=i[e];if(!n.visible||s.constructor!==n.constructor)continue;const a=n.interval;a>r&&o.push(a)}}t.rs=e}return t.rs}pv(t,e,i){const n=i.length;for(let s=0;s<n;s++){const n=e%(i[s]*t.graduatedTickUnit),o=1e-6*t.graduatedTickUnit;if(n<o&&n>-o)return!1}return!0}zi(t,e,i){const n=i.oa;i.oa=!0;const s=t.naturalBounds,o=s.width,r=s.height,a=e instanceof Et;e.save(),e.beginPath(),e.rect(-1,-1,o+1,r+1),e.clip(),e.endPath();const l=t.findMainElement();l.zi(e,i);let h=t.getDocumentScale()*i.scale;h<=0&&(h=1);const u=l.actualBounds,c=t.T.r,d=t.Ps,f=c.length;for(let g=0;g<f;g++){const n=c[g],s=d[g],o=s.length;if(n.visible&&n!==l&&0!==s.length)if(n instanceof Jt){if(t.graduatedTickUnit*n.interval*l.geometry.flattenedTotalLength/t.graduatedRange*h<2&&null===n.graduatedSkip)continue;const r=n.measuredBounds,c=n.strokeWidth*n.scale;let d=n.alignmentFocus;d.isNoSpot()&&(d=w.TopCenter);for(let l=0;l<o;l++){const o=s[l].pt,h=s[l].angle;this.wv(n,o,u,h,r,c,d),n.zi(e,i),a&&(t.svg.appendChild(n.svg),n.svg=null),n._r.Ii()}}else if(n instanceof ie){null===t.Ne&&(t.Ne=new ie);const r=t.Ne;this.DA(n,r),r.R2=!0;for(let l=0;l<o;l++){const o=s[l];if(o.actualBounds&&o.measuredBounds&&o.naturalBounds){r.xv(o);const s=o.actualBounds;r.Yt(s.x,s.y,s.width,s.height),this.bv(r,u,s,o.measuredBounds,o.naturalBounds),r.il=n.part,r.Gs=n.panel,r.zi(e,i),r.Gs=null,r.il=null,a&&(t.svg.appendChild(r.svg),r.svg=null)}}}}i.oa=n,e.restore(),e.clearContextCache(!0)}wv(t,e,i,n,s,o,r){const a=t._r;a.Ii(),a.Es(e.x+i.x,e.y+i.y),a.ds(n+t.angle,0,0),a.Es(-s.width*r.x+r.offsetX+o/2,-s.height*r.y+r.offsetY+o/2),a.nt(t.scale,t.scale),t.sd(!1),t.uh.set(t._r),t.wa=t.scale,t.Ca(!1)}bv(t,e,i,n,s){const o=t._r;o.Ii(),o.Es(i.x+e.x,i.y+e.y),o.Es(-n.x,-n.y),t.x0(o,s.x,s.y,s.width,s.height),t.sd(!1),t.uh.set(t._r),t.wa=t.scale,t.Ca(!1)}DA(t,e){e.kv(t)}});var Xt=(t=>(t[t.Uniform=6]="Uniform",t[t.UniformToFill=7]="UniformToFill",t))(Xt||{});class Yt extends At{$;T;ti;ad;qn;ol;ho;jo;v2;O;cd;lt;bi;ei;fd;Ph;Ws;constructor(t,i){if(super(),this.$=null,void 0===t)this.$=Yt.Position;else if("string"==typeof t){const e=Gt.os.get(t);null!==e&&(this.$=e)}else t instanceof Gt?this.$=t:t&&(this.$=Yt.Position,i=t);null===this.$&&e.o("Panel type not specified or PanelLayout not loaded: "+t),this.n|=4194304|(this.$===Yt.Grid?1048576:0),this.T=new l,this.ti=v.Bg,this.ad=w.Default,this.qn=1,this.ol=null,this.ho="",this.jo=new b(NaN,NaN,NaN,NaN),this.v2=null,this.O=null,this.cd=6,this.bi=null,this.lt=null,this.ei=null,this.fd=NaN,this.Ph=null,this.Ws=null,i&&Object.assign(this,i)}cloneProtected(t){super.cloneProtected(t),t.$=this.$,t.ti=this.ti.N(),t.ad=this.ad.N(),t.qn=this.qn,t.ho=this.ho,t.jo.a(this.jo),null!==this.O&&(t.O=this.O.copy(t)),t.cd=this.cd,null!==this.lt&&(t.lt=this.lt.copy()),null!==this.bi&&(t.bi=this.bi.copy()),t.ei=this.ei,t.fd=this.fd,t.Ph=this.Ph}Xo(t){super.Xo(t),t.T=this.T;const e=t.T.r,i=e.length;for(let n=0;n<i;n++){e[n].Gs=t}t.ol=null}copy(){const t=super.copy();if(null!==t){const e=this.T.r,i=e.length;for(let n=0;n<i;n++){const i=e[n].copy();t.Pv(i)}return t}return null}toString(){return"Panel("+this.type.name+")#"+u.us(this)}get type(){return this.$}set type(t){const e=this.$;e!==t&&(this.$=t,this.mf=this.$===Yt.Grid,this.c(),this.t("type",e,t))}get elements(){return this.T.iterator}get naturalBounds(){return this.Ki}get padding(){return this.ti}set padding(t){"number"==typeof t?(t<0&&e._(t,">= 0",Yt,"padding"),t=new v(t)):(t.left<0&&e._(t.left,">= 0",Yt,"padding:value.left"),t.right<0&&e._(t.right,">= 0",Yt,"padding:value.right"),t.top<0&&e._(t.top,">= 0",Yt,"padding:value.top"),t.bottom<0&&e._(t.bottom,">= 0",Yt,"padding:value.bottom"));const i=this.ti;i.equals(t)||(t=t.N(),this.ti=t,this.c(),this.t("padding",i,t))}get defaultAlignment(){return this.ad}set defaultAlignment(t){const e=this.ad;e.equals(t)||(t=t.N(),this.ad=t,this.c(),this.t("defaultAlignment",e,t))}get defaultStretch(){return this.qn}set defaultStretch(t){const e=this.qn;e!==t&&(this.qn=t,this.c(),this.t("defaultStretch",e,t))}get defaultSeparatorPadding(){return null!==this.O?this.O._0:v.Bg}set defaultSeparatorPadding(t){"number"==typeof t&&(t=new v(t));const e=this.defaultSeparatorPadding;e.equals(t)||(t=t.N(),null===this.O&&(this.O=new qt),this.O._0=t,this.c(),this.t("defaultSeparatorPadding",e,t))}get defaultRowSeparatorStroke(){return null!==this.O?this.O.tp:null}set defaultRowSeparatorStroke(t){const e=this.defaultRowSeparatorStroke;e!==t&&(null===t||"string"==typeof t||t instanceof Ut)&&(t instanceof Ut&&t.u(),null===this.O&&(this.O=new qt),this.O.tp=t,this.C(),this.t("defaultRowSeparatorStroke",e,t))}get defaultRowSeparatorStrokeWidth(){return null!==this.O?this.O.ip:1}set defaultRowSeparatorStrokeWidth(t){const e=this.defaultRowSeparatorStrokeWidth;e!==t&&isFinite(t)&&t>=0&&(null===this.O&&(this.O=new qt),this.O.ip=t,this.c(),this.t("defaultRowSeparatorStrokeWidth",e,t))}get defaultRowSeparatorDashArray(){return null!==this.O?this.O.ep:null}set defaultRowSeparatorDashArray(t){const i=this.defaultRowSeparatorDashArray;if(i!==t){if(null!==t&&!Array.isArray(t)&&e.te(t,"Array",Yt,"defaultRowSeparatorDashArray:value"),null!==t){const n=t.length;let s=0;for(let i=0;i<n;i++){const n=t[i];("number"!=typeof n||!(n>=0)||!isFinite(n))&&e.o("defaultRowSeparatorDashArray value "+n+" at index "+i+" must be a positive number or zero."),s+=n}if(0===s){if(null===i)return;t=null}}null===this.O&&(this.O=new qt),this.O.ep=t,this.C(),this.t("defaultRowSeparatorDashArray",i,t)}}get defaultColumnSeparatorStroke(){return null!==this.O?this.O.sp:null}set defaultColumnSeparatorStroke(t){const e=this.defaultColumnSeparatorStroke;e!==t&&(null===t||"string"==typeof t||t instanceof Ut)&&(t instanceof Ut&&t.u(),null===this.O&&(this.O=new qt),this.O.sp=t,this.C(),this.t("defaultColumnSeparatorStroke",e,t))}get defaultColumnSeparatorStrokeWidth(){return null!==this.O?this.O.np:1}set defaultColumnSeparatorStrokeWidth(t){const e=this.defaultColumnSeparatorStrokeWidth;e!==t&&isFinite(t)&&t>=0&&(null===this.O&&(this.O=new qt),this.O.np=t,this.c(),this.t("defaultColumnSeparatorStrokeWidth",e,t))}get defaultColumnSeparatorDashArray(){return null!==this.O?this.O.op:null}set defaultColumnSeparatorDashArray(t){const i=this.defaultColumnSeparatorDashArray;if(i!==t){if(null!==t&&!Array.isArray(t)&&e.te(t,"Array",Yt,"defaultColumnSeparatorDashArray:value"),null!==t){const n=t.length;let s=0;for(let i=0;i<n;i++){const n=t[i];("number"!=typeof n||!(n>=0)||!isFinite(n))&&e.o("defaultColumnSeparatorDashArray value "+n+" at index "+i+" must be a positive number or zero."),s+=n}if(0===s){if(null===i)return;t=null}}null===this.O&&(this.O=new qt),this.O.op=t,this.C(),this.t("defaultColumnSeparatorDashArray",i,t)}}get kh(){return null!==this.O?this.O.kh:null}set kh(t){null===this.O&&(this.O=new qt),this.O.kh=t}get viewboxStretch(){return this.cd}set viewboxStretch(t){const e=this.cd;e!==t&&(this.cd=t,this.c(),this.t("viewboxStretch",e,t))}get gridCellSize(){return null!==this.bi?this.bi.ud:x.uC}set gridCellSize(t){null===this.bi&&(this.bi=new Ht);const i=this.bi.ud;if(!i.equals(t)){(!t.isReal()||0===t.width||0===t.height)&&e.o("Invalid Panel.gridCellSize: "+t),this.bi.ud=t.N();const n=this.diagram;null!==n&&this===n.grid&&n.rh(),this.C(),this.t("gridCellSize",i,t)}}get gridOrigin(){return null!==this.bi?this.bi.dd:y.Lo}set gridOrigin(t){null===this.bi&&(this.bi=new Ht);const i=this.bi.dd;if(!i.equals(t)){t.isReal()||e.o("Invalid Panel.gridOrigin: "+t),this.bi.dd=t.N();const n=this.diagram;null!==n&&this===n.grid&&n.rh(),this.C(),this.t("gridOrigin",i,t)}}get graduatedMin(){return null!==this.lt?this.lt.rp:0}set graduatedMin(t){const e=this.graduatedMin;if(e!==t&&(null===this.lt&&(this.lt=new _t),this.lt.rp=t,this.c(),this.t("graduatedMin",e,t),this.tf())){const t=this.part;null!==t&&this.Na(t,"graduatedRange")}}get graduatedMax(){return null!==this.lt?this.lt.lp:100}set graduatedMax(t){const e=this.graduatedMax;if(e!==t&&(null===this.lt&&(this.lt=new _t),this.lt.lp=t,this.c(),this.t("graduatedMax",e,t),this.tf())){const t=this.part;null!==t&&this.Na(t,"graduatedRange")}}get graduatedRange(){return this.graduatedMax-this.graduatedMin}get graduatedTickUnit(){return null!==this.lt?this.lt.hp:10}set graduatedTickUnit(t){const e=this.graduatedTickUnit;e!==t&&t>0&&(null===this.lt&&(this.lt=new _t),this.lt.hp=t,this.c(),this.t("graduatedTickUnit",e,t))}get graduatedTickBase(){return null!==this.lt?this.lt.ap:0}set graduatedTickBase(t){const e=this.graduatedTickBase;e!==t&&(null===this.lt&&(this.lt=new _t),this.lt.ap=t,this.c(),this.t("graduatedTickBase",e,t))}get Ps(){return null!==this.lt?this.lt.Ps:null}set Ps(t){null!==this.lt?this.lt.Ps=t:null!==t&&(this.lt=new _t,this.lt.Ps=t)}get je(){return null!==this.lt?this.lt.je:null}set je(t){null!==this.lt?this.lt.je=t:null!==t&&(this.lt=new _t,this.lt.je=t)}get rs(){return null!==this.lt?this.lt.rs:null}set rs(t){null!==this.lt?this.lt.rs=t:null!==t&&(this.lt=new _t,this.lt.rs=t)}get Ne(){return null!==this.lt?this.lt.Ne:null}set Ne(t){null!==this.lt?this.lt.Ne=t:null!==t&&(this.lt=new _t,this.lt.Ne=t)}S0(t){super.S0(t);const e=this.T.r,i=e.length;for(let n=0;n<i;n++)e[n].S0(t)}wh(t,e){if(this.$===Yt.Grid)return t.commitTransform(),void this.$.zi(this,t,e);if(this.$===Yt.Graduated)return t.commitTransform(),void this.$.zi(this,t,e);if(this.$===Yt.Table)if(t.commitTransform(),t instanceof Et){const i=t.currentElement;t.currentElement=t.newGroup2("gojs-ts"),this.O2(t,e),t.endGroup(),t.currentElement=i}else this.O2(t,e);const i=this.isClipping&&this.$===Yt.Spot;i&&t.save();const n=this.findMainElement(),s=this.T.r,o=s.length;for(let r=0;r<o;r++){const o=s[r];i&&o===n&&(t.clipInsteadOfFill=!0),o.zi(t,e),i&&o===n&&(t.clipInsteadOfFill=!1)}i&&(t.restore(),t.clearContextCache(!0))}O2(t,e){t.lineCap="butt";const i=this.rowCount>0?this.Ge:null,n=this.columnCount>0?this.He:null;null!==i&&this.qb(t,e,!0,i,!0),null!==n&&this.qb(t,e,!1,n,!0),null!==i&&this.FA(t,!0,i),null!==n&&this.FA(t,!1,n),null!==i&&this.qb(t,e,!0,i,!1),null!==n&&this.qb(t,e,!1,n,!1)}FA(t,e,i){const n=i.length,s=this.actualBounds,o=this.naturalBounds;let r=!0;for(let a=0;a<n;a++){const n=i[a];if(void 0===n||0===n.actual)continue;if(r){r=!1;continue}if(e){if(n.position>o.height)continue}else if(n.position>o.width)continue;let l=n.separatorStrokeWidth;isNaN(l)&&(l=e?this.defaultRowSeparatorStrokeWidth:this.defaultColumnSeparatorStrokeWidth);let h=n.separatorStroke;if(null===h&&(h=e?this.defaultRowSeparatorStroke:this.defaultColumnSeparatorStroke),0===l||null===h)continue;this.mn(t,h,!1,!1,o,s);let u=!1,c=n.separatorDashArray;null===c&&(c=e?this.defaultRowSeparatorDashArray:this.defaultColumnSeparatorDashArray),null!==c&&(u=!0,t.enableDash(c,0)),t.beginPath();const d=n.position+l;e?d>o.height&&(l-=d-o.height):d>o.width&&(l-=d-o.width);let f=n.position+l/2;t.lineWidth=l;const g=this.ti;if(e){f+=g.top;const e=g.left,i=o.width-g.right;t.moveTo(e,f),t.lineTo(i,f)}else{f+=g.left;const e=g.top,i=o.height-g.bottom;t.moveTo(f,e),t.lineTo(f,i)}t.stroke(),t.endPath(),u&&t.disableDash()}}qb(t,e,i,n,s){const o=n.length,r=this.actualBounds,a=this.naturalBounds,l=this.RA(!0),h=this.RA(!1);for(let u=0;u<o;u++){const e=n[u];if(void 0===e||null===e.background||e.coversSeparators===s||0===e.actual)continue;const o=i?r.height:r.width;if(e.position>o)continue;let c=e.computeEffectiveSpacing(),d=e.separatorStrokeWidth;isNaN(d)&&(d=i?this.defaultRowSeparatorStrokeWidth:this.defaultColumnSeparatorStrokeWidth);let f=e.separatorStroke;null===f&&(f=i?this.defaultRowSeparatorStroke:this.defaultColumnSeparatorStroke),(null===f||e.index===(i?l:h))&&(d=0),c-=d;const g=e.position+d;let m=c+e.actual;if(g+m>o&&(m=o-g),m<=0)continue;const p=this.ti;this.mn(t,e.background,!0,!1,a,r),i?t.fillRect(p.left,g+p.top,r.width-(p.left+p.right),m):t.fillRect(g+p.left,p.top,m,r.height-(p.top+p.bottom))}}RA(t){const e=t?this.rowCount:this.columnCount;for(let i=0;i<e;i++){const e=t?this.Ge[i]:this.He[i];if(void 0!==e)return e.index}return 0}of(){const t=this.T.r,e=t.length;for(let i=0;i<e;i++)t[i].of();this.Ye(!0)}nf(t,e,i){const n=this.svg;if(null===n)return!1;if(this.type===Yt.Table){const i=n.getElementsByClassName("gojs-ts"),s=0!==i.length?i[0]:null;null!==s&&(s.innerHTML=""),t.currentElement=s,this.O2(t,e),t.currentElement=null}else{if(this.$===Yt.Grid)return n.innerHTML="",n.remove(),!1;if(this.$===Yt.Graduated)return n.innerHTML="",n.remove(),!1;if(this.$===Yt.Spot&&this.isClipping)return n.innerHTML="",n.remove(),this.dh=null,this.of(),!1}if(!super.nf(t,e,i))return!1;const s=this.T.r,o=s.length;for(let r=0;r<o;r++)s[r].zi(t,e);return!0}ed(t){return!0}N0(t,e,i,n){if(!this.isClipping){if(this.js()&&null!==t.partClipRect){const e=t.partClipRect,s=this.T.r;let o=0,r=0;for(let t=0;t<s.length;t++){if(!s[t].isVisibleObject())continue;const e=s[t].actualBounds;o=0===t?e.x:Math.min(e.x,o),r=0===t?e.y:Math.min(e.y,r)}return void n.setAttributeNS(null,"clip-path",`path('M ${e.x-i.x-o},${e.y-i.y-r} l ${e.width} 0 l 0 ${e.height} l -${e.width} 0 z')`)}super.N0(t,e,i,n)}}ef(t,e,i,n,s){const o=this.wn(),r=this.F,a=1/(r.m11*r.m22-r.m12*r.m21);let l=r.m22*a,h=-r.m12*a,u=-r.m21*a,c=r.m11*a,d=a*(r.m21*r.dy-r.m22*r.dx),f=a*(r.m12*r.dx-r.m11*r.dy);if(null!==this.background){const o=t*l+e*u+d,a=t*h+e*c+f,g=i*l+n*u+d,m=i*h+n*c+f;s.i(0,0);const p=this.naturalBounds,y=S.kl(0,0,p.width,p.height,o,a,g,m,s);return s.F(r),y}{o||(l=1,h=0,u=0,c=1,d=0,f=0);const a=t*l+e*u+d,g=t*h+e*c+f,m=i*l+n*u+d,p=i*h+n*c+f;s.i(m,p);let x=(m-a)**2+(p-g)**2,b=!1;const v=this.T.r,w=v.length,k=y.l();let S=null,P=1/0,M=null;const C=this.isClipping&&this.$===Yt.Spot;C&&(M=y.l(),S=this.findMainElement(),b=S.ef(a,g,m,p,M),b&&(P=(a-M.x)**2+(g-M.y)**2));for(let t=0;t<w;t++){const e=v[t];if(!e.visible||e===S||!e.ef(a,g,m,p,k))continue;b=!0;const i=(a-k.x)**2+(g-k.y)**2;i<x&&(x=i,s.set(k))}return C&&(P>x&&s.set(M),y.e(M)),y.e(k),o&&s.F(r),b}}vu(){const t=this.T.r,e=t.length;for(let i=0;i<e;i++)t[i].vu();super.vu()}c(t){if(this.Bo())return;super.c(t);let e=null;(this.$===Yt.Auto||this.$===Yt.Link)&&(e=this.findMainElement());const i=this.T.r,n=i.length;for(let s=0;s<n;s++){const t=i[s];if((t===e||t.isPanelMain)&&t.c(!0),t.desiredSize.isReal())continue;const n=t.Hs(!1);!(t instanceof Te)&&!(t instanceof Yt)&&!(t instanceof ie)&&0===n||t.c(!0)}}lf(){if(this.Bo())return;this.me(!0),this.no(!0);const t=this.T.r,e=t.length;for(let i=0;i<e;i++)t[i].lf()}sf(){if(!1===this.Bb()){this.sd(!0),this.Ca(!0);const t=this.T.r,e=t.length;for(let i=0;i<e;i++)t[i].d2()}}d2(){this.Ca(!0);const t=this.T.r,e=t.length;for(let i=0;i<e;i++)t[i].d2()}_u(t,e,i,n){const s=this.jo;s.i(0,0,0,0);const o=this.desiredSize,r=this.minSize;void 0===i&&(i=r.width,n=r.height),i=Math.max(i,r.width),n=Math.max(n,r.height);const a=this.maxSize;isNaN(o.width)||(t=Math.min(o.width,a.width)),isNaN(o.height)||(e=Math.min(o.height,a.height)),t=Math.max(i,t),e=Math.max(n,e);const l=this.ti;t=Math.max(t-l.left-l.right,0),e=Math.max(e-l.top-l.bottom,0);const h=this.T.r;this.$.measure(this,t,e,h,s,i,n);let u=s.width+l.left+l.right,c=s.height+l.top+l.bottom;isFinite(o.width)&&(u=o.width),isFinite(o.height)&&(c=o.height),u=Math.min(a.width,u),c=Math.min(a.height,c),u=Math.max(r.width,u),c=Math.max(r.height,c),u=Math.max(i,u),c=Math.max(n,c),s.zn(u,c),this.naturalBounds.zn(u,c),this.so(0,0,u,c)}findMainElement(){if(null===this.ol){const t=this.T.r,e=t.length;if(0===e)return null;for(let i=0;i<e;i++){const e=t[i];if(!0===e.isPanelMain)return this.ol=e,e}this.ol=t[0]}return this.ol}Ho(){return null!==this.part?this.part.locationObject:null}get panelLayoutState(){return this.v2}set panelLayoutState(t){this.v2=t}ph(t,e,i,n){const s=this.T.r;if(this.actualBounds.i(t,e,i,n),!this.desiredSize.isReal()){let t=this.Hs(!0);const e=this.measuredBounds,s=e.width,o=e.height,r=this.tl,a=r.left+r.right,l=r.top+r.bottom;switch(s===i&&o===n&&(t=0),t){case 0:(s>i||o>n)&&(this.c(),this.ut(s>i?i:s,o>n?n:o,0,0));break;case 2:this.c(!0),this.ut(i+a,n+l,0,0);break;case 5:this.c(!0),this.ut(i+a,o+l,0,0);break;case 4:this.c(!0),this.ut(s+a,n+l,0,0)}}this.$.arrange(this,s,this.jo)}mh(t){const e=this.naturalBounds,i=this.Ho();if(b.contains(0,0,e.width,e.height,t.x,t.y)){const e=this.T.r,n=e.length,s=y.X(0,0);for(let o=n;o--;){const n=e[o];if((n.visible||n===i)&&(s.set(t).Be(n.F),n.containsPoint(s)))return y.e(s),!0}return y.e(s),null!==this.Dt}return!1}w0(t){if(this.io===t)return this;const e=this.T.r,i=e.length;for(let n=0;n<i;n++){const i=e[n].w0(t);if(null!==i)return i}return null}walkVisualTreeFrom(t,e){if(e(this,t),t instanceof Yt){const i=t.T.r,n=i.length;for(let t=0;t<n;t++)this.walkVisualTreeFrom(i[t],e)}}$r(t){this.vA(this,t)}vA(t,e){e(t);const i=t.T.r,n=i.length;for(let s=0;s<n;s++){const t=i[s];t instanceof Yt&&this.vA(t,e)}}Sv(t){this.OA(this,t)}OA(t,e){if(e(t),t instanceof Yt){const i=t.T.r,n=i.length;for(let t=0;t<n;t++)this.OA(i[t],e)}}findInVisualTree(t){return this.IA(this,t)}IA(t,e){if(e(t))return t;if(t instanceof Yt){const i=t.T.r,n=i.length;for(let t=0;t<n;t++){const n=this.IA(i[t],e);if(null!==n)return n}}return null}findObject(t){if(this.name===t)return this;const e=this.T.r;let i=e.length;this.Mv()&&(i=this.cp());for(let n=0;n<i;n++){const i=e[n];if(i instanceof Yt){const e=i.findObject(t);if(null!==e)return e}if(i.name===t)return i}return null}EA(){const t=this.T.r,e=t.length;let i=0;for(let n=0;n<e;n++){const e=t[n];e instanceof Yt?i=Math.max(i,e.EA()):e instanceof Jt&&(i=Math.max(i,e.Nv()))}return i}wn(){return!(this.type===Yt.TableRow||this.type===Yt.TableColumn)}el(){return this.type===Yt.TableRow||this.type===Yt.TableColumn}gL(t,e,i){if(!1===this.pickable||(void 0===e&&(e=null),void 0===i&&(i=null),this.es()))return null;const n=this.naturalBounds,s=1/this.getDocumentScale(),o=this.wn(),r=o?t:y.X(t.x,t.y).Be(this.F),a=this.diagram;let l=10,h=5;if(null!==a&&(l=a.getInputOption("extraTouchArea"),h=l/2),b.contains(-h*s,-h*s,n.width+l*s,n.height+l*s,r.x,r.y)){if(!this.mf){const n=this.T.r,s=n.length,a=y.l(),l=this.isClipping&&this.$===Yt.Spot,h=l?this.findMainElement():null;if(l&&(h.wn()?a.set(t).Be(h.F):a.set(t),!h.containsPoint(a)))return y.e(a),o||y.e(r),null;const u=this.Ho();for(let c=s;c--;){const s=n[c];if(!s.visible&&s!==u||(s.wn()?a.set(t).Be(s.F):a.set(t),l&&s===h))continue;let d=null;if(s instanceof Yt?d=s.gL(a,e,i):!0===s.pickable&&s.containsPoint(a)&&(d=s),null!==d&&(null!==e&&(d=e(d)),null!==d&&(null===i||i(d))))return y.e(a),o||y.e(r),d}y.e(a)}if(null===this.background)return o||y.e(r),null;const s=b.contains(0,0,n.width,n.height,r.x,r.y)?this:null;return o||y.e(r),s}return o||y.e(r),null}mL(t,e,i,n){if(!1===this.pickable)return!1;void 0===e&&(e=null),void 0===i&&(i=null);const s=this.naturalBounds,o=this.wn(),r=o?t:y.X(t.x,t.y).Be(this.F),a=this.el(),l=b.contains(0,0,s.width,s.height,r.x,r.y);if(a||l){if(!this.mf){const s=this.T.r,o=s.length,r=y.l(),a=this.Ho();for(let l=o;l--;){const o=s[l];if(!o.visible&&o!==a)continue;o.wn()?r.set(t).Be(o.F):r.set(t);let h=o;const u=o instanceof Yt?o:null;if(null!==u?u.mL(r,e,i,n):h.containsPoint(r)){if(!1===h.pickable)continue;null!==e&&(h=e(h)),null!==h&&(null===i||i(h))&&n.add(h)}}y.e(r)}return o||y.e(r),l&&null!==this.background}return o||y.e(r),!1}Om(t,e,i,n,s,o){if(!1===this.pickable)return!1;void 0===e&&(e=null),void 0===i&&(i=null);let r=o;if(void 0===o&&(r=k.l(),r.Ii()),r.ac(this.F),this.containedInRect(t,r))return this.I2(e,i,s),void 0===o&&k.e(r),!0;if(this.intersectsRect(t,r)){if(!this.mf){const o=this.Ho(),a=this.T.r;for(let l=a.length;l--;){const h=a[l];if(!h.visible&&h!==o)continue;const u=h.actualBounds,c=this.naturalBounds;if(u.x>c.width||u.y>c.height||u.x+u.width<0||u.y+u.height<0)continue;let d=h;const f=h instanceof Yt?h:null,g=k.l();g.set(r),(null!==f?f.Om(t,e,i,n,s,g):d.uA(t,n,g))&&(null!==e&&(d=e(d)),null!==d&&(null===i||i(d))&&s.add(d)),k.e(g)}}return void 0===o&&k.e(r),n}return void 0===o&&k.e(r),!1}I2(t,e,i){const n=this.T.r;for(let s=n.length;s--;){const o=n[s];if(!o.visible)continue;const r=o.actualBounds,a=this.naturalBounds;if(r.x>a.width||r.y>a.height||r.x+r.width<0||r.y+r.height<0)continue;o instanceof Yt&&o.I2(t,e,i);let l=o;null!==t&&(l=t(l)),null!==l&&(null===e||e(l))&&i.add(l)}}pL(t,e,i,n,s,o){if(!1===this.pickable)return!1;void 0===i&&(i=null),void 0===n&&(n=null);const r=this.naturalBounds,a=this.wn(),l=a?t:y.X(t.x,t.y).Be(this.F),h=a?e:y.X(e.x,e.y).Be(this.F),u=l.distanceSquaredPoint(h),c=l.x>0&&l.x<r.width&&l.y>0&&l.y<r.height||y.distanceLineSegmentSquared(l.x,l.y,0,0,0,r.height)<=u||y.distanceLineSegmentSquared(l.x,l.y,0,r.height,r.width,r.height)<=u||y.distanceLineSegmentSquared(l.x,l.y,r.width,r.height,r.width,0)<=u||y.distanceLineSegmentSquared(l.x,l.y,r.width,0,0,0)<=u,d=l.distanceSquared(0,0)<=u&&l.distanceSquared(0,r.height)<=u&&l.distanceSquared(r.width,0)<=u&&l.distanceSquared(r.width,r.height)<=u;if(a||(y.e(l),y.e(h)),c){if(!this.mf){const r=y.l(),l=y.l(),h=this.Ho(),u=this.T.r;for(let c=u.length;c--;){const d=u[c];if(!d.visible&&d!==h)continue;const f=d.actualBounds,g=this.naturalBounds;if(a&&(f.x>g.width||f.y>g.height||f.x+f.width<0||f.y+f.height<0))continue;if(d.wn()){const i=d.F;r.set(t).Be(i),l.set(e).Be(i)}else r.set(t),l.set(e);let m=d;const p=d instanceof Yt?d:null;(null!==p?p.pL(r,l,i,n,s,o):m.dA(r,l,s))&&(null!==i&&(m=i(m)),null!==m&&(null===n||n(m))&&o.add(m))}y.e(r),y.e(l)}return s?c:d}return!1}T2(t){let e=null;if(t instanceof Jt){e=t.spot1,e===w.Default&&(e=null);const i=t.geometry;null!==i&&null===e&&(e=i.spot1)}return null===e&&(e=w.TopLeft),e}D2(t){let e=null;if(t instanceof Jt){e=t.spot2,e===w.Default&&(e=null);const i=t.geometry;null!==i&&null===e&&(e=i.spot2)}return null===e&&(e=w.BottomRight),e}add(){for(let t=0;t<arguments.length;t++)this.insertAt(this.T.count,t<0||arguments.length<=t?void 0:arguments[t]);return this}elt(t){return this.T.elt(t)}insertAt(t,i){i instanceof ce&&e.o("Cannot add a Part to a Panel: "+i+"; use a Panel instead"),(this===i||this.isContainedBy(i))&&(this===i&&e.o("Cannot make a Panel contain itself: "+this.toString()),e.o("Cannot make a Panel indirectly contain itself: "+this.toString()+" already contains "+i.toString()));const n=i.panel;if(null!==n&&n!==this&&e.o("Cannot add a GraphObject that already belongs to another Panel to this Panel: "+i.toString()+", already contained by "+n.toString()+", cannot be shared by this Panel: "+this.toString()),this.$===Yt.Grid&&!(i instanceof Jt)&&e.o("Can only add Shapes to a Grid Panel, not: "+i),this.$===Yt.Graduated&&!(i instanceof Jt||i instanceof ie)&&e.o("Can only add Shapes or TextBlocks to a Graduated Panel, not: "+i),i.La(this),i.il=null,null!==this.itemArray){const t=i.data;e.H(t)&&(null===this.Ws&&(this.Ws=new p),this.Ws.set(t,i))}const s=this.T;let o=-1;if(n===this){let r=-1;const a=this.T.r,l=a.length;for(let t=0;t<l;t++)if(a[t]===i){r=t;break}if(-1!==r){if(r===t||r+1>=s.count&&t>=s.count)return;s.removeAt(r),o=r}else e.o("element "+i.toString()+" has panel "+n.toString()+" but is not contained by it.")}(t<0||t>s.count)&&(t=s.count),s.insertAt(t,i),(0===t||i.isPanelMain)&&(this.ol=null),this.Bo()||this.c(),i.c(!1),(null!==i.portId||i instanceof Yt&&!0===i.bn)&&(this.bn=!0),this.rs=null,this.isEnabledObject()||this.Wb(i,!1);const r=this.part;if(null!==r){r.R0(),r.pf(),this.bn&&r instanceof me&&(r.bn=!0),r.bn&&r instanceof me&&(r.le=null);const e=this.diagram;if(null!==e&&e.undoManager.isUndoingRedoing)return;-1!==o&&r.raiseChangedEvent(4,"elements",this,i,null,o,null),r.raiseChangedEvent(3,"elements",this,null,i,null,t)}}get bn(){return 0!==(8388608&this.n)}set bn(t){0!==(8388608&this.n)!==t&&(this.n=8388608^this.n)}a2(){return 0!==(16777216&this.n)}E2(t){t?this.n|=16777216:this.n&=-16777217}Pv(t){t.La(this),t.il=null;const e=this.T,i=e.count;e.insertAt(i,t);const n=this.part;if(null!==n){n.R0(),null!==t.portId&&n instanceof me&&(n.bn=!0);const e=this.diagram;if(null!==e&&e.undoManager.isUndoingRedoing)return;n.raiseChangedEvent(3,"elements",this,null,t,null,i)}}GR(t){const e=this.T.r,i=e.length;let n=-1;for(let s=0;s<i;s++)if(e[s]===t){n=s;break}return n}remove(t){const e=this.T.r,i=e.length;let n=-1;for(let s=0;s<i;s++)if(e[s]===t){n=s;break}-1!==n&&this.se(n,!0)}removeAt(t){t>=0&&this.se(t,!0)}se(t,i){const n=this.T,s=n.elt(t);if(s.il=null,s.La(null),null!==this.Ws){const t=s.data;e.H(t)&&this.Ws.delete(t)}n.removeAt(t),this.me(!1),this.c(),this.ol===s&&(this.ol=null),this.rs=null;const o=this.part;if(null!==o){o.R0(),o.pf(),o.invalidateAdornments(),o instanceof me&&(s instanceof Yt?s.walkVisualTreeFrom(s,((t,e)=>o.w2(e,i))):o.w2(s,i));const e=this.diagram;if(null!==e&&e.undoManager.isUndoingRedoing)return;o.raiseChangedEvent(4,"elements",this,s,null,t,null)}}get Ge(){return null===this.O&&(this.O=new qt),this.O.Ge}get rowCount(){return null===this.O?0:this.Ge.length}getRowDefinition(t){t<0&&e._(t,">= 0",Yt,"getRowDefinition:idx"),t=Math.round(t);const i=this.Ge;if(void 0===i[t]){const e=new $t;e.La(this),e.isRow=!0,e.index=t,i[t]=e,this.raiseChangedEvent(3,"rowdefs",this,null,e,null,t)}return i[t]}removeRowDefinition(t){if(t<0&&e._(t,">= 0",Yt,"removeRowDefinition:idx"),0===this.rowCount)return;t=Math.round(t);const i=this.Ge,n=i[t];if(n){i[t]=void 0;let e=i.length-1;for(;e>=0&&void 0===i[e--];)i.length--;this.raiseChangedEvent(4,"rowdefs",this,n,null,t,null),this.c()}}GL(t,e){const i=this.Ge;if(!(t<0)){if(i[t]=e instanceof $t?e:void 0,!e){let t=i.length-1;for(;t>=0&&void 0===i[t--];)i.length--}this.c()}}get He(){return null===this.O&&(this.O=new qt),this.O.He}get columnCount(){return null===this.O?0:this.He.length}getColumnDefinition(t){t<0&&e._(t,">= 0",Yt,"getColumnDefinition:idx"),t=Math.round(t);const i=this.He;if(void 0===i[t]){const e=new $t;e.La(this),e.isRow=!1,e.index=t,i[t]=e,this.raiseChangedEvent(3,"coldefs",this,null,e,null,t)}return i[t]}removeColumnDefinition(t){if(t<0&&e._(t,">= 0",Yt,"removeColumnDefinition:idx"),0===this.columnCount)return;t=Math.round(t);const i=this.He,n=i[t];if(n){i[t]=void 0;let e=i.length-1;for(;e>=0&&void 0===i[e--];)i.length--;this.raiseChangedEvent(4,"coldefs",this,n,null,t,null),this.c()}}HL(t,e){const i=this.He;if(!(t<0)){if(i[t]=e instanceof $t?e:void 0,!e){let t=i.length-1;for(;t>=0&&void 0===i[t--];)i.length--}this.c()}}addRowColumnDefinition(t){let e=null;return t.isRow?e=this.getRowDefinition(t.index):t.isRow||(e=this.getColumnDefinition(t.index)),e&&e.Vb(t),this}addRowDefinition(t,e){const i=this.getRowDefinition(t);return i&&i.Vb(new $t(e)),this}addColumnDefinition(t,e){const i=this.getColumnDefinition(t);return i&&i.Vb(new $t(e)),this}get rowSizing(){return null!==this.O?this.O.fp:3}set rowSizing(t){const e=this.rowSizing;e!==t&&(null===this.O&&(this.O=new qt),this.O.fp=t,this.c(),this.t("rowSizing",e,t))}get columnSizing(){return null!==this.O?this.O.dp:3}set columnSizing(t){const e=this.columnSizing;e!==t&&(null===this.O&&(this.O=new qt),this.O.dp=t,this.c(),this.t("columnSizing",e,t))}get topIndex(){return null!==this.O?this.O.gp:0}set topIndex(t){const i=this.topIndex;i!==t&&((!isFinite(t)||t<0)&&e.o("Panel.topIndex must be greater than zero and a real number, not: "+t),null===this.O&&(this.O=new qt),this.O.gp=t,this.c(),this.t("topIndex",i,t))}get leftIndex(){return null!==this.O?this.O.mp:0}set leftIndex(t){const i=this.leftIndex;i!==t&&((!isFinite(t)||t<0)&&e.o("Panel.leftIndex must be greater than zero and a real number, not: "+t),null===this.O&&(this.O=new qt),this.O.mp=t,this.c(),this.t("leftIndex",i,t))}findRowForLocalY(t){if(t<0||this.type!==Yt.Table||0===this.rowCount)return-1;let e=0;const i=this.Ge,n=i.length;let s=this.topIndex;for(;s<n;s++){const n=i[s];if(void 0!==n&&(e+=n.total,t<e))return s}return s}findColumnForLocalX(t){if(t<0||this.type!==Yt.Table||0===this.columnCount)return-1;let e=0;const i=this.He,n=i.length;let s=this.leftIndex;for(;s<n;s++){const n=i[s];if(void 0!==n&&(e+=n.total,t<e))return s}return s}graduatedPointForValue(t,e){if(void 0===e&&(e=new y(NaN,NaN)),this.type!==Yt.Graduated)return e.i(NaN,NaN),e;t=Math.min(Math.max(t,this.graduatedMin),this.graduatedMax);const i=this.findMainElement();return i.geometry.getPointAlongPath((t-this.graduatedMin)/this.graduatedRange,e),i.F.xt(e)}graduatedValueForPoint(t){if(this.type!==Yt.Graduated)return NaN;const e=this.findMainElement();return e.F._e(t),e.geometry.getFractionForPoint(t)*this.graduatedRange+this.graduatedMin}get data(){return this.ei}set data(t){const i=this.ei;if(i!==t){const n=this instanceof ce&&!(this instanceof fe);n&&e.s(t,"object",Yt,"data"),this.zt(),this.ei=t;const s=this.diagram;if(null!==s)if(n)s.partManager.Cv(this,i,t);else{const e=this.panel;null!==e&&null!==e.Ws&&(null!==i&&e.Ws.delete(i),null!==t&&e.Ws.set(t,this))}if(this.t("data",i,t),null!==s&&s.undoManager.isUndoingRedoing)return;null!==t&&this.updateTargetBindings()}}get itemIndex(){return this.fd}set itemIndex(t){const e=this.fd;e!==t&&(this.fd=t,this.t("itemIndex",e,t))}get qs(){return null!==this.b?this.b.qs:null}set qs(t){this.Ti!==t&&(null===this.b&&(this.b=new Dt),this.b.qs=t)}b2(){return null!==this.qs}PA(){const t=this.qs;return null!==t&&t.h}freezeBindings(){return this.zt()}zt(){let t=this.qs;if(null===t)null!==this.data&&e.o("Template cannot have .data be non-null: "+this),this.qs=t=new l;else if(t.h)return this;const i=new l;this.E2(!1),this.walkVisualTreeFrom(this,((e,n)=>{n.gh();const s=n.Ti;if(null!==s){n.g2(!1);const o=s.iterator;for(;o.next();){const s=o.value;2===s.mode&&n.g2(!0);const r=s.sourceName;if(s.isToObject){"/"===r&&e.E2(!0);const t=s.fA(e,n);null!==t&&(i.add(t),null===t.eo&&(t.eo=new l),t.eo.add(s))}t.add(s)}}if(n instanceof Yt&&n.type===Yt.Table){if(n.rowCount>0){const e=n.Ge,i=e.length;for(let n=0;n<i;n++){const i=e[n];if(void 0!==i&&null!==i.Ss){const e=i.Ss.iterator;for(;e.next();){const n=e.value;n.Se=i,n.gd=2,n.yf=i.index,t.add(n)}}}}if(n.columnCount>0){const e=n.He,i=e.length;for(let n=0;n<i;n++){const i=e[n];if(void 0!==i&&null!==i.Ss){const e=i.Ss.iterator;for(;e.next();){const n=e.value;n.Se=i,n.gd=1,n.yf=i.index,t.add(n)}}}}}}));const n=i.iterator;for(;n.next();){const t=n.value;if(null!==t.eo){t.g2(!0);const e=t.eo.iterator;for(;e.next();){const i=e.value;null===t.Ti&&(t.Ti=new l),t.Ti.add(i)}}t.eo=null}let s=t.iterator;for(;s.next();){const t=s.value;let i=t.Se;if(null!==i){t.Se=null;const n=t.targetProperty,s=n.indexOf(".");if(s>0&&i instanceof Yt){const o=n.substring(0,s),r=n.substring(s+1),a=i.findObject(o);null!==a?(i=a,t.targetProperty=r):(e.li('Warning: unable to find GraphObject named "'+o+'" for Binding: '+t.toString()),i=null)}if(i instanceof $t){const e=u.us(i.panel);t.targetId=void 0===e?-1:e,i.panel.io=t.targetId}else if(i instanceof At){const e=u.us(i);t.targetId=void 0===e?-1:e,i.io=t.targetId}else e.o("Unknown type of binding target: "+i);t.check(i)}}return t.u(),this instanceof ce&&this.Me()&&this.ensureBounds(),this}static ME=!1;copyTemplate(t){void 0===t&&(t=!1);const e=this.copy();return e.Sv((t=>{t instanceof Yt&&(t.qs=null,t.ei=null);const e=t.Ti;null!==e&&(t.Ti=null,e.each((e=>t.bind(e.copy()))));const i=t.ks;null!==i&&(t.ks=null,i.each((e=>t.trigger(e.value.copy()))))})),t&&e.zt(),e}updateTargetBindings(t){const e=this.qs;if(null===e)return;void 0===t&&(t="");const i=this.diagram?.model,n=e.iterator;for(;n.next();){const e=n.value,s=this.BA(e,t);if(null===s)continue;const{data:o,elt:r}=s;e.isToTheme&&null===this.diagram||void 0!==r&&e.updateTarget(r,o,void 0,i)}}Uo(){if(null!==this.diagram)if(this.b2()){const t=this.diagram.model,e=this.qs.iterator;for(;e.next();){const i=e.value;if(!i.isToTheme)continue;const n=this.BA(i);if(null===n)continue;const{data:s,elt:o}=n;void 0!==o&&i.updateTarget(o,s,void 0,t)}}else{const t=this.T.r,e=t.length;for(let i=0;i<e;i++)t[i].Uo()}}BA(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const i=t.sourceProperty;if(""!==e&&""!==i&&i!==e)return null;const n=t.targetProperty;if(null===t.converter&&""===n)return null;let s=this.data;const o=t.sourceName;if(t.isToObject){if(s=this.cA(o),null===s)return null}else if(t.isToModel){const t=this.diagram;if(null===t)return null;s=t.model.modelData}let r=this;const a=t.targetId;if(-1!==a){if(r=this.w0(a),null===r)return null}else null!==t.Se&&(r=t.Se);"/"===o?s=r.part:"."===o?s=r:".."===o&&(s=r.panel);const l=t.gd;if(0!==l){if(!(r instanceof Yt))return null;1===l?r=r.getColumnDefinition(t.yf):2===l&&(r=r.getRowDefinition(t.yf))}return{data:s,elt:r}}get itemArray(){return this.Ph}set itemArray(t){const e=this.Ph;if(e!==t||null!==t&&this.Lv(t)){const i=this.diagram;if(e!==t&&(null!==i&&null!==e&&i.partManager.TM(this,i),this.Ph=t,null!==i&&null!==t&&i.partManager.AM(this,i)),this.t("itemArray",e,t),null!==i&&i.undoManager.isUndoingRedoing)return;this.UA(e,t)}}findItemPanelForData(t){return null==t||null===this.Ws?null:(e.lc(t,Yt,"findItemPanelForData"),this.Ws.get(t))}Lv(t){const e=this.T.r,i=e.length,n=t.length;let s=0,o=null;for(;s<i&&(o=e[s],!(o instanceof Yt)||null===o.data);)s++,o=e[s];if(i-s!==n)return!0;if(null===o)return n>0;let r=0;for(;s<i&&r<n;){if(o=e[s],!(o instanceof Yt)||o.data!==t[r])return!0;s++,r++}return!1}cp(){if(this.type===Yt.Spot||this.type===Yt.Auto)return Math.min(this.T.length,1);if(this.type===Yt.Link){const t=this.T,e=t.length;let i=0;for(;i<e;i++){const e=t.elt(i);if(!(e instanceof Jt)||!e.isPanelMain)return i}return i}if(this.type===Yt.Table&&this.T.length>0){const t=this.T.elt(0);if(t.isPanelMain&&t instanceof Yt&&t.el())return 1}return 0}rebuildItemElements(){const t=this.cp();for(;this.T.length>t;)this.se(this.T.length-1,!1);this.UA(null,this.itemArray)}UA(t,e){const i=this.cp(),n=e;if(null!==n&&0!==n.length)if(this.T.length<=i){const t=n.length;for(let e=0;e<t;e++)this.Jb(n[e],e,!0)}else{let t=i;for(let i=0;i<n.length;i++,t++){const e=n[i],s=t<this.T.length?this.T.elt(t):null;if(s instanceof Yt){if(s.data!==e){const n=this.B2(s.data,i),o=this.B2(e,i);let r=o!==n;if(!r){const t=this.U2(s.data,i,n);r=this.U2(e,i,o)!==t}r?(this.se(t,!1),this.Jb(e,i,!1)):s.data=e}}else this.Jb(e,i,!1)}for(;t<this.T.length;)this.se(t,!1);this.ol=null,this.V2(i,0),this.Bo()||this.c(),this.rs=null,this.isEnabledObject()||this.Wb(this,!1);const e=this.part;null!==e&&(e.R0(),e.pf(),this.bn&&e instanceof me&&(e.bn=!0),e.bn&&e instanceof me&&(e.le=null))}else for(;this.T.length>i;)this.se(this.T.length-1,!1)}Jb(t,i,n){if(null==t||i<0)return null;const s=this.B2(t,i),o=this.U2(t,i,s);if(null!==o){o.zt();const s=o.copy();if(s.a2()){const t=this.findBindingPanel();null!==t&&t.E2(!0)}e.H(t)&&(null===this.Ws&&(this.Ws=new p),this.Ws.set(t,s));const r=i+this.cp();return this.insertAt(r,s),n&&(s.ei=t,this.V2(r,i),s.ei=null),s.data=t,s}return null}Av(t){if(t<0)return;const e=t+this.cp();this.se(e,!0),this.V2(e,t)}V2(t,e){const i=this.T;let n=t,s=e;for(;n<i.length;){const t=i.elt(n);t instanceof Yt&&t.Tv(n,s),n++,s++}}Tv(t,e){this.type===Yt.TableRow?this.row=t:this.type===Yt.TableColumn&&(this.column=t),this.itemIndex=e}Mv(){return null!==this.Ph||null!==this.itemTemplateMap}get itemTemplate(){return null===this.itemTemplateMap?null:this.itemTemplateMap.get("")}set itemTemplate(t){if(null===this.itemTemplateMap){if(null===t)return;this.itemTemplateMap=new p}const i=this.itemTemplateMap.get("");if(i!==t){(t instanceof ce||t.isPanelMain)&&e.o("Panel.itemTemplate must not be a Part or be Panel.isPanelMain: "+t),this.itemTemplateMap.set("",t),this.t("itemTemplate",i,t);const n=this.diagram;if(null!==n&&n.undoManager.isUndoingRedoing)return;this.rebuildItemElements()}}get itemTemplateMap(){return null!==this.b?this.b.q0:null}set itemTemplateMap(t){const e=this.itemTemplateMap;if(e!==t){const i=t.iterator;for(;i.next();){i.value}this.qt().q0=t,this.t("itemTemplateMap",e,t);const n=this.diagram;if(null!==n&&n.undoManager.isUndoingRedoing)return;this.rebuildItemElements()}}get itemCategoryProperty(){return null!==this.b?this.b.W0:"category"}set itemCategoryProperty(t){const i=this.itemCategoryProperty;i!==t&&("string"!=typeof t&&!e.ot(t)&&e.te(t,"string or function",Yt,"itemCategoryProperty"),this.qt().W0=t,this.t("itemCategoryProperty",i,t))}B2(t,i){if(null===t)return"";const n=this.itemCategoryProperty;let s="";if(e.ot(n))s=n(t);else{if("string"!=typeof n||!e.H(t))return"";{if(""===n)return"";const e=this.diagram,i=null!==e?e.model:null;s=i?i.bt(t,n):Ue.bt(t,n)}}return void 0===s?"":"string"==typeof s?s:void e.o("Panel.getCategoryForItemData found a non-string category for "+t+": "+s)}static VA=!1;static zA=null;U2(t,i,n){const s=this.itemTemplateMap;let o=null;return null!==s&&(o=s.get(n)),null===o&&(null!==s&&(o=s.get("")),null===o&&(Yt.VA||(Yt.VA=!0,e.li('No item template Panel found for category "'+n+'" on '+this),e.li("  Using default item template."),Yt.zA=(new Yt).add((new ie).bind("text","",e.toString).theme("stroke","text"))),o=Yt.zA)),o}get mf(){return 0!==(1048576&this.n)}set mf(t){const i=0!==(1048576&this.n);i!==t&&(e.s(t,"boolean",Yt,"isAtomic"),this.n=1048576^this.n,this.t("isAtomic",i,t))}get isClipping(){return 0!==(2097152&this.n)}set isClipping(t){const e=0!==(2097152&this.n);e!==t&&(this.of(),this.n=2097152^this.n,this instanceof Ne&&(this.ri=null),this.c(),this.t("isClipping",e,t))}get isOpposite(){return 0!==(33554432&this.n)}set isOpposite(t){const e=0!==(33554432&this.n);e!==t&&(this.n=33554432^this.n,this.c(),this.t("isOpposite",e,t))}get isEnabled(){return 0!==(4194304&this.n)}set isEnabled(t){const e=0!==(4194304&this.n);if(e!==t){const i=null===this.panel||this.panel.isEnabledObject();this.n=4194304^this.n,this.t("isEnabled",e,t);const n=this.diagram;if(null!==n&&n.undoManager.isUndoingRedoing)return;i&&this.Wb(this,t)}}Wb(t,e){const i=t.enabledChanged;if(null!==i&&i(t,e),t instanceof Yt){const i=t.T.r,n=i.length;for(let t=0;t<n;t++){const n=i[t];e&&n instanceof Yt&&!n.isEnabled||this.Wb(n,e)}}}get alignmentFocusName(){return this.ho}set alignmentFocusName(t){const e=this.ho;e!==t&&(this.ho=t,this.c(),this.t("alignmentFocusName",e,t))}static definePanelLayout(t,e){Gt.Pn(t,e)}static isBuilderDefined(t){return Gt.os.has(t)}static Position=(()=>Gt.os.get("Position"))();static Horizontal=(()=>Gt.os.get("Horizontal"))();static Vertical=(()=>Gt.os.get("Vertical"))();static Spot=(()=>Gt.os.get("Spot"))();static Auto=(()=>Gt.os.get("Auto"))();static Table=(()=>Gt.os.get("Table"))();static Viewbox=(()=>Gt.os.get("Viewbox"))();static TableRow=(()=>Gt.os.get("TableRow"))();static TableColumn=(()=>Gt.os.get("TableColumn"))();static Link=(()=>Gt.os.get("Link"))();static Grid=(()=>Gt.os.get("Grid"))();static Graduated=(()=>Gt.os.get("Graduated"))()}Yt.definePanelLayout=Yt.definePanelLayout;class _t{rp;lp;hp;ap;Ps;je;rs;Ne;constructor(){this.rp=0,this.lp=100,this.hp=10,this.ap=0,this.Ps=null,this.je=null,this.rs=null,this.Ne=null}copy(){const t=new _t;return t.rp=this.rp,t.lp=this.lp,t.hp=this.hp,t.ap=this.ap,t.Ps=this.Ps,t.je=this.je,t.rs=this.rs,t.Ne=this.Ne,t}}class Ht{ud;dd;Wc;Q0;constructor(){this.ud=x.uC,this.dd=y.Lo,this.Wc=x.mw,this.Q0=[]}copy(){const t=new Ht;return t.ud=this.ud.copy(),t.dd=this.dd.copy(),t.Wc=this.Wc.copy(),t.Q0=this.Q0,t}}class qt{Ge;He;fp;dp;gp;mp;_0;ip;tp;ep;np;sp;op;kh;constructor(){this.Ge=[],this.He=[],this.fp=3,this.dp=3,this.gp=0,this.mp=0,this._0=v.Bg,this.ip=1,this.tp=null,this.ep=null,this.np=1,this.sp=null,this.op=null,this.kh=null}copy(t){const e=new qt,i=this.Ge,n=i.length,s=e.Ge;for(let l=0;l<n;l++){if(void 0===i[l])continue;const e=i[l].copy();e.La(t),s[l]=e}const o=this.He,r=o.length,a=e.He;for(let l=0;l<r;l++){if(void 0===o[l])continue;const e=o[l].copy();e.La(t),a[l]=e}return e.fp=this.fp,e.dp=this.dp,e.gp=this.gp,e.mp=this.mp,e._0=this._0.N(),e.ip=this.ip,e.tp=this.tp,e.ep=this.ep,e.np=this.np,e.sp=this.sp,e.op=this.op,e.kh=this.kh,e}}var Wt=(t=>(t[t.Default=1]="Default",t[t.None=2]="None",t[t.ProportionalExtra=3]="ProportionalExtra",t))(Wt||{});class $t{Gs;pp;Ft;Fa;Ra;fi;dt;md;oo;rl;pd;yd;va;Dt;wd;Ss;st;Fi;pe;constructor(t){u.qi(this),this.Gs=null,this.pp=!0,this.Ft=0,this.pe=NaN,this.Fa=0,this.Ra=1/0,this.fi=w.Default,this.st=0,this.Fi=0,this.dt=0,this.Ss=null,this.md=1,this.oo=1,this.rl=null,this.pd=null,this.yd=NaN,this.va=null,this.Dt=null,this.wd=!1,t&&(Object.assign(this,t),void 0!==t.column?(this.isRow=!1,this.index=t.column):void 0!==t.row&&(this.isRow=!0,this.index=t.row))}copy(){const t=new $t;return t.pp=this.pp,t.Ft=this.Ft,t.pe=this.pe,t.Fa=this.Fa,t.Ra=this.Ra,t.fi=this.fi,t.st=this.st,t.Fi=this.Fi,t.dt=this.dt,t.oo=this.oo,t.md=this.md,null===this.rl?t.rl=null:t.rl=this.rl.N(),t.pd=this.pd,t.yd=this.yd,t.va=null,null!==this.va&&(t.separatorDashArray=this.va.slice()),t.Dt=this.Dt,t.wd=this.wd,t.Ss=this.Ss,t}Vb(t){t.isRow?void 0!==t.height&&(this.height=t.height):void 0!==t.width&&(this.width=t.width),void 0!==t.minimum&&(this.minimum=t.minimum),void 0!==t.maximum&&(this.maximum=t.maximum),void 0!==t.alignment&&(this.alignment=t.alignment),void 0!==t.stretch&&(this.stretch=t.stretch),void 0!==t.sizing&&(this.sizing=t.sizing),void 0!==t.separatorPadding&&(this.separatorPadding=t.separatorPadding),void 0!==t.separatorStroke&&(this.separatorStroke=t.separatorStroke),void 0!==t.separatorStrokeWidth&&(this.separatorStrokeWidth=t.separatorStrokeWidth),void 0!==t.separatorDashArray&&(this.va=t.separatorDashArray),void 0!==t.background&&(this.background=t.background),void 0!==t.coversSeparators&&(this.coversSeparators=t.coversSeparators),void 0!==t.Ss&&(this.Ss=t.Ss)}hi(t){t in Wt?this.sizing=t:e.cr(this,t)}toString(){return"RowColumnDefinition "+(this.isRow?"(Row ":"(Column ")+this.index+") #"+u.us(this)}static Default=1;static None=2;static ProportionalExtra=3;La(t){this.Gs=t}computeEffectiveSpacingTop(t){let e=0;const i=this.Gs;if(this.index!==t){let t=this.separatorStroke;null===t&&null!==i&&(t=this.isRow?i.defaultRowSeparatorStroke:i.defaultColumnSeparatorStroke),null!==t&&(e=this.separatorStrokeWidth,isNaN(e)&&(e=null!==i?this.isRow?i.defaultRowSeparatorStrokeWidth:i.defaultColumnSeparatorStrokeWidth:0))}let n=this.rl;if(null===n){if(null===i)return e;n=i.defaultSeparatorPadding}return e+(this.isRow?n.top:n.left)}computeEffectiveSpacing(){let t=0;const e=this.Gs;let i=0;const n=this.isRow;if(null!==e&&e.type===Yt.Table){const t=n?e.Ge.length:e.He.length;for(let s=0;s<t;s++){const t=n?e.Ge[s]:e.He[s];if(void 0!==t&&0!==t.st){i=t.index;break}}}if(this.index!==i){let i=this.separatorStroke;null===i&&null!==e&&(i=n?e.defaultRowSeparatorStroke:e.defaultColumnSeparatorStroke),null!==i&&(t=this.separatorStrokeWidth,isNaN(t)&&(t=null!==e?n?e.defaultRowSeparatorStrokeWidth:e.defaultColumnSeparatorStrokeWidth:0))}let s=this.rl;if(null===s){if(null===e)return t;s=e.defaultSeparatorPadding}return t+(this.isRow?s.top+s.bottom:s.left+s.right)}t(t,e,i,n,s){const o=this.Gs;if(null!==o&&(o.raiseChangedEvent(2,t,this,e,i,n,s),null!==this.Ss)){const e=o.diagram;if(null!==e&&!e.ge){const e=o.findBindingPanel();if(null!==e){const i=e.data;if(null!==i){const n=this.Ss.iterator;for(;n.next();)n.value.updateSource(this,i,t,e)}}}}}get panel(){return this.Gs}get isRow(){return this.pp}set isRow(t){this.pp=t}get index(){return this.Ft}set index(t){this.Ft=t}get height(){return this.pe}set height(t){const i=this.pe;i!==t&&(t<0&&e._(t,">= 0",$t,"height"),this.pe=t,this.actual=this.st,null!==this.panel&&this.panel.c(),this.t("height",i,t))}get width(){return this.pe}set width(t){const i=this.pe;i!==t&&(t<0&&e._(t,">= 0",$t,"width"),this.pe=t,this.actual=this.st,null!==this.panel&&this.panel.c(),this.t("width",i,t))}get minimum(){return this.Fa}set minimum(t){const i=this.Fa;i!==t&&((t<0||!isFinite(t))&&e._(t,">= 0",$t,"minimum"),this.Fa=t,this.actual=this.st,null!==this.panel&&this.panel.c(),this.t("minimum",i,t))}get maximum(){return this.Ra}set maximum(t){const i=this.Ra;i!==t&&(t<0&&e._(t,">= 0",$t,"maximum"),this.Ra=t,this.actual=this.st,null!==this.panel&&this.panel.c(),this.t("maximum",i,t))}get alignment(){return this.fi}set alignment(t){const e=this.fi;e.equals(t)||(this.fi=t.N(),null!==this.panel&&this.panel.c(),this.t("alignment",e,t))}get stretch(){return this.oo}set stretch(t){const e=this.oo;e!==t&&(this.oo=t,null!==this.panel&&this.panel.c(),this.t("stretch",e,t))}get separatorPadding(){return this.rl}set separatorPadding(t){"number"==typeof t&&(t=new v(t));const e=this.rl;(null===t||null===e||!e.equals(t))&&(null!==t&&(t=t.N()),this.rl=t,null!==this.panel&&this.panel.c(),this.t("separatorPadding",e,t))}get separatorStroke(){return this.pd}set separatorStroke(t){const e=this.pd;e!==t&&(null!==t&&Ut.nd(t,"RowColumnDefinition.separatorStroke"),t instanceof Ut&&t.u(),this.pd=t,null!==this.panel&&this.panel.c(),this.t("separatorStroke",e,t))}get separatorStrokeWidth(){return this.yd}set separatorStrokeWidth(t){const e=this.yd;e!==t&&(this.yd=t,null!==this.panel&&this.panel.c(),this.t("separatorStrokeWidth",e,t))}get separatorDashArray(){return this.va}set separatorDashArray(t){const i=this.va;if(i!==t){if(null!==t&&!Array.isArray(t)&&e.te(t,"Array",$t,"separatorDashArray:value"),null!==t){const n=t.length;let s=0;for(let i=0;i<n;i++){const n=t[i];("number"!=typeof n||!(n>=0)||!isFinite(n))&&e.o("separatorDashArray value "+n+" at index "+i+" must be a positive number or zero."),s+=n}if(0===s){if(null===i)return;t=null}}this.va=t,null!==this.panel&&this.panel.C(),this.t("separatorDashArray",i,t)}}get background(){return this.Dt}set background(t){const e=this.Dt;e!==t&&(null!==t&&Ut.nd(t,"RowColumnDefinition.background"),t instanceof Ut&&t.u(),this.Dt=t,null!==this.panel&&this.panel.C(),this.t("background",e,t))}get coversSeparators(){return this.wd}set coversSeparators(t){const i=this.wd;i!==t&&(e.s(t,"boolean",$t,"coversSeparators"),this.wd=t,null!==this.panel&&this.panel.C(),this.t("coversSeparators",i,t))}get sizing(){return this.md}set sizing(t){const e=this.md;e!==t&&(this.md=t,null!==this.panel&&this.panel.c(),this.t("sizing",e,t))}Hb(){if(1===this.sizing){const t=this.Gs;return this.isRow?t.rowSizing:t.columnSizing}return this.sizing}get actual(){return this.st}set actual(t){isNaN(this.pe)?this.st=Math.max(Math.min(this.Ra,t),this.Fa):this.st=Math.max(Math.min(this.Ra,this.pe),this.Fa)}get measured(){return this.Fi}set measured(t){this.Fi=t}get total(){return this.st+this.computeEffectiveSpacing()}get position(){return this.dt}set position(t){this.dt=t}bind(t,e,i,n){return this.af(t,e,i,n),this}bindTwoWay(t,e,i,n){const s=this.af(t,e,i,n);return void 0===n&&s.makeTwoWay(),this}theme(t,e,i,n,s){return this.xh(t,e,i,n,s),this}themeData(t,e,i,n,s){return this.xh(t,e,i,n,s).ofData(),this}themeObject(t,e,i,n,s,o){return this.xh(t,e,i,n,s).ofObject(o),this}themeModel(t,e,i,n,s){return this.xh(t,e,i,n,s).ofModel(),this}af(t,e,i,n){let s;return s="string"==typeof t?new Ve(t,e,i,n):t,this.j0(s),s}xh(t,e,i,n,s){let o;return o="string"==typeof t?new je(t,e,i,n,s):t,this.j0(o),o}j0(t){t.Se=this;const i=this.panel;if(null!==i){const n=i.findBindingPanel();null!==n&&n.PA()&&e.o("Cannot add a Binding to a RowColumnDefinition that is already frozen: "+t+" on "+i)}null===this.Ss&&(this.Ss=new l),this.Ss.add(t)}}class Jt extends At{at;Ms;xd;Oa;Wi;qo;Ko;Wt;bd;kd;W;constructor(t,e){super(),this.at=null,this.Ms=null,this.xd="None",this.Oa="black",this.Wi="black",this.qo=1,this.Ko=null,this.Wt=null,this.bd=NaN,this.kd=NaN,this.W=null,"string"==typeof t?this.figure=t:t&&Object.assign(this,t),e&&Object.assign(this,e)}cloneProtected(t){super.cloneProtected(t),t.at=this.at,t.Ms=this.Ms,t.xd=this.xd,t.Oa=this.Oa,t.Wi=this.Wi,t.qo=this.qo,null!==this.Ko&&(t.Ko=this.Ko.slice()),null!==this.Wt&&(this.Wt.gi?t.Wt=this.Wt:t.Wt=this.Wt.copy()),t.bd=this.bd,t.kd=this.kd,null!==this.W&&(t.W=this.W.copy())}Ia(){return null===this.Wt?this.Wt=new Zt:this.Wt.gi&&(this.Wt=this.Wt.copy()),this.Wt}gh(){super.gh(),null!==this.Wt&&(this.Wt.gi=!0)}hi(t){t in C?this.geometryStretch=t:super.hi(t)}toString(){return"Shape("+("None"!==this.figure?this.figure:"None"!==this.toArrow?this.toArrow:this.fromArrow)+")#"+u.us(this)}Dv(t,i){const n=this.pathPattern;n.ut(1/0,1/0);const s=n.measuredBounds;n.Yt(0,0,s.width,s.height);const o=this.geometry;t.save(),t.beginPath();const r=e.rt();if(1===o.type)r.push(o.startX),r.push(o.startY),r.push(o.endX),r.push(o.endY),this.Pd(t,i,r,n);else if(4===o.type){const s=o.figures.iterator;for(;s.next();){const o=s.value;r.length=0,r.push(o.startX),r.push(o.startY);let a=o.startX,l=o.startY,h=a,u=l;const c=o.segments.r,d=c.length;for(let s=0;s<d;s++){const d=c[s];switch(d.type){case 1:this.Pd(t,i,r,n),r.length=0,r.push(d.endX),r.push(d.endY),a=d.endX,l=d.endY,h=a,u=l;break;case 2:r.push(d.endX),r.push(d.endY),a=d.endX,l=d.endY;break;case 3:S.Yn(a,l,d.point1X,d.point1Y,d.point2X,d.point2Y,d.endX,d.endY,.5,r),a=d.endX,l=d.endY;break;case 4:S.Vg(a,l,d.point1X,d.point1Y,d.endX,d.endY,.5,r),a=d.endX,l=d.endY;break;case 5:{const t=d.Ao(o),e=t.length;if(0===e){r.push(d.centerX),r.push(d.centerY),a=d.centerX,l=d.centerY;break}for(let i=0;i<e;i++){const e=t[i];S.Yn(a,l,e[2],e[3],e[4],e[5],e[6],e[7],.5,r),a=e[6],l=e[7]}break}case 6:{const t=d.Yh(o,a,l),e=t.length;if(0===e){r.push(d.endX),r.push(d.endY),a=d.endX,l=d.endY;break}for(let i=0;i<e;i++){const e=t[i];S.Yn(a,l,e[2],e[3],e[4],e[5],e[6],e[7],.5,r),a=e[6],l=e[7]}break}default:e.o("Segment not of valid type: "+d.type)}d.isClosed&&(r.push(h),r.push(u),this.Pd(t,i,r,n))}this.Pd(t,i,r,n)}}else if(2===o.type)r.push(o.startX),r.push(o.startY),r.push(o.endX),r.push(o.startY),r.push(o.endX),r.push(o.endY),r.push(o.startX),r.push(o.endY),r.push(o.startX),r.push(o.startY),this.Pd(t,i,r,n);else if(3===o.type){const e=new T;e.startX=o.endX,e.startY=(o.startY+o.endY)/2;const s=new A(5);s.startAngle=0,s.sweepAngle=360,s.centerX=(o.startX+o.endX)/2,s.centerY=(o.startY+o.endY)/2,s.radiusX=Math.abs(o.startX-o.endX)/2,s.radiusY=Math.abs(o.startY-o.endY)/2,e.add(s);const a=s.Ao(e),l=a.length;if(0===l)r.push(s.centerX),r.push(s.centerY);else{let t=e.startX,i=e.startY;for(let e=0;e<l;e++){const n=a[e];S.Yn(t,i,n[2],n[3],n[4],n[5],n[6],n[7],.5,r),t=n[6],i=n[7]}}this.Pd(t,i,r,n)}e.tt(r),t.restore(),t.clearContextCache(!1)}Fv(t){let e=t.measuredBounds.width;return t instanceof Jt&&(e-=t.strokeWidth),e<1&&(e=1),e}Pd(t,i,n,s){const o=n.length;if(o<4)return;const r=s.measuredBounds,a=Math.max(1,r.width),l=r.height;let h=n[0],u=n[1],c=0,d=0,f=0,g=0,m=0,p=0,y=0,x=0;const b=e.rt();for(let e=2;e<o;e+=2)c=n[e],d=n[e+1],f=c-h,g=d-u,0===f&&(f=.001),m=g/f,p=Math.atan2(g,f),y=Math.sqrt(f*f+g*g),b.push([f,p,m,y]),x+=y,h=c,u=d;h=n[0],u=n[1];const v=this.Fv(s);let w=v;const k=a/2;let S=0!==k,P=0,M=b[P];f=M[0],p=M[1],m=M[2],y=M[3];let C=0;for(;x>=.1;){if(0===C&&(S?(w=v,w-=k,x-=k,S=!1):w=v,0===w&&(w=1)),w>x)return w=x,void e.tt(b);w>y?(C=w-y,w=y):C=0;let n=Math.sqrt(w*w/(1+m*m));if(f<0&&(n=-n),h+=n,u+=m*n,t.translate(h,u),t.rotate(p),t.translate(-a/2,-l/2),0===C&&s.wh(t,i),t.translate(a/2,l/2),t.rotate(-p),t.translate(-h,-u),x-=w,y-=w,0!==C){if(P++,P===b.length)return void e.tt(b);M=b[P],f=M[0],p=M[1],m=M[2],y=M[3],w=C}}e.tt(b)}wh(t,e){const i=t instanceof Et;let n=this.Wi;const s=this.Oa;if(null===n&&null===s)return;const o=this.at;if(null===o)return;t.commitTransform();const r=this.actualBounds,a=this.naturalBounds;null!==s&&this.mn(t,s,!0,!1,a,r);const l=this.part;let h=this.qo;null!==n&&0===h&&null!==l&&(this.isPanelMain||l.findMainElement()===this)&&(h=l.Rv()),0===h&&(n=null),null!==n&&0!==h&&(this.mn(t,n,!1,!1,a,r),t.lineWidth=h,t.lineJoin=this.strokeJoin,t.lineCap=this.strokeCap,t.miterLimit=this.strokeMiterLimit);let u=!1;l&&e.getRenderingHint("drawShadows")&&(u=l.isShadowed),!1===t.sl&&(u=!1);let c=!0;null!==n&&(null===s||"transparent"===s)&&(c=!1);let d=!1;const f=this.strokeDashArray;if(null!==f&&(d=!0,t.enableDash(f,this.strokeDashOffset)),1===o.type)t.beginPath(),t.moveTo(o.startX,o.startY),t.lineTo(o.endX,o.endY),null!==n&&t.strokeContext(),t.endPath();else if(2===o.type){const e=o.startX,i=o.startY,r=o.endX,a=o.endY,l=Math.min(e,r),h=Math.min(i,a),d=Math.abs(r-e),f=Math.abs(a-i);t.beginPath(),t.rect(l,h,d,f),null!==s&&t.fillContext(s,!1,null),null!==n&&(c&&u&&t.shadowsOff(),t.strokeContext(),c&&u&&t.shadowsOn()),t.endPath()}else if(3===o.type){const e=o.startX,i=o.startY,r=o.endX,a=o.endY,l=Math.abs(r-e)/2,h=Math.abs(a-i)/2,d=Math.min(e,r)+l,f=Math.min(i,a)+h;t.beginPath(),t.moveTo(d,f-h),t.bezierCurveTo(d+S.Xn*l,f-h,d+l,f-S.Xn*h,d+l,f),t.bezierCurveTo(d+l,f+S.Xn*h,d+S.Xn*l,f+h,d,f+h),t.bezierCurveTo(d-S.Xn*l,f+h,d-l,f+S.Xn*h,d-l,f),t.bezierCurveTo(d-l,f-S.Xn*h,d-S.Xn*l,f-h,d,f-h),t.closePath(),null!==s&&t.fillContext(s,!1,null),null!==n&&(c&&u&&t.shadowsOff(),t.strokeContext(),c&&u&&t.shadowsOn()),t.endPath()}else if(4===o.type){const e=o.figures,r=e.length;for(let o=0;o<r;o++){const r=e.r[o];i?this.buildPath(t,r):null===r.Ve&&(r.Ve=new Path2D,this.buildPath(r.Ve,r));const a=r.isFilled;u?r.isShadowed?(!0===a&&"transparent"!==s&&null!==s&&t.fillContext(s,r.isEvenOdd,r.Ve),null!==n&&(a&&c&&t.shadowsOff(),t.stroke(r.Ve),a&&c&&t.shadowsOn())):(t.shadowsOff(),a&&"transparent"!==s&&null!==s&&t.fillContext(s,r.isEvenOdd,r.Ve),null!==n&&t.stroke(r.Ve),t.shadowsOn()):(a&&null!==s&&t.fillContext(s,r.isEvenOdd,r.Ve),null!==n&&t.stroke(r.Ve)),t.endPath(o)}}d&&t.disableDash(),null!==this.pathPattern&&this.Dv(t,e)}buildPath(t,e){t instanceof Path2D||t.beginPath(),t.moveTo(e.startX,e.startY);const i=e.segments.r,n=i.length;let s=null;for(let o=0;o<n;o++){const n=i[o];switch(n.type){case 1:t.moveTo(n.endX,n.endY);break;case 2:t.lineTo(n.endX,n.endY);break;case 3:t.bezierCurveTo(n.point1X,n.point1Y,n.point2X,n.point2Y,n.endX,n.endY);break;case 4:t.quadraticCurveTo(n.point1X,n.point1Y,n.endX,n.endY);break;case 5:if(n.radiusX===n.radiusY){const i=null!==s?s.endX:e.startX,o=null!==s?s.endY:e.startY,r=Math.PI/180;t.arc(n.point1X,n.point1Y,n.radiusX,n.startAngle*r,(n.startAngle+n.sweepAngle)*r,n.sweepAngle<0,i,o)}else{const i=n.Ao(e),s=i.length;if(0===s){t.lineTo(n.centerX,n.centerY);break}for(let e=0;e<s;e++){const n=i[e];0===e&&t.lineTo(n[0],n[1]),t.bezierCurveTo(n[2],n[3],n[4],n[5],n[6],n[7])}}break;case 6:{let i,o=0,r=0;if(null!==s&&5===s.type){i=s.Ao(e);const a=i.length;if(0===a){t.lineTo(n.endX,n.endY);break}const l=i[a-1]||null;null!==l&&(o=l[6],r=l[7])}else o=null!==s?s.endX:e.startX,r=null!==s?s.endY:e.startY;i=n.Yh(e,o,r);const a=i.length;if(0===a){t.lineTo(n.endX,n.endY);break}for(let e=0;e<a;e++){const n=i[e];t.bezierCurveTo(n[2],n[3],n[4],n[5],n[6],n[7])}break}}n.isClosed&&t.closePath(),s=n}}nf(t,e,i){if(!super.nf(t,e,i)||null===this.Wi&&null===this.Oa||null===this.at||null!==this.pathPattern)return!1;const n=this.svg.getElementsByTagName("path");return this.geometry.figures.length===n.length&&(t.currentPath=this.svg,this.wh(t,e),t.currentPath=null,!0)}ed(t){return null!==this.geometry&&this.geometry.figures.length>1||null!==this.pathPattern||super.ed(t)}u2(t,e){if("g"!==t.nodeName)t.setAttributeNS(null,"filter",e);else{const i=t.getElementsByTagName("path");for(let t=0;t<i.length;t++)i[t].setAttributeNS(null,"filter",e)}}getDocumentPoint(t,i){if(void 0===i&&(i=new y),t instanceof w){const n=t;n.isNoSpot()&&e.o("getDocumentPoint Spot must be a real, specific Spot, not: "+n.toString());const s=this.naturalBounds,o=this.strokeWidth;return i.i(n.x*(s.width+o)-o/2+s.x+n.offsetX,n.y*(s.height+o)-o/2+s.y+n.offsetY),this.Ys.xt(i),i}return i.set(t),this.Ys.xt(i),i}getDocumentBounds(t){void 0===t&&(t=new b);const e=this.naturalBounds,i=this.Ys,n=b.X(e.x,e.y,e.width,e.height),s=this.strokeWidth;n.inflate(s/2,s/2);const o=y.X(n.x,n.y).F(i);return t.i(o.x,o.y,0,0),o.i(n.right,n.y).F(i),t.unionNoCheck(o.x,o.y,0,0),o.i(n.right,n.bottom).F(i),t.unionNoCheck(o.x,o.y,0,0),o.i(n.x,n.bottom).F(i),t.unionNoCheck(o.x,o.y,0,0),b.e(n),y.e(o),t}mh(t,i){const n=this.geometry;if(null===n||null===this.fill&&null===this.stroke)return!1;const s=n.bounds;let o=this.strokeWidth/2;1===n.type&&!i&&(o+=2);const r=b.l();if(r.a(s),r.inflate(o+2,o+2),!r.containsPoint(t))return b.e(r),!1;const a=o+1e-4;if(1===n.type){if(null===this.stroke)return!1;const e=(n.startX-n.endX)*(t.x-n.endX)+(n.startY-n.endY)*(t.y-n.endY),i=(n.endX-n.startX)*(t.x-n.startX)+(n.endY-n.startY)*(t.y-n.startY);return!(e<0||i<0)&&(b.e(r),S.Ei(n.startX,n.startY,n.endX,n.endY,o,t.x,t.y))}if(2===n.type){const e=n.startX,i=n.startY,s=n.endX,l=n.endY;if(r.x=Math.min(e,s),r.y=Math.min(i,l),r.width=Math.abs(s-e),r.height=Math.abs(l-i),null===this.fill){if(r.inflate(-a,-a),r.containsPoint(t))return b.e(r),!1;r.inflate(a,a)}null!==this.stroke&&r.inflate(o,o);const h=r.containsPoint(t);return b.e(r),h}if(3===n.type){const e=n.startX,i=n.startY,s=n.endX,o=n.endY;let l=Math.min(e,s),h=Math.min(i,o);let u=Math.abs(s-e)/2,c=Math.abs(o-i)/2;if(l=t.x-(l+u),h=t.y-(h+c),null===this.fill){if(u-=a,c-=a,u<=0||c<=0)return b.e(r),!1;if(l*l/(u*u)+h*h/(c*c)<=1)return b.e(r),!1;u+=a,c+=a}return null!==this.stroke&&(u+=a,c+=a),b.e(r),!(u<=0||c<=0)&&l*l/(u*u)+h*h/(c*c)<=1}if(4===n.type)return b.e(r),null===this.fill?n.DC(t.x,t.y,o):n.zk(t,o,this.strokeWidth>1,i);e.o("Unknown Geometry type: "+n.type)}_u(t,i,n,s){const o=this.desiredSize,r=this.qo;let a;if(t=Math.max(t,0),i=Math.max(i,0),null!==this.Ms)a=this.geometry.bounds;else{const t=this.figure;let i=Jt.z2[t];if(void 0===i){let n=S.Gn[t];"string"==typeof n&&(n=S.Gn[n]),e.ot(n)?(i=n(null,100,100),Jt.z2[t]=i):e.o("Unsupported Figure: "+t)}a=i.bounds}let l=a.width,h=a.height,u=a.width,c=a.height;switch(this.Hs(!0)){case 0:n=0,s=0;break;case 2:u=Math.max(t-r,0),c=Math.max(i-r,0);break;case 5:u=Math.max(t-r,0),s=0;break;case 4:n=0,c=Math.max(i-r,0)}isFinite(o.width)&&(u=o.width),isFinite(o.height)&&(c=o.height);const d=this.maxSize,f=this.minSize;n=Math.max(n-r,f.width),s=Math.max(s-r,f.height),u=Math.min(d.width,u),c=Math.min(d.height,c),u=isFinite(u)?Math.max(n,u):Math.max(l,n),c=isFinite(c)?Math.max(s,c):Math.max(h,s);const g=this.eS();switch(g){case 0:break;case 2:l=u,h=c;break;case 6:{let t=Math.min(u/l,c/h);isFinite(t)||(t=1),l*=t,h*=t;break}default:e.o(g+" is not a valid geometryStretch.")}if(null!==this.Ms){0===l&&(l=.001),0===h&&(h=.001);const t=(null!==this.Ms?this.Ms:this.at).sF(l,h);this.at=t}else(null===this.at||!S.Y(this.at.fc,t-r)||!S.Y(this.at.uc,i-r))&&(this.at=Jt.vv(this,l,h));a=this.at.bounds,t===1/0||i===1/0?this.so(a.x-r/2,a.y-r/2,0===t&&0===l?0:a.width+r,0===i&&0===h?0:a.height+r):this.so(-r/2,-r/2,u+r,c+r),o.isReal()?(u=o.width,c=o.height,u=Math.min(d.width,u),c=Math.min(d.height,c),u=Math.max(f.width,u),c=Math.max(f.height,c),this.Ki.i(0,0,u,c)):this.Ki.a(a)}eS(){const t=this.geometryStretch;return null!==this.Ms?1===t?2:t:1===t?Jt.z2[this.figure].defaultStretch:t}ph(t,e,i,n){this.commonArrange(t,e,i,n)}getNearestIntersectionPoint(t,e,i){return this.ef(t.x,t.y,e.x,e.y,i)}ef(t,i,n,s,o){const r=this.F,a=1/(r.m11*r.m22-r.m12*r.m21),l=r.m22*a,h=-r.m12*a,u=-r.m21*a,c=r.m11*a,d=a*(r.m21*r.dy-r.m22*r.dx),f=a*(r.m12*r.dx-r.m11*r.dy),g=t*l+i*u+d,m=t*h+i*c+f,p=n*l+s*u+d,x=n*h+s*c+f,v=this.qo/2;let w=this.at;null===w&&(this.ut(1/0,1/0),w=this.at);const k=w.bounds;let P=!1;if(1===w.type)if(this.strokeWidth<=1.5)P=S.Kn(w.startX,w.startY,w.endX,w.endY,g,m,p,x,o);else{let t=0,i=0;if(w.startX===w.endX)t=v,i=0;else{const e=(w.endY-w.startY)/(w.endX-w.startX);i=v/Math.sqrt(1+e*e),t=i*e}const n=e.rt();let s=new y;S.Kn(w.startX+t,w.startY+i,w.endX+t,w.endY+i,g,m,p,x,s)&&n.push(s),s=new y,S.Kn(w.startX-t,w.startY-i,w.endX-t,w.endY-i,g,m,p,x,s)&&n.push(s),s=new y,S.Kn(w.startX+t,w.startY+i,w.startX-t,w.startY-i,g,m,p,x,s)&&n.push(s),s=new y,S.Kn(w.endX+t,w.endY+i,w.endX-t,w.endY-i,g,m,p,x,s)&&n.push(s);const r=n.length;if(0===r)return e.tt(n),!1;P=!0;let a=1/0;for(let e=0;e<r;e++){const t=n[e],i=(t.x-g)**2+(t.y-m)**2;i<a&&(a=i,o.x=t.x,o.y=t.y)}e.tt(n)}else if(2===w.type)P=S.kl(k.x-v,k.y-v,k.x+k.width+v,k.y+k.height+v,g,m,p,x,o);else if(3===w.type){const t=b.X(k.x,k.y,k.width,k.height).inflate(v,v);P=this.Ov(t,g,m,p,x,o),b.e(t)}else if(4===w.type){let r=0,a=0,l=0,h=0;const u=y.l();let c=p-g,d=x-m,f=c*c+d*d,b=g,M=m;if(f>0&&k.contains(b,M)&&(u.x=b,u.y=M,this.containsPoint(u)))for(0!==c&&Math.abs(c)<.5?(d*=.5/c,c=.5):0!==d&&Math.abs(d)<.5&&(c*=.5/d,d=.5),b-=c,M-=d;k.contains(b,M);)b-=c,M-=d;const C=.6;o.x=p,o.y=x;for(let t=0;t<w.figures.count;t++){const i=w.figures.r[t],n=i.isFilled?b:g,s=i.isFilled?M:m,c=i.segments;r=i.startX,a=i.startY;let d=r,y=a;for(let t=0;t<c.count;t++){const g=c.r[t],m=g.type;l=g.endX,h=g.endY;let b=!1;switch(m){case 1:d=l,y=h;break;case 2:b=this.$b(r,a,l,h,n,s,p,x,u);break;case 3:b=S.zg(r,a,g.point1X,g.point1Y,g.point2X,g.point2Y,l,h,n,s,p,x,C,u);break;case 4:b=S.zg(r,a,r+2/3*(g.point1X-r),a+2/3*(g.point1Y-a),l+2/3*(g.point1X-l),h+2/3*(g.point1Y-h),l,h,n,s,p,x,C,u);break;case 5:case 6:{const t=5===g.type?g.Ao(i):g.Yh(i,r,a),e=t.length;if(0===e){b=this.$b(r,a,5===g.type?g.centerX:g.endX,5===g.type?g.centerY:g.endY,n,s,p,x,u);break}let c=null;for(let i=0;i<e;i++){if(c=t[i],0===i&&this.$b(r,a,c[0],c[1],n,s,p,x,u)){const t=this.Zb(n,s,u,f,o);t<f&&(f=t,P=!0)}if(S.zg(c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7],n,s,p,x,C,u)){const t=this.Zb(n,s,u,f,o);t<f&&(f=t,P=!0)}}l=c[6],h=c[7];break}default:e.o("Unknown Segment type: "+m)}if(r=l,a=h,b){const t=this.Zb(n,s,u,f,o);t<f&&(f=t,P=!0)}if(g.isClosed&&(l=d,h=y,this.$b(r,a,l,h,n,s,p,x,u))){const t=this.Zb(n,s,u,f,o);t<f&&(f=t,P=!0)}}}let N=n-t,T=s-i;const L=Math.sqrt(N*N+T*T);0!==L&&(N/=L,T/=L),o.x-=N*v,o.y-=T*v,y.e(u)}else e.o("Unknown Geometry type: "+w.type);return!!P&&(this.F.xt(o),!0)}Zb(t,e,i,n,s){const o=i.x-t,r=i.y-e,a=o*o+r*r;return a<n?(s.x=i.x,s.y=i.y,a):n}$b(t,e,i,n,s,o,r,a,l){if(S.Y(t,i)&&S.Y(e,n)||S.Y(s,r)&&S.Y(o,a))return!1;let h=!1;const u=(s-r)*(e-n)-(o-a)*(t-i);if(0===u)return!1;if(l.x=((s*a-o*r)*(t-i)-(s-r)*(t*n-e*i))/u,l.y=((s*a-o*r)*(e-n)-(o-a)*(t*n-e*i))/u,(t>i?t-i:i-t)<(e>n?e-n:n-e)){const t=e<n?e:n,i=e<n?n:e;(l.y>t||S.Y(l.y,t))&&(l.y<i||S.Y(l.y,i))&&(h=!0)}else{const e=t<i?t:i,n=t<i?i:t;(l.x>e||S.Y(l.x,e))&&(l.x<n||S.Y(l.x,n))&&(h=!0)}return h}Iv(t,e,i){return!1!==this.pickable&&(i.ac(this.F),e?this.Ev(t,i):this.containedInRect(t,i))}containedInRect(t,e){if(void 0===e)return t.containsRect(this.actualBounds);let i=this.at;null===i&&(this.ut(1/0,1/0),i=this.at);const n=i.bounds,s=this.strokeWidth/2;let o=!1;const r=y.l();return r.i(n.x-s,n.y-s),t.containsPoint(e.xt(r))&&(r.i(n.x-s,n.bottom+s),t.containsPoint(e.xt(r))&&(r.i(n.right+s,n.bottom+s),t.containsPoint(e.xt(r))&&(r.i(n.right+s,n.y-s),t.containsPoint(e.xt(r))&&(o=!0)))),y.e(r),o}intersectsRect(t,e){if(this.containedInRect(t,e)||void 0===e&&(e=this.F,t.containsRect(this.actualBounds)))return!0;const i=k.l();i.set(e),i.yw();const n=t.left,s=t.right,o=t.top,r=t.bottom,a=y.l();if(a.i(n,o),i.xt(a),this.mh(a,!0))return y.e(a),!0;if(a.i(s,o),i.xt(a),this.mh(a,!0))return y.e(a),!0;if(a.i(n,r),i.xt(a),this.mh(a,!0))return y.e(a),!0;if(a.i(s,r),i.xt(a),this.mh(a,!0))return y.e(a),!0;const l=y.l(),h=y.l();i.set(e),i.xC(this.F),i.yw(),l.x=s,l.y=o,l.F(i),a.x=n,a.y=o,a.F(i);let u=!1;return this.Ea(a,l,h)?u=!0:(a.x=s,a.y=r,a.F(i),this.Ea(a,l,h)?u=!0:(l.x=n,l.y=r,l.F(i),this.Ea(a,l,h)?u=!0:(a.x=n,a.y=o,a.F(i),this.Ea(a,l,h)&&(u=!0)))),y.e(a),k.e(i),y.e(l),y.e(h),u}Ea(t,e,i){if(!this.getNearestIntersectionPoint(t,e,i))return!1;const n=t.x,s=t.y,o=e.x,r=e.y,a=i.x,l=i.y;if(n===o){let t=0,e=0;return s<r?(t=s,e=r):(t=r,e=s),l>=t&&l<=e}{let t=0,e=0;return n<o?(t=n,e=o):(t=o,e=n),a>=t&&a<=e}}Ev(t,e){if(this.containedInRect(t,e)||void 0===e&&(e=this.F,t.containsRect(this.actualBounds)))return!0;const i=t.left,n=t.right,s=t.top,o=t.bottom,r=y.l(),a=y.l(),l=y.l(),h=k.l();h.set(e),h.xC(this.F),h.yw(),a.x=n,a.y=s,a.F(h),r.x=i,r.y=s,r.F(h);let u=!1;return this.Ea(r,a,l)?u=!0:(r.x=n,r.y=o,r.F(h),this.Ea(r,a,l)?u=!0:(a.x=i,a.y=o,a.F(h),this.Ea(r,a,l)?u=!0:(r.x=i,r.y=s,r.F(h),this.Ea(r,a,l)&&(u=!0)))),k.e(h),y.e(r),y.e(a),y.e(l),u}dA(t,i,n){if(n&&null!==this.fill&&this.mh(t,!0))return!0;let s=t.distanceSquaredPoint(i);const o=s;this.strokeWidth>1.5&&(s=this.strokeWidth/2+Math.sqrt(s),s*=s);let r=this.at;if(null===r&&(this.ut(1/0,1/0),r=this.at,null===r))return!1;if(!n){const e=r.bounds,i=e.x,n=e.y,o=e.x+e.width,a=e.y+e.height;if(y.distanceSquared(t.x,t.y,i,n)<=s&&y.distanceSquared(t.x,t.y,o,n)<=s&&y.distanceSquared(t.x,t.y,i,a)<=s&&y.distanceSquared(t.x,t.y,o,a)<=s)return!0}function a(t,e){const i=t.length;for(let n=0;n<i;n+=2)if(e.distanceSquared(t[n],t[n+1])>s)return!0;return!1}const l=r.startX,h=r.startY,u=r.endX,c=r.endY;if(1===r.type){const e=y.distanceLineSegmentSquared(t.x,t.y,l,h,u,c),i=(u-l)*(t.x-l)+(c-h)*(t.y-h),n=(l-u)*(t.x-u)+(h-c)*(t.y-c);return e<=(i>=0&&n>=0?s:o)}if(2===r.type){let e=!1;return n&&(e=y.distanceLineSegmentSquared(t.x,t.y,l,h,l,c)<=s||y.distanceLineSegmentSquared(t.x,t.y,l,h,u,h)<=s||y.distanceLineSegmentSquared(t.x,t.y,u,h,u,c)<=s||y.distanceLineSegmentSquared(t.x,t.y,l,c,u,c)<=s),e}if(3===r.type){const e=(l+u)/2,i=(h+c)/2,o=t.x-e,r=t.y-i,a=Math.abs(u-l)/2,d=Math.abs(c-h)/2;if(0===a||0===d)return y.distanceLineSegmentSquared(t.x,t.y,l,h,u,c)<=s;if(n){const t=S.WD(a,d,o,r);return t*t<=s}return!(y.distanceSquared(o,r,-a,0)>=s||y.distanceSquared(o,r,0,-d)>=s||y.distanceSquared(o,r,0,d)>=s||y.distanceSquared(o,r,a,0)>=s)}if(4===r.type){const i=r.bounds,o=i.x,l=i.y,h=i.x+i.width,u=i.y+i.height;if(t.x>h&&t.x<o&&t.y>u&&t.y<l&&y.distanceLineSegmentSquared(t.x,t.y,o,l,o,u)>s&&y.distanceLineSegmentSquared(t.x,t.y,o,l,h,l)>s&&y.distanceLineSegmentSquared(t.x,t.y,h,u,o,u)>s&&y.distanceLineSegmentSquared(t.x,t.y,h,u,h,l)>s)return!1;const c=Math.sqrt(s);if(!n){const i=r.figures;for(let n=0;n<i.count;n++){const o=i.r[n];let r=o.startX,l=o.startY;if(t.distanceSquared(r,l)>s)return!1;const h=o.segments.r,u=h.length;for(let i=0;i<u;i++){const n=h[i];switch(n.type){case 1:case 2:if(r=n.endX,l=n.endY,t.distanceSquared(r,l)>s)return!1;break;case 3:{const i=e.rt();S.Yn(r,l,n.point1X,n.point1Y,n.point2X,n.point2Y,n.endX,n.endY,.8,i);const o=a(i,t);if(e.tt(i),o||(r=n.endX,l=n.endY,t.distanceSquared(r,l)>s))return!1;break}case 4:{const i=e.rt();S.Vg(r,l,n.point1X,n.point1Y,n.endX,n.endY,.8,i);const o=a(i,t);if(e.tt(i),o||(r=n.endX,l=n.endY,t.distanceSquared(r,l)>s))return!1;break}case 5:case 6:{const i=5===n.type?n.Ao(o):n.Yh(o,r,l),h=i.length;if(0===h){if(r=5===n.type?n.centerX:n.endX,l=5===n.type?n.centerY:n.endY,t.distanceSquared(r,l)>s)return!1;break}let u=null;const c=e.rt();for(let n=0;n<h;n++)if(u=i[n],c.length=0,S.Yn(u[0],u[1],u[2],u[3],u[4],u[5],u[6],u[7],.8,c),a(c,t))return e.tt(c),!1;e.tt(c),null!==u&&(r=u[6],l=u[7]);break}default:e.o("Unknown Segment type: "+n.type)}}}return!0}if(null===this.fill?r.DC(t.x,t.y,c):r.zk(t,c,!0,!1))return!0}return!1}Ov(t,e,i,n,s,o){if(0===t.width)return S.Kn(t.x,t.y,t.x,t.y+t.height,e,i,n,s,o);if(0===t.height)return S.Kn(t.x,t.y,t.x+t.width,t.y,e,i,n,s,o);{const r=t.width/2,a=t.height/2,l=t.x+r,h=t.y+a;let u=9999;if(e!==n&&(u=(i-s)/(e-n)),Math.abs(u)<9999){const t=i-h-u*(e-l);if(r*r*(u*u)+a*a-t*t<0)return o.x=NaN,o.y=NaN,!1;const n=Math.sqrt(r*r*(u*u)+a*a-t*t),s=(-r*r*u*t+r*a*n)/(a*a+r*r*(u*u))+l,c=(-r*r*u*t-r*a*n)/(a*a+r*r*(u*u))+l,d=u*(s-l)+t+h,f=u*(c-l)+t+h;Math.abs((e-s)**2)+Math.abs((i-d)**2)<Math.abs((e-c)**2)+Math.abs((i-f)**2)?(o.x=s,o.y=d):(o.x=c,o.y=f)}else{const t=a*a,n=e-l,s=t-t/(r*r)*(n*n);if(s<0)return o.x=NaN,o.y=NaN,!1;const u=Math.sqrt(s),c=h+u,d=h-u;Math.abs(c-i)<Math.abs(d-i)?(o.x=e,o.y=c):(o.x=e,o.y=d)}return!0}}Nv(){return this.qo/2*this.strokeMiterLimit*this.getDocumentScale()}get geometry(){return null!==this.at?this.at:this.Ms}set geometry(t){const e=this.at,i=this.Ms;if(e===t)return;null!==t?(this.at=t.u(),this.Ms=this.at):(this.at=null,this.Ms=null);const n=this.part;if(null!==n&&n.pf(),this.c(),this.t("geometry",e||i,t),this.tf()){const t=this.part;null!==t&&this.Na(t,"geometryString")}}get geometryString(){return null===this.geometry?"":this.geometry.toString()}set geometryString(t){const e=N.parse(t),i=e.normalize();this.geometry=e;const n=y.X(-i.x,-i.y);this.position=n,y.e(n)}get isGeometryPositioned(){return 0!==(1048576&this.n)}set isGeometryPositioned(t){const e=0!==(1048576&this.n);e!==t&&(this.n=1048576^this.n,this.c(),this.t("isGeometryPositioned",e,t))}oe(){this.at=null}get fill(){return this.Oa}set fill(t){const e=this.Oa;e!==t&&(null!==t&&Ut.nd(t,"Shape.fill"),t instanceof Ut&&t.u(),this.Oa=t,this.C(),this.t("fill",e,t))}get stroke(){return this.Wi}set stroke(t){const e=this.Wi;e!==t&&(null!==t&&Ut.nd(t,"Shape.stroke"),t instanceof Ut&&t.u(),this.Wi=t,this.C(),this.t("stroke",e,t))}get strokeWidth(){return this.qo}set strokeWidth(t){const i=this.qo;if(i!==t)if(t>=0){this.qo=t,this.c();const e=this.part;null!==e&&e.pf(),this.t("strokeWidth",i,t)}else e._(t,"value >= 0",Jt,"strokeWidth:value")}k0(){return this.qo}get strokeCap(){return null!==this.Wt?this.Wt.yp:"butt"}set strokeCap(t){const i=this.strokeCap;i!==t&&("string"!=typeof t||"butt"!==t&&"round"!==t&&"square"!==t?e._(t,'"butt", "round", or "square"',Jt,"strokeCap"):(this.Ia().yp=t,this.C(),this.t("strokeCap",i,t)))}get strokeJoin(){return null!==this.Wt?this.Wt.wp:"miter"}set strokeJoin(t){const i=this.strokeJoin;i!==t&&("string"!=typeof t||"miter"!==t&&"bevel"!==t&&"round"!==t?e._(t,'"miter", "bevel", or "round"',Jt,"strokeJoin"):(this.Ia().wp=t,this.C(),this.t("strokeJoin",i,t)))}get strokeMiterLimit(){return null!==this.Wt?this.Wt.xp:10}set strokeMiterLimit(t){const e=this.strokeMiterLimit;if(e!==t&&t>=1){this.Ia().xp=t,this.C();const i=this.part;null!==i&&i.pf(),this.t("strokeMiterLimit",e,t)}}get strokeDashArray(){return this.Ko}set strokeDashArray(t){const i=this.Ko;if(i!==t){if(null!==t&&!Array.isArray(t)&&e.te(t,"Array",Jt,"strokeDashArray:value"),null!==t){const n=t.length;let s=0;for(let i=0;i<n;i++){const n=t[i];(!(n>=0)||!isFinite(n))&&e.o("strokeDashArray:value "+n+" at index "+i+" must be a positive number or zero."),s+=n}if(0===s){if(null===i)return;t=null}}this.Ko=t,this.C(),this.t("strokeDashArray",i,t)}}get strokeDashOffset(){return null!==this.Wt?this.Wt.bh:0}set strokeDashOffset(t){const e=this.strokeDashOffset;e!==t&&t>=0&&(this.Ia().bh=t,this.C(),this.t("strokeDashOffset",e,t))}get figure(){return this.xd}set figure(t){const i=this.xd;if(i!==t){let n=S.Gn[t];if(e.ot(n)?n=t:(n=S.Gn[t.toLowerCase()],n||e.o("Unknown Shape.figure: "+t)),i!==n){const t=this.part;null!==t&&t.pf(),this.xd=n,this.Ms=null,this.oe(),this.c(),this.t("figure",i,n)}}}get toArrow(){return null!==this.Ut?this.Ut.bp:"None"}set toArrow(t){const i=this.toArrow;if(!0===t?t="Standard":!1===t&&(t=""),i!==t){const n=Jt.XA(t);null===n?e.o("Unknown Shape.toArrow: "+t):i!==n&&(null===this.Ut&&(this.Ut=new Ce),this.Ut.bp=n,this.Ms=null,this.oe(),this.c(),this.YA(n),this.t("toArrow",i,n))}}get fromArrow(){return null!==this.Ut?this.Ut.kp:"None"}set fromArrow(t){const i=this.fromArrow;if(!0===t?t="Standard":!1===t&&(t=""),i!==t){const n=Jt.XA(t);null===n?e.o("Unknown Shape.fromArrow: "+t):i!==n&&(null===this.Ut&&(this.Ut=new Ce),this.Ut.kp=n,this.Ms=null,this.oe(),this.c(),this.YA(n),this.t("fromArrow",i,n))}}YA(t){const e=this.diagram;if(null!==e&&e.undoManager.isUndoingRedoing)return;this.WR();const i=w.MiddleRight;"None"!==this.toArrow?(this.segmentIndex=-1,this.alignmentFocus=i):"None"!==this.fromArrow&&(this.segmentIndex=0,this.alignmentFocus=new w(1-i.x,i.y))}get spot1(){return null!==this.Wt?this.Wt.Hn:w.Default}set spot1(t){const e=this.spot1;e.equals(t)||(t=t.N(),this.Ia().Hn=t,this.c(),this.t("spot1",e,t))}get spot2(){return null!==this.Wt?this.Wt.jn:w.Default}set spot2(t){const e=this.spot2;e.equals(t)||(t=t.N(),this.Ia().jn=t,this.c(),this.t("spot2",e,t))}get parameter1(){return this.bd}set parameter1(t){const e=this.bd;e!==t&&(this.bd=t,this.oe(),this.c(),this.t("parameter1",e,t))}get parameter2(){return this.kd}set parameter2(t){const e=this.kd;e!==t&&(this.kd=t,this.oe(),this.c(),this.t("parameter2",e,t))}get naturalBounds(){return this.Ki}gv(){const t=this.desiredSize;if(t.isReal()||null===this.at)this.Ki.i(0,0,t.width,t.height);else{const t=this.at.bounds;this.Ki.a(t)}}get pathPattern(){return null!==this.Wt?this.Wt.Pp:null}set pathPattern(t){const e=this.pathPattern;e!==t&&(this.Ia().Pp=t,this.C(),this.t("pathPattern",e,t))}get geometryStretch(){return null!==this.Wt?this.Wt.Sp:1}set geometryStretch(t){const e=this.geometryStretch;e!==t&&(this.Ia().Sp=t,this.c(),this.t("geometryStretch",e,t))}get interval(){return null!==this.W?this.W.wf:1}set interval(t){const e=this.interval;if(e!==(t=Math.round(t))&&0!==t&&isFinite(t)){null===this.W&&(this.W=new se),this.W.wf=t;const i=this.diagram;null!==i&&this.panel===i.grid&&i.rh(),this.c();const n=this.panel;null!==n&&(n.rs=null),this.t("interval",e,t)}}get graduatedStart(){return null!==this.W?this.W.xf:0}set graduatedStart(t){const e=this.graduatedStart;e!==t&&(t<0?t=0:t>1&&(t=1),null===this.W&&(this.W=new se),this.W.xf=t,this.c(),this.t("graduatedStart",e,t))}get graduatedEnd(){return null!==this.W?this.W.bf:1}set graduatedEnd(t){const e=this.graduatedEnd;e!==t&&(t<0?t=0:t>1&&(t=1),null===this.W&&(this.W=new se),this.W.bf=t,this.c(),this.t("graduatedEnd",e,t))}get graduatedSkip(){return null!==this.W?this.W.kf:null}set graduatedSkip(t){const i=this.graduatedSkip;i!==t&&(null!==t&&e.S(t,Jt,"graduatedSkip"),null===this.W&&(this.W=new se),this.W.kf=t,this.c(),this.t("graduatedSkip",i,t))}static vv(t,i,n){let s=null;if("None"!==t.toArrow)s=Jt.Sn[t.toArrow];else if("None"!==t.fromArrow)s=Jt.Sn[t.fromArrow];else{let o=S.Gn[t.figure];"string"==typeof o&&(o=S.Gn[o]),void 0===o&&e.o("Unknown Shape.figure: "+t.figure),s=o(t,i,n),s.fc=i,s.uc=n}if(null===s){const o=S.Gn.Rectangle;e.ot(o)&&(s=o(t,i,n))}return s}static getFigureGenerators(){const t=new p;for(const e in S.Gn){if(e===e.toLowerCase())continue;const i=S.Gn[e];t.set(e,i)}return t.u(),t}static defineFigureGenerator(t,i){e.s(t,"string",Jt,"defineFigureGenerator:name"),"string"==typeof i||e.S(i,Jt,"defineFigureGenerator:func");const n=t.toLowerCase(),s=S.Gn;s[t]=i,s[n]=t}static isFigureDefined(t){return S.Gn.has(t)}static getArrowheadGeometries(){const t=new p;for(const e in S.Kg)if(void 0===Jt.Sn[e]){const t=N.parse(S.Kg[e],!1);Jt.Sn[e]=t;const i=e.toLowerCase();i!==e&&(Jt.Sn[i]=e)}for(const e in Jt.Sn){if(e===e.toLowerCase())continue;const i=Jt.Sn[e];i instanceof N&&t.set(e,i)}return t.u(),t}static defineArrowheadGeometry(t,i){e.s(t,"string",Jt,"defineArrowheadGeometry:name");let n=null;"string"==typeof i?(e.s(i,"string",Jt,"defineArrowheadGeometry:pathstr"),n=N.parse(i,!1)):n=i;const s=t.toLowerCase();("none"===s||t===s)&&e.o("Shape.defineArrowheadGeometry name must not be empty or None or all-lower-case: "+t);const o=Jt.Sn;o[t]=n,o[s]=t}static isArrowheadDefined(t){return Jt.Sn.has(t)}static Sn=(()=>new n)();static z2=(()=>new n)();static XA(t){let e=Jt.Sn[t];if(void 0===e){const i=t.toLowerCase();if("none"===i)return"None";if(e=Jt.Sn[i],void 0===e){let t=null;for(const e in S.Kg)if(e.toLowerCase()===i){t=e;break}if(null!==t){const e=N.parse(S.Kg[t],!1);return Jt.Sn[t]=e,i!==t&&(Jt.Sn[i]=t),t}}}return"string"==typeof e?e:e instanceof N?t:null}}class Zt{gi;yp;wp;xp;bh;Pp;Sp;Hn;jn;constructor(){this.gi=!1,this.yp="butt",this.wp="miter",this.xp=10,this.bh=0,this.Pp=null,this.Sp=1,this.Hn=w.Default,this.jn=w.Default}copy(){const t=new Zt;return t.yp=this.yp,t.wp=this.wp,t.xp=this.xp,t.bh=this.bh,t.Pp=this.Pp,t.Sp=this.Sp,t.Hn=this.Hn.N(),t.jn=this.jn.N(),t}}var Qt=(t=>(t[t.None=0]="None",t[t.Fit=1]="Fit",t[t.DesiredSize=2]="DesiredSize",t[t.BreakAll=3]="BreakAll",t))(Qt||{}),te=(t=>(t[t.Clip=0]="Clip",t[t.Ellipsis=1]="Ellipsis",t))(te||{}),ee=(t=>(t[t.Trim=0]="Trim",t[t.None=1]="None",t))(ee||{});class ie extends At{ai;Wi;Mn;ye;mi;P0;Sd;W;ct;El;ao;Nn;Te;Ri;Cn;constructor(t,e){return super(),this.n|=2097152,this.ai="",this.Wi="black",this.Mn="13px sans-serif",this.ye=0,this.mi=0,this.P0=0,this.Sd=null,this.W=null,this.ct=null,this.El=0,this.ao=null,this.Nn=0,this.Te=null,this.Ri=null,this.Cn=null,"string"==typeof t?this.text=t:t&&Object.assign(this,t),e&&Object.assign(this,e),this}cloneProtected(t){super.cloneProtected(t),t.ai=this.ai,t.Wi=this.Wi,t.Mn=this.Mn,t.ye=this.ye,t.mi=this.mi,t.P0=this.P0,t.Sd=this.Sd,null!==this.W&&(t.W=this.W.copy()),null!==this.ct&&(this.ct.gi?t.ct=this.ct:t.ct=this.ct.copy()),t.El=this.El,t.ao=this.ao,t.Nn=this.Nn,t.Te=this.Te,t.Ri=this.Ri,t.Cn=this.Cn}Ln(){return null===this.ct?this.ct=new ne:this.ct.gi&&(this.ct=this.ct.copy()),this.ct}gh(){super.gh(),null!==this.ct&&(this.ct.gi=!0)}kv(t){this.n=6144|t.n,this._t=t.opacity,this.Dt=t.background,this.ns=t.desiredSize.N(),this.minSize=t.minSize.N(),this.maxSize=t.maxSize.N(),null!==t.ki?this.ki=t.ki.copy():this.ki=null,this.nt=t.scale,this.Ht=t.angle,this.stretch=t.stretch,this.tl=t.margin.N(),this.fi=t.alignment.N(),this.$u=t.alignmentFocus.N(),this.segmentFraction=t.segmentFraction,this.segmentOffset=t.segmentOffset.N(),this.segmentOrientation=t.segmentOrientation,null!==t.ri&&(this.ri=t.ri.copy()),this.shadowVisible=t.shadowVisible,this.ai=t.ai,this.Wi=t.Wi,this.Mn=t.Mn,null!==this.W&&(this.W=t.W.copy()),null!==t.ct&&(t.ct.gi?this.ct=t.ct:this.ct=t.ct.copy()),this.El=t.El}xv(t){if(this.ai=t.text||"",this.Ht=t.labelAngle||0,this.ye=t.lineCount||0,this.Bv(t.lines),t.naturalBounds&&(this.Ki=t.naturalBounds),t.actualBounds){const e=t.actualBounds;this.Yt(e.x,e.y,e.width,e.height)}}hi(t){t in Qt?this.wrap=t:super.hi(t)}toString(){return this.ai.length>22?'TextBlock("'+this.ai.substring(0,20)+'"...)':'TextBlock("'+this.ai+'")'}static getEllipsis(){return ie.Mp}static setEllipsis(t){ie.Mp=t,ie.Qb=new n,ie.X2=0}static getBaseline(){return ie._b}static setBaseline(t){ie._b=t}static _b=null;static getUnderline(){return ie.t1}static setUnderline(t){ie.t1=t}static t1=null;static None=0;static WrapFit=1;static WrapDesiredSize=2;static WrapBreakAll=3;static OverflowClip=0;static OverflowEllipsis=1;static FormatTrim=0;static FormatNone=1;c(){super.c(),this.Ye(!0)}get font(){return this.Mn}set font(t){const e=this.Mn;e!==t&&(this.Mn=t,this.ao=null,this.c(),this.t("font",e,t))}static isValidFont(e){return!t.CSS||t.CSS.supports("font",e)}get text(){return this.ai}set text(t){const e=this.ai;e!==(t=null!=t?t.toString():"")&&(this.ai=t,this.c(),this.t("text",e,t))}get textAlign(){return null!==this.ct?this.ct.Np:"start"}set textAlign(t){const e=this.textAlign;e!==t&&("start"===t||"end"===t||"left"===t||"right"===t||"center"===t)&&(this.Ln().Np=t,this.C(),this.t("textAlign",e,t))}get flip(){return null!==this.ct?this.ct.co:0}set flip(t){const e=this.flip;e!==t&&(this.Ln().co=t,this.C(),this.t("flip",e,t))}get verticalAlignment(){return null!==this.ct?this.ct.ll:w.Top}set verticalAlignment(t){const e=this.verticalAlignment;e.equals(t)||(t=t.N(),this.Ln().ll=t,this.hf(),this.t("verticalAlignment",e,t))}get naturalBounds(){if(!this.Ki.isReal()){const t=x.l();this.Y2(this.ai,999999,t);let e=t.width;x.e(t);let i=this.KA(e);const n=this.desiredSize;isNaN(n.width)||(e=n.width),isNaN(n.height)||(i=n.height),this.Ki.zn(e,i)}return this.Ki}get isMultiline(){return 0!==(2097152&this.n)}set isMultiline(t){const e=0!==(2097152&this.n);e!==t&&(this.n=2097152^this.n,this.c(),this.t("isMultiline",e,t))}get isUnderline(){return 0!==(4194304&this.n)}set isUnderline(t){const e=0!==(4194304&this.n);e!==t&&(this.n=4194304^this.n,this.Ye(!0),this.C(),this.t("isUnderline",e,t))}get isStrikethrough(){return 0!==(8388608&this.n)}set isStrikethrough(t){const e=0!==(8388608&this.n);e!==t&&(this.n=8388608^this.n,this.Ye(!0),this.C(),this.t("isStrikethrough",e,t))}get wrap(){return null!==this.ct?this.ct.Cp:2}set wrap(t){const e=this.wrap;e!==t&&(this.Ln().Cp=t,this.c(),this.t("wrap",e,t))}get overflow(){return null!==this.ct?this.ct.Lp:0}set overflow(t){const e=this.overflow;e!==t&&(this.Ln().Lp=t,this.c(),this.t("overflow",e,t))}get isOverflowed(){return 0!==(16777216&this.n)}K2(t){t?this.n|=16777216:this.n&=-16777217}get stroke(){return this.Wi}set stroke(t){const e=this.Wi;e!==t&&(null!==t&&Ut.nd(t,"TextBlock.stroke"),t instanceof Ut&&t.u(),this.Wi=t,"string"!=typeof t&&this.of(),this.C(),this.t("stroke",e,t))}get lineCount(){return this.ye}get lineHeight(){return this.Ap()}get editable(){return 0!==(1048576&this.n)}set editable(t){const e=0!==(1048576&this.n);e!==t&&(this.n=1048576^this.n,this.t("editable",e,t))}get R2(){return 0!==(33554432&this.n)}set R2(t){this.n=33554432^this.n}get textEditor(){return null!==this.ct?this.ct.Tp:null}set textEditor(t){const e=this.textEditor;e!==t&&(this.Ln().Tp=t,this.t("textEditor",e,t))}get errorFunction(){return null!==this.ct?this.ct.ls:null}set errorFunction(t){const i=this.errorFunction;i!==t&&(null!==t&&e.S(t,ie,"errorFunction"),this.Ln().ls=t,this.t("errorFunction",i,t))}get interval(){return null!==this.W?this.W.wf:1}set interval(t){const e=this.interval;if(e!==(t=Math.round(t))&&0!==t&&isFinite(t)){null===this.W&&(this.W=new se),this.W.wf=t,this.c();const i=this.panel;null!==i&&(i.rs=null),this.t("interval",e,t)}}get graduatedStart(){return null!==this.W?this.W.xf:0}set graduatedStart(t){const e=this.graduatedStart;e!==t&&(t<0?t=0:t>1&&(t=1),null===this.W&&(this.W=new se),this.W.xf=t,this.c(),this.t("graduatedStart",e,t))}get graduatedEnd(){return null!==this.W?this.W.bf:1}set graduatedEnd(t){const e=this.graduatedEnd;e!==t&&(t<0?t=0:t>1&&(t=1),null===this.W&&(this.W=new se),this.W.bf=t,this.c(),this.t("graduatedEnd",e,t))}get graduatedFunction(){return null!==this.W?this.W.Dp:null}set graduatedFunction(t){const i=this.graduatedFunction;i!==t&&(null!==t&&e.S(t,ie,"graduatedFunction"),null===this.W&&(this.W=new se),this.W.Dp=t,this.c(),this.t("graduatedFunction",i,t))}get graduatedSkip(){return null!==this.W?this.W.kf:null}set graduatedSkip(t){const i=this.graduatedSkip;i!==t&&(null!==t&&e.S(t,ie,"graduatedSkip"),null===this.W&&(this.W=new se),this.W.kf=t,this.c(),this.t("graduatedSkip",i,t))}wh(t,e){if(null===this.Wi||0===this.ai.length||null===this.Mn)return;const i=this.naturalBounds,n=this.actualBounds,s=i.width,o=i.height,r=this.Ap();let a=t.textAlign=this.textAlign;const l=e.Hu;"start"===a?a=l?"right":"left":"end"===a&&(a=l?"left":"right");const h=this.isUnderline,u=this.isStrikethrough;this.mn(t,this.Wi,!0,!1,i,n),(h||u)&&this.mn(t,this.Wi,!1,!1,i,n);let c=0;const d=s;let f=!1;e.ii===t&&!(e.ii instanceof Et)&&!this.R2&&!0===e.getRenderingHint("textGreeking")&&r*this.wa*e.scale<3&&(f=!0);const g=this.spacingAbove,m=this.spacingBelow;switch(this.flip){case 0:break;case 2:t.translate(s,0),t.scale(-1,1);break;case 1:t.translate(0,o),t.scale(1,-1);break;case 3:t.translate(s,o),t.scale(-1,-1)}t.commitTransform();const p=this.ye,y=(g+r+m)*p;if(o>y){const t=this.verticalAlignment;c=t.y*o-t.y*y+t.offsetY}if(1===p&&null!==this.Cn){let e=this.mi;e>d&&(e=d),c+=g,this.GA(this.Cn,t,0,c,d,r,e,f,a,h,u)}else if(null!==this.Te&&null!==this.Ri)for(let x=0;x<p;x++){let e=this.Te[x];e>d&&(e=d),c+=g,this.GA(this.Ri[x],t,0,c,d,r,e,f,a,h,u),c+=r+m}switch(this.flip){case 0:break;case 2:t.scale(-1,1),t.translate(-s,0);break;case 1:t.scale(1,-1),t.translate(0,-o);break;case 3:t.scale(-1,-1),t.translate(-s,-o)}}GA(t,e,i,n,s,o,r,a,l,h,u){let c=0;if(a){"left"===l?c=0:"right"===l?c=s-r:"center"===l&&(c=(s-r)/2);const t=e.globalAlpha;return e.globalAlpha=t/2,e.fillRect(i+c,n+o/4,r,o/2),void(e.globalAlpha=t)}"left"===l?c=0:"right"===l?c=s:"center"===l&&(c=s/2);const d=null!==ie._b?ie._b(this,o):.75*o;e.fillText(t,i+c,n+d);let f=o/20|0;if(0===f&&(f=1),"right"===l?c-=r:"center"===l&&(c-=r/2),h){const t=null!==ie.t1?ie.t1(this,o):.8*o;this.HA(i+c,n+t,i+c+r,n+t,f,e),e instanceof Et&&e.lastCreatedElement.classList.add("gojs-td")}if(u){let t=n+o-o/2.2|0;f%2!==0&&(t+=.5),this.HA(i+c,t,i+c+r,t,f,e),e instanceof Et&&e.lastCreatedElement.classList.add("gojs-td")}}HA(t,e,i,n,s,o){o.beginPath(),o.lineWidth=s,o.moveTo(t,e),o.lineTo(i,n),o.stroke(),o.endPath()}nf(t,e,i){if(!super.nf(t,e,i))return!1;if(this.mn(t,this.Wi,!0,!1,this.naturalBounds,this.actualBounds),i){if(0===this.svg.getElementsByTagName("text").length)return!0;const e=this.svg.getElementsByClassName("gojs-td");for(let i=0;i<e.length;i++)t.setFillOrStrokeInPlace(e[i],!1)}else this.Uv(this.svg,this.text,t);return!0}Uv(t,e,i){t.innerHTML=e,i.setFillOrStrokeInPlace(t,!0)}ed(t){return!!(this.lineCount>1||this.isUnderline||this.isStrikethrough)||super.ed(t)}u2(t,e){if("g"!==t.nodeName)t.setAttributeNS(null,"filter",e);else{const i=t.getElementsByTagName("text");for(let t=0;t<i.length;t++)i[t].setAttributeNS(null,"filter",e)}}Vv(){this.Nn=0,this.mi=0,this.ao=null,this.Te=null,this.Ri=null,this.Cn=null}_u(t,e,i,n){const s=this.ye;this.El=t,this.K2(!1);const o=this.Mn;null!==ie.nl&&ie.jA!==o&&(ie.nl.font=o,ie.jA=o),this.Vv();let r=0,a=0;isNaN(this.desiredSize.width)?(r=this.zv(),r=Math.min(r,t/this.scale)):r=this.desiredSize.width,null!==this.panel&&(r=Math.min(r,this.panel.maxSize.width)),a=this.KA(r),a=isNaN(this.desiredSize.height)?Math.min(a,e/this.scale):this.desiredSize.height,this.Xv(t,a),(1===this.wrap||isNaN(this.desiredSize.width))&&(r=isNaN(t)?this.mi:Math.min(t,this.mi)),r=Math.max(i,r),a=Math.max(n,a),this.Ki.zn(r,a),this.so(0,0,r,a),null!==this.svg&&s!==this.ye&&this.Ye(!0)}ph(t,e,i,n){this.commonArrange(t,e,i,n)}An(t,e){null===this.Cn?(this.Cn=t,this.mi=e):((null===this.Ri||null===this.Te)&&(this.Ri=[],this.Te=[],this.Ri.push(this.Cn),this.Te.push(this.mi)),this.Ri.push(t),this.Te.push(e),this.Ri.length>this.maxLines&&(this.n|=16777216))}Y2(t,e,i){const n=0===this.formatting;n&&(t=t.trim());let s=0,o=0,r=0;const a=this.Mn,l=this.spacingAbove+this.spacingBelow,h=Math.max(0,this.Ap()+l),u=1===this.overflow?this.qA(a):0;if(this.ye>=this.maxLines)return void(null!==i&&i.i(0,h));let c=t;if(0===this.wrap){if(this.Nn=1,o=this.getStringWidth(t),0===u||o<=e)return this.mi=Math.max(this.mi,o),this.An(t,this.mi),void(null!==i&&i.i(o,h));let s=this.Md(c);c=c.substring(s.length);let a=this.Md(c);for(o=this.getStringWidth(s+a),r=0;a.length>0&&o<=e;){s+=a,c=c.substring(a.length),a=this.Md(c),r=o;let t=s+a;n&&(t=t.trim()),o=this.getStringWidth(t)}for(n&&(a=a.trim()),s+=a,e=Math.max(1,e-u);this.getStringWidth(s)>e&&s.length>1;)s=s.substring(0,s.length-1);return this.K2(!0),s+=ie.Mp,r=this.getStringWidth(s),this.mi=r,this.An(s,r),void(null!==i&&i.i(r,h))}let d=0;for(0===c.length&&(d=1,this.An(c,0));c.length>0;){let t=this.Md(c);for(c=c.substring(t.length);this.getStringWidth(t)>e;){let i=1;for(o=this.getStringWidth(t.substring(0,i)),r=0;o<=e;)i++,r=o,o=this.getStringWidth(t.substring(0,i));let n=0;1===i?(n=o,s=Math.max(s,o)):(n=r,s=Math.max(s,r)),i--,i<1&&(i=1);const a=t.substring(0,i);if(this.An(a,n),d++,t=t.substring(i),this.ye+d>this.maxLines)break}let i=this.Md(c);for(o=this.getStringWidth(t+i),r=0;i.length>0&&o<=e;){t+=i,c=c.substring(i.length),i=this.Md(c),r=o;let e=t+i;n&&(e=e.trim()),o=this.getStringWidth(e)}if(n&&(t=t.trim()),""===t)continue;"\xad"===t[t.length-1]&&(t=t.substring(0,t.length-1)+"\u2010");let a=0;if(0===i.length?(a=o,s=Math.max(s,o)):(r=this.getStringWidth(t),a=r,s=Math.max(s,r)),this.An(t,a),d++,this.ye+d>this.maxLines)break}this.Nn=Math.min(this.maxLines-this.ye,d),this.mi=Math.max(this.mi,s),null!==i&&i.i(this.mi,h*this.Nn)}Xv(t,e){if(0===this.mi||null===this.Te||null===this.Ri||1!==this.overflow)return;const i=this.Mn,n=1===this.overflow?this.qA(i):0,s=this.spacingAbove+this.spacingBelow,o=Math.max(0,this.Ap()+s),r=Math.min(this.maxLines-1,Math.max(Math.floor(e/o+.01)-1,0));if(r+1>=this.Ri.length)return;this.K2(!0);let a=this.Ri[r];const l=Math.max(1,t-n);for(;this.getStringWidth(a)>l&&a.length>1;)a=a.substring(0,a.length-1);a+=ie.Mp;const h=this.getStringWidth(a);this.Ri[r]=a,this.Ri=this.Ri.slice(0,r+1),this.Te[r]=h,this.Te=this.Te.slice(0,r+1),this.Nn=this.Ri.length,this.mi=Math.max(this.mi,h),this.ye=this.Nn,1===this.ye&&(this.Cn=this.Ri[0])}Md(t){if(3===this.wrap)return t.substring(0,1);let e=t.length,i=0;const n=ie.Yv;for(;i<e&&!n.test(t.charAt(i));)i++;for(1===this.formatting&&(e=Math.min(e,i+1));i<e&&n.test(t.charAt(i));)i++;return i>=t.length?t:t.substring(0,i)}getStringWidth(t){return null===ie.nl?8*t.length:ie.nl.measureText(t).width}Ap(){if(null!==this.ao)return this.ao;const t=this.Mn;let e=0;return null===ie.nl?(e=16,this.ao=e,e):(void 0!==ie.G2[t]&&ie.WA<5e3?e=ie.G2[t]:(e=1.3*ie.nl.measureText("M").width,ie.G2[t]=e,ie.WA++),this.ao=e,e)}qA(t){if(null===ie.nl)return 6;let e=0;return void 0!==ie.Qb[t]&&ie.X2<5e3?e=ie.Qb[t]:(e=ie.nl.measureText(ie.Mp).width,ie.Qb[t]=e,ie.X2++),e}i1(t,e){return t.indexOf("\n",e)}KA(t){let e=this.ai.replace(/\r\n/g,"\n").replace(/\r/g,"\n");const i=this.spacingAbove+this.spacingBelow,n=Math.max(0,this.Ap()+i);if(0===e.length)return this.mi=0,this.ye=1,n;if(!this.isMultiline){const t=this.i1(e,0);t>=0&&(e=e.substring(0,t))}let s=0;this.ye=0;let o=0,r=-1,a=!1;for(;!a;){if(r=this.i1(e,o),-1===r&&(r=e.length,a=!0),o<=r){const i=e.substring(o,r);if(0!==this.wrap){this.Nn=0;const e=x.l();this.Y2(i,t,e),s+=e.height,x.e(e),this.ye+=this.Nn}else this.Y2(i,t,null),s+=n,this.ye++;this.ye===this.maxLines&&(a=!0)}o=r+1}return this.P0=s,s}zv(){let t=this.ai.replace(/\r\n/g,"\n").replace(/\r/g,"\n");if(0===t.length)return 8;if(this.isMultiline){let e=0,i=0,n=!1;for(;!n;){let s=this.i1(t,i);-1===s&&(s=t.length,n=!0);let o=t.substring(i,s);0===this.formatting&&(o=o.trim()),e=Math.max(e,this.getStringWidth(o)),i=s+1}return e}{const e=this.i1(t,0);return e>=0&&(t=t.substring(0,e)),this.getStringWidth(t)}}get textValidation(){return null!==this.ct?this.ct.Il:null}set textValidation(t){const i=this.textValidation;i!==t&&(null!==t&&e.S(t,ie,"textValidation"),this.Ln().Il=t,this.t("textValidation",i,t))}get textEdited(){return null!==this.ct?this.ct.Fp:null}set textEdited(t){const i=this.textEdited;i!==t&&(null!==t&&e.S(t,ie,"textEdited"),this.Ln().Fp=t,this.t("textEdited",i,t))}get spacingAbove(){return null!==this.ct?this.ct.Rp:0}set spacingAbove(t){const e=this.spacingAbove;e!==t&&(this.Ln().Rp=t,this.c(),this.t("spacingAbove",e,t))}get spacingBelow(){return null!==this.ct?this.ct.vp:0}set spacingBelow(t){const e=this.spacingBelow;e!==t&&(this.Ln().vp=t,this.c(),this.t("spacingBelow",e,t))}get formatting(){return null!==this.ct?this.ct.Op:0}set formatting(t){const e=this.formatting;e!==t&&(this.Ln().Op=t,this.c(),this.t("formatting",e,t))}get maxLines(){return null!==this.ct?this.ct.Ip:1/0}set maxLines(t){const i=this.maxLines;i!==t&&((t=Math.floor(t))<=0&&e._(t,"> 0",ie,"maxLines"),this.Ln().Ip=t,this.c(),this.t("maxLines",i,t))}getMetrics(){return[this.mi,this.El,this.ao,this.Nn,this.Te,this.Ri,this.Cn]}Bv(t){void 0!==t&&(this.mi=t[0],this.El=t[1],this.ao=t[2],this.Nn=t[3],this.Te=t[4],this.Ri=t[5],this.Cn=t[6])}get metrics(){return{arrSize:null!==this.Te?this.Te:[this.mi],arrText:null!==this.Ri?this.Ri:[this.Cn],maxLineWidth:this.mi,fontHeight:this.ao}}get choices(){return this.Sd}set choices(t){const e=this.Sd;e!==t&&(this.Sd=t,this.t("choices",e,t))}static Yv=(()=>new RegExp("[ \u200b\xad]"))();static G2=(()=>new n)();static WA=0;static Qb=(()=>new n)();static X2=0;static Mp="...";static jA="";static nl=(()=>bt.isUsingDOM()?new Bt(null).ci:null)()}class ne{gi;ls;co;Op;Ip;Lp;Rp;vp;Np;Fp;Tp;Il;ll;Cp;constructor(){this.gi=!1,this.ls=null,this.co=0,this.Op=0,this.Ip=1/0,this.Lp=0,this.Rp=0,this.vp=0,this.Np="start",this.Fp=null,this.Tp=null,this.Il=null,this.ll=w.Top,this.Cp=2}copy(){const t=new ne;return t.ls=this.ls,t.co=this.co,t.Op=this.Op,t.Ip=this.Ip,t.Lp=this.Lp,t.Rp=this.Rp,t.vp=this.vp,t.Np=this.Np,t.Fp=this.Fp,t.Tp=this.Tp,t.Il=this.Il,t.ll=this.ll,t.Cp=this.Cp,t}}class se{wf;xf;bf;Dp;kf;constructor(){this.wf=1,this.xf=0,this.bf=1,this.Dp=null,this.kf=null}copy(){const t=new se;return t.wf=this.wf,t.xf=this.xf,t.bf=this.bf,t.Dp=this.Dp,t.kf=this.kf,t}}var oe=(t=>(t[t.None=0]="None",t[t.Fill=2]="Fill",t[t.Uniform=6]="Uniform",t[t.UniformToFill=7]="UniformToFill",t))(oe||{});class re extends At{hl;wt;al;Pf;ls;cl;Sf;co;Mf;Nf;Ib;constructor(t,e){super(),this.n|=2097152,this.hl=null,this.wt="",this.al=b.KD,this.Pf=2,this.ls=null,this.cl=null,this.Sf=w.Center,this.co=0,this.Mf=null,this.Nf=null,this.Ib=null,"string"==typeof t?this.source=t:t&&Object.assign(this,t),e&&Object.assign(this,e)}cloneProtected(t){super.cloneProtected(t),t.wt=this.wt,t.element=this.hl,t.al=this.al.N(),t.Pf=this.Pf,t.co=this.co,t.ls=this.ls,t.cl=this.cl,t.Sf=this.Sf.N(),t.Nf=this.Nf}hi(t){t in oe?this.imageStretch=t:super.hi(t)}toString(){return"Picture("+this.source+")#"+u.us(this)}get Cf(){return 0!==(1048576&this.n)}set Cf(t){this.Cf!==t&&(this.n=1048576^this.n)}get Ep(){return 0!==(2097152&this.n)}set Ep(t){this.Ep!==t&&(this.n=2097152^this.n)}get yn(){return 0!==(4194304&this.n)}set yn(t){this.yn!==t&&(this.n=4194304^this.n)}static clearCache(t){void 0===t&&(t=""),e.s(t,"string",re,"clearCache:url"),""!==t?re.Bp[t]&&(delete re.Bp[t],re.e1--):(re.Bp=new n,re.e1=0)}static WL(t,e){e.JA||(e.s1=i=>{re.Kv(e,i),t.desiredSize.isReal()||(t.me(!1),t.c())},e.o1=t=>re.Gv(e,t),e.addEventListener("load",e.s1),e.addEventListener("error",e.o1),e.JA=!0)}static FR(t){t.s1&&t.removeEventListener("load",t.s1),t.o1&&t.removeEventListener("error",t.o1),delete t.s1,delete t.o1,delete t.JA}get element(){return this.hl}set element(t){const i=this.hl;if(this.Ye(!0),i!==t){this.Cf=t instanceof HTMLCanvasElement;const n=t instanceof HTMLImageElement;null!==t&&!(n||t instanceof HTMLVideoElement||this.Cf)&&e.o("Picture.element must be an instance of Image, Canvas, or Video, not: "+t);const s=this.diagram;null!==s&&s.EM(this),this.hl=t,null!==t&&n&&void 0===t.ss&&(t.ss=new u),null!==s&&n&&s.IM(this),this.t("element",i,t),this.C()}}TR(){const t=this.hl;if(null===t)return;const e=this.desiredSize.isReal();(this.Cf||!0===t.complete)&&(t.c0&&(t.Up instanceof Event&&null!==this.ls?this.ls(this,t.Up):!0===t.yn&&!t.Up&&null!==this.cl&&t.H2&&this.cl(this,t.H2)),t.yn=!0),t.yn&&e&&null!==this.diagram&&this.diagram.Gu.add(this)}Hv(){if(null===this.hl)return void(this.Mf=!1);const t=new Bt(null).ci;try{t.drawImage(this.hl,0,0)}catch{this.Ep=!1}try{t.getImageData(0,0,1,1).data[3]&&(this.Mf=!1),this.Mf=!1}catch{this.Mf=!0}}get source(){return this.wt}set source(t){const i=this.wt;if(i!==t){this.Ye(!0),e.s(t,"string",re,"source"),this.wt=t;let n=re.Bp;if(!bt.isUsingDOM())return void this.t("source",i,t);let s=null;if(void 0!==n[t])s=n[t];else if(""!==t){re.e1>30&&(re.clearCache(),n=re.Bp),s=e.fs("img"),s.c0=!0,re.WL(this,s);const i=this.Nf;null!==i&&(s.crossOrigin=i(this)),s.src=t,n[t]=s,re.e1++}this.element=s,null!==s&&void 0===s.__goCache&&(s.__goCache=new ae),this.c(),this.C(),this.t("source",i,t)}}static Kv(t,e){let i;t.yn=!0,t.Up=!1;const n=t.ss.copy();if(null==n)return;const s=n.iterator;for(;s.next();){const n=s.value;n.C();const o=t.getAttribute("src")||"",r=n.ih.get(o);if(null===r)continue;const a=r.length;for(let s=0;s<a;s++)i=r[s],i.desiredSize.isReal()||n.Gu.add(i),i.Ye(!0),n.requestUpdate(),t.c0&&(void 0===t.H2&&(t.H2=e),null!==i.cl&&i.cl(i,e))}t.ss.clear()}static Gv(t,i){let n;t.Up=i;const s=t.ss.copy();if(null==s)return;const o=s.iterator;for(;o.next();){const s=o.value,r=t.getAttribute("src")||"",a=s.ih.get(r);if(null===a)continue;const l=a.length,h=e.rt();for(let t=0;t<l;t++)h.push(a[t]);if(t.c0)for(let t=0;t<l;t++)n=h[t],null!==n.ls&&n.ls(n,i);e.tt(h)}t.ss.clear()}reloadSource(){if(""===this.source)return;re.clearCache(this.source);const t=this.source;this.source="",this.source=t}redraw(){this.C(),this.Ye(!0)}get sourceCrossOrigin(){return this.Nf}set sourceCrossOrigin(t){if(this.Nf!==t&&(null!==t&&e.S(t,re,"sourceCrossOrigin"),this.Nf=t,null!==this.element)){const e=this.element.getAttribute("src");null===t&&"string"==typeof e?this.element.crossOrigin=null:null!==t&&(this.element.crossOrigin=t(this)),this.element.src=e}}get sourceRect(){return this.al}set sourceRect(t){const e=this.al;e.equals(t)||(t=t.N(),this.al=t,this.C(),this.t("sourceRect",e,t))}get imageStretch(){return this.Pf}set imageStretch(t){const e=this.Pf;e!==t&&(this.Pf=t,this.C(),this.t("imageStretch",e,t))}get flip(){return this.co}set flip(t){const e=this.co;e!==t&&(this.co=t,this.C(),this.t("flip",e,t))}get imageAlignment(){return this.Sf}set imageAlignment(t){const e=this.Sf;e.equals(t)||(t=t.N(),this.Sf=t,this.C(),this.t("imageAlignment",e,t))}get errorFunction(){return this.ls}set errorFunction(t){const i=this.ls;i!==t&&(null!==t&&e.S(t,re,"errorFunction"),this.ls=t,this.t("errorFunction",i,t))}get successFunction(){return this.cl}set successFunction(t){const i=this.cl;i!==t&&(null!==t&&e.S(t,re,"successFunction"),this.cl=t,this.t("successFunction",i,t))}wh(t,e){const i=this.hl;if(null===i)return;const n=i.getAttribute("src");if(i instanceof HTMLImageElement&&(null===n||""===n)||i.Up instanceof Event&&t instanceof It)return;const s=t instanceof Et,o=this.naturalBounds;let r=0,a=0;const l=this.Cf;let h=l?+i.width:i.naturalWidth,u=l?+i.height:i.naturalHeight;if(void 0===h&&i.videoWidth&&(h=i.videoWidth),void 0===u&&i.videoHeight&&(u=i.videoHeight),0===h||0===u)return;const c=h,d=u;this.sourceRect.isReal()&&(r=this.al.x,a=this.al.y,h=this.al.width,u=this.al.height);let f=h,g=u;const m=this.Pf,p=this.Sf;switch(m){case 0:if(this.sourceRect.isReal())break;f>=o.width&&(r=r+p.offsetX+(f*p.x-o.width*p.x)),g>=o.height&&(a=a+p.offsetY+(g*p.y-o.height*p.y)),h=Math.min(o.width,f),u=Math.min(o.height,g);break;case 2:f=o.width,g=o.height;break;case 6:case 7:let t=0;6===m?(t=Math.min(o.height/g,o.width/f),f*=t,g*=t):7===m&&(t=Math.max(o.height/g,o.width/f),f*=t,g*=t,f>=o.width&&(r=(r+p.offsetX+(f*p.x-o.width*p.x)/f)*h),g>=o.height&&(a=(a+p.offsetY+(g*p.y-o.height*p.y)/g)*u),h*=1/(f/o.width),u*=1/(g/o.height),f=o.width,g=o.height)}const y=h*u,x=this.getDocumentScale()*e.scale,b=f*x*(g*x),v=y/b,w=i.__goCache;let k=null;const S=re.jv;if(!s){if(i.yn&&void 0!==w&&b>4&&v>S*S){null===w.Ot&&(w.$A(4,c,d,i),w.$A(16,c,d,i));const t=w.Ot,e=t.length;for(let i=0;i<e&&t[i].Nd*t[i].Nd<v;i++)k=t[i]}if(!e.Ku&&(null===this.Mf&&this.Hv(),this.Mf))return}const P=f<o.width?p.offsetX+(o.width*p.x-f*p.x):0,M=g<o.height?p.offsetY+(o.height*p.y-g*p.y):0;switch(this.flip){case 0:break;case 2:t.translate(Math.min(o.width,f),0),t.scale(-1,1);break;case 1:t.translate(0,Math.min(o.height,g)),t.scale(1,-1);break;case 3:t.translate(Math.min(o.width,f),Math.min(o.height,g)),t.scale(-1,-1)}if(t.commitTransform(),e.getRenderingHint("pictureRatioOptimization")&&!e.oa&&void 0!==w&&null!==k&&1!==k.Nd){t.save();const e=k.Nd;try{t.drawImage(k.wt,r/e,a/e,Math.min(k.wt.width,h/e),Math.min(k.wt.height,u/e),P,M,Math.min(o.width,f),Math.min(o.height,g)),t instanceof Et&&(this.Ib=[r/e,a/e,Math.min(k.wt.width,h/e),Math.min(k.wt.height,u/e),P,M,Math.min(o.width,f),Math.min(o.height,g)])}catch{this.Ep=!1}t.restore()}else try{t.drawImage(i,r,a,h,u,P,M,Math.min(o.width,f),Math.min(o.height,g)),t instanceof Et&&(this.Ib=[r,a,h,u,P,M,Math.min(o.width,f),Math.min(o.height,g)])}catch{this.Ep=!1}switch(this.flip){case 0:break;case 2:t.scale(-1,1),t.translate(-Math.min(o.width,f),0);break;case 1:t.scale(1,-1),t.translate(0,-Math.min(o.height,g));break;case 3:t.scale(-1,-1),t.translate(-Math.min(o.width,f),-Math.min(o.height,g))}}get naturalBounds(){return this.Ki}_u(t,e,i,n){const s=this.desiredSize,o=this.Hs(!0),r=this.hl,a=this.Cf;let l=0,h=0;(a||!this.yn&&r&&r.complete)&&(this.yn=!0),null===r?(isFinite(s.width)||(t=i),isFinite(s.height)||(e=n)):(l=a?+r.width:r.naturalWidth,h=a?+r.height:r.naturalHeight),isFinite(s.width)||2===o||5===o?(isFinite(t)||(this.sourceRect.isReal()?t=this.sourceRect.width:null!==r&&(t=l)),i=0):null!==r&&!1!==this.yn&&(t=this.sourceRect.isReal()?this.sourceRect.width:l),isFinite(s.height)||2===o||4===o?(isFinite(e)||(this.sourceRect.isReal()?e=this.sourceRect.height:null!==r&&(e=h)),n=0):null!==r&&!1!==this.yn&&(e=this.sourceRect.isReal()?this.sourceRect.height:h),isFinite(s.width)&&(t=s.width),isFinite(s.height)&&(e=s.height);const u=this.maxSize,c=this.minSize;i=Math.max(i||0,c.width),n=Math.max(n||0,c.height),t=Math.min(u.width,t),e=Math.min(u.height,e),t=Math.max(i,t),e=Math.max(n,e),null!==r&&!r.complete&&(isFinite(t)||(t=0),isFinite(e)||(e=0)),this.Ki.zn(t,e),this.so(0,0,t,e)}ph(t,e,i,n){this.commonArrange(t,e,i,n)}static Bp=(()=>new n)();static e1=0;static jv=4}class ae{Ot;constructor(){this.Ot=null}$A(t,e,i,n){null===this.Ot&&(this.Ot=[]);const s=new Bt(null),o=s.ci,r=1/t;if(s.width=e/t,s.height=i/t,0===s.width||0===s.height)return;const a=new le(s.Rt,t);let l=n,h=1;if(this.Ot.length>0){const t=this.Ot[this.Ot.length-1];l=t.wt,h=t.Nd}o.setTransform(r*h,0,0,r*h,0,0),o.commitTransform(),o.drawImage(l,0,0),this.Ot.push(a)}}class le{wt;Nd;constructor(t,e){this.wt=t,this.Nd=e}}class he{Si;Wg;constructor(){this.Wg=new N,this.Si=null}Ii(t){null!==t?(this.Wg=t,t.figures.clear()):this.Wg=new N,this.Si=null}gu(t,e,i,n,s,o){if(void 0!==n&&!0===n){const i=new A(1);i.endX=t,i.endY=e,this.Si.segments.add(i)}else this.Si=new T,this.Si.startX=t,this.Si.startY=e,this.Si.isFilled=i,this.Si.isEvenOdd=o||!1,this.Wg.figures.add(this.Si);void 0!==s&&(this.Si.isShadowed=s)}_D(){const t=this.Si.segments.length;t>0&&this.Si.segments.elt(t-1).close()}tF(){this.Si.segments.length>0&&(this.Si.isFilled=!0)}iF(t){this.Si.isShadowed=t}NE(t){this.Si.isEvenOdd=t}$D(t,e,i){void 0===i&&(i=!1);const n=new A(1);n.endX=t,n.endY=e,i&&n.close(),this.Si.segments.add(n)}mr(t,e,i){void 0===i&&(i=!1);const n=new A(2);n.endX=t,n.endY=e,i&&n.close(),this.Si.segments.add(n)}pr(t,e,i,n,s,o,r){void 0===r&&(r=!1);const a=new A(3);a.point1X=t,a.point1Y=e,a.point2X=i,a.point2Y=n,a.endX=s,a.endY=o,r&&a.close(),this.Si.segments.add(a)}Sw(t,e,i,n,s){void 0===s&&(s=!1);const o=new A(4);o.point1X=t,o.point1Y=e,o.endX=i,o.endY=n,s&&o.close(),this.Si.segments.add(o)}ZD(t,e,i,n,s,o,r){void 0===o&&(o=0),void 0===r&&(r=!1);const a=new A(5);a.startAngle=t,a.sweepAngle=e,a.centerX=i,a.centerY=n,a.radiusX=s,a.radiusY=0!==o?o:s,r&&a.close(),this.Si.segments.add(a)}QD(t,e,i,n,s,o,r,a){void 0===a&&(a=!1);const l=new A(6,o,r,t,e,i,n,s);a&&l.close(),this.Si.segments.add(l)}static j2=null;static CC(t){const e=he.j2;if(null!==e)return he.j2=null,e.Ii(t),e;{const e=new he;return e.Ii(t),e}}static LC(t){he.j2=t}}{const t=function(t,e){const i=t.toLowerCase(),n=S.Gn;n[t]=e,n[i]=t};t("Rectangle",((t,e,i)=>{const n="r"+e+","+i;let s=S.dr[n];return void 0!==s||(s=new N(2),s.endX=e,s.endY=i,S.gr<S.Gg&&(S.dr[n]=s,S.gr++)),s})),t("Square",((t,e,i)=>{const n="s"+e+","+i;let s=S.dr[n];return void 0!==s||(s=new N(2),s.endX=e,s.endY=i,s.defaultStretch=6,S.gr<S.Gg&&(S.dr[n]=s,S.gr++)),s}));const e=(t,e,i,n,s)=>{(isNaN(n)||n<0)&&(n=5),isNaN(s)&&(s=15);const o="rr"+e+","+i+","+n+","+s;let r=S.dr[o];if(void 0!==r)return r;let a=n;1===(1&s)?(a=Math.min(a,2===(2&s)?e/3:e),a=Math.min(a,8===(8&s)?i/3:i)):a=0;const l=new T(a,0,!0);r=(new N).add(l);const h=w.TopLeft.copy(),u=w.BottomRight.copy();if(2===(2&s)){let t=n;t=Math.min(t,1===(1&s)?e/3:e),t=Math.min(t,4===(4&s)?i/3:i);const o=t*S.Xn;l.add(new A(2,e-t,0)).add(new A(3,e,t,e-o,0,e,o)),h.offsetY=o,u.offsetX=-o}else l.add(new A(2,e,0));if(4===(4&s)){let t=n;t=Math.min(t,8===(8&s)?e/3:e),t=Math.min(t,2===(2&s)?i/3:i);const o=t*S.Xn;l.add(new A(2,e,i-t)).add(new A(3,e-t,i,e,i-o,e-o,i)),u.offsetX=-o,u.offsetY=-o}else l.add(new A(2,e,i));if(8===(8&s)){let t=n;t=Math.min(t,4===(4&s)?e/3:e),t=Math.min(t,1===(1&s)?i/3:i);const o=t*S.Xn;l.add(new A(2,t,i)).add(new A(3,0,i-t,o,i,0,i-o)),h.offsetX=o,u.offsetY=-o}else l.add(new A(2,0,i));if(1===(1&s)){const t=a*S.Xn;l.add(new A(2,0,a)).add(new A(3,a,0,0,t,t,0).close()),h.offsetX=t,h.offsetY=t}else l.add(new A(2,0,0).close());return r.spot1=h,r.spot2=u,S.gr<S.Gg&&(S.dr[o]=r,S.gr++),r};t("RoundedRectangle",((t,i,n)=>{const s=t?t.parameter1:NaN,o=t?t.parameter2:NaN;return e(t,i,n,s,o)})),t("Border","RoundedRectangle"),t("RoundedTopRectangle",((t,i,n)=>{const s=t?t.parameter1:NaN;return e(t,i,n,s,3)})),t("RoundedBottomRectangle",((t,i,n)=>{const s=t?t.parameter1:NaN;return e(t,i,n,s,12)})),t("RoundedLeftRectangle",((t,i,n)=>{const s=t?t.parameter1:NaN;return e(t,i,n,s,9)})),t("RoundedRightRectangle",((t,i,n)=>{const s=t?t.parameter1:NaN;return e(t,i,n,s,6)})),t("Ellipse",((t,e,i)=>{const n="e"+e+","+i;let s=S.dr[n];return void 0!==s||(s=new N(3),s.endX=e,s.endY=i,s.spot1=w.vk,s.spot2=w.Ok,S.gr<S.Gg&&(S.dr[n]=s,S.gr++)),s})),t("Circle",((t,e,i)=>{const n="c"+e+","+i;let s=S.dr[n];return void 0!==s||(s=new N(3),s.endX=e,s.endY=i,s.spot1=w.vk,s.spot2=w.Ok,s.defaultStretch=6,S.gr<S.Gg&&(S.dr[n]=s,S.gr++)),s})),t("TriangleRight",((t,e,i)=>(new N).add(new T(0,0).add(new A(2,e,.5*i)).add(new A(2,0,i).close())).setSpots(0,.25,.5,.75))),t("TriangleDown",((t,e,i)=>(new N).add(new T(0,0).add(new A(2,e,0)).add(new A(2,.5*e,i).close())).setSpots(.25,0,.75,.5))),t("TriangleLeft",((t,e,i)=>(new N).add(new T(e,i).add(new A(2,0,.5*i)).add(new A(2,e,0).close())).setSpots(.5,.25,1,.75))),t("TriangleUp",((t,e,i)=>(new N).add(new T(e,i).add(new A(2,0,i)).add(new A(2,.5*e,0).close())).setSpots(.25,.5,.75,1))),t("Triangle","TriangleUp"),t("Diamond",((t,e,i)=>(new N).add(new T(.5*e,0).add(new A(2,0,.5*i)).add(new A(2,.5*e,i)).add(new A(2,e,.5*i).close())).setSpots(.25,.25,.75,.75))),t("LineH",((t,e,i)=>{const n=new N(1);return n.startX=0,n.startY=i/2,n.endX=e,n.endY=i/2,n})),t("LineV",((t,e,i)=>{const n=new N(1);return n.startX=e/2,n.startY=0,n.endX=e/2,n.endY=i,n})),t("None","Rectangle"),t("BarH","Rectangle"),t("BarV","Rectangle"),t("MinusLine","LineH"),t("PlusLine",((t,e,i)=>(new N).add(new T(0,i/2,!1).add(new A(2,e,i/2)).add(new A(1,e/2,0)).add(new A(2,e/2,i))))),t("XLine",((t,e,i)=>(new N).add(new T(0,i,!1).add(new A(2,e,0)).add(new A(1,0,0)).add(new A(2,e,i))))),t("LineRight",((t,e,i)=>(new N).add(new T(.25*e,0,!1).add(new A(2,.75*e,.5*i)).add(new A(2,.25*e,i))))),t("LineDown",((t,e,i)=>(new N).add(new T(0,.25*i,!1).add(new A(2,.5*e,.75*i)).add(new A(2,e,.25*i))))),t("LineLeft",((t,e,i)=>(new N).add(new T(.75*e,0,!1).add(new A(2,.25*e,.5*i)).add(new A(2,.75*e,i))))),t("LineUp",((t,e,i)=>(new N).add(new T(0,.75*i,!1).add(new A(2,.5*e,.25*i)).add(new A(2,e,.75*i))))),t("Capsule",((t,e,i)=>{const n=new N;if(e<i){const s=e/2,o=new T(0,s,!0);n.add(o),o.add(new A(5,180,180,s,s,s,s)),o.add(new A(2,e,i-s)),o.add(new A(5,0,180,s,i-s,s,s)),o.add(new A(2,0,s));const r=isFinite(t.parameter1)?t.parameter1:.156*e;return n.spot1=new w(0,0,0,r),n.spot2=new w(1,1,0,-r),n}if(e>i){const s=i/2,o=new T(s,0,!0);n.add(o),o.add(new A(2,e-s,0)),o.add(new A(5,270,180,e-s,s,s,s)),o.add(new A(2,s,i)),o.add(new A(5,90,180,s,s,s,s));const r=isFinite(t.parameter1)?t.parameter1:.156*i;return n.spot1=new w(0,0,r,0),n.spot2=new w(1,1,-r,0),n}return n.type=3,n.endX=e,n.endY=i,n.spot1=w.vk,n.spot2=w.Ok,n}));const i=(t,e)=>new T(t,e,!1,!1),n=(t,e,i)=>t.add(new A(2,e,i)),s=(t,e,i)=>t.add(new A(1,e,i));t("Borders",((t,e,o)=>{let r=t?t.parameter1:NaN;isNaN(r)?r=10:r&=15;const a=new N;let l;return 10===r?(l=i(e,0),n(l,e,o),s(l,0,o),n(l,0,0)):5===r?(l=i(0,0),n(l,e,0),s(l,e,o),n(l,0,o)):1===r?(l=i(0,0),n(l,e,0),s(l,e,o)):2===r?(l=i(e,0),n(l,e,o)):4===r?(l=i(e,o),n(l,0,o)):8===r?(l=i(0,o),n(l,0,0),s(l,e,o)):3===r?(l=i(0,0),n(l,e,0),n(l,e,o)):6===r?(l=i(e,0),n(l,e,o),n(l,0,o)):12===r?(l=i(e,o),n(l,0,o),n(l,0,0)):9===r?(l=i(0,o),n(l,0,0),n(l,e,0)):7===r?(l=i(0,0),n(l,e,0),n(l,e,o),n(l,0,o)):14===r?(l=i(e,0),n(l,e,o),n(l,0,o),n(l,0,0)):13===r?(l=i(e,o),n(l,0,o),n(l,0,0),n(l,e,0)):11===r?(l=i(0,o),n(l,0,0),n(l,e,0),n(l,e,o)):15===r?(l=i(0,0),n(l,e,0),n(l,e,o),n(l,0,o),l.add(new A(2,0,0).close())):(l=i(0,0),s(l,e,o)),a.add(l),a}))}S.Kg={"":"",Standard:"F1 m 0,0 l 8,4 -8,4 2,-4 z",Backward:"F1 m 8,0 l -2,4 2,4 -8,-4 z",Triangle:"F1 m 0,0 l 8,4.62 -8,4.62 z",BackwardTriangle:"F1 m 8,4 l 0,4 -8,-4 8,-4 0,4 z",Boomerang:"F1 m 0,0 l 8,4 -8,4 4,-4 -4,-4 z",BackwardBoomerang:"F1 m 8,0 l -8,4 8,4 -4,-4 4,-4 z",SidewaysV:"m 0,0 l 8,4 -8,4 0,-1 6,-3 -6,-3 0,-1 z",BackwardV:"m 8,0 l -8,4 8,4 0,-1 -6,-3 6,-3 0,-1 z",OpenTriangle:"m 0,0 l 8,4 -8,4",BackwardOpenTriangle:"m 8,0 l -8,4 8,4",OpenTriangleLine:"m 0,0 l 8,4 -8,4 m 8.5,0 l 0,-8",BackwardOpenTriangleLine:"m 8,0 l  -8,4 8,4 m -8.5,0 l 0,-8",OpenTriangleTop:"m 0,0 l 8,4 m 0,4",BackwardOpenTriangleTop:"m 8,0 l -8,4 m 0,4",OpenTriangleBottom:"m 0,8 l 8,-4",BackwardOpenTriangleBottom:"m 0,4 l 8,4",HalfTriangleTop:"F1 m 0,0 l 0,4 8,0 z m 0,8",BackwardHalfTriangleTop:"F1 m 8,0 l 0,4 -8,0 z m 0,8",HalfTriangleBottom:"F1 m 0,4 l 0,4 8,-4 z",BackwardHalfTriangleBottom:"F1 m 8,4 l 0,4 -8,-4 z",ForwardSemiCircle:"m 4,0 b 270 180 0 4 4",BackwardSemiCircle:"m 4,8 b 90 180 0 -4 4",Feather:"m 0,0 l 3,4 -3,4",BackwardFeather:"m 3,0 l -3,4 3,4",DoubleFeathers:"m 0,0 l 3,4 -3,4 m 3,-8 l 3,4 -3,4",BackwardDoubleFeathers:"m 3,0 l -3,4 3,4 m 3,-8 l -3,4 3,4",TripleFeathers:"m 0,0 l 3,4 -3,4 m 3,-8 l 3,4 -3,4 m 3,-8 l 3,4 -3,4",BackwardTripleFeathers:"m 3,0 l -3,4 3,4 m 3,-8 l -3,4 3,4 m 3,-8 l -3,4 3,4",ForwardSlash:"m 0,8 l 5,-8",BackSlash:"m 0,0 l 5,8",DoubleForwardSlash:"m 0,8 l 4,-8 m -2,8 l 4,-8",DoubleBackSlash:"m 0,0 l 4,8 m -2,-8 l 4,8",TripleForwardSlash:"m 0,8 l 4,-8 m -2,8 l 4,-8 m -2,8 l 4,-8",TripleBackSlash:"m 0,0 l 4,8 m -2,-8 l 4,8 m -2,-8 l 4,8",Fork:"m 0,4 l 8,0 m -8,0 l 8,-4 m -8,4 l 8,4",BackwardFork:"m 8,4 l -8,0 m 8,0 l -8,-4 m 8,4 l -8,4",LineFork:"m 0,0 l 0,8 m 0,-4 l 8,0 m -8,0 l 8,-4 m -8,4 l 8,4",BackwardLineFork:"m 8,4 l -8,0 m 8,0 l -8,-4 m 8,4 l -8,4 m 8,-8 l 0,8",CircleFork:"F1 m 6,4 b 0 360 -3 0 3 z m 0,0 l 6,0 m -6,0 l 6,-4 m -6,4 l 6,4",BackwardCircleFork:"F1 m 0,4 l 6,0 m -6,-4 l 6,4 m -6,4 l 6,-4 m 6,0 b 0 360 -3 0 3",CircleLineFork:"F1 m 6,4 b 0 360 -3 0 3 z m 1,-4 l 0,8 m 0,-4 l 6,0 m -6,0 l 6,-4 m -6,4 l 6,4",BackwardCircleLineFork:"F1 m 0,4 l 6,0 m -6,-4 l 6,4 m -6,4 l 6,-4 m 0,-4 l 0,8 m 7,-4 b 0 360 -3 0 3",Circle:"F1 m 8,4 b 0 360 -4 0 4 z",Block:"F1 m 0,0 l 0,8 8,0 0,-8 z",StretchedDiamond:"F1 m 0,3 l 5,-3 5,3 -5,3 -5,-3 z",Diamond:"F1 m 0,4 l 4,-4 4,4 -4,4 -4,-4 z",Chevron:"F1 m 0,0 l 5,0 3,4 -3,4 -5,0 3,-4 -3,-4 z",StretchedChevron:"F1 m 0,0 l 8,0 3,4 -3,4 -8,0 3,-4 -3,-4 z",NormalArrow:"F1 m 0,2 l 4,0 0,-2 4,4 -4,4 0,-2 -4,0 z",X:"m 0,0 l 8,8 m 0,-8 l -8,8",TailedNormalArrow:"F1 m 0,0 l 2,0 1,2 3,0 0,-2 2,4 -2,4 0,-2 -3,0 -1,2 -2,0 1,-4 -1,-4 z",DoubleTriangle:"F1 m 0,0 l 4,4 -4,4 0,-8 z  m 4,0 l 4,4 -4,4 0,-8 z",BigEndArrow:"F1 m 0,0 l 5,2 0,-2 3,4 -3,4 0,-2 -5,2 0,-8 z",ConcaveTailArrow:"F1 m 0,2 h 4 v -2 l 4,4 -4,4 v -2 h -4 l 2,-2 -2,-2 z",RoundedTriangle:"F1 m 0,1 a 1,1 0 0 1 1,-1 l 7,3 a 0.5,1 0 0 1 0,2 l -7,3 a 1,1 0 0 1 -1,-1 l 0,-6 z",SimpleArrow:"F1 m 1,2 l -1,-2 2,0 1,2 -1,2 -2,0 1,-2 5,0 0,-2 2,2 -2,2 0,-2 z",AccelerationArrow:"F1 m 0,0 l 0,8 0.2,0 0,-8 -0.2,0 z m 2,0 l 0,8 1,0 0,-8 -1,0 z m 3,0 l 2,0 2,4 -2,4 -2,0 0,-8 z",BoxArrow:"F1 m 0,0 l 4,0 0,2 2,0 0,-2 2,4 -2,4 0,-2 -2,0 0,2 -4,0 0,-8 z",TriangleLine:"F1 m 8,4 l -8,-4 0,8 8,-4 z m 0.5,4 l 0,-8",CircleEndedArrow:"F1 m 10,4 l -2,-3 0,2 -2,0 0,2 2,0 0,2 2,-3 z m -4,0 b 0 360 -3 0 3 z",DynamicWidthArrow:"F1 m 0,3 l 2,0 2,-1 2,-2 2,4 -2,4 -2,-2 -2,-1 -2,0 0,-2 z",EquilibriumArrow:"m 0,3 l 8,0 -3,-3 m 3,5 l -8,0 3,3",FastForward:"F1 m 0,0 l 3.5,4 0,-4 3.5,4 0,-4 1,0 0,8 -1,0 0,-4 -3.5,4 0,-4 -3.5,4 0,-8 z",Kite:"F1 m 0,4 l 2,-4 6,4 -6,4 -2,-4 z",HalfArrowTop:"F1 m 0,0 l 4,4 4,0 -8,-4 z m 0,8",HalfArrowBottom:"F1 m 0,8 l 4,-4 4,0 -8,4 z",OpposingDirectionDoubleArrow:"F1 m 0,4 l 2,-4 0,2 4,0 0,-2 2,4 -2,4 0,-2 -4,0 0,2 -2,-4 z",PartialDoubleTriangle:"F1 m 0,0 4,3 0,-3 4,4 -4,4 0,-3 -4,3 0,-8 z",LineCircle:"F1 m 0,0 l 0,8 m 7 -4 b 0 360 -3 0 3 z",DoubleLineCircle:"F1 m 0,0 l 0,8 m 2,-8 l 0,8 m 7 -4 b 0 360 -3 0 3 z",TripleLineCircle:"F1 m 0,0 l 0,8 m 2,-8 l 0,8 m 2,-8 l 0,8 m 7 -4 b 0 360 -3 0 3 z",CircleLine:"F1 m 6 4 b 0 360 -3 0 3 z m 1,-4 l 0,8",DiamondCircle:"F1 m 8,4 l -4,4 -4,-4 4,-4 4,4 m 8,0 b 0 360 -4 0 4 z",PlusCircle:"F1 m 8,4 b 0 360 -4 0 4 l -8 0 z m -4 -4 l 0 8",OpenRightTriangleTop:"m 8,0 l 0,4 -8,0 m 0,4",OpenRightTriangleBottom:"m 8,8 l 0,-4 -8,0",Line:"m 0,0 l 0,8",DoubleLine:"m 0,0 l 0,8 m 2,0 l 0,-8",TripleLine:"m 0,0 l 0,8 m 2,0 l 0,-8 m 2,0 l 0,8",PentagonArrow:"F1 m 8,4 l -4,-4 -4,0 0,8 4,0 4,-4 z"};var ue=(t=>(t[t.None=0]="None",t[t.Added=1]="Added",t[t.Removed=2]="Removed",t[t.Shown=4]="Shown",t[t.Hidden=8]="Hidden",t[t.NodeSized=16]="NodeSized",t[t.GroupLayout=32]="GroupLayout",t[t.NodeReplaced=64]="NodeReplaced",t[t.Standard=127]="Standard",t[t.All=16777215]="All",t))(ue||{});class ce extends Yt{k;Wo;J;fl;ul;Jo;ai;$o;Sh;Js;Zo;Cd;XS;ZA;Vp;zp;constructor(t,e){let i;void 0===t||t instanceof Gt||"string"==typeof t?i=t:t&&(e=t),super(i),this.k=2408959,this.Wo="",this.J=null,this.fl="",this.ul=null,this.Jo=null,this.ai="",this.$o=null,this.Sh=null,this.Js=new y(NaN,NaN).u(),this.Zo=null,this.Cd=NaN,this.XS=-1,this.ZA=new b,this.Vp=null,this.zp=NaN,e&&Object.assign(this,e)}cloneProtected(t){super.cloneProtected(t),t.k=49152|-4097&this.k,t.Wo=this.Wo,null!==this.J&&(this.J.gi?t.J=this.J:t.J=this.J.copy()),t.fl=this.fl,t.Jo=null,t.ai=this.ai,t.Js.a(this.Js),t.Cd=this.Cd}Xo(t){super.Xo(t),t.yh(),t.ul=null,t.Zo=null,t.Vp=null}toString(){let t=e.Vn(this.constructor)+"#"+u.us(this);return null!==this.data&&(t+="("+e.toString(this.data)+")"),t}static LayoutNone=0;static LayoutAdded=1;static LayoutRemoved=2;static LayoutShown=4;static LayoutHidden=8;static LayoutNodeSized=16;static LayoutGroupLayout=32;static LayoutNodeReplaced=64;static LayoutStandard=127;static LayoutAll=16777215;Ji(){return null===this.J?this.J=new de:this.J.gi&&(this.J=this.J.copy()),this.J}gh(){super.gh(),null!==this.J&&(this.J.gi=!0)}_c(t,e,i,n,s,o,r){const a=this.diagram;null!==a&&(3===t&&"elements"===e?s instanceof Yt?s.$r((t=>{a.partManager.AM(t,a)})):s instanceof re&&a.IM(s):4===t&&"elements"===e&&(s instanceof Yt?s.$r((t=>a.partManager.TM(t,a))):s instanceof re&&a.EM(s)),a.raiseChangedEvent(t,e,i,n,s,o,r))}updateTargetBindings(t){if(super.updateTargetBindings(t),null===this.data)return;const e=this.T.r,i=e.length;for(let s=0;s<i;s++){const t=e[s];t instanceof Yt&&t.$r((t=>{null!==t.data&&t.updateTargetBindings()}))}const n=this.adornments;for(;n.next();)n.value.updateTargetBindings(t)}Uo(){if(super.Uo(),this.b2()){const t=this.T.r,e=t.length;for(let i=0;i<e;i++){const e=t[i];e instanceof Yt&&e.$r((t=>t.Uo()))}}const t=this.adornments;for(;t.next();)t.value.Uo()}updateRelationshipsFromData(){null!==this.data&&this.diagram?.partManager.updateRelationshipsFromData(this)}get key(){const t=this.diagram;if(null!==t)return t.model.getKeyForNodeData(this.data)}get adornments(){return null===this.Jo?s.instance:this.Jo.iteratorValues}findAdornment(t){const e=this.Jo;return null===e?null:e.get(t)}addAdornment(t,e){if(null===e)return;let i=null,n=this.Jo;if(null!==n&&(i=n.get(t)),i!==e){if(null!==i){const t=i.diagram;null!==t&&t.remove(i)}null===n&&(n=new p,this.Jo=n),e.Wo!==t&&(e.category=t),n.set(t,e);const s=this.diagram;if(null!==s){s.add(e);const t=e.adornedObject;if(null!==t){const i=t.findBindingPanel();null!==i&&(e.data=i.data)}}}}removeAdornment(t){const e=this.Jo;if(null===e)return;const i=e.get(t);if(null!==i){const t=i.diagram;null!==t&&(t.remove(i),i.data=null)}e.delete(t),0===e.count&&(this.Jo=null)}clearAdornments(){const t=this.Jo;if(null===t)return;const i=e.rt(),n=t.iterator;for(;n.next();){const t=n.key;i.push(t)}const s=i.length;for(let e=0;e<s;e++)this.removeAdornment(i[e]);e.tt(i)}updateAdornments(){const t=this.diagram;if(null===t)return;this.qv(t),this.Wv(t);let e=this.adornments;for(;e.next();){const t=e.value;t.c(),t.hasPlaceholder()&&t.placeholder?.c()}for(e=this.adornments;e.next();)e.value.updateTargetBindings()}invalidateAdornments(){const t=this.diagram;null!==t&&(t.oh(),!0!==this.QA()&&this._A(!0))}YS(){!1!==this.QA()&&(this.updateAdornments(),this._A(!1))}qv(t){const e="Selection";if(this.isSelected&&this.selectionAdorned){const i=this.selectionObject;if(null!==i&&this.actualBounds.isReal()&&this.isVisible()&&i.isVisibleObject()&&i.actualBounds.isReal()){let n=this.findAdornment(e);if(null===n){let e=this.selectionAdornmentTemplate;null===e&&(e=this.Rl()?t.linkSelectionAdornmentTemplate:this instanceof Ne?t.groupSelectionAdornmentTemplate:t.nodeSelectionAdornmentTemplate),n=e.copy(),null!==n&&(this.Rl()&&this.selectionObject===this.path&&(n.type=Yt.Link),n.adornedObject=i)}if(null!==n)return n.type===Yt.Link&&n.c(),void this.addAdornment(e,n)}}this.removeAdornment(e)}Wv(t){const e=this;t.toolManager.mouseDownTools.each((t=>{t.isEnabled&&t.updateAdornments(e)})),t.toolManager.updateAdornments(e)}VS(t){this.$o=t,null===t&&this.HR()}get layer(){return this.$o}get diagram(){const t=this.$o;return null==t?null:t.diagram}get layerName(){return this.fl}set layerName(t){const e=this.fl;if(e===t)return;let i=this.diagram;if(null!==i&&(null===i.findLayer(t)||i.partManager.addsToTemporaryLayer))return;this.fl=t,null!==i&&i.invalidateDocumentBounds(),this.t("layerName",e,t);const n=this.layer;if(null===n||n.name===t||(i=n.diagram,null===i))return;const s=i.findLayer(t);if(null===s||s===n)return;let o=n.se(-1,this,!0);o>=0&&i.raiseChangedEvent(4,"parts",n,this,null,o,!0),o=s._h(99999999,this,!0),n.visible!==s.visible&&this.Vi(s.visible),o>=0&&i.raiseChangedEvent(3,"parts",s,null,this,!0,o);const r=this.layerChanged;if(null===r)return;const a=i.K;i.K=!0,r(this,n,s),i.K=a}get layerChanged(){return null!==this.J?this.J.Xp:null}set layerChanged(t){const i=this.layerChanged;i!==t&&(null!==t&&e.S(t,ce,"layerChanged"),this.Ji().Xp=t,this.t("layerChanged",i,t))}get zOrder(){return this.Cd}set zOrder(t){const e=this.Cd;if(e===t)return;this.Cd=t;const i=this.layer;null!==i&&i.mx(-1,this),this.t("zOrder",e,t);const n=this.diagram;null!==n&&n.C()}Jv(){const t=this.layer;null!==t&&t.mx(-1,this)}l1(){if(!1!==this.lh())return;this.q2(!0),this.sf();const t=this.diagram;null!==t&&(t.o0(this),t.requestUpdate())}tT(){if(this.k|=2097152,!1===this.lh())return;const t=this.position,e=this.location;(!e.isReal()||!t.isReal())&&this.iT(t,e);const i=this.Ai,n=b.l().a(i);i.At(),i.x=t.x,i.y=t.y,i.u(),this.td(n,i),b.e(n),this.q2(!1),this.sf()}so(t,e,i,n){const s=this.re;s.i(t,e,i,n),null===this.ki&&(this.ki=new k);const o=this.ki;o.Ii(),this.x0(o,t,e,i,n),this.ki=o,o.Ik()||o.Ug(s)}x0(t,e,i,n,s){if(1!==this.nt&&t.nt(this.nt),0===this.Ht)return;let o=w.Center;this.locationSpot.isSpot()&&(o=this.locationSpot);const r=y.l();if(this.locationObject!==this){const t=this.locationObject,e=t.naturalBounds;r.setSpot(e.x,e.y,e.width,e.height,o),null!==t.ki&&t.ki.xt(r),r.offset(-t.measuredBounds.x,-t.measuredBounds.y);let i=t.panel;for(;null!==i&&i!==this;)null!==i.ki&&i.ki.xt(r),r.offset(-i.measuredBounds.x,-i.measuredBounds.y),i=i.panel}else r.setSpot(e,i,n,s,o);t.ds(this.Ht,r.x,r.y),y.e(r)}get locationObject(){if(null===this.Zo)if(this instanceof fe&&this.type!==Yt.Link&&this.hasPlaceholder())this.Zo=this.placeholder;else{const t=this.locationObjectName;if(""!==t){const e=this.findObject(t);this.Zo=null!==e?e:this}else this.Zo=this}return this.Zo?.visible?this.Zo:this}get minLocation(){return null!==this.J?this.J.Yp:y.hC}set minLocation(t){const e=this.minLocation;e.equals(t)||(t=t.N(),this.Ji().Yp=t,this.t("minLocation",e,t))}get maxLocation(){return null!==this.J?this.J.Kp:y.aC}set maxLocation(t){const e=this.maxLocation;e.equals(t)||(t=t.N(),this.Ji().Kp=t,this.t("maxLocation",e,t))}get locationObjectName(){return null!==this.J?this.J.Gp:""}set locationObjectName(t){const e=this.locationObjectName;e!==t&&(this.Ji().Gp=t,this.Zo=null,this.c(),this.t("locationObjectName",e,t))}get locationSpot(){return null!==this.J?this.J.Hp:w.TopLeft}set locationSpot(t){const e=this.locationSpot;e.equals(t)||(t=t.N(),this.Ji().Hp=t,this.c(),this.t("locationSpot",e,t))}move(t,e){!0===e?this.location=t:this.position=t}moveTo(t,e,i){const n=y.X(t,e);this.move(n,i),y.e(n)}isVisible(){if(!this.visible)return!1;const t=this.layer;if(null!==t){if(!t.visible)return!1;const e=t.diagram;if(null!==e&&e.animationManager.ex(this))return!0}const e=this.containingGroup;return!(null!==e&&(!e.isSubGraphExpanded||!e.isVisible()))}Vi(t){const e=this.diagram;t?(this.invalidateLayout(4),this.invalidateAdornments(),null!==e&&e.o0(this)):(this.invalidateLayout(8),this.clearAdornments()),this.yh(),null!==e&&(e.invalidateDocumentBounds(),e.C())}findObject(t){if(this.name===t)return this;let e=this.Vp;if(null===e&&(this.Vp=e=new p),null!==e.get(t))return e.get(t);const i=super.findObject(t);return null!==i?(e.set(t,i),i):(e.set(t,null),null)}R0(){this.Vp=null}getRelativePoint(t,e,i){void 0===i&&(i=new y);const n=e.isNoSpot()?w.Center:e,s=t.naturalBounds;if(i.i(s.width*n.x+n.offsetX,s.height*n.y+n.offsetY),null===t||t===this)return i;t.F.xt(i);let o=t.panel;for(;null!==o&&o!==this;)o.F.xt(i),o=o.panel;return null!==this.ki&&this.ki.xt(i),i.offset(-this.re.x,-this.re.y),i}getDocumentBounds(t){return void 0===t&&(t=new b),t.a(this.actualBounds)}ensureBounds(){this.ut(1/0,1/0),this.Yt()}TA(t){const e=this.locationSpot,i=this.locationObject;let n=i.naturalBounds;n.isReal()||(n=b.Eg);const s=i instanceof Jt?i.strokeWidth:0;if(t.setSpot(0,0,n.width+s,n.height+s,e),i!==this){t.offset(-s/2,-s/2),i.F.xt(t);let e=i.panel;for(;null!==e&&e!==this;)e.F.xt(t),e=e.panel}return null!==this.ki&&this.ki.xt(t),t.offset(-this.re.x,-this.re.y),t}Qh(t,e){const i=void 0===e?this.ZA:e,n=this.$v(),s=2*n;if(!this.isShadowed)return i.i(t.x-1-n,t.y-1-n,t.width+2+s,t.height+2+s),i;let o=t.x,r=t.y,a=t.width,l=t.height;const h=this.shadowBlur,u=this.shadowOffset;return a+=h,l+=h,o-=h/2,r-=h/2,u.x>0?a+=u.x:(o+=u.x,a-=u.x),u.y>0?l+=u.y:(r+=u.y,l-=u.y),i.i(o-1,r-1,a+2,l+2),i}Rv(){return this.type===Yt.Link&&this instanceof fe&&"Selection"===this.category&&this.adornedObject instanceof Jt&&this.adornedPart.findMainElement()===this.adornedObject?this.adornedObject.strokeWidth:0}$v(){return isNaN(this.zp)&&(this.zp=this.EA()),this.zp}pf(){this.zp=NaN}Yt(){if(!1===this.es())return void this.tT();this.no(!1);const t=this.Ai,e=b.l();e.a(t);const i=this.Fl();this.ph(0,0,this.re.width,this.re.height);const n=this.position;this.iT(n,this.location),t.At(),t.x=n.x,t.y=n.y,t.u(),this.td(e,t),e.equals(t)?this.xs(i):this.Me()&&(!S.f(e.width,t.width)||!S.f(e.height,t.height))&&this.XS>=0&&this.invalidateLayout(16),b.e(e),this.q2(!1)}td(t,e){const i=this.diagram;if(null===i)return;let n=!1;if(!1===i.na&&t.isReal()){const s=b.l();s.a(i.documentBounds),s.subtractMargin(i.padding),t.x>s.x&&t.y>s.y&&t.right<s.right&&t.bottom<s.bottom&&e.x>s.x&&e.y>s.y&&e.right<s.right&&e.bottom<s.bottom&&(n=!0),b.e(s)}(!0===this.Zv()||!t.equals(e))&&this.UL(n,i),i.C(),(t.isReal()||e.isReal())&&!t.equalsApproxClose(e)&&(this instanceof me&&!i.undoManager.isUndoingRedoing&&this.invalidateConnectedLinks(),this.yh())}get location(){return this.Js}set location(t){const e=t.x,i=t.y,n=this.Js;(n.x!==e&&(!isNaN(n.x)||!isNaN(e))||n.y!==i&&(!isNaN(n.y)||!isNaN(i)))&&(t=t.copy(),this.Qv(t,n)&&this.t("location",n,t.copy()))}Qv(t,e){if(this.Rl())return!1;if(this.Js=t,this.k|=2097152,!1===this.es()){this.l1();const i=this.dt;if(i.isReal()){const n=this.diagram;if(null===n||n.animationManager.isTicking||!n.undoManager.isUndoingRedoing){const s=i.copy();i.i(i.x+(t.x-e.x),i.y+(t.y-e.y)),this.eT(n,i,s.x,s.y),this.t("position",s,i.copy())}}}return!0}m2(t,e,i){if(this.Rl()||!t.isReal())return!1;const n=this.diagram;if(null!==n&&this.eT(n,t,e,i),this.dt=t,this.k&=-2097153,this.Js.isReal()&&(null===n||n.animationManager.isTicking||!n.undoManager.isUndoingRedoing)){const n=this.Js;this.Js=new y(n.x+(t.x-e),n.y+(t.y-i)),this.t("location",n,this.Js.copy())}return!1===this.lh()&&!1===this.es()&&(this.l1(),this.tT()),!0}eT(t,e,i,n){if(null===t||this instanceof fe)return;const s=t.animationManager;s.xi&&s.lL(this,new y(i,n),e,!1)}Cc(t,e,i){const n=this.Js,s=this.dt;if(i){if(n.x===t&&n.y===e)return;this.lh()||this.es()?s.i(NaN,NaN):s.i(s.x+t-n.x,s.y+e-n.y),n.i(t,e)}else{if(s.x===t&&s.y===e)return;n.i(n.x+t-s.x,n.y+e-s.y),s.i(t,e)}this.l1()}p2(){this.k&=-2097153,this.l1()}iT(t,e){const i=this.TA(y.l()),n=this.diagram,s=e.isReal(),o=t.isReal();s&&o?2097152&this.k?this.sT(t,e,n,i):this.nT(t,e,n,i):s?this.sT(t,e,n,i):o&&this.nT(t,e,n,i),this.k|=2097152,y.e(i),this.sf()}sT(t,e,i,n){const s=t.x,o=t.y;if(t.i(e.x-n.x,e.y-n.y),null!==i){const e=i.animationManager,n=e.defaultAnimation.isAnimating;!n&&e.xi&&!(this instanceof fe)&&e.lL(this,new y(s,o),t,!1),!n&&(t.x!==s||t.y!==o)&&this.t("position",new y(s,o),t.copy())}}nT(t,e,i,n){const s=e.copy();e.i(t.x+n.x,t.y+n.y),!e.equals(s)&&null!==i&&this.t("location",s,e.copy())}UL(t,e){this.c2(!1),this instanceof me&&e.YM(this),!this.layer.isTemporary&&!t&&e.invalidateDocumentBounds();const i=this.Ai,n=e.viewportBounds;n.isReal()?this.Fl()?(i.intersectsRectPlus(n,10)||this.xs(!1),this.updateAdornments()):this.isVisible()&&i.intersectsRect(n)?(this.xs(!0),this.updateAdornments()):this.invalidateAdornments():e.Xc=!0}Jr(){return!0}Me(){return!0}Rl(){return!1}js(){return!0}hasPlaceholder(){return!1}get category(){return this.Wo}set category(t){const e=this.Wo;if(e===t)return;null!==this.svg&&(this.svg.remove(),this.Ye(!0));const i=this.diagram,n=this.data;let s=null;if(null!==i&&null!==n&&!(this instanceof fe)){const t=i.model.undoManager;t.isEnabled&&!t.isUndoingRedoing&&(s=this.clone(),s.T.addAll(this.T))}if(this.Wo=t,this.t("category",e,t),null===i||null===n||this instanceof fe){if(this instanceof fe){const t=this.adornedPart;if(null!==t){const i=t.Jo;null!==i&&i.delete(e),t.addAdornment(this.category,this)}}}else{const o=i.model;if(o.undoManager.isUndoingRedoing)return;if(this.Rl()){i.partManager.setLinkCategoryForData(n,t);const s=i.partManager.findLinkTemplateForCategory(t);if(null!==s){s.zt();const i=s.copy();null!==i&&this.W2(i,e,t)}}else{null!==o&&o.setCategoryForNodeData(n,t);const s=i.partManager.findTemplateForNodeData(n,t);if(null!==s){s.zt();const i=s.copy();if(null!==i&&!(i instanceof ve)){const n=this.location.copy();this.W2(i,e,t),this.location.isReal()||(this.location=n)}}}if(null!==s){const t=this.clone();t.T.addAll(this.T),this.t("self",s,t)}}}get self(){return this}set self(t){this.W2(t,this.category,t.category)}static oT=!1;W2(t,i,n){t.constructor!==this.constructor&&(ce.oT||(ce.oT=!0,e.li('Should not change the class of the Part when changing category from "'+i+'" to "'+n+'"'),e.li("  Old class: "+e.Vn(this.constructor)+", new class: "+e.Vn(t.constructor)+", part: "+this.toString()))),this.clearAdornments();const s=this.data,o=this.layerName,r=this.isSelected,a=this.isHighlighted;let l=!0,h=!0,u=!1;this instanceof me&&(l=this.isTreeLeaf,h=this.isTreeExpanded,u=this.wasTreeExpanded),t.Xo(this),t.cloneProtected(this),this.Wo=n,null!==this.svg&&(this.svg.remove(),this.svg=null,this.Ye(!0)),this.c(),this.C();const c=this.diagram;let d=!0;null!==c&&(d=c.skipsUndoManager,c.skipsUndoManager=!0),this.ei=s,this.k=r?4096|this.k:-4097&this.k,this.k=a?524288|this.k:-524289&this.k,this instanceof me&&(this.E=l?4|this.E:-5&this.E,this.E=h?1|this.E:-2&this.E,this.E=u?2|this.E:-3&this.E),null!==s&&this.updateTargetBindings();const f=this.layerName;f!==o&&(this.fl=o,this.layerName=f),null!==c&&(c.skipsUndoManager=d),this.Me()&&this.invalidateLayout(64)}canCopy(){if(!this.copyable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowCopy)return!1;const e=t.diagram;return null===e||!!e.allowCopy}canDelete(){if(!this.deletable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowDelete)return!1;const e=t.diagram;return null===e||!!e.allowDelete}canEdit(){if(!this.textEditable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowTextEdit)return!1;const e=t.diagram;return null===e||!!e.allowTextEdit}canGroup(){if(!this.groupable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowGroup)return!1;const e=t.diagram;return null===e||!!e.allowGroup}canMove(){if(!this.movable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowMove)return!1;const e=t.diagram;return null===e||!!e.allowMove}canReshape(){if(!this.reshapable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowReshape)return!1;const e=t.diagram;return null===e||!!e.allowReshape}canResize(){if(!this.resizable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowResize)return!1;const e=t.diagram;return null===e||!!e.allowResize}canRotate(){if(!this.rotatable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowRotate)return!1;const e=t.diagram;return null===e||!!e.allowRotate}canSelect(){if(!this.selectable)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowSelect)return!1;const e=t.diagram;return null===e||!!e.allowSelect}get copyable(){return 0!==(1&this.k)}set copyable(t){const e=0!==(1&this.k);e!==t&&(this.k=1^this.k,this.t("copyable",e,t))}get deletable(){return 0!==(2&this.k)}set deletable(t){const e=0!==(2&this.k);e!==t&&(this.k=2^this.k,this.t("deletable",e,t))}get textEditable(){return 0!==(4&this.k)}set textEditable(t){const e=0!==(4&this.k);e!==t&&(this.k=4^this.k,this.t("textEditable",e,t),this.invalidateAdornments())}get groupable(){return 0!==(8&this.k)}set groupable(t){const e=0!==(8&this.k);e!==t&&(this.k=8^this.k,this.t("groupable",e,t))}get movable(){return 0!==(16&this.k)}set movable(t){const e=0!==(16&this.k);e!==t&&(this.k=16^this.k,this.t("movable",e,t))}get selectionAdorned(){return 0!==(32&this.k)}set selectionAdorned(t){const e=0!==(32&this.k);e!==t&&(this.k=32^this.k,this.t("selectionAdorned",e,t),this.invalidateAdornments())}get isInDocumentBounds(){return 0!==(64&this.k)}set isInDocumentBounds(t){const e=0!==(64&this.k);if(e!==t){this.k=64^this.k;const i=this.diagram;null!==i&&i.invalidateDocumentBounds(),this.t("isInDocumentBounds",e,t)}}get isLayoutPositioned(){return 0!==(128&this.k)}set isLayoutPositioned(t){const e=0!==(128&this.k);e!==t&&(this.k=128^this.k,this.t("isLayoutPositioned",e,t),this.invalidateLayout(t?4:8))}get selectable(){return 0!==(256&this.k)}set selectable(t){const e=0!==(256&this.k);e!==t&&(this.k=256^this.k,this.t("selectable",e,t),this.invalidateAdornments())}get reshapable(){return 0!==(512&this.k)}set reshapable(t){const e=0!==(512&this.k);e!==t&&(this.k=512^this.k,this.t("reshapable",e,t),this.invalidateAdornments())}get resizable(){return 0!==(1024&this.k)}set resizable(t){const e=0!==(1024&this.k);e!==t&&(this.k=1024^this.k,this.t("resizable",e,t),this.invalidateAdornments())}get rotatable(){return 0!==(2048&this.k)}set rotatable(t){const e=0!==(2048&this.k);e!==t&&(this.k=2048^this.k,this.t("rotatable",e,t),this.invalidateAdornments())}get isSelected(){return 0!==(4096&this.k)}set isSelected(t){const e=0!==(4096&this.k);if(e!==t){const i=this.diagram;if(t){if(!this.canSelect())return;if(null!==i){const t=i.maxSelectionCount;if(i.selection.count>=t)return}}this.k=4096^this.k;let n=!1;if(null!==i){n=i.skipsUndoManager,i.skipsUndoManager=!0;const e=i.selection;e.At(),t?e.add(this):e.delete(this),e.u()}this.t("isSelected",e,t),this.invalidateAdornments();const s=this.selectionChanged;null!==s&&s(this),null!==i&&(i.requestUpdate(),i.skipsUndoManager=n)}}get isHighlighted(){return 0!==(524288&this.k)}set isHighlighted(t){const e=0!==(524288&this.k);if(e!==t){this.k=524288^this.k;const i=this.diagram;if(null!==i){const e=i.highlighteds;e.At(),t?e.add(this):e.delete(this),e.u()}this.t("isHighlighted",e,t),this.C();const n=this.highlightedChanged;null!==n&&n(this)}}get isShadowed(){return 0!==(8192&this.k)}set isShadowed(t){const e=0!==(8192&this.k);e!==t&&(this.k=8192^this.k,this.Ye(!0),this.t("isShadowed",e,t),this.C())}QA(){return 0!==(16384&this.k)}_A(t){t?this.k|=16384:this.k&=-16385}lh(){return 0!==(32768&this.k)}q2(t){t?this.k|=32768:this.k&=-32769}Zv(){return 0!==(65536&this.k)}c2(t){t?this.k|=65536:this.k&=-65537}Fl(){return 0!==(131072&this.k)}xs(t){t?this.k|=131072:this.k&=-131073}rT(){return 0!==(1048576&this.k)}h1(t){t?this.k|=1048576:this.k&=-1048577}get isAnimated(){return 0!==(262144&this.k)}set isAnimated(t){const e=0!==(262144&this.k);e!==t&&(this.k=262144^this.k,this.t("isAnimated",e,t))}get highlightedChanged(){return null!==this.J?this.J.jp:null}set highlightedChanged(t){const i=this.highlightedChanged;i!==t&&(null!==t&&e.S(t,ce,"highlightedChanged"),this.Ji().jp=t,this.t("highlightedChanged",i,t))}get selectionObjectName(){return null!==this.J?this.J.qp:""}set selectionObjectName(t){const e=this.selectionObjectName;e!==t&&(this.Ji().qp=t,this.ul=null,this.t("selectionObjectName",e,t))}get selectionAdornmentTemplate(){return null!==this.J?this.J.Wp:null}set selectionAdornmentTemplate(t){const e=this.selectionAdornmentTemplate;e!==t&&(null!==t&&t.zt(),this.Ji().Wp=t,this.t("selectionAdornmentTemplate",e,t))}get selectionObject(){if(null===this.ul){const t=this.selectionObjectName;if(null!==t&&""!==t){const e=this.findObject(t);this.ul=null!==e?e:this}else if(this instanceof ve){const t=this.path;this.ul=null!==t?t:this}else this.ul=this}return this.ul}get selectionChanged(){return null!==this.J?this.J.Jp:null}set selectionChanged(t){const i=this.selectionChanged;i!==t&&(null!==t&&e.S(t,ce,"selectionChanged"),this.Ji().Jp=t,this.t("selectionChanged",i,t))}get resizeAdornmentTemplate(){return null!==this.J?this.J.$p:null}set resizeAdornmentTemplate(t){const e=this.resizeAdornmentTemplate;e!==t&&(this.Ji().$p=null!==t?t.zt():null,this.t("resizeAdornmentTemplate",e,t))}get resizeObjectName(){return null!==this.J?this.J.Zp:""}set resizeObjectName(t){const e=this.resizeObjectName;e!==t&&(this.Ji().Zp=t,this.t("resizeObjectName",e,t))}get resizeObject(){const t=this.resizeObjectName;if(""!==t){const e=this.findObject(t);if(null!==e)return e}return this}get resizeCellSize(){return null!==this.J?this.J.Qp:x.mw}set resizeCellSize(t){const e=this.resizeCellSize;e.equals(t)||(t=t.N(),this.Ji().Qp=t,this.t("resizeCellSize",e,t))}get rotateAdornmentTemplate(){return null!==this.J?this.J._p:null}set rotateAdornmentTemplate(t){const e=this.rotateAdornmentTemplate;e!==t&&(this.Ji()._p=null!==t?t.zt():null,this.t("rotateAdornmentTemplate",e,t))}get rotateObjectName(){return null!==this.J?this.J.ty:""}set rotateObjectName(t){const e=this.rotateObjectName;e!==t&&(this.Ji().ty=t,this.t("rotateObjectName",e,t))}get rotateObject(){const t=this.rotateObjectName;if(""!==t){const e=this.findObject(t);if(null!==e)return e}return this}get rotationSpot(){return null!==this.J?this.J.iy:w.Default}set rotationSpot(t){const e=this.rotationSpot;e.equals(t)||(t=t.N(),this.Ji().iy=t,this.t("rotationSpot",e,t))}get text(){return this.ai}set text(t){const e=this.ai;e!==t&&(this.ai=t,this.t("text",e,t))}get containingGroup(){return this.Sh}set containingGroup(t){if(this.Me()){const i=this.Sh;if(i!==t){null!==t&&(this===t||t.isMemberOf(this))&&(this===t&&e.o("Cannot make a Group a member of itself: "+this.toString()),e.o("Cannot make a Group indirectly contain itself: "+this.toString()+" already contains "+t.toString())),this.invalidateLayout(2);const n=this.diagram;if(null!==i?i.J2(this):this instanceof Ne&&null!==n&&n.qr.delete(this),this.Sh=t,null!==t?t.$2(this):this instanceof Ne&&null!==n&&n.qr.add(this),this.invalidateLayout(1),null!==n&&n.K){const e=this.data,i=n.model;if(null!==e&&i.Qc()){const n=null!==t?t.data:null;i.setGroupForData(e,i.getKeyForNodeData(n))}}const s=this.containingGroupChanged;if(null!==s){let e=!0;null!==n&&(e=n.K,n.K=!0),s(this,i,t),null!==n&&(n.K=e)}if(this instanceof Ne){const t=new u;ce.ch(t,this,!0,0,!0);const e=t.iterator;for(;e.next();){const t=e.value;if(t instanceof me){const e=t.linksConnected;for(;e.next();)e.value.Ld()}}}if(this instanceof me){const t=this.linksConnected;for(;t.next();)t.value.Ld();const e=this.labeledLink;null!==e&&e.Ld()}this.t("containingGroup",i,t),null!==t&&t.Jv()}}else e.o("cannot set the Part.containingGroup of a Link or Adornment")}yh(){const t=this.containingGroup;null!==t&&(t.hasPlaceholder()&&t.placeholder?.c(),t.c(),t.invalidateConnectedLinks())}C(){const t=this.diagram;null!==t&&!this.es()&&!this.lh()&&this.isVisible()&&this.Ai.isReal()&&t.C(this.Qh(this.Ai))}c(){if(this.Bo())return;super.c();const t=this.diagram;null!==t&&(t.o0(this),this instanceof me&&null!==this.labeledLink&&this.labeledLink.hf(),t.requestUpdate(!0))}hf(t){if(this.es())return;const e=this.diagram;null!==e&&(e.o0(this),this instanceof me&&this.invalidateConnectedLinks(),e.requestUpdate()),this.no(!0)}Bm(t){if(!t){const t=this.Sh;null!==t&&t.$2(this)}}Um(t){if(!t){const t=this.Sh;null!==t&&t.J2(this)}}qc(){const t=this.data;if(null!==t){const e=this.diagram;if(null!==e){const i=e.model;null!==i&&i.removeNodeData(t)}}}get containingGroupChanged(){return null!==this.J?this.J.ey:null}set containingGroupChanged(t){const i=this.containingGroupChanged;i!==t&&(null!==t&&e.S(t,ce,"containingGroupChanged"),this.Ji().ey=t,this.t("containingGroupChanged",i,t))}findSubGraphLevel(){return this.Z2(this)}Z2(t){const e=t.containingGroup;if(null!==e)return 1+this.Z2(e);if(t instanceof me){const e=t.labeledLink;if(null!==e)return this.Z2(e)}return 0}findTopLevelPart(){return this.Q2(this)}Q2(t){const e=t.containingGroup;if(null!==e)return this.Q2(e);if(t instanceof me){const e=t.labeledLink;if(null!==e)return this.Q2(e)}return t}get isTopLevel(){return!(null!==this.containingGroup||this instanceof me&&null!==this.labeledLink)}isMemberOf(t){return t instanceof Ne&&this._2(this,t)}_2(t,e){if(t===e||null===e)return!1;const i=t.containingGroup;if(null!==i&&(i===e||this._2(i,e)))return!0;if(t instanceof me){const i=t.labeledLink;if(null!==i)return this._2(i,e)}return!1}findCommonContainingGroup(t){if(null===t)return null;if(this===t)return this.containingGroup;let e=this;for(;null!==e;){if(e instanceof Ne&&e.h1(!0),e instanceof me){const t=e.labeledLink;null!==t&&(e=t)}e=e.containingGroup}let i=null;for(e=t;null!==e;){if(e.rT()){i=e;break}if(e instanceof me){const t=e.labeledLink;null!==t&&(e=t)}e=e.containingGroup}for(e=this;null!==e;){if(e instanceof Ne&&e.h1(!1),e instanceof me){const t=e.labeledLink;null!==t&&(e=t)}e=e.containingGroup}return i}get layoutConditions(){return null!==this.J?this.J.sy:127}set layoutConditions(t){const e=this.layoutConditions;e!==t&&(this.Ji().sy=t,this.t("layoutConditions",e,t))}canLayout(){if(!this.isLayoutPositioned||!this.isVisible())return!1;const t=this.layer;return!(null!==t&&t.isTemporary||this instanceof me&&this.isLinkLabel)}_v(t){if(!this.isLayoutPositioned||!(t&this.layoutConditions))return!1;const e=this.layer;if(null!==e&&e.isTemporary||this instanceof me&&this.isLinkLabel)return!1;const i=this.diagram;return!(null!==i&&i.undoManager.isUndoingRedoing)}invalidateLayout(t){if(void 0===t&&(t=16777215),!this._v(t))return;const e=this.Sh;if(null!==e){const i=e.layout;null!==i?i.invalidateLayout():e.invalidateLayout(t)}else{const t=this.diagram;if(null!==t){const e=t.layout;null!==e&&e.invalidateLayout()}}}VL(){if(!this.isVisible())return!1;const t=this.layer;return!(null!==t&&t.isTemporary)}static ch(t,e,i,n,s,o){if(void 0===o&&(o=null),!t.has(e)&&(null===o||o(e))&&!(e instanceof fe))if(t.add(e),e instanceof me){if(i&&e instanceof Ne){const r=e.memberParts;for(;r.next();){const e=r.value;ce.ch(t,e,i,n,s,o)}}if(!1!==s){const r=e.linksConnected;for(;r.next();){const e=r.value;if(t.has(e))continue;const a=e.fromNode,l=e.toNode,h=null===a||t.has(a),u=null===l||t.has(l);(s?h&&u:h||u)&&ce.ch(t,e,i,n,s,o)}}if(n>1){const r=e.findTreeChildrenNodes();for(;r.next();){const e=r.value;ce.ch(t,e,i,n-1,s,o)}}}else if(e instanceof ve){const r=e.labelNodes;for(;r.next();){const e=r.value;ce.ch(t,e,i,n,s,o)}}}get dragComputation(){return null!==this.J?this.J.ny:null}set dragComputation(t){const i=this.dragComputation;i!==t&&(null!==t&&e.S(t,ce,"dragComputation"),this.Ji().ny=t,this.t("dragComputation",i,t))}get shadowOffset(){return null!==this.J?this.J.oy:y.cC}set shadowOffset(t){const e=this.shadowOffset;e.equals(t)||(t=t.N(),this.Ji().oy=t,this.C(),this.t("shadowOffset",e,t))}get shadowColor(){return null!==this.J?this.J.ry:"gray"}set shadowColor(t){const e=this.shadowColor;e!==t&&(this.Ji().ry=t,this.C(),this.t("shadowColor",e,t))}get shadowBlur(){return null!==this.J?this.J.kn:4}set shadowBlur(t){const e=this.shadowBlur;e!==t&&(this.Ji().kn=t,this.C(),this.t("shadowBlur",e,t))}}class de{gi;Xp;ey;Wp;qp;Jp;jp;$p;Zp;Qp;_p;ty;iy;Gp;Hp;Yp;Kp;ny;sy;oy;ry;kn;constructor(){this.gi=!1,this.Xp=null,this.ey=null,this.Wp=null,this.qp="",this.Jp=null,this.jp=null,this.$p=null,this.Zp="",this.Qp=x.mw,this._p=null,this.ty="",this.iy=w.Default,this.Gp="",this.Hp=w.TopLeft,this.Yp=y.hC,this.Kp=y.aC,this.ny=null,this.sy=127,this.oy=y.cC,this.ry="gray",this.kn=4}copy(){const t=new de;return t.Xp=this.Xp,t.ey=this.ey,t.Wp=this.Wp,t.qp=this.qp,t.Jp=this.Jp,t.jp=this.jp,t.$p=this.$p,t.Zp=this.Zp,t.Qp=this.Qp.N(),t._p=this._p,t.ty=this.ty,t.iy=this.iy.N(),t.Gp=this.Gp,t.Hp=this.Hp.N(),t.Yp=this.Yp.N(),t.Kp=this.Kp.N(),t.ny=this.ny,t.sy=this.sy,t.oy=this.oy.N(),t.ry=this.ry,t.kn=this.kn,t}}class fe extends ce{ms;It;ZP;QP;gf;constructor(t,e){let i;void 0===t||t instanceof Gt||"string"==typeof t?i=t:t&&(e=t),super(i),this.k&=-257,this.fl="Adornment",this.ms=null,this.ZP=0,this.QP=!1,this.It=null,this.gf=null,e&&Object.assign(this,e)}toString(){const t=this.adornedPart;return"Adornment("+this.category+")"+(null!==t?t.toString():"")}updateRelationshipsFromData(){}hd(t){const e=this.adornedObject;if(!(e instanceof Jt))return;const i=e.part;if(!(i instanceof ve))return;const n=i.path;let s=n.geometry;i.hd(t),s=n.geometry;const o=this.T.r,r=o.length;for(let a=0;a<r;a++){const t=o[a];t.isPanelMain&&t instanceof Jt&&(t.at=s)}}hasPlaceholder(){return null!==this.It&&this.It.isVisibleObject()}get placeholder(){return this.It}get adornedObject(){return this.ms}set adornedObject(t){const e=this.adornedPart;let i=null;null!==t&&(i=t.part),null!==e&&(null===t||e!==i)&&e.removeAdornment(this.category),this.ms=t,null!==i&&i.addAdornment(this.category,this)}get adornedPart(){const t=this.ms;return null!==t?t.part:null}Jr(){const t=this.ms;if(null===t)return!0;const e=t.part;return null===e||!e.es()}Me(){return!1}get containingGroup(){return null}_c(t,e,i,n,s,o,r){if(3===t&&"elements"===e){if(s instanceof Te)null===this.It&&(this.It=s);else if(s instanceof Yt){const t=s.findInVisualTree((t=>t instanceof Te));t instanceof Te&&null===this.It&&(this.It=t)}}else 4===t&&"elements"===e&&null!==this.It&&(n===this.It||n instanceof Yt&&this.It.isContainedBy(n))&&(this.It=null);super._c(t,e,i,n,s,o,r)}updateAdornments(){}qc(){}}var ge=(t=>(t[t.None=0]="None",t[t.Evenly=1]="Evenly",t[t.Packed=2]="Packed",t))(ge||{});class me extends ce{E;Et;Lf;dl;Mh;le;si;constructor(t,e){let i;void 0===t||t instanceof Gt||"string"==typeof t?i=t:t&&(e=t),super(i),this.E=13,this.Et=null,this.si=new l,this.Lf=null,this.dl=null,this.le=null,this.Mh=!1,e&&Object.assign(this,e)}cloneProtected(t){super.cloneProtected(t),t.E=this.E,null!==this.Et&&(this.Et.gi?t.Et=this.Et:t.Et=this.Et.copy())}Xo(t){super.Xo(t),t.invalidateConnectedLinks(),t.dl=this.dl,t.le=null}static SpreadingNone=0;static SpreadingEvenly=1;static SpreadingPacked=2;gl(){return null===this.Et?this.Et=new pe:this.Et.gi&&(this.Et=this.Et.copy()),this.Et}gh(){super.gh(),null!==this.Et&&(this.Et.gi=!0)}lT(t){null!==t&&(null===this.dl&&(this.dl=new u),this.dl.add(t))}hT(t){null!==t&&null!==this.dl&&this.dl.delete(t)}aT(t,e,i){if(null===t||null===this.dl)return null;const n=this.dl.iterator;for(;n.next();){const s=n.value;if(s.ly===this&&s.a1===t&&s.tN===e&&s.iN===i||s.ly===t&&s.a1===this&&s.tN===i&&s.iN===e)return s}return null}invalidateLinkBundle(t,e,i){null==e&&(e=""),null==i&&(i="");const n=this.aT(t,e,i);null!==n&&n.Ad()}_c(t,e,i,n,s,o,r){(3===t&&"elements"===e||4===t&&"elements"===e)&&(this.le=null),super._c(t,e,i,n,s,o,r)}invalidateConnectedLinks(t){const e=this.linksConnected;for(;e.next();){const i=e.value;void 0!==t&&t.has(i)||(this.$i(i.fromPort),this.$i(i.toPort),i.invalidateRoute())}}gA(t){const e=this.linksConnected;for(;e.next();){const i=e.value;i.fromPort!==t&&i.toPort!==t||(this.$i(i.fromPort),this.$i(i.toPort),i.invalidateRoute())}}$i(t){if(null===t)return;const e=t.Ju;null!==e&&e.Ad();const i=t.part,n=i.containingGroup;null!==n&&!i.isVisible()&&n.$i(n.port)}Jr(){return!0}get portSpreading(){return null!==this.Et?this.Et.hy:1}set portSpreading(t){const e=this.portSpreading;if(e!==t){this.gl().hy=t,this.t("portSpreading",e,t);const i=this.diagram;if(null!==i&&i.undoManager.isUndoingRedoing)return;this.invalidateConnectedLinks()}}get avoidable(){return 0!==(8&this.E)}set avoidable(t){const e=0!==(8&this.E);if(e!==t){this.E=8^this.E;const i=this.diagram;null!==i&&i.YM(this),this.t("avoidable",e,t)}}get avoidableMargin(){return null!==this.Et?this.Et.ay:v.pC}set avoidableMargin(t){"number"==typeof t&&(t=new v(t));const e=this.avoidableMargin;if(!e.equals(t)){t=t.N(),this.gl().ay=t;const i=this.diagram;null!==i&&i.YM(this),this.t("avoidableMargin",e,t)}}canAvoid(){return this.avoidable&&!this.isLinkLabel}getAvoidableRect(t){return t.set(this.actualBounds),t.addMargin(this.avoidableMargin),t}findVisibleNode(){let t=this;for(;null!==t&&!t.isVisible();)t=t.containingGroup;return t}isVisible(){if(!super.isVisible())return!1;let t=!0,e=1;const i=this.diagram;if(null!==i){if(i.animationManager.ex(this))return!0;t=i.isTreePathToChildren,e=i.treeCollapsePolicy}if(1===e){const t=this.findTreeParentNode();if(null!==t&&!t.isTreeExpanded)return!1}else if(2===e){const e=t?this.findLinksInto():this.findLinksOutOf();let i=!1,n=!1;for(;e.next();){const s=e.value;if(s.isTreeLink){i=!0;const e=t?s.fromNode:s.toNode;if(e&&e.isTreeExpanded){n=!0;break}}}if(i&&!n)return!1}else if(3===e){const e=t?this.findLinksInto():this.findLinksOutOf();let i=!1,n=!1;for(;e.next();){const s=e.value;if(s.isTreeLink){i=!0;const e=t?s.fromNode:s.toNode;if(e&&!e.isTreeExpanded){n=!0;break}}}if(i&&n)return!1}const n=this.labeledLink;return null===n||n.isVisible()}Vi(t){super.Vi(t);const e=this.linksConnected;for(;e.next();){const i=e.value;if(t&&null!==this.containingGroup){const t=i.getOtherNode(this);null!==t&&!t.isMemberOf(this.containingGroup)&&i.invalidateRoute()}i.Vi(t)}}get linksConnected(){return this.si.iterator}findExternalTreeLinksConnected(){const t=new u,e=new u;return this.cT(this,t,e),e.iterator}cT(t,e,i){if(null===t||e.has(t))return;e.add(t);let n=!0;const s=this.diagram;null!==s&&(n=s.isTreePathToChildren),t.linksConnected.each((s=>{s.isTreeLink?(n?s.fromNode===t:s.toNode===t)&&this.cT(n?s.toNode:s.fromNode,e,i):i.add(s)}))}findLinksConnected(t){if(void 0===t&&(t=null),null===t)return this.si.iterator;const e=new r(this.si),i=this;return e.predicate=e=>e.fromNode===i&&e.fromPortId===t||e.toNode===i&&e.toPortId===t,e}findLinksOutOf(t){void 0===t&&(t=null);const e=new r(this.si),i=this;return e.predicate=e=>e.fromNode===i&&(null===t||e.fromPortId===t),e}findLinksInto(t){void 0===t&&(t=null);const e=new r(this.si),i=this;return e.predicate=e=>e.toNode===i&&(null===t||e.toPortId===t),e}findNodesConnected(t){void 0===t&&(t=null);let e=null,i=null;const n=this.si.iterator;for(;n.next();){const s=n.value;if(s.fromNode===this){if(null===t||s.fromPortId===t){const t=s.toNode;null!==e?e.add(t):null!==i&&i!==t?(e=new u,e.add(i),e.add(t)):i=t}}else if(s.toNode===this&&(null===t||s.toPortId===t)){const t=s.fromNode;null!==e?e.add(t):null!==i&&i!==t?(e=new u,e.add(i),e.add(t)):i=t}}return null!==e?e.iterator:null!==i?new o(i):s.instance}findNodesOutOf(t){void 0===t&&(t=null);let e=null,i=null;const n=this.si.iterator;for(;n.next();){const s=n.value;if(s.fromNode===this&&(null===t||s.fromPortId===t)){const t=s.toNode;null!==e?e.add(t):null!==i&&i!==t?(e=new u,e.add(i),e.add(t)):i=t}}return null!==e?e.iterator:null!==i?new o(i):s.instance}findNodesInto(t){void 0===t&&(t=null);let e=null,i=null;const n=this.si.iterator;for(;n.next();){const s=n.value;if(s.toNode===this&&(null===t||s.toPortId===t)){const t=s.fromNode;null!==e?e.add(t):null!==i&&i!==t?(e=new u,e.add(i),e.add(t)):i=t}}return null!==e?e.iterator:null!==i?new o(i):s.instance}findLinksBetween(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null);const n=new r(this.si),s=this;return n.predicate=n=>n.fromNode===s&&n.toNode===t&&(null===e||n.fromPortId===e)&&(null===i||n.toPortId===i)||n.fromNode===t&&n.toNode===s&&(null===i||n.fromPortId===i)&&(null===e||n.toPortId===e),n}findLinksTo(t,e,i){void 0===e&&(e=null),void 0===i&&(i=null);const n=new r(this.si),s=this;return n.predicate=n=>!(n.fromNode!==s||n.toNode!==t||null!==e&&n.fromPortId!==e||null!==i&&n.toPortId!==i),n}get linkConnected(){return null!==this.Et?this.Et.cy:null}set linkConnected(t){const i=this.linkConnected;i!==t&&(null!==t&&e.S(t,me,"linkConnected"),this.gl().cy=t,this.t("linkConnected",i,t))}get linkDisconnected(){return null!==this.Et?this.Et.fy:null}set linkDisconnected(t){const i=this.linkDisconnected;i!==t&&(null!==t&&e.S(t,me,"linkDisconnected"),this.gl().fy=t,this.t("linkDisconnected",i,t))}get linkValidation(){return null!==this.Et?this.Et.Dl:null}set linkValidation(t){const i=this.linkValidation;i!==t&&(null!==t&&e.S(t,me,"linkValidation"),this.gl().Dl=t,this.t("linkValidation",i,t))}c1(t,e){this.$i(e);const i=this.si.has(t);if(i||this.si.add(t),!i||t.fromNode===t.toNode){const i=this.linkConnected;if(null!==i){let n=!0;const s=this.diagram;null!==s&&(n=s.K,s.K=!0),i(this,t,e),null!==s&&(s.K=n)}}if(!i){if(!t.isTreeLink)return;const e=t.fromNode,i=t.toNode;if(null!==e&&null!==i&&e!==i){let t=!0;const n=this.diagram;null!==n&&(t=n.isTreePathToChildren);const s=t?i:e,o=t?e:i;if(s.Mh||(s.Mh=o),o.isTreeLeaf){if(null!==n&&n.undoManager.isUndoingRedoing)return;t?e===o&&(o.isTreeLeaf=!1):i===o&&(o.isTreeLeaf=!1)}}}}f1(t,e){this.$i(e);const i=this.si.delete(t);let n=null;if(i||t.toNode===t.fromNode){const i=this.linkDisconnected;if(n=this.diagram,null!==i){let s=!0;null!==n&&(s=n.K,n.K=!0),i(this,t,e),null!==n&&(n.K=s)}}if(i){if(!t.isTreeLink)return;let e=!0;null!==n&&(e=n.isTreePathToChildren);const i=e?t.toNode:t.fromNode,s=e?t.fromNode:t.toNode;if(null!==i&&(i.Mh=!1),null!==s&&!s.isTreeLeaf)if(0===s.si.count){if(s.Mh=null,null!==n&&n.undoManager.isUndoingRedoing)return;s.isTreeLeaf=!0}else s.f0()}}f0(){if(this.Mh=!1,0===this.si.count)return;let t=!0;const e=this.diagram;if(null!==e&&e.undoManager.isUndoingRedoing)return;null!==e&&(t=e.isTreePathToChildren);const i=this.si.iterator;for(;i.next();){const e=i.value;if(e.isTreeLink)if(t){if(e.fromNode===this)return void(this.isTreeLeaf=!1)}else if(e.toNode===this)return void(this.isTreeLeaf=!1)}this.isTreeLeaf=!0}updateRelationshipsFromData(){const t=this.diagram;null!==t&&t.partManager.updateRelationshipsFromData(this)}Bm(t){if(super.Bm(t),!t){this.f0();const t=this.Lf;null!==t&&t.fT(this)}}Um(t){if(super.Um(t),!t){const t=this.Lf;null!==t&&t.uT(this)}}qc(){if(this.si.count>0){const t=this.diagram;if(null!==t){const e=null===t.commandHandler||t.commandHandler.deletesConnectedLinks,i=this.si.copy().iterator;for(;i.next();){const n=i.value;e?t.remove(n):(n.fromNode===this&&(n.fromNode=null),n.toNode===this&&(n.toNode=null))}}}this.labeledLink=null,super.qc()}get isLinkLabel(){return null!==this.Lf}get labeledLink(){return this.Lf}set labeledLink(t){const e=this.Lf;if(e!==t){const i=this.diagram,n=this.data;if(null!==e){if(e.uT(this),null!==i&&null!==n&&!i.undoManager.isUndoingRedoing){const t=e.data,s=i.model;if(null!==t&&s.Ba()){const e=s.getKeyForNodeData(n);void 0!==e&&s.removeLabelKeyForLinkData(t,e)}}this.containingGroup=null}if(this.Lf=t,null!==t){if(t.fT(this),null!==i&&null!==n&&!i.undoManager.isUndoingRedoing){const e=t.data,s=i.model;if(null!==e&&s.Ba()){const t=s.getKeyForNodeData(n);void 0!==t&&s.addLabelKeyForLinkData(e,t)}}this.containingGroup=t.containingGroup}this.hf(),this.t("labeledLink",e,t)}}findVisiblePort(t){let e=t;for(;null!==e&&(!e.actualBounds.isReal()||!e.isVisibleObject());)e=e.panel;return null===e?this.port:e}findPort(t){if(null===this.le){if(""===t&&!1===this.bn)return this;this.dT()}let e=this.le.get(t);return null!==e||""!==t&&(e=this.le.get(""),null!==e)?e:this}get port(){return this.findPort("")}get ports(){return null===this.le&&this.dT(),this.le.iteratorValues}dT(){null===this.le?this.le=new p:this.le.clear(),this.walkVisualTreeFrom(this,((t,e)=>t.kA(e))),0===this.le.count&&this.le.set("",this)}kA(t){const e=t.portId;null!==e&&null!==this.le&&this.le.set(e,t)}w2(t,i){const n=t.portId;if(null!==n){null!==this.le&&this.le.delete(n);const t=this.diagram;if(null!==t&&i){let i=null;const s=this.findLinksConnected(n);for(;s.next();){const t=s.value;null===i&&(i=e.rt()),i.push(t)}if(null!==i){for(let e=0;e<i.length;e++){const n=i[e];t.remove(n)}e.tt(i)}}}}isInTreeOf(t){if(null===t||t===this)return!1;let e=!0;const i=this.diagram;null!==i&&(e=i.isTreePathToChildren);let n=this;const s=t;let o;if(e)for(;n!==s;){o=null;const t=n.si.iterator;for(;t.next();){const e=t.value;if(e.isTreeLink&&(o=e.fromNode,o!==n&&o!==this))break}if(o===this||null===o||o===n)return!1;n=o}else for(;n!==s;){o=null;const t=n.si.iterator;for(;t.next();){const e=t.value;if(e.isTreeLink&&(o=e.toNode,o!==n&&o!==this))break}if(o===this||null===o||o===n)return!1;n=o}return!0}findTreeRoot(){let t=!0;const e=this.diagram;null!==e&&(t=e.isTreePathToChildren);let i,n=this;if(t)for(;;){i=null;const t=n.si.iterator;for(;t.next();){const e=t.value;if(e.isTreeLink&&(i=e.fromNode,i!==n&&i!==this))break}if(i===this)return this;if(null===i||i===n)return n;n=i}else for(;;){i=null;const t=n.si.iterator;for(;t.next();){const e=t.value;if(e.isTreeLink&&(i=e.toNode,i!==n&&i!==this))break}if(i===this)return this;if(null===i||i===n)return n;n=i}}findCommonTreeParent(t){if(null===t)return null;if(this===t)return this;let e=this;for(;null!==e;)e.h1(!0),e=e.findTreeParentNode();let i=null;for(e=t;null!==e;){if(e.rT()){i=e;break}e=e.findTreeParentNode()}for(e=this;null!==e;)e.h1(!1),e=e.findTreeParentNode();return i}findTreeParentLink(){let t=!0;const e=this.diagram;null!==e&&(t=e.isTreePathToChildren);const i=this.si.iterator;if(t)for(;i.next();){const t=i.value;if(t.isTreeLink&&t.fromNode!==this)return t}else for(;i.next();){const t=i.value;if(t.isTreeLink&&t.toNode!==this)return t}return null}findTreeParentNode(){const t=this.Mh;if(null===t)return null;if(t instanceof me)return t;const e=this.diagram,i=null===e||e.isTreePathToChildren,n=this.si.iterator;for(;n.next();){const t=n.value;if(!t.isTreeLink)continue;const e=i?t.fromNode:t.toNode;if(e!==this)return this.Mh=e,e}return this.Mh=null,null}findTreeParentChain(){const t=new u;return function t(e,i){i.add(e);const n=e.findTreeParentLink();if(null!==n){i.add(n);const s=e.findTreeParentNode();if(null===s)return;t(s,i)}}(this,t),t}findTreeLevel(){return this.tO(this)}tO(t){let e=0,i=t.findTreeParentNode();for(;null!==i&&i!==t;)i=i.findTreeParentNode(),e++;return e}findTreeChildrenLinks(){let t=!0;const e=this.diagram;null!==e&&(t=e.isTreePathToChildren);const i=new r(this.si),n=this;return i.predicate=t?t=>!(!t.isTreeLink||t.fromNode!==n):t=>!(!t.isTreeLink||t.toNode!==n),i}findTreeChildrenNodes(){let t=!0;const e=this.diagram;null!==e&&(t=e.isTreePathToChildren);let i=null,n=null;const r=this.si.iterator;if(t)for(;r.next();){const t=r.value;if(t.isTreeLink&&t.fromNode===this){const e=t.toNode;null!==i?i.add(e):null!==n&&n!==e?(i=new l,i.add(n),i.add(e)):n=e}}else for(;r.next();){const t=r.value;if(t.isTreeLink&&t.toNode===this){const e=t.fromNode;null!==i?i.add(e):null!==n&&n!==e?(i=new l,i.add(n),i.add(e)):n=e}}return null!==i?i.iterator:null!==n?new o(n):s.instance}findTreeParts(t){void 0===t&&(t=1/0),e.s(t,"number",me,"findTreeParts:level");const i=new u;return ce.ch(i,this,!1,t,!0),i}collapseTree(t){void 0===t&&(t=1),t<1&&(t=1);const e=this.diagram;if(null===e||e.isCollapsingExpanding)return;e.isCollapsingExpanding=!0;const i=new u;i.add(this),this.gT(i,e.isTreePathToChildren,t,e,this,1===e.treeCollapsePolicy),e.isCollapsingExpanding=!1}gT(t,e,i,n,s,o){if(i>1){const r=e?this.findLinksOutOf():this.findLinksInto();for(;r.next();){const a=r.value;if(!a.isTreeLink)continue;const l=a.getOtherNode(this);null!==l&&l!==this&&!t.has(l)&&(t.add(l),l.gT(t,e,i-1,n,s,o))}}else this.mT(t,e,n,s,o)}mT(t,e,i,n,s){const o=n===this||this.isTreeExpanded,r=e?this.findLinksOutOf():this.findLinksInto();for(;r.next();){const a=r.value;if(!a.isTreeLink)continue;const l=a.getOtherNode(this);if(null!==l&&l!==this){const r=t.has(l);if(r||t.add(l),o){const t=e?l.findNodesInto():l.findNodesOutOf(),s=this;t.all((t=>t===s||!t.isTreeExpanded))&&i.vc(l,n),l.yh(),l.Vi(!1)}l.isTreeExpanded&&(l.wasTreeExpanded=l.isTreeExpanded,r||l.mT(t,e,i,n,s))}}this.isTreeExpanded=!1}expandTree(t){void 0===t&&(t=2),t<2&&(t=2);const e=this.diagram;if(null===e||e.isCollapsingExpanding)return;e.isCollapsingExpanding=!0;const i=new u;i.add(this),this.pT(i,e.isTreePathToChildren,t,e,this,1===e.treeCollapsePolicy),e.isCollapsingExpanding=!1}pT(t,e,i,n,s,o){const r=s!==this&&this.isTreeExpanded,a=e?this.findLinksOutOf():this.findLinksInto();for(;a.next();){const l=a.value;if(!l.isTreeLink)continue;r||l.Ce||l.invalidateRoute();const h=l.getOtherNode(this);if(null!==h&&h!==this&&!t.has(h)){if(t.add(h),!r){h.Vi(!0),h.yh();const t=e?h.findNodesInto():h.findNodesOutOf(),i=this;t.all((t=>t===i||!t.isTreeExpanded))&&n.Rc(h,s)}(i>2||h.wasTreeExpanded)&&(h.wasTreeExpanded=!1,h.pT(t,e,i-1,n,s,o))}}this.isTreeExpanded=!0}get isTreeExpanded(){return 0!==(1&this.E)}set isTreeExpanded(t){const e=0!==(1&this.E);if(e!==t){this.E=1^this.E;const i=this.diagram;this.t("isTreeExpanded",e,t);const n=this.treeExpandedChanged;if(null!==n){let t=!0;null!==i&&(t=i.K,i.K=!0),n(this),null!==i&&(i.K=t)}if(null!==i&&i.undoManager.isUndoingRedoing)return void this.Vi(t);t?this.expandTree():this.collapseTree()}}get wasTreeExpanded(){return 0!==(2&this.E)}set wasTreeExpanded(t){const e=0!==(2&this.E);e!==t&&(this.E=2^this.E,this.t("wasTreeExpanded",e,t))}get treeExpandedChanged(){return null!==this.Et?this.Et.uy:null}set treeExpandedChanged(t){const i=this.treeExpandedChanged;i!==t&&(null!==t&&e.S(t,me,"treeExpandedChanged"),this.gl().uy=t,this.t("treeExpandedChanged",i,t))}get isTreeLeaf(){return 0!==(4&this.E)}set isTreeLeaf(t){const e=0!==(4&this.E);e!==t&&(this.E=4^this.E,this.t("isTreeLeaf",e,t))}get isTreeRoot(){return null===this.findTreeParentLink()}}class pe{gi;cy;fy;Dl;uy;ay;hy;gy;my;ah;py;constructor(){this.gi=!1,this.cy=null,this.fy=null,this.Dl=null,this.uy=null,this.ay=v.pC,this.hy=1,this.gy=null,this.my=null,this.ah=null,this.py=null}copy(){const t=new pe;return t.cy=this.cy,t.fy=this.fy,t.Dl=this.Dl,t.uy=this.uy,t.ay=this.ay.N(),t.hy=this.hy,t.gy=this.gy,t.my=this.my,t.ah=this.ah,t.py=this.py,t}}var ye=(t=>(t[t.None=0]="None",t[t.End=17]="End",t[t.Scale=18]="Scale",t[t.Stretch=19]="Stretch",t))(ye||{}),xe=(t=>(t[t.Normal=1]="Normal",t[t.Orthogonal=2]="Orthogonal",t[t.AvoidsNodes=6]="AvoidsNodes",t[t.AvoidsNodesStraight=7]="AvoidsNodesStraight",t))(xe||{}),be=(t=>(t[t.None=0]="None",t[t.Bezier=9]="Bezier",t[t.JumpGap=10]="JumpGap",t[t.JumpOver=11]="JumpOver",t))(be||{});class ve extends ce{Lt;fo;uo;Td;go;mo;Dd;Af;Fd;Rd;vd;Ua;Od;$s;Pi;ml;Lr;Tf;Qo;eN;sN;u1;nN;oN;Va;d1;at;_o;static za=null;static Xa=null;gf;rN;lN;constructor(t){super(Yt.Link),this.Lt=8,this.fo=null,this.uo="",this.Td=null,this.go=null,this.mo="",this.Dd=null,this.Af=0,this.Fd=0,this.Rd=0,this.vd=NaN,this.Ua=1,this.Od=.5,this.$s=null,this.Pi=(new l).u(),this.ml=null,this.Lr=null,this.Tf=new b,this.at=new N,this.Qo=null,this._o=null,this.eN=null,this.sN=null,this.rN=0,this.lN=0,this.u1=new y,this.nN=null,this.oN=null,this.Va=null,this.d1=NaN,this.gt=null,this.gf=[],t&&Object.assign(this,t)}cloneProtected(t){super.cloneProtected(t),t.Lt=-113&this.Lt,t.uo=this.uo,t.Td=this.Td,t.mo=this.mo,t.Dd=this.Dd,t.Af=this.Af,t.Fd=this.Fd,t.Rd=this.Rd,t.vd=this.vd,t.Ua=this.Ua,t.Od=this.Od,null!==this.gt&&(t.gt=this.gt.copy())}Xo(t){super.Xo(t),this.uo=t.uo,this.mo=t.mo,t.ml=null,t.invalidateRoute(),t._o=this._o;const e=t.fromPort;null!==e&&t.fromNode.$i(e);const i=t.toPort;null!==i&&t.toNode.$i(i)}hi(t){t in xe||t in be||t in ye?ve.hN(t)?this.routing=t:9===t||10===t||11===t?this.curve=t:17===t||18===t||19===t?this.adjusting=t:1===t||0===t||e.o("Unknown Link enum value for a Link property: "+t):super.hi(t)}static Normal=1;static Orthogonal=2;static AvoidsNodes=6;static AvoidsNodesStraight=7;static None=0;static Bezier=9;static JumpGap=10;static JumpOver=11;static End=17;static Scale=18;static Stretch=19;static OrientAlong=21;static OrientPlus90=22;static OrientMinus90=23;static OrientOpposite=24;static OrientUpright=25;static OrientPlus90Upright=26;static OrientMinus90Upright=27;static OrientUpright45=28;static iO=8;static eO=16;static sO=14;static Ya=8;Xe(){return null===this.gt&&(this.gt=new Me),this.gt}dv(t,i,n){const s=t.segmentIndex,o=t.segmentFraction;let r=t.alignmentFocus;const a=t.segmentOrientation,l=t.segmentOffset;let h=0,u=0,c=0,d=0;if(isNaN(s)){const i=this.at,n=e.rt();i.getPointAndAngleAlongPath(o,n);const s=y.X(n[0],n[1]);if(s.add(this.getPoint(0)),1===i.type)s.offset(-i.startX,-i.startY);else{const t=i.figures.first();s.offset(-t.startX,-t.startY)}d=n[2],0!==a&&(c=this.computeAngle(t,a,d),t.angle=c),h=s.x,u=s.y,y.e(s),e.tt(n)}else if(s<-i||s>=i){const e=y.l();this.AA(e),d=this.midAngle,0!==a&&(c=this.computeAngle(t,a,d),t.angle=c),h=e.x,u=e.y,y.e(e)}else{let e,r,l=0;if(s>=0?(e=n.r[s],r=s<i-1?n.r[s+1]:e):(l=i+s,e=n.r[l],r=l>0?n.r[l-1]:e),e.equalsApprox(r)){let t,o;s>=0?(t=s>0?n.r[s-1]:e,o=s<i-2?n.r[s+2]:r):(t=l<i-1?n.r[l+1]:e,o=l>1?n.r[l-2]:r);const a=t.distanceSquaredPoint(e),h=r.distanceSquaredPoint(o);d=a>h+10?s>=0?t.directionPoint(e):e.directionPoint(t):h>a+10?s>=0?r.directionPoint(o):o.directionPoint(r):s>=0?t.directionPoint(o):o.directionPoint(t)}else d=s>=0?e.directionPoint(r):r.directionPoint(e);0!==a&&(c=this.computeAngle(t,a,d),t.angle=c),h=e.x+(r.x-e.x)*o,u=e.y+(r.y-e.y)*o}if(r.isNone())return void(t.location=new y(h,u));r.isNoSpot()&&(r=w.Center);const f=k.l();f.Ii(),f.nt(t.scale,t.scale),f.ds(t.angle,0,0);const g=t.naturalBounds,m=b.X(0,0,g.width,g.height),p=y.l();p.setRectSpot(m,r),f.xt(p);let x=-p.x,v=-p.y;const S=g.width,P=g.height,M=y.l();M.a(l);const C=isNaN(l.x),N=isNaN(l.y);if(C||N){const t=S/2+3,e=P/2+3,i=d>=45&&d<=135,n=d>=225&&d<=315;0===a&&(i||n)?(M.x=N?t:l.y,M.y=C?e:l.x,i?s>=0||isNaN(s)&&o<.5||C&&(M.y=-e):n&&((s>=0||isNaN(s)&&o<.5)&&C&&(M.y=-e),N&&(M.x=-t))):(C&&(s>=0||isNaN(s)&&o<.5?M.x=t:M.x=-t),N&&(M.y=-e),M.rotate(d))}else M.rotate(d);h+=M.x,u+=M.y,f.Ug(m),x+=m.x,v+=m.y;const T=y.X(h+x,u+v);t.move(T),y.e(T),y.e(M),y.e(p),b.e(m),k.e(f)}Jr(){let t=this.fromNode;if(null!==t){const e=t.findVisibleNode();if(null!==e&&(t=e),t.es()||t.lh())return!1}let e=this.toNode;if(null!==e){const t=e.findVisibleNode();if(null!==t&&(e=t),e.es()||e.lh())return!1}return!0}m2(t,e,i){return!1}p2(){}Me(){return!1}computeAngle(t,e,i){return ve.computeAngle(e,i)}static computeAngle(t,e){let i=0;switch(t){default:case 0:i=0;break;case 21:i=e;break;case 22:i=e+90;break;case 23:i=e-90;break;case 24:i=e+180;break;case 25:i=S.Yg(e),i>90&&i<270&&(i-=180);break;case 26:i=S.Yg(e+90),i>90&&i<270&&(i-=180);break;case 27:i=S.Yg(e-90),i>90&&i<270&&(i-=180);break;case 28:if(i=S.Yg(e),i>45&&i<135||i>225&&i<315)return 0;i>90&&i<270&&(i-=180)}return S.Yg(i)}get fromNode(){return this.fo}set fromNode(t){const e=this.fo;if(e!==t){const i=this.fromPort;null!==e&&(this.go!==e&&e.f1(this,i),this.yy(),this.invalidateLayout(2)),this.fo=t,null!==t&&this.Vi(t.isVisible()),this.Qo=null,this.invalidateRoute();const n=this.diagram;null!==n&&n.K&&n.partManager.setFromNodeForLink(this,t,e);const s=this.fromPort,o=this.fromPortChanged;if(null!==o){let t=!0;null!==n&&(t=n.K,n.K=!0),o(this,i,s),null!==n&&(n.K=t)}null!==t&&(this.go!==t&&t.c1(this,s),this.wy(),this.invalidateLayout(1)),this.t("fromNode",e,t),this.Ld()}}get fromPortId(){return this.uo}set fromPortId(t){const e=this.uo;if(e!==t){const i=this.fromPort;null!==i&&this.fromNode?.$i(i),this.yy(),this.uo=t;const n=this.fromPort;null!==n&&this.fromNode?.$i(n);const s=this.diagram;if(null!==s){const e=this.data,i=s.model;null!==e&&i.Ba()&&i.setFromPortIdForLinkData(e,t)}if(i!==n){this.Qo=null,this.invalidateRoute();const t=this.fromPortChanged;if(null!==t){let e=!0;null!==s&&(e=s.K,s.K=!0),t(this,i,n),null!==s&&(s.K=e)}}this.wy(),this.t("fromPortId",e,t)}}get fromPort(){const t=this.fo;if(null===t)return null;const e=this.uo;return t.findPort(e)}get fromPortChanged(){return this.Td}set fromPortChanged(t){const i=this.Td;i!==t&&(null!==t&&e.S(t,ve,"fromPortChanged"),this.Td=t,this.t("fromPortChanged",i,t))}get toNode(){return this.go}set toNode(t){const e=this.go;if(e!==t){const i=this.toPort;null!==e&&(this.fo!==e&&e.f1(this,i),this.yy(),this.invalidateLayout(2)),this.go=t,null!==t&&this.Vi(t.isVisible()),this.Qo=null,this.invalidateRoute();const n=this.diagram;null!==n&&n.K&&n.partManager.setToNodeForLink(this,t,e);const s=this.toPort,o=this.toPortChanged;if(null!==o){let t=!0;null!==n&&(t=n.K,n.K=!0),o(this,i,s),null!==n&&(n.K=t)}null!==t&&(this.fo!==t&&t.c1(this,s),this.wy(),this.invalidateLayout(1)),this.t("toNode",e,t),this.Ld()}}get toPortId(){return this.mo}set toPortId(t){const e=this.mo;if(e!==t){const i=this.toPort;null!==i&&this.toNode?.$i(i),this.yy(),this.mo=t;const n=this.toPort;null!==n&&this.toNode?.$i(n);const s=this.diagram;if(null!==s){const e=this.data,i=s.model;null!==e&&i.Ba()&&i.setToPortIdForLinkData(e,t)}if(i!==n){this.Qo=null,this.invalidateRoute();const t=this.toPortChanged;if(null!==t){let e=!0;null!==s&&(e=s.K,s.K=!0),t(this,i,n),null!==s&&(s.K=e)}}this.wy(),this.t("toPortId",e,t)}}get toPort(){const t=this.go;if(null===t)return null;const e=this.mo;return t.findPort(e)}get toPortChanged(){return this.Dd}set toPortChanged(t){const i=this.Dd;i!==t&&(null!==t&&e.S(t,ve,"toPortChanged"),this.Dd=t,this.t("toPortChanged",i,t))}get fromSpot(){return null!==this.gt?this.gt.xa:w.Default}set fromSpot(t){const e=this.fromSpot;if(!e.equals(t)){if(t=t.N(),this.Xe().xa=t,this.t("fromSpot",e,t),e.isSide()||t.isSide()){const t=this.fromNode;null!==t&&t.$i(this.fromPort)}this.invalidateRoute()}}get fromEndSegmentLength(){return null!==this.gt?this.gt.ka:NaN}set fromEndSegmentLength(t){const i=this.fromEndSegmentLength;if(i!==t){if(t<0&&e._(t,">= 0",ve,"fromEndSegmentLength"),this.Xe().ka=t,this.t("fromEndSegmentLength",i,t),this.computeSpot(!0,this.fromPort).isSide()){const t=this.fromNode;null!==t&&t.$i(this.fromPort)}this.invalidateRoute()}}get fromShortLength(){return null!==this.gt?this.gt.Sa:NaN}set fromShortLength(t){const e=this.fromShortLength;e!==t&&(this.Xe().Sa=t,this.oe(),this.t("fromShortLength",e,t))}get toSpot(){return null!==this.gt?this.gt.ba:w.Default}set toSpot(t){const e=this.toSpot;if(!e.equals(t)){if(t=t.N(),this.Xe().ba=t,this.t("toSpot",e,t),e.isSide()||t.isSide()){const t=this.toNode;null!==t&&t.$i(this.toPort)}this.invalidateRoute()}}get toEndSegmentLength(){return null!==this.gt?this.gt.Pa:NaN}set toEndSegmentLength(t){const i=this.toEndSegmentLength;if(i!==t){if(t<0&&e._(t,">= 0",ve,"toEndSegmentLength"),this.Xe().Pa=t,this.t("toEndSegmentLength",i,t),this.computeSpot(!1,this.toPort).isSide()){const t=this.toNode;null!==t&&t.$i(this.toPort)}this.invalidateRoute()}}get toShortLength(){return null!==this.gt?this.gt.Ma:NaN}set toShortLength(t){const e=this.toShortLength;e!==t&&(this.Xe().Ma=t,this.oe(),this.t("toShortLength",e,t))}Ld(){const t=this.fromNode,e=this.toNode;let i=null;if(i=null!==t?null!==e?t.findCommonContainingGroup(e):t.containingGroup:null!==e?e.containingGroup:null,this.nO(i),this.isLabeledLink){const t=this.labelNodes;for(;t.next();){t.value.containingGroup=i}}}nO(t){const e=this.Sh;if(e!==t){null!==e&&e.J2(this),this.Sh=t,null!==t&&t.$2(this);const i=this.containingGroupChanged;if(null!==i){let n=!0;const s=this.diagram;null!==s&&(n=s.K,s.K=!0),i(this,e,t),null!==s&&(s.K=n)}this.Ce&&(this.nN===e||this.oN===e)&&this.invalidateRoute()}}yh(){const t=this.containingGroup;null!==t&&this.fromNode!==t&&this.toNode!==t&&t.computesBoundsIncludingLinks&&super.yh()}getOtherNode(t){const e=this.fromNode;return t===e?this.toNode:e}getOtherPort(t){const e=this.fromPort;return t===e?this.toPort:e}get isLabeledLink(){return null!==this.$s&&this.$s.count>0}get labelNodes(){return null===this.$s?s.instance:this.$s.iterator}fT(t){null===this.$s&&(this.$s=new u),this.$s.add(t),this.c()}uT(t){null!==this.$s&&(this.$s.delete(t),this.c())}Bm(t){if(super.Bm(t),this.Ka()&&this.invalidateOtherJumpOvers(this.actualBounds),!t){const t=this.fo;let e=null;null!==t&&(e=this.fromPort,t.c1(this,e));const i=this.go;let n=null;null!==i&&(n=this.toPort,(i!==t||n!==e)&&i.c1(this,n)),this.wy()}}Um(t){if(super.Um(t),this.Ka()&&this.invalidateOtherJumpOvers(this.actualBounds),!t){const t=this.fo;let e=null;null!==t&&(e=this.fromPort,t.f1(this,e));const i=this.go;let n=null;null!==i&&(n=this.toPort,(i!==t||n!==e)&&i.f1(this,n)),this.yy()}}qc(){if(this.Ce=!0,null!==this.$s){const t=this.diagram;if(null!==t){const e=this.$s.copy().iterator;for(;e.next();){const i=e.value;t.remove(i)}}}if(null!==this.data){const t=this.diagram;null!==t&&t.partManager.aN(this)}}updateRelationshipsFromData(){if(null===this.data)return;const t=this.diagram;null!==t&&t.partManager.updateRelationshipsFromData(this)}move(t,e){const i=e?this.location:this.position;let n=i.x;isNaN(n)&&(n=0);let s=i.y;isNaN(s)&&(s=0);const o=t.x-n,r=t.y-s;if(!0===e)super.move(t,!1);else{const t=y.X(i.x+o,i.y+r);super.move(t,!1),y.e(t)}this.xr(o,r);const a=this.labelNodes;for(;a.next();){const t=a.value,e=t.position;t.moveTo(e.x+o,e.y+r)}}get relinkableFrom(){return 0!==(1&this.Lt)}set relinkableFrom(t){const e=0!==(1&this.Lt);e!==t&&(this.Lt=1^this.Lt,this.t("relinkableFrom",e,t),this.invalidateAdornments())}get relinkableTo(){return 0!==(2&this.Lt)}set relinkableTo(t){const e=0!==(2&this.Lt);e!==t&&(this.Lt=2^this.Lt,this.t("relinkableTo",e,t),this.invalidateAdornments())}canRelinkFrom(){if(!this.relinkableFrom)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowRelink)return!1;const e=t.diagram;return!(null!==e&&!e.allowRelink)}canRelinkTo(){if(!this.relinkableTo)return!1;const t=this.layer;if(null===t)return!0;if(!t.allowRelink)return!1;const e=t.diagram;return!(null!==e&&!e.allowRelink)}get resegmentable(){return 0!==(4&this.Lt)}set resegmentable(t){const e=0!==(4&this.Lt);e!==t&&(this.Lt=4^this.Lt,this.t("resegmentable",e,t),this.invalidateAdornments())}get isTreeLink(){return 0!==(8&this.Lt)}set isTreeLink(t){const e=0!==(8&this.Lt);e!==t&&(this.Lt=8^this.Lt,this.t("isTreeLink",e,t),null!==this.fromNode&&this.fromNode.f0(),null!==this.toNode&&this.toNode.f0())}get path(){const t=this.findMainElement();return t instanceof Jt?t:null}get routeBounds(){return this.updateRoute(),this.oO(this.Tf)}oO(t){let e=1/0,i=1/0;const n=this.pointsCount;if(0===n)return t.i(NaN,NaN,0,0),t;if(1===n){const n=this.getPoint(0);e=Math.min(n.x,e),i=Math.min(n.y,i),t.i(n.x,n.y,0,0)}else if(2===n){const n=this.getPoint(0),s=this.getPoint(1);e=Math.min(n.x,s.x),i=Math.min(n.y,s.y),t.i(n.x,n.y,0,0),t.unionPoint(s)}else if(9===this.computeCurve()&&n>=3&&!this.isOrthogonal){let s=this.getPoint(0);if(e=s.x,i=s.y,t.i(e,i,0,0),3===n){const n=this.getPoint(1);e=Math.min(n.x,e),i=Math.min(n.y,i);const o=this.getPoint(2);e=Math.min(o.x,e),i=Math.min(o.y,i),S.fu(s.x,s.y,n.x,n.y,n.x,n.y,o.x,o.y,.5,t)}else for(let o=3;o<n;o+=3){const r=this.getPoint(o-2);o+3>=n&&(o=n-1);const a=this.getPoint(o-1),l=this.getPoint(o);S.fu(s.x,s.y,r.x,r.y,a.x,a.y,l.x,l.y,.5,t),e=Math.min(l.x,e),i=Math.min(l.y,i),s=l}}else{const s=this.getPoint(0),o=this.getPoint(1);e=Math.min(s.x,o.x),i=Math.min(s.y,o.y),t.i(s.x,s.y,0,0),t.unionPoint(o);for(let r=2;r<n;r++){const n=this.getPoint(r);e=Math.min(n.x,e),i=Math.min(n.y,i),t.unionPoint(n)}}return this.u1.i(e-t.x,i-t.y),t}get midPoint(){return this.updateRoute(),this.computeMidPoint(new y)}AA(t){return this.updateRoute(),this.computeMidPoint(t)}computeMidPoint(t){const e=this.pointsCount;if(0===e)return t.a(y.Ak),t;if(1===e)return t.a(this.getPoint(0)),t;if(2===e){const e=this.getPoint(0),i=this.getPoint(1);return t.i((e.x+i.x)/2,(e.y+i.y)/2),t}if(this.isOrthogonal&&(this.computeCorner()>=15||9===this.computeCurve())){this.at.getPointAlongPath(.5,t),t.add(this.getPoint(0));const e=this.at.figures.first();return t.offset(-e.startX,-e.startY),t}if(9===this.computeCurve()){if(3===e){const e=this.getPoint(0),i=this.getPoint(1),n=this.getPoint(2);return S.PC(e.x,e.y,i.x,i.y,i.x,i.y,n.x,n.y,t),t}const i=(e-1)/3|0,n=3*(i/2|0);if(i%2===1){const e=this.getPoint(n),i=this.getPoint(n+1),s=this.getPoint(n+2),o=this.getPoint(n+3);return S.PC(e.x,e.y,i.x,i.y,s.x,s.y,o.x,o.y,t),t}return t.a(this.getPoint(n)),t}const i=this.flattenedLengths,n=this.flattenedTotalLength;let s=0,o=0,r=0;for(;s<n/2&&o<e&&(r=i[o],!(s+r>n/2));)s+=r,o++;const a=this.getPoint(o),l=this.getPoint(o+1);if(Math.abs(a.x-l.x)<1)a.y>l.y?t.i(a.x,a.y-(n/2-s)):t.i(a.x,a.y+(n/2-s));else if(Math.abs(a.y-l.y)<1)a.x>l.x?t.i(a.x-(n/2-s),a.y):t.i(a.x+(n/2-s),a.y);else{const e=(n/2-s)/r,i=e*(l.x-a.x),o=e*(l.y-a.y);t.i(a.x+i,a.y+o)}return t}get midAngle(){return this.updateRoute(),this.computeMidAngle()}computeMidAngle(){const t=this.pointsCount;if(t<2)return NaN;if(2===t){const t=this.getPoint(0),e=this.getPoint(1);return t.directionPoint(e)}if(this.isOrthogonal&&(this.computeCorner()>=15||9===this.computeCurve()))return this.at.getAngleAlongPath(.5);if(9===this.computeCurve()&&t>=4){const e=(t-1)/3|0;let i=3*(e/2|0);if(e%2===1){i=Math.floor(i);const t=this.getPoint(i),e=this.getPoint(i+1),n=this.getPoint(i+2),s=this.getPoint(i+3);return S.jD(t.x,t.y,e.x,e.y,n.x,n.y,s.x,s.y)}if(i>0&&i+1<t){const t=this.getPoint(i-1),e=this.getPoint(i+1);return t.directionPoint(e)}}const e=this.flattenedLengths,i=this.flattenedTotalLength;let n=0,s=0,o=0;for(;n<i/2&&s<t&&(o=e[s],!(n+o>i/2));)n+=o,s++;const r=this.getPoint(s),a=this.getPoint(s+1);if(Math.abs(r.x-a.x)<1&&Math.abs(r.y-a.y)<1){if(s>0&&s+2<t){const t=this.getPoint(s-1),e=this.getPoint(s+2);return t.directionPoint(e)}}else{if(Math.abs(r.x-a.x)<1)return r.y>a.y?270:90;if(Math.abs(r.y-a.y)<1)return r.x>a.x?180:0}return r.directionPoint(a)}get flattenedLengths(){return null!==this.Va?this.Va:(this.Ce||this.g1(),this.rO())}get flattenedTotalLength(){let t=this.d1;if(isNaN(t)){const e=this.flattenedLengths,i=e.length;t=0;for(let n=0;n<i;n++)t+=e[n];this.d1=t}return t}rO(){null===this.Va?this.Va=[]:this.Va.length=0;const t=this.Va,e=this.pointsCount;for(let i=0;i<e-1;i++){let e=0;const n=this.getPoint(i),s=this.getPoint(i+1);S.Y(n.x,s.x)?(e=s.y-n.y,e<0&&(e=-e),t.push(e)):S.Y(n.y,s.y)?(e=s.x-n.x,e<0&&(e=-e),t.push(e)):(e=Math.sqrt(n.distanceSquaredPoint(s)),t.push(e))}return t}get points(){return this.Pi}set points(t){const i=this.Pi;if(i===t)return;let n=null;if(Array.isArray(t)){const i=t;let s=i.length%2===0;if(s)for(let t=0;t<i.length;t++)if("number"!=typeof i[t]||isNaN(i[t])){s=!1;break}if(s){n=new l;for(let t=0;t<i.length/2;t++){const e=new y(i[2*t],i[2*t+1]).u();n.add(e)}}else{let t=!0;for(let n=0;n<i.length;n++){const s=i[n];if(!e.H(s)||"number"!=typeof s.x||isNaN(s.x)||"number"!=typeof s.y||isNaN(s.y)){t=!1;break}}if(t){n=new l;for(let t=0;t<i.length;t++){const e=i[t];n.add(new y(e.x,e.y).u())}}}}else if(t instanceof l){n=t.copy();const e=n.iterator;for(;e.next();)e.value.u()}else e.o("Link.points value is not an instance of List or Array: "+t);if(null===n)return;n.u(),this.Pi=n,this.oe(),this.g1();const s=this.diagram;null!==s&&(!s.Kh&&!s.undoManager.isUndoingRedoing&&s.ux.add(this),s.animationManager.xi&&s.animationManager.RS(this,n)),this.t("points",i,n)}get pointsCount(){return this.Pi.count}getPoint(t){return this.Pi.r[t]}setPoint(t,e){this.Pi.setElt(t,e)}setPointAt(t,e,i){this.Pi.setElt(t,new y(e,i))}insertPoint(t,e){this.Pi.insertAt(t,e)}insertPointAt(t,e,i){this.Pi.insertAt(t,new y(e,i))}addPoint(t){this.Pi.add(t)}addPointAt(t,e){this.Pi.add(new y(t,e))}removePoint(t){this.Pi.removeAt(t)}clearPoints(){this.Pi.clear()}xr(t,e){if(0===t&&0===e)return;if(0===this.pointsCount)return this.defaultFromPoint&&this.defaultFromPoint.offset(t,e),void(this.defaultToPoint&&this.defaultToPoint.offset(t,e));const i=this.Ce,n=new l,s=this.Pi.iterator;for(;s.next();){const i=s.value;n.add(new y(i.x+t,i.y+e).u())}n.u();const o=this.Pi;this.Pi=n;const r=this.diagram;isNaN(t)||isNaN(e)||null!==r&&r.animationManager.xi?this.c():(this.Js.i(this.Js.x+t,this.Js.y+e),this.dt.i(this.dt.x+t,this.dt.y+e),this.hf()),i?this.g1():(this.defaultFromPoint&&(this.defaultFromPoint=this.getPoint(0)),this.defaultToPoint&&(this.defaultToPoint=this.getPoint(this.pointsCount-1))),null!==r&&r.animationManager.xi&&r.animationManager.RS(this,n),this.t("points",o,n)}startRoute(){null===this.ml&&(this.ml=this.Pi,this.Pi=this.Pi.copy())}commitRoute(){if(null===this.ml)return;const t=this.ml,e=this.Pi;let i=1/0,n=1/0;const s=t.r,o=s.length;for(let c=0;c<o;c++){const t=s[c];i=Math.min(t.x,i),n=Math.min(t.y,n)}let r=1/0,a=1/0;const l=e.r,h=l.length;for(let c=0;c<h;c++){const t=l[c];r=Math.min(t.x,r),a=Math.min(t.y,a),t.u()}if(e.u(),h===o)for(let c=0;c<h;c++){const t=s[c],e=l[c];if(t.x-i!==e.x-r||t.y-n!==e.y-a){this.oe();break}}else this.oe();this.ml=null;const u=this.diagram;null!==u&&u.animationManager.xi&&u.animationManager.RS(this,e),this.g1(),this.t("points",t,e)}rollbackRoute(){null!==this.ml&&(this.Pi=this.ml,this.ml=null)}FF(){null!==this.Lr&&(this.points=this.Lr,this.Lr=null)}g1(){0!==this.Pi.count?(this.Ce=!0,this.Va=null,this.d1=NaN,this.defaultFromPoint=this.getPoint(0),this.defaultToPoint=this.getPoint(this.pointsCount-1),this.m1(!1)):this.Ce=!1}invalidateRoute(){if(this.suspendsRouting)return;const t=this.path;if(null===t)return;const e=this.diagram;if(e){if(e.ux.has(this)||e.undoManager.isUndoingRedoing)return;const t=e.animationManager;if(t.isTicking&&!t.isAnimating)return;null!==this.Lr&&!t.isTicking&&(this.Lr=null)}this.Ce=!1,this.c(),t.c()}get Ce(){return 0!==(16&this.Lt)}set Ce(t){0!==(16&this.Lt)!==t&&(this.Lt=16^this.Lt)}get suspendsRouting(){return 0!==(32&this.Lt)}set suspendsRouting(t){0!==(32&this.Lt)!==t&&(this.Lt=32^this.Lt)}get xy(){return 0!==(64&this.Lt)}set xy(t){0!==(64&this.Lt)!==t&&(this.Lt=64^this.Lt)}get cN(){return 0!==(512&this.Lt)}set cN(t){0!==(512&this.Lt)!==t&&(this.Lt=512^this.Lt)}get defaultFromPoint(){return this.eN}set defaultFromPoint(t){this.eN=null!==t?t.copy():null}get defaultToPoint(){return this.sN}set defaultToPoint(t){this.sN=null!==t?t.copy():null}updateRoute(){if(this.Ce||this.xy)return;let t=!0;try{this.xy=!0,this.startRoute(),t=this.computePoints()}catch{this.xy=!1,this.rollbackRoute()}finally{this.xy=!1,t?this.commitRoute():this.rollbackRoute()}}computePoints(){const t=this.diagram;if(null===t)return!1;let e=this.fromNode,i=null;if(null===e?(ve.za||(ve.za=new me,ve.za.desiredSize=x.hc,ve.za.ensureBounds()),this.defaultFromPoint&&(ve.za.location=this.defaultFromPoint,ve.za.ensureBounds(),e=ve.za,i=ve.za)):i=this.fromPort,null!==i&&!e.isVisible()){const t=e.findVisibleNode();null!==t&&t!==e?(e=t,i=t.port):e=t}if(this.nN=e,null===e||!e.location.isReal()||null===i||(i=e.findVisiblePort(i),null===i))return!1;let n=this.toNode,s=null;if(null===n?(ve.Xa||(ve.Xa=new me,ve.Xa.desiredSize=x.hc,ve.Xa.ensureBounds()),this.defaultToPoint&&(ve.Xa.location=this.defaultToPoint,ve.Xa.ensureBounds(),n=ve.Xa,s=ve.Xa)):s=this.toPort,null!==s&&!n.isVisible()){const t=n.findVisibleNode();null!==t&&t!==n?(n=t,s=t.port):n=t}if(this.oN=n,null===n||!n.location.isReal()||null===s||(s=n.findVisiblePort(s),null===s))return!1;const o=this.pointsCount,r=this.computeSpot(!0,i),a=this.computeSpot(!1,s),l=this.Id(r),h=this.Id(a),u=i===s&&null!==i,c=this.isOrthogonal;let d=9===this.curve;u&&!c?(d=!0,this.Qo=!0):this.Qo=!1;const f=0===this.computeAdjusting()||u;if(!c&&!u&&l&&h){let t=!1;if(!f&&o>=3){let l=this.getLinkPoint(e,i,r,!0,!1,n,s),h=this.getLinkPoint(n,s,a,!1,!1,e,i);t=this.adjustPoints(0,l,o-1,h),t&&(l=this.getLinkPoint(e,i,r,!0,!1,n,s),h=this.getLinkPoint(n,s,a,!1,!1,e,i),this.adjustPoints(0,l,o-1,h))}t||(this.clearPoints(),d?this.lO(e,i,r,n,s,a):this.hO(e,i,r,n,s,a))}else{const t=this.isAvoiding;f&&(c&&t||u)&&this.clearPoints();const d=u?this.computeCurviness():0,g=this.getLinkPoint(e,i,r,!0,c,n,s);let m=0,p=0,x=0;if(c||!l||u){let t=this.computeEndSegmentLength(e,i,r,!0);if(x=this.getLinkDirection(e,i,g,r,!0,c,n,s),u&&(l||r.equals(a)||!c&&r.x+a.x===1&&r.y+a.y===1)&&(x-=c?90:30,d<0&&(x-=180)),x<0?x+=360:x>=360&&(x-=360),u&&(t+=Math.abs(d)*(c?1:2)),0===x?m=t:90===x?p=t:180===x?m=-t:270===x?p=-t:(m=t*Math.cos(x*Math.PI/180),p=t*Math.sin(x*Math.PI/180)),r.isNoSpot()&&u){const t=i.getDocumentPoint(w.Center,y.l()),n=y.X(t.x+1e3*m,t.y+1e3*p);this.getLinkPointFromPoint(e,i,t,n,!0,g),y.e(t),y.e(n)}}const b=this.getLinkPoint(n,s,a,!1,c,e,i);let v=0,k=0,S=0;if(c||!h||u){let t=this.computeEndSegmentLength(n,s,a,!1);if(S=this.getLinkDirection(n,s,b,a,!1,c,e,i),u&&(h||r.equals(a)||!c&&r.x+a.x===1&&r.y+a.y===1)&&(S+=c?0:30,d<0&&(S+=180)),S<0?S+=360:S>=360&&(S-=360),u&&(t+=Math.abs(d)*(c?1:2)),0===S?v=t:90===S?k=t:180===S?v=-t:270===S?k=-t:(v=t*Math.cos(S*Math.PI/180),k=t*Math.sin(S*Math.PI/180)),a.isNoSpot()&&u){const t=s.getDocumentPoint(w.Center,y.l()),e=y.X(t.x+1e3*v,t.y+1e3*k);this.getLinkPointFromPoint(n,s,t,e,!1,b),y.e(t),y.e(e)}}let P=g;(c||!l||u)&&(P=new y(g.x+m,g.y+p));let M=b;(c||!h||u)&&(M=new y(b.x+v,b.y+k)),!f&&!c&&l&&o>3&&this.adjustPoints(0,g,o-2,M)?this.setPoint(o-1,b):!f&&!c&&h&&o>3&&this.adjustPoints(1,P,o-1,b)?this.setPoint(0,g):!f&&(c?o>=6:o>4)&&this.adjustPoints(1,P,o-2,M)?(this.setPoint(0,g),this.setPoint(o-1,b)):(this.clearPoints(),this.addPoint(g),(c||!l||u)&&this.addPoint(P),c&&this.addOrthoPoints(P,x,M,S,e,n),(c||!h||u)&&this.addPoint(M),this.addPoint(b))}return t.addInvalidRoute(this),!0}fN(t,e){return Math.abs(e.x-t.x)>Math.abs(e.y-t.y)?(e.x>=t.x?e.x=t.x+9e9:e.x=t.x-9e9,e.y=t.y):(e.y>=t.y?e.y=t.y+9e9:e.y=t.y-9e9,e.x=t.x),e}getLinkPointFromPoint(t,e,i,n,s,o){if(void 0===o&&(o=new y),null===t||null===e)return o.a(i),o;if(!t.isVisible()){const i=t.findVisibleNode();null!==i&&i!==t&&(e=(t=i).port)}let r=0,a=0,l=0,h=0,u=null,c=e.panel;if(null!==c&&!c.wn()&&(c=c.panel),null===c)r=n.x,a=n.y,l=i.x,h=i.y;else{u=c.Ys;const t=1/(u.m11*u.m22-u.m12*u.m21),e=u.m22*t,s=-u.m12*t,o=-u.m21*t,d=u.m11*t,f=t*(u.m21*u.dy-u.m22*u.dx),g=t*(u.m12*u.dx-u.m11*u.dy);r=n.x*e+n.y*o+f,a=n.x*s+n.y*d+g,l=i.x*e+i.y*o+f,h=i.x*s+i.y*d+g}return e.ef(r,a,l,h,o),null!==u&&o.F(u),o}aO(t,e){const i=t.Ju;return null!==i?i.yT(e):null}p1(t){if(null===t)return null;let e=t.Ju;return null===e&&(e=new Se(t.part,t),t.Ju=e),e.yT(this)}getLinkPoint(t,e,i,n,s,o,r,a){if(void 0===a&&(a=new y),i.isSpot()&&!this.Id(i))return e.getDocumentPoint(i,a),a;if(i.isSide()){const l=this.p1(e);if(null!==l){const h=l.Ed;if(a.a(h),s&&7===this.routing){const h=this.p1(r);if(null!==h&&l.Df<h.Df){const l=y.l(),h=y.l(),u=new b(e.getDocumentPoint(w.TopLeft,l),e.getDocumentPoint(w.BottomRight,h)),c=this.computeSpot(!n,r),d=this.getLinkPoint(o,r,c,!n,s,t,e,h);(i.includesSide(w.LeftSide)||i.includesSide(w.RightSide))&&d.y>=u.y&&d.y<=u.y+u.height?a.y=d.y:(i.includesSide(w.TopSide)||i.includesSide(w.BottomSide))&&d.x>=u.x&&d.x<=u.x+u.width&&(a.x=d.x),y.e(l),y.e(h)}}return a}}const l=e.getDocumentPoint(this.w1(i,n),y.l());let h=null;if(this.pointsCount>(s?6:2))h=n?this.getPoint(1):this.getPoint(this.pointsCount-2),s&&(h=this.fN(l,h.copy()));else{const t=this.computeSpot(!n,r),e=y.l();h=r.getDocumentPoint(this.w1(t,!n),e),s&&(h=this.fN(l,h)),y.e(e)}return this.getLinkPointFromPoint(t,e,l,h,n,a),y.e(l),a}getLinkDirection(t,e,i,n,s,o,r,a){let l=this.cO(t,e,i,n,s,o,r,a);if(r&&n.isNoSpot()&&r.isMemberOf(t)&&(l+=180,l>=360&&(l-=360)),this.Id(n)||null===e)return l;const h=e.getDocumentAngle();return 0===h||(45<=h&&h<135?l+=90:135<=h&&h<225?l+=180:225<=h&&h<315&&(l+=270),l>=360&&(l-=360)),l}cO(t,e,i,n,s,o,r,a){if(n.isSpot())return n.x>n.y?n.x>1-n.y?0:n.x<1-n.y?270:315:n.x<n.y?n.x>1-n.y?90:n.x<1-n.y?180:135:n.x<.5?225:n.x>.5?45:0;if(n.isSide()){const t=this.p1(e);if(null===t)return n.includesSide(w.TopSide)?270:n.includesSide(w.BottomSide)?90:n.includesSide(w.LeftSide)?180:0;switch(t.we){case 1:return 270;case 2:return 180;default:case 4:return 0;case 8:return 90}}if(null===e||null===a)return 0;const l=e.getDocumentPoint(w.Center,y.l());let h=null;if(this.pointsCount>(o?6:2))h=s?this.getPoint(1):this.getPoint(this.pointsCount-2),h=o?this.fN(l,h.copy()):i;else{const t=y.l();h=a.getDocumentPoint(w.Center,t),y.e(t)}let u=0;return u=Math.abs(h.x-l.x)>Math.abs(h.y-l.y)?h.x>=l.x?0:180:h.y>=l.y?90:270,y.e(l),u}computeEndSegmentLength(t,e,i,n){if(null!==e&&i.isSide()){const t=this.p1(e);if(null!==t)return t.b1}let s=NaN;return s=n?this.fromEndSegmentLength:this.toEndSegmentLength,null!==e&&isNaN(s)&&(s=n?e.fromEndSegmentLength:e.toEndSegmentLength),isNaN(s)&&(s=10),s}computeSpot(t,e){return void 0===e&&(e=null),t?this.fO(e||this.fromPort):this.uO(e||this.toPort)}fO(t){if(null===t)return w.Center;let e=this.fromSpot;return e.isDefault()&&(e=t.fromSpot),e===w.Default?w.None:e}uO(t){if(null===t)return w.Center;let e=this.toSpot;return e.isDefault()&&(e=t.toSpot),e===w.Default?w.None:e}Id(t){return t===w.None||.5===t.x&&.5===t.y}w1(t,e){return.5===t.x&&.5===t.y?t:w.Center}computeOtherPoint(t,e){if(0!==this.computeAdjusting()&&this.pointsCount>4)return this.computeMidPoint(new y);{const t=this.aO(e,this);return null!==t?t.Ed:e.getDocumentPoint(w.Center)}}computeShortLength(t){if(t){let t=this.fromShortLength;if(isNaN(t)){const e=this.fromPort;null!==e&&(t=e.fromShortLength)}return isNaN(t)?0:t}{let t=this.toShortLength;if(isNaN(t)){const e=this.toPort;null!==e&&(t=e.toShortLength)}return isNaN(t)?0:t}}Om(t,e,i,n,s,o){if(!1===this.pickable)return!1;let r;if(void 0===e&&(e=null),void 0===i&&(i=null),void 0===o?(r=k.l(),r.Ii()):r=o,r.ac(this.F),this.containedInRect(t,r))return this.I2(e,i,s),void 0===o&&k.e(r),!0;if(this.intersectsRect(t,r)){let a=!1;if(!this.mf){const o=this.T.r;for(let l=o.length;l--;){const h=o[l];if(!h.visible&&h!==this.locationObject)continue;const u=h.actualBounds,c=this.naturalBounds;if(u.x>c.width||u.y>c.height||u.x+u.width<0||u.y+u.height<0)continue;const d=h,f=k.l();if(f.set(r),d instanceof Yt?a=d.Om(t,e,i,n,s,f):this.path===d?d instanceof Jt&&(a=d.Iv(t,n,f)):a=d.uA(t,n,f),a){let t=d;null!==e&&(t=e(d)),t&&(null===i||i(t))&&s.add(t)}k.e(f)}}return void 0===o&&k.e(r),a||null!==this.background}return void 0===o&&k.e(r),!1}get isOrthogonal(){return 2===(2&this.Ua)}static hN(t){return 2===(2&t)}get isAvoiding(){return 4===(4&this.Ua)}computeCurve(){if(null===this.Qo){const t=this.fromPort,e=null!==t&&t===this.toPort,i=this.isOrthogonal;this.Qo=e&&!i}return this.Qo?9:this.curve}computeCorner(){if(9===this.curve)return 0;let t=this.corner;return(isNaN(t)||t<0)&&(t=10),t}findMidLabel(){const t=this.path,e=this.T.r,i=e.length;for(let s=0;s<i;s++){const i=e[s];if(i!==t&&!i.isPanelMain&&(i.segmentIndex===-1/0||isNaN(i.segmentIndex)))return i}const n=this.labelNodes;for(;n.next();){const t=n.value;if(t.segmentIndex===-1/0||isNaN(t.segmentIndex))return t}return null}computeSpacing(){if(!this.isVisible())return 0;let t=ve.sO;t=Math.max(t,this.computeThickness());const e=this.fromPort,i=this.toPort;if(null!==e&&null!==i){const n=this.findMidLabel();if(null!==n){const s=n.naturalBounds,o=n.margin,r=isNaN(s.width)?30:s.width*n.scale+o.left+o.right,a=isNaN(s.height)?14:s.height*n.scale+o.top+o.bottom,l=n.segmentOrientation;if(21===l||25===l||24===l)t=Math.max(t,a);else if(23===l||27===l||22===l||26===l)t=Math.max(t,r);else{const n=e.getDocumentPoint(w.Center).directionPoint(i.getDocumentPoint(w.Center))/180*Math.PI;t=Math.max(t,Math.abs(Math.sin(n)*r)+Math.abs(Math.cos(n)*a)+1)}9===this.curve&&(t*=1.333)}}return t}arrangeBundledLinks(t,e){if(e)for(let i=0;i<t.length;i++){const e=t[i];0===e.computeAdjusting()&&e.invalidateRoute()}}computeCurviness(){let t=this.curviness;if(isNaN(t)){t=ve.eO;const i=this._o;if(null!==i){const n=e.rt();let s=0;const o=i.Zs;for(let t=0;t<o.length;t++){const e=o[t].computeSpacing();n.push(e),s+=e}let r=-s/2;for(let e=0;e<o.length;e++){if(o[e]===this){t=r+n[e]/2;break}r+=n[e]}i.ly===this.fromNode&&(t=-t),e.tt(n)}}return t}computeThickness(){if(!this.isVisible())return 0;const t=this.path;return null!==t?Math.max(t.strokeWidth,1):1}hasCurviness(){return!isNaN(this.curviness)||null!==this._o}hO(t,e,i,n,s,o){const r=this.getLinkPoint(t,e,i,!0,!1,n,s),a=this.getLinkPoint(n,s,o,!1,!1,t,e);if(this.hasCurviness()){const t=a.x-r.x,e=a.y-r.y,i=this.computeCurviness(),n=i,s=r.x+t/2,o=r.y+e/2;let l=s,h=o;if(S.f(e,0))t>0?h-=n:h+=n;else{const r=-t/e;let a=Math.sqrt(n*n/(r*r+1));i<0&&(a=-a),l=(e<0?-1:1)*a+s,h=r*(l-s)+o}this.addPoint(r),this.addPointAt(l,h),this.addPoint(a)}else{this.addPoint(r),this.addPoint(a);const l=b.l();e.getDocumentBounds(l);const h=l.containsPoint(a);s.getDocumentBounds(l);const u=l.containsPoint(r);if(h||u){const l=e.getDocumentPoint(this.w1(i,!0),new y);this.setPoint(0,this.getLinkPointFromPoint(t,e,l,a,!0,l));const h=s.getDocumentPoint(this.w1(o,!1),new y);this.setPoint(1,this.getLinkPointFromPoint(n,s,h,r,!1,h))}b.e(l)}}lO(t,e,i,n,s,o){const r=this.getLinkPoint(t,e,i,!0,!1,n,s),a=this.getLinkPoint(n,s,o,!1,!1,t,e),l=a.x-r.x,h=a.y-r.y,u=this.computeCurviness();let c=0,d=0,f=r.x+l/3,g=r.y+h/3,m=f,p=g;S.f(h,0)?l>0?p-=u:p+=u:(c=-l/h,d=Math.sqrt(u*u/(c*c+1)),u<0&&(d=-d),m=(h<0?-1:1)*d+f,p=c*(m-f)+g),f=r.x+2*l/3,g=r.y+2*h/3;let y=f,x=g;S.f(h,0)?l>0?x-=u:x+=u:(y=(h<0?-1:1)*d+f,x=c*(y-f)+g),this.clearPoints(),this.addPoint(r),this.addPointAt(m,p),this.addPointAt(y,x),this.addPoint(a),this.setPoint(0,this.getLinkPoint(t,e,i,!0,!1,n,s)),this.setPoint(3,this.getLinkPoint(n,s,o,!1,!1,t,e))}adjustPoints(t,e,i,n){let s=this.computeAdjusting();if(this.isOrthogonal){if(18===s)return!1;19===s&&(s=17)}switch(s){case 18:return this.dO(t,e,i,n);case 19:return this.gO(t,e,i,n);case 17:return this.mO(t,e,i,n);default:return!1}}dO(t,e,i,n){const s=this.getPoint(t),o=this.getPoint(i);if(s.equalsApprox(e)&&o.equalsApprox(n))return!0;const r=s.x,a=s.y;let l=o.x-r,h=o.y-a;const u=Math.sqrt(l*l+h*h);if(S.Y(u,0))return!0;let c=0;S.Y(l,0)?c=h<0?-Math.PI/2:Math.PI/2:(c=Math.atan(h/Math.abs(l)),l<0&&(c=Math.PI-c));const d=e.x,f=e.y,g=n.x-d,m=n.y-f,p=Math.sqrt(g*g+m*m);let y=0;S.Y(g,0)?y=m<0?-Math.PI/2:Math.PI/2:(y=Math.atan(m/Math.abs(g)),g<0&&(y=Math.PI-y));const x=p/u,b=y-c;this.setPoint(t,e);for(let v=t+1;v<i;v++){const t=this.getPoint(v);l=t.x-r,h=t.y-a;const e=Math.sqrt(l*l+h*h);if(S.Y(e,0))continue;let i=0;S.Y(l,0)?i=h<0?-Math.PI/2:Math.PI/2:(i=Math.atan(h/Math.abs(l)),l<0&&(i=Math.PI-i));const n=i+b,s=e*x,o=d+s*Math.cos(n),u=f+s*Math.sin(n);this.setPointAt(v,o,u)}return this.setPoint(i,n),!0}gO(t,e,i,n){const s=this.getPoint(t),o=this.getPoint(i);if(s.equalsApprox(e)&&o.equalsApprox(n))return!0;const r=s.x,a=s.y,l=o.x,h=o.y,u=(l-r)**2+(h-a)**2,c=e.x,d=e.y,f=n.x,g=n.y;let m=0,p=1;f-c!==0?(m=(g-d)/(f-c),p=Math.sqrt(1+1/(m*m))):m=9e9,this.setPoint(t,e);for(let y=t+1;y<i;y++){const t=this.getPoint(y),e=t.x,i=t.y;let n=.5;0!==u&&(n=((r-e)*(r-l)+(a-i)*(a-h))/u);const s=r+n*(l-r),o=a+n*(h-a);let x=Math.sqrt((e-s)**2+(i-o)**2);i<m*(e-s)+o&&(x=-x),m>0&&(x=-x);const b=c+n*(f-c),v=d+n*(g-d);if(0!==m){const t=b+x/p,e=v-(t-b)/m;this.setPointAt(y,t,e)}else this.setPointAt(y,b,v+x)}return this.setPoint(i,n),!0}mO(t,e,i,n){if(this.isOrthogonal){let s=this.getPoint(t),o=this.getPoint(t+1),r=this.getPoint(t+2),a=o.x,l=o.y;const h=a,u=l;S.f(s.y,o.y)?S.f(o.x,r.x)?l=e.y:S.f(o.y,r.y)&&(a=e.x):S.f(s.x,o.x)&&(S.f(o.y,r.y)?a=e.x:S.f(o.x,r.x)&&(l=e.y)),this.setPointAt(t+1,a,l),s=this.getPoint(i),o=this.getPoint(i-1),r=this.getPoint(i-2);let c=o.x,d=o.y;const f=c,g=d;if(S.f(s.y,o.y)?S.f(o.x,r.x)?d=n.y:S.f(o.y,r.y)&&(c=n.x):S.f(s.x,o.x)&&(S.f(o.y,r.y)?c=n.x:S.f(o.x,r.x)&&(d=n.y)),this.setPointAt(i-1,c,d),this.YL())return this.setPointAt(t+1,h,u),this.setPointAt(i-1,f,g),!1}return this.setPoint(t,e),this.setPoint(i,n),!0}addOrthoPoints(t,e,i,n,s,o){e<0?e+=360:e>=360&&(e-=360),n<0?n+=360:n>=360&&(n-=360);const r=n;e=e>=315||e<45?0:45<=e&&e<135?90:135<=e&&e<225?180:270,n=n>=315||n<45?0:45<=n&&n<135?90:135<=n&&n<225?180:270;const a=t,l=i,h=s.actualBounds.copy(),u=o.actualBounds.copy();if(!h.isReal()||!u.isReal())return;h.inflate(ve.Ya,ve.Ya),u.inflate(ve.Ya,ve.Ya),h.unionPoint(t),u.unionPoint(i);const c=y.l(),d=y.l();0===e?l.x>a.x||270===n&&l.y<a.y&&u.right>a.x||90===n&&l.y>a.y&&u.right>a.x?(c.i(l.x,a.y),d.i(l.x,(a.y+l.y)/2),180===n?(c.x=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!1),d.x=c.x,d.y=l.y):270===n&&l.y<a.y||90===n&&l.y>a.y?(a.x<u.left?c.x=this.computeMidOrthoPosition(a.x,a.y,u.left,l.y,!1):a.x<u.right&&(270===n&&a.y<u.top||90===n&&a.y>u.bottom)?c.x=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!1):c.x=u.right,d.x=c.x,d.y=l.y):0===n&&a.x<u.left&&a.y>u.top&&a.y<u.bottom&&(c.x=a.x,a.y<l.y?c.y=Math.min(l.y,u.top):c.y=Math.max(l.y,u.bottom),d.y=c.y)):(c.i(a.x,l.y),d.i((a.x+l.x)/2,l.y),(180===n||90===n&&l.y<h.top||270===n&&l.y>h.bottom)&&(180===n&&(u.containsPoint(a)||h.containsPoint(l))?c.y=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!0):l.y<a.y&&(180===n||90===n)?c.y=this.computeMidOrthoPosition(a.x,h.top,l.x,Math.max(l.y,u.bottom),!0):l.y>a.y&&(180===n||270===n)&&(c.y=this.computeMidOrthoPosition(a.x,h.bottom,l.x,Math.min(l.y,u.top),!0)),d.x=l.x,d.y=c.y),c.y>h.top&&c.y<h.bottom&&(l.x>=h.left&&l.x<=a.x||a.x<=u.right&&a.x>=l.x?(90===n||270===n)&&(c.i(Math.max((a.x+l.x)/2,a.x),a.y),d.i(c.x,l.y)):(270===n||(0===n||180===n)&&l.y<a.y?c.y=Math.min(l.y,0===n?h.top:Math.min(h.top,u.top)):c.y=Math.max(l.y,0===n?h.bottom:Math.max(h.bottom,u.bottom)),d.x=l.x,d.y=c.y))):180===e?l.x<a.x||270===n&&l.y<a.y&&u.left<a.x||90===n&&l.y>a.y&&u.left<a.x?(c.i(l.x,a.y),d.i(l.x,(a.y+l.y)/2),0===n?(c.x=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!1),d.x=c.x,d.y=l.y):270===n&&l.y<a.y||90===n&&l.y>a.y?(a.x>u.right?c.x=this.computeMidOrthoPosition(a.x,a.y,u.right,l.y,!1):a.x>u.left&&(270===n&&a.y<u.top||90===n&&a.y>u.bottom)?c.x=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!1):c.x=u.left,d.x=c.x,d.y=l.y):180===n&&a.x>u.right&&a.y>u.top&&a.y<u.bottom&&(c.x=a.x,a.y<l.y?c.y=Math.min(l.y,u.top):c.y=Math.max(l.y,u.bottom),d.y=c.y)):(c.i(a.x,l.y),d.i((a.x+l.x)/2,l.y),(0===n||90===n&&l.y<h.top||270===n&&l.y>h.bottom)&&(0===n&&(u.containsPoint(a)||h.containsPoint(l))?c.y=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!0):l.y<a.y&&(0===n||90===n)?c.y=this.computeMidOrthoPosition(a.x,h.top,l.x,Math.max(l.y,u.bottom),!0):l.y>a.y&&(0===n||270===n)&&(c.y=this.computeMidOrthoPosition(a.x,h.bottom,l.x,Math.min(l.y,u.top),!0)),d.x=l.x,d.y=c.y),c.y>h.top&&c.y<h.bottom&&(l.x<=h.right&&l.x>=a.x||a.x>=u.left&&a.x<=l.x?(90===n||270===n)&&(c.i(Math.min((a.x+l.x)/2,a.x),a.y),d.i(c.x,l.y)):(270===n||(0===n||180===n)&&l.y<a.y?c.y=Math.min(l.y,180===n?h.top:Math.min(h.top,u.top)):c.y=Math.max(l.y,180===n?h.bottom:Math.max(h.bottom,u.bottom)),d.x=l.x,d.y=c.y))):90===e?l.y>a.y||180===n&&l.x<a.x&&u.bottom>a.y||0===n&&l.x>a.x&&u.bottom>a.y?(c.i(a.x,l.y),d.i((a.x+l.x)/2,l.y),270===n?(c.y=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!0),d.x=l.x,d.y=c.y):180===n&&l.x<a.x||0===n&&l.x>a.x?(a.y<u.top?c.y=this.computeMidOrthoPosition(a.x,a.y,l.x,u.top,!0):a.y<u.bottom&&(180===n&&a.x<u.left||0===n&&a.x>u.right)?c.y=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!0):c.y=u.bottom,d.x=l.x,d.y=c.y):90===n&&a.y<u.top&&a.x>u.left&&a.x<u.right&&(a.x<l.x?c.x=Math.min(l.x,u.left):c.x=Math.max(l.x,u.right),c.y=a.y,d.x=c.x)):(c.i(l.x,a.y),d.i(l.x,(a.y+l.y)/2),(270===n||0===n&&l.x<h.left||180===n&&l.x>h.right)&&(270===n&&(u.containsPoint(a)||h.containsPoint(l))?c.x=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!1):l.x<a.x&&(270===n||0===n)?c.x=this.computeMidOrthoPosition(h.left,a.y,Math.max(l.x,u.right),l.y,!1):l.x>a.x&&(270===n||180===n)&&(c.x=this.computeMidOrthoPosition(h.right,a.y,Math.min(l.x,u.left),l.y,!1)),d.x=c.x,d.y=l.y),c.x>h.left&&c.x<h.right&&(l.y>=h.top&&l.y<=a.y||a.y<=u.bottom&&a.y>=l.y?(0===n||180===n)&&(c.i(a.x,Math.max((a.y+l.y)/2,a.y)),d.i(l.x,c.y)):(180===n||(90===n||270===n)&&l.x<a.x?c.x=Math.min(l.x,90===n?h.left:Math.min(h.left,u.left)):c.x=Math.max(l.x,90===n?h.right:Math.max(h.right,u.right)),d.x=c.x,d.y=l.y))):l.y<a.y||180===n&&l.x<a.x&&u.top<a.y||0===n&&l.x>a.x&&u.top<a.y?(c.i(a.x,l.y),d.i((a.x+l.x)/2,l.y),90===n?(c.y=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!0),d.x=l.x,d.y=c.y):180===n&&l.x<a.x||0===n&&l.x>=a.x?(a.y>u.bottom?c.y=this.computeMidOrthoPosition(a.x,a.y,l.x,u.bottom,!0):a.y>u.top&&(180===n&&a.x<u.left||0===n&&a.x>u.right)?c.y=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!0):c.y=u.top,d.x=l.x,d.y=c.y):270===n&&a.y>u.bottom&&a.x>u.left&&a.x<u.right&&(a.x<l.x?c.x=Math.min(l.x,u.left):c.x=Math.max(l.x,u.right),c.y=a.y,d.x=c.x)):(c.i(l.x,a.y),d.i(l.x,(a.y+l.y)/2),(90===n||0===n&&l.x<h.left||180===n&&l.x>h.right)&&(90===n&&(u.containsPoint(a)||h.containsPoint(l))?c.x=this.computeMidOrthoPosition(a.x,a.y,l.x,l.y,!1):l.x<a.x&&(90===n||0===n)?c.x=this.computeMidOrthoPosition(h.left,a.y,Math.max(l.x,u.right),l.y,!1):l.x>a.x&&(90===n||180===n)&&(c.x=this.computeMidOrthoPosition(h.right,a.y,Math.min(l.x,u.left),l.y,!1)),d.x=c.x,d.y=l.y),c.x>h.left&&c.x<h.right&&(l.y<=h.bottom&&l.y>=a.y||a.y>=u.top&&a.y<=l.y?(0===n||180===n)&&(c.i(a.x,Math.min((a.y+l.y)/2,a.y)),d.i(l.x,c.y)):(180===n||(90===n||270===n)&&l.x<a.x?c.x=Math.min(l.x,270===n?h.left:Math.min(h.left,u.left)):c.x=Math.max(l.x,270===n?h.right:Math.max(h.right,u.right)),d.x=c.x,d.y=l.y))),this.cN=n!==r,this.rN=e,this.lN=n,this.addPoint(c.copy()),this.addPoint(d.copy()),y.e(c),y.e(d)}computeMidOrthoPosition(t,e,i,n,s){let o=0;return this.hasCurviness()&&!this.computeSpot(!0,this.fromPort).isSide()&&!this.computeSpot(!1,this.toPort).isSide()&&(o=this.computeCurviness()),s?(e+n)/2+o:(t+i)/2+o}YL(){if(null===this.diagram||!this.isAvoiding||this.diagram.animationManager.isTicking)return!1;const t=this.points.r,e=t.length;if(e<4)return!1;const i=this.diagram.getPositions(!1,this.containingGroup,null);for(let n=1;n<e-2;n++){const e=t[n],s=t[n+1];if(!i.isUnoccupied(Math.min(e.x,s.x),Math.min(e.y,s.y),Math.abs(e.x-s.x),Math.abs(e.y-s.y)))return!0}return!1}findClosestSegment(t){const e=t.x,i=t.y;let n=this.getPoint(0),s=this.getPoint(1),o=y.distanceLineSegmentSquared(e,i,n.x,n.y,s.x,s.y),r=0;for(let a=1;a<this.pointsCount-1;a++){n=this.getPoint(a+1);const t=y.distanceLineSegmentSquared(e,i,s.x,s.y,n.x,n.y);s=n,t<o&&(r=a,o=t)}return r}oe(){this.Nh=!1,this.c()}get Nh(){return 0!==(128&this.Lt)}set Nh(t){0!==(128&this.Lt)!==t&&(this.Lt=128^this.Lt)}get geometry(){if(!this.Nh){if(this.updateRoute(),this.pointsCount<2)return this.Nh=!0,this.at;this.at=this.makeGeometry()}return this.at}hd(t){if(!t){if(!1===this.Ce)return;const t=this.findMainElement();if(this.Nh&&(null===t||null!==t.geometry))return}this.pointsCount<2?this.Nh=!0:this.at=this.makeGeometry();const e=this.path;if(null===e)return;e.at=this.at;const i=this.T.r,n=i.length;for(let s=0;s<n;s++){const t=i[s];t!==e&&t.isPanelMain&&t instanceof Jt&&(t.at=this.at)}}pO(t){return this.Ka()&&t.eh.has(this)&&(0!==this.Tf.width||0!==this.Tf.height)&&(t.animationManager.isAnimating||t.currentTool!==t.toolManager)}makeGeometry(){const t=this.at,e=this.pointsCount;let i=!1;const n=this.diagram;null!==n&&this.pO(n)&&(i=!0);let s=0,o=0,r=this.getPoint(0).copy();const a=r.copy(),l=this.Pi.r,h=this.computeCurve();if(9===h&&e>=3&&!S.Y(this.smoothness,0))if(3===e){let t=this.getPoint(1);s=Math.min(r.x,t.x),o=Math.min(r.y,t.y),t=this.getPoint(2),s=Math.min(s,t.x),o=Math.min(o,t.y)}else if(this.isOrthogonal){for(let t=0;t<e;t++){const e=l[t];a.x=Math.min(e.x,a.x),a.y=Math.min(e.y,a.y)}s=a.x,o=a.y}else{for(let t=3;t<e;t+=3){t+3>=e&&(t=e-1);const i=this.getPoint(t);a.x=Math.min(i.x,a.x),a.y=Math.min(i.y,a.y)}s=a.x,o=a.y}else{for(let t=0;t<e;t++){const e=l[t];a.x=Math.min(e.x,a.x),a.y=Math.min(e.y,a.y)}s=a.x,o=a.y}if(s-=this.u1.x,o-=this.u1.y,r.x-=s,r.y-=o,2!==e||this.Ka()){t.type=4;const n=he.CC(t);if(0!==this.computeShortLength(!0)&&(r=this.Ff(r,!0,a)),n.gu(r.x,r.y,!1,!1),9===h&&e>=3&&!S.Y(this.smoothness,0))if(3===e){const t=this.getPoint(1),e=t.x-s,i=t.y-o;let r=this.getPoint(2).copy();r.x-=s,r.y-=o,0!==this.computeShortLength(!1)&&(r=this.Ff(r,!1,a)),n.pr(e,i,e,i,r.x,r.y)}else if(this.isOrthogonal){const t=y.X(s,o),e=y.l();e.a(this.getPoint(1));const i=y.X(s,o),r=y.X(s,o);let a=this.getPoint(0),l=null;const h=this.smoothness/3;for(let f=1;f<this.pointsCount-1;f++){l=this.getPoint(f);const u=a,c=l,d=this.getPoint(this.uN(l,f,!1));S.Y(u.x,c.x)&&S.Y(c.x,d.x)||S.Y(u.y,c.y)&&S.Y(c.y,d.y)||(this.yO(u,c,d,h,i,r),(1===f||2===f&&S.Y(a.x,this.getPoint(0).x)&&S.Y(a.y,this.getPoint(0).y))&&(e.x=.5*(a.x+l.x),e.y=.5*(a.y+l.y)),n.pr(e.x-s,e.y-o,i.x-s,i.y-o,l.x-s,l.y-o),t.set(i),e.set(r),a=l)}let u=a.x,c=a.y,d=this.getPoint(this.pointsCount-1);0!==this.computeShortLength(!1)&&(d=this.Ff(d.copy(),!1,y.Lo)),u=.5*(u+d.x),c=.5*(c+d.y),n.pr(r.x-s,r.y-o,u-s,c-o,d.x-s,d.y-o),y.e(t),y.e(e),y.e(i),y.e(r)}else for(let t=3;t<e;t+=3){const i=this.getPoint(t-2);t+3>=e&&(t=e-1);const r=this.getPoint(t-1);let a=this.getPoint(t);t===e-1&&0!==this.computeShortLength(!1)&&(a=this.Ff(a.copy(),!1,y.Lo)),n.pr(i.x-s,i.y-o,r.x-s,r.y-o,a.x-s,a.y-o)}else{const t=y.l();t.a(this.getPoint(0));const r=y.l();r.a(t);const a=this.computeCorner();let l=1,h=0;for(;l<e;){l=this.uN(t,l,l>1);let u=this.getPoint(l);if(l>=e-1){if(t.equals(u)){if(0===h)for(l=1;l<e;)r.a(t),u=this.getPoint(l++),this.An(n,-s,-o,t,u,i),t.a(u)}else 0!==this.computeShortLength(!1)&&(u=this.Ff(u.copy(),!1,y.Lo)),this.An(n,-s,-o,t,u,i);break}h=this.uN(u,l+1,l<e-3);const c=this.getPoint(h);this.wO(n,-s,-o,t,u,c,t,r,a,i),r.a(u),l=h}y.e(t)}return he.LC(n),this.Nh=!0,t}{let e=this.getPoint(1).copy();return e.x-=s,e.y-=o,0!==this.computeShortLength(!0)&&(r=this.Ff(r,!0,a)),0!==this.computeShortLength(!1)&&(e=this.Ff(e,!1,a)),t.type=1,t.startX=r.x,t.startY=r.y,t.endX=e.x,t.endY=e.y,this.Nh=!0,t}}k1(t,e,i,n){let s=i-t;if(isNaN(s)||s===1/0||s===-1/0)return NaN;s<0&&(s=-s);let o=n-e;return isNaN(o)||o===1/0||o===-1/0?NaN:(o<0&&(o=-o),S.Y(s,0)?o:S.Y(o,0)?s:Math.sqrt(s*s+o*o))}yO(t,e,i,n,s,o){isNaN(n)&&(n=this.smoothness/3);const r=t.x,a=t.y,l=e.x,h=e.y,u=i.x,c=i.y,d=n*this.k1(r,a,l,h),f=n*this.k1(l,h,u,c);if(S.Y(a,h)&&S.Y(l,u)&&(l>r?c>h?(s.x=l-d,s.y=h-d,o.x=l+f,o.y=h+f):(s.x=l-d,s.y=h+d,o.x=l+f,o.y=h-f):c>h?(s.x=l+d,s.y=h-d,o.x=l-f,o.y=h+f):(s.x=l+d,s.y=h+d,o.x=l-f,o.y=h-f)),S.Y(r,l)&&S.Y(h,c)&&(h>a?u>l?(s.x=l-d,s.y=h-d,o.x=l+f,o.y=h+f):(s.x=l+d,s.y=h-d,o.x=l-f,o.y=h+f):u>l?(s.x=l-d,s.y=h+d,o.x=l+f,o.y=h-f):(s.x=l+d,s.y=h+d,o.x=l-f,o.y=h-f)),S.Y(r,l)&&S.Y(l,u)||S.Y(a,h)&&S.Y(h,c)){const t=.5*(r+u),e=.5*(a+c);s.x=t,s.y=e,o.x=t,o.y=e}}Ff(t,e,i){const n=this.pointsCount;if(n<2)return t;if(e){const e=this.getPoint(1),s=e.x-i.x,o=e.y-i.y,r=this.k1(t.x,t.y,s,o);if(0===r)return t;const a=2===n?.5*r:r;let l=this.computeShortLength(!0);l>a&&(l=a);const h=l*(s-t.x)/r,u=l*(o-t.y)/r;t.x+=h,t.y+=u}else{const e=this.getPoint(n-2),s=e.x-i.x,o=e.y-i.y,r=this.k1(t.x,t.y,s,o);if(0===r)return t;const a=2===n?.5*r:r;let l=this.computeShortLength(!1);l>a&&(l=a);const h=l*(t.x-s)/r,u=l*(t.y-o)/r;t.x-=h,t.y-=u}return t}uN(t,e,i){const n=this.pointsCount;let s=t;for(;S.Y(t.x,s.x)&&S.Y(t.y,s.y);){if(e>=n)return n-1;s=this.getPoint(e++)}if(!S.Y(t.x,s.x)&&!S.Y(t.y,s.y))return e-1;let o=s;for(;S.Y(t.x,s.x)&&S.Y(s.x,o.x)&&(!i||(t.y>=s.y?s.y>=o.y:s.y<=o.y))||S.Y(t.y,s.y)&&S.Y(s.y,o.y)&&(!i||(t.x>=s.x?s.x>=o.x:s.x<=o.x));){if(e>=n)return n-1;o=this.getPoint(e++)}return e-2}wO(t,e,i,n,s,o,r,a,l,h){if(S.f(n.y,s.y)&&S.f(s.x,o.x)){let u=Math.min(l,Math.abs(s.x-a.x)/2);const c=Math.min(u,Math.abs(o.y-s.y)/2);if(u=c,S.f(u,0))return this.An(t,e,i,n,s,h),void r.a(s);let d=s.x;const f=s.y,g=d;let m=f;s.x>n.x?(d=s.x-u,m=o.y>s.y?s.y+c:s.y-c):(d=s.x+u,m=o.y>s.y?s.y+c:s.y-c);const p=y.X(d,f);this.An(t,e,i,n,p,h),y.e(p),t.Sw(s.x+e,s.y+i,g+e,m+i),r.i(g,m)}else if(S.f(n.x,s.x)&&S.f(s.y,o.y)){let u=Math.min(l,Math.abs(s.y-a.y)/2);const c=Math.min(u,Math.abs(o.x-s.x)/2);if(u=c,S.f(c,0))return this.An(t,e,i,n,s,h),void r.a(s);const d=s.x;let f=s.y,g=d;const m=f;s.y>n.y?(f=s.y-u,g=o.x>s.x?s.x+c:s.x-c):(f=s.y+u,g=o.x>s.x?s.x+c:s.x-c);const p=y.X(d,f);this.An(t,e,i,n,p,h),y.e(p),t.Sw(s.x+e,s.y+i,g+e,m+i),r.i(g,m)}else this.An(t,e,i,n,s,h),r.a(s)}computeJumpLength(){return 10}An(t,e,i,n,s,o){if(o||!this.Ka())t.mr(s.x+e,s.y+i);else{const o=this.computeJumpLength(),r=o/2,a=[];let l=0;this.isVisible()&&(l=this.xO(n,s,a));let h=n.x,u=n.y;if(l>0)if(S.f(n.y,s.y))if(n.x<s.x){let c=0;for(;c<l;){const d=Math.max(n.x,Math.min(a[c++]-r,s.x-o));t.mr(d+e,s.y+i),h=d+e,u=s.y+i;let f=Math.min(d+o,s.x);for(;c<l;){const t=a[c];if(!(t<f+o))break;c++,f=Math.min(t+r,s.x)}const g=s.y-o+i,m=f+e,p=s.y+i;10===this.curve?t.gu(m,p,!1,!1):t.pr(h,g,m,g,m,p),h=m,u=p}}else{let c=l-1;for(;c>=0;){const l=Math.min(n.x,Math.max(a[c--]+r,s.x+o));t.mr(l+e,s.y+i),h=l+e,u=s.y+i;let d=Math.max(l-o,s.x);for(;c>=0;){const t=a[c];if(!(t>d-o))break;c--,d=Math.max(t-r,s.x)}const f=s.y-o+i,g=d+e,m=s.y+i;10===this.curve?t.gu(g,m,!1,!1):t.pr(h,f,g,f,g,m),h=g,u=m}}else if(S.f(n.x,s.x))if(n.y<s.y){let c=0;for(;c<l;){const d=Math.max(n.y,Math.min(a[c++]-r,s.y-o));t.mr(s.x+e,d+i),h=s.x+e,u=d+i;let f=Math.min(d+o,s.y);for(;c<l;){const t=a[c];if(!(t<f+o))break;c++,f=Math.min(t+r,s.y)}const g=s.x-o+e,m=s.x+e,p=f+i;10===this.curve?t.gu(m,p,!1,!1):t.pr(g,u,g,p,m,p),h=m,u=p}}else{let c=l-1;for(;c>=0;){const l=Math.min(n.y,Math.max(a[c--]+r,s.y+o));t.mr(s.x+e,l+i),h=s.x+e,u=l+i;let d=Math.max(l-o,s.y);for(;c>=0;){const t=a[c];if(!(t>d-o))break;c--,d=Math.max(t-r,s.y)}const f=s.x-o+e,g=s.x+e,m=d+i;10===this.curve?t.gu(g,m,!1,!1):t.pr(f,u,f,m,g,m),h=g,u=m}}t.mr(s.x+e,s.y+i)}}xO(t,e,i){const n=this.diagram;if(null===n||t.equals(e))return 0;const s=n.layers;for(;s.next();){const n=s.value;if(null!==n&&n.visible){const s=n.zS(),o=s.length;for(let n=0;n<o;n++){const o=s[n];if(!(o instanceof ve))continue;if(o===this)return i.length>0&&i.sort(((t,e)=>t-e)),i.length;if(!o.isVisible()||!o.Ka())continue;const r=o.routeBounds;if(!r.isReal()||!this.routeBounds.intersectsRect(r)||this.usesSamePort(o))continue;const a=o.path;null!==a&&a.isVisibleObject()&&this.bO(t,e,i,o)}}}return i.length>0&&i.sort(((t,e)=>t-e)),i.length}bO(t,e,i,n){const s=S.f(t.y,e.y),o=n.pointsCount;let r=n.getPoint(0);const a=y.l();for(let l=1;l<o;l++){const h=n.getPoint(l);if(l<o-1){const t=n.getPoint(l+1);if(r.y===h.y&&h.y===t.y){if(h.x>r.x&&t.x>=h.x||h.x<r.x&&t.x<=h.x)continue}else if(r.x===h.x&&h.x===t.x&&(h.y>r.y&&t.y>=h.y||h.y<r.y&&t.y<=h.y))continue}this.kO(t,e,r,h,a)&&(s?i.push(a.x):i.push(a.y)),r=h}y.e(a)}kO(t,e,i,n,s){const o=t.x,r=t.y,a=e.x,l=e.y,h=i.x,u=i.y,c=n.x,d=n.y;if(S.f(o,a)){if(!S.f(r,l)&&S.f(u,d)&&Math.min(r,l)<u&&Math.max(r,l)>u&&Math.min(h,c)<o&&Math.max(h,c)>o&&!S.f(h,c))return s.x=o,s.y=u,!0}else if(S.f(r,l)&&S.f(h,c)&&Math.min(o,a)<h&&Math.max(o,a)>h&&Math.min(u,d)<r&&Math.max(u,d)>r&&!S.f(u,d))return s.x=h,s.y=r,!0;return s.x=0,s.y=0,!1}get firstPickIndex(){return this.pointsCount<=2?0:this.isOrthogonal||!this.Id(this.computeSpot(!0))?1:0}get lastPickIndex(){const t=this.pointsCount;return 0===t?0:t<=2?t-1:this.isOrthogonal||!this.Id(this.computeSpot(!1))?t-2:t-1}Ka(){const t=this.curve;return 11===t||10===t}m1(t){if(t||this.Ka()){const t=this.diagram;null!==t&&!t.animationManager.isTicking&&!t.eh.has(this)&&(0!==this.Tf.width||0!==this.Tf.height)&&t.eh.set(this,this.Tf.copy())}}invalidateOtherJumpOvers(t){const e=this.layer;if(null===e||!e.visible||e.isTemporary)return;const i=e.diagram;if(null===i||i.animationManager.isTicking)return;let n=!1;const s=i.layers;for(;s.next();){const i=s.value;if(i.visible)if(i===e){n=!0;let e=!1;const s=i.zS(),o=s.length;for(let i=0;i<o;i++){const n=s[i];n instanceof ve&&(n===this?e=!0:e&&this.wT(n,t))}}else if(n){const e=i.zS(),n=e.length;for(let i=0;i<n;i++){const n=e[i];n instanceof ve&&this.wT(n,t)}}}}wT(t,e){if(null===t||!t.Nh||!t.Ce||!t.Ka())return;const i=t.routeBounds;i.isReal()&&(!this.routeBounds.intersectsRect(i)&&!e.intersectsRect(i)||this.usesSamePort(t)||t.oe())}usesSamePort(t){const e=this.pointsCount,i=t.pointsCount;if(e>0&&i>0){const n=this.getPoint(0),s=t.getPoint(0);if(n.equalsApprox(s))return!0;const o=this.getPoint(e-1),r=t.getPoint(i-1);if(o.equalsApprox(r)||n.equalsApprox(r)||o.equalsApprox(s))return!0}else if(this.fromNode===t.fromNode||this.toNode===t.toNode||this.fromNode===t.toNode||this.toNode===t.fromNode)return!0;return!1}isVisible(){if(!super.isVisible())return!1;const t=this.containingGroup;let e=!0;const i=this.diagram;null!==i&&(e=i.isTreePathToChildren);const n=this.fromNode;if(null!==n){if(this.isTreeLink&&e&&!n.isTreeExpanded)return!1;if(n===t)return!0;let i=n;for(;null!==i;){if(i.labeledLink===this)return!0;i=i.containingGroup}const s=n.findVisibleNode();if(null===s||s===t)return!1}const s=this.toNode;if(null!==s){if(this.isTreeLink&&!e&&!s.isTreeExpanded)return!1;if(s===t)return!0;let i=s;for(;null!==i;){if(i.labeledLink===this)return!0;i=i.containingGroup}const n=s.findVisibleNode();if(null===n||n===t)return!1}return!0}Vi(t){if(super.Vi(t),t&&this.m1(!1),null!==this._o&&this._o.Ad(),null!==this.$s){const e=this.$s.iterator;for(;e.next();)e.value.Vi(t)}}get adjusting(){return this.Af}set adjusting(t){const e=this.Af;e!==t&&(this.Af=t,this.t("adjusting",e,t))}computeAdjusting(){return this.isAvoiding&&null!==this.diagram&&this.diagram.animationManager.defaultAnimation.isAnimating?17:this.Af}get corner(){return this.Fd}set corner(t){const e=this.Fd;e!==t&&(this.Fd=t,this.oe(),this.t("corner",e,t))}get curve(){return this.Rd}set curve(t){const e=this.Rd;e!==t&&(this.Rd=t,this.invalidateRoute(),this.oe(),this.m1(10===e||11===e||10===t||11===t),this.t("curve",e,t))}get curviness(){return this.vd}set curviness(t){const e=this.vd;e!==t&&(this.vd=t,this.invalidateRoute(),this.oe(),this.t("curviness",e,t))}get routing(){return this.Ua}set routing(t){const e=this.Ua;e!==t&&(this.Ua=t,this.isAvoiding&&null!==this.diagram&&(this.diagram.Gm=!0),this.Qo=null,this.invalidateRoute(),this.m1(ve.hN(e)||ve.hN(t)),this.t("routing",e,t))}get smoothness(){return this.Od}set smoothness(t){const e=this.Od;e!==t&&(this.Od=t,this.oe(),this.t("smoothness",e,t))}wy(){const t=this.fo;if(null===t)return;const e=this.go;if(null===e||!isNaN(this.curviness))return;const i=this.uo,n=this.mo;let s=null,o=null;const r=t.si.r,a=r.length;for(let l=0;l<a;l++){const a=r[l];(a.fo!==t||a.uo!==i||a.go!==e||a.mo!==n)&&(a.fo!==e||a.uo!==n||a.go!==t||a.mo!==i)||(null===o?o=a:(null===s&&(s=[],s.push(o)),s.push(a)))}if(null!==s){let o=t.aT(e,i,n);null===o&&(o=new we(t,i,e,n),t.lT(o),e.lT(o)),o.Zs=s;for(let t=0;t<s.length;t++){s[t]._o=o}o.Ad()}}yy(){const t=this._o;if(null!==t){if(!isNaN(this.curviness))return;this._o=null;const e=t.Zs.indexOf(this);e>=0&&(t.Zs.splice(e,1),t.Ad())}}Rl(){return!0}get key(){const t=this.diagram;if(null!==t&&t.model.Ba())return t.model.getKeyForLinkData(this.data)}}class we{Vo;zs;ly;tN;a1;iN;Zs;constructor(t,e,i,n){u.qi(this),this.Vo=!1,this.zs=!1,this.ly=t,this.tN=e,this.a1=i,this.iN=n,this.Zs=[]}Ad(){if(!this.Vo){const t=this.Zs;if(t.length>0){const e=t[0].diagram;null!==e&&(e.fM.add(this),this.zs=e.undoManager.isUndoingRedoing)}}this.Vo=!0}NM(){if(this.Vo){this.Vo=!1;const t=this.Zs;if(t.length>0){const e=t[0],i=e.diagram,n=null===i||i.Kh&&!this.zs;this.zs=!1,e.arrangeBundledLinks(t,n),1===t.length&&(e._o=null,t.length=0)}0===t.length&&(this.ly.hT(this),this.a1.hT(this))}}}class ke{he;ae;Ga;Ha;pi;yi;Ot;Ch;Lh;pa;UM;Vo;by;Jc;VM;zM;constructor(t){u.qi(this),this.pa=null,this.UM=null,this.Vo=!0,this.by=!1,this.he=1,this.ae=1,this.Ga=-1,this.Ha=-1,this.pi=t.width,this.yi=t.height,this.Ot=[],this.Ch=0,this.Lh=0,this.Jc=11,this.VM=2*this.Jc,this.zM=2*this.Jc}static Qs=0;static ja=1;static Bd=999999;static dN=(()=>ke.Bd+1)();static gN=(()=>ke.Bd+2)();bb(t){if(t.width<=0||t.height<=0)return;const e=t.x,i=t.y,n=t.x+t.width,s=t.y+t.height;this.he=Math.floor((e-this.pi)/this.pi)*this.pi,this.ae=Math.floor((i-this.yi)/this.yi)*this.yi,this.Ga=Math.ceil((n+2*this.pi)/this.pi)*this.pi,this.Ha=Math.ceil((s+2*this.yi)/this.yi)*this.yi;const o=1+(0|Math.ceil((this.Ga-this.he)/this.pi)),r=1+(0|Math.ceil((this.Ha-this.ae)/this.yi));if(null===this.Ot||this.Ch<o-1||this.Lh<r-1){const t=[];for(let e=0;e<=o;e++)t[e]=new Uint32Array(r);this.Ot=t,this.Ch=o-1,this.Lh=r-1}this.PO(ke.dN)}get bounds(){return new b(this.he,this.ae,this.Ga-this.he,this.Ha-this.ae)}get cellWidth(){return this.pi}set cellWidth(t){t>0&&t!==this.pi&&(this.pi=t,this.bb(this.bounds))}get cellHeight(){return this.yi}set cellHeight(t){t>0&&t!==this.yi&&(this.yi=t,this.bb(this.bounds))}Ud(t,e){return this.he<=t&&t<=this.Ga&&this.ae<=e&&e<=this.Ha}po(t,e){if(!this.Ud(t,e))return ke.dN;t-=this.he,t/=this.pi,e-=this.ae;const i=0|t,n=0|(e/=this.yi);return this.Ot[i][n]}RR(t,e,i,n){if(!this.Ud(t,e))return;const s=(t-this.he)/this.pi|0,o=(e-this.ae)/this.yi|0,r=(t+i-this.he)/this.pi|0,a=(e+n-this.ae)/this.yi|0,l=Math.min(r,this.Ch),h=Math.min(a,this.Lh);for(let u=s;u<=l;u++){const t=this.Ot[u];if(t.fill)t.fill(ke.Qs,o,h+1);else for(let e=o;e<=h;e++)t[e]=ke.Qs}}PO(t){if(null!==this.Ot)for(let e=0;e<=this.Ch;e++){const i=this.Ot[e];if(i.fill)i.fill(t);else for(let e=0;e<=this.Lh;e++)i[e]=t}}tA(){if(null!==this.Ot)for(let t=0;t<=this.Ch;t++){const e=this.Ot[t];for(let t=0;t<=this.Lh;t++)e[t]>=ke.ja&&(e[t]=ke.dN)}}SO(t,e){return this.po(t,e)===ke.Qs}isUnoccupied(t,e,i,n){if(t>this.Ga||t+i<this.he||e>this.Ha||e+n<this.ae)return!0;let s=(t-this.he)/this.pi|0,o=(e-this.ae)/this.yi|0,r=Math.max(0,i)/this.pi+1|0,a=Math.max(0,n)/this.yi+1|0;if(s<0&&(r+=s,s=0),o<0&&(a+=o,o=0),r<0||a<0)return!0;const l=0|Math.min(s+r-1,this.Ch),h=0|Math.min(o+a-1,this.Lh);for(let u=s;u<=l;u++){const t=this.Ot[u];for(let e=o;e<=h;e++)if(t[e]===ke.Qs)return!1}return!0}maxAvoidsLinksSpaceH(t,e,i,n){if(t>this.Ga||e<this.he||i>this.Ha||i<this.ae)return 0;const s=(t-this.he)/this.pi|0,o=(e-this.he)/this.pi|0,r=(i-this.ae)/this.yi|0,a=n/this.yi+1|0;let l;for(l=0;l<a/2;l++){let t=!1;for(let e=s;e<=o;e++)if(this.Ot[e][r+l]===ke.Qs||this.Ot[e][r-l]===ke.Qs){t=!0;break}if(t)return Math.max(0,(2*l-1)*this.yi)}return n}maxAvoidsLinksSpaceV(t,e,i,n){if(t>this.Ha||e<this.ae||i>this.Ga||i<this.he)return 0;const s=(t-this.ae)/this.yi|0,o=(e-this.ae)/this.yi|0,r=(i-this.he)/this.pi|0,a=n/this.pi+1|0;let l;for(l=0;l<a/2;l++){let t=!1;for(let e=s;e<=o;e++)if(this.Ot[r+l][e]===ke.Qs||this.Ot[r-l][e]===ke.Qs){t=!0;break}if(t)return Math.max(0,(2*l-1)*this.pi)}return n}MO(t,e,i,n,s,o,r,a){t|=0,e|=0;let l=this.Ot[t][e];if(l>=ke.ja&&l<ke.Bd)for(n?e+=i:t+=i,l+=1;s<=t&&t<=o&&r<=e&&e<=a;){if(l>=this.Ot[t][e])break;this.Ot[t][e]=l,l+=1,n?e+=i:t+=i}return n?e:t}yo(t,e,i,n,s,o,r,a){if(t<s||t>o||e<r||e>a)return;const l=this.MO(t,e,i,n,s,o,r,a);if(n)if(i>0)for(let h=e+i;h<l;h+=i)this.yo(t,h,1,!n,s,o,r,a),this.yo(t,h,-1,!n,s,o,r,a);else for(let h=e+i;h>l;h+=i)this.yo(t,h,1,!n,s,o,r,a),this.yo(t,h,-1,!n,s,o,r,a);else if(i>0)for(let h=t+i;h<l;h+=i)this.yo(h,e,1,!n,s,o,r,a),this.yo(h,e,-1,!n,s,o,r,a);else for(let h=t+i;h>l;h+=i)this.yo(h,e,1,!n,s,o,r,a),this.yo(h,e,-1,!n,s,o,r,a)}P1(t,e,i,n,s,o,r,a,l,h){let u=0|t,c=0|e,d=ke.Qs,f=ke.ja;for(this.Ot[u][c]=f;d===ke.Qs&&u>r&&u<a&&c>l&&c<h;)f+=1,this.Ot[u][c]=f,o?c+=s:u+=s,d=this.Ot[u][c];return o?c:u}S1(t,e,i,n,s,o,r,a,l,h){let u=0|i,c=0|n,d=ke.Qs;const f=ke.Bd;for(this.Ot[u][c]=f;d===ke.Qs&&u>r&&u<a&&c>l&&c<h;)this.Ot[u][c]=f,o?c+=s:u+=s,d=this.Ot[u][c]}xT(t,i,n,s,o,r){if(null===this.Ot)return;this.by=!1;let a=t.x,l=t.y;if(!this.Ud(a,l))return;a-=this.he,a/=this.pi,l-=this.ae,l/=this.yi;let h=n.x,u=n.y;if(!this.Ud(h,u))return;if(h-=this.he,h/=this.pi,u-=this.ae,u/=this.yi,Math.abs(a-h)<=1&&Math.abs(l-u)<=1)return void(this.by=!0);let c=o.x,d=o.y,f=o.x+o.width,g=o.y+o.height;c-=this.he,c/=this.pi,d-=this.ae,d/=this.yi,f-=this.he,f/=this.pi,g-=this.ae,g/=this.yi;const m=Math.max(0,Math.min(this.Ch,0|c)),p=Math.min(this.Ch,Math.max(0,0|f)),y=Math.max(0,Math.min(this.Lh,0|d)),x=Math.min(this.Lh,Math.max(0,0|g)),b=90,v=270,w=this.Ot,k=0|a,S=0|l,P=0|h,M=0|u,C=0===i||i===b?1:-1,N=i===b||i===v;w[k][S]===ke.Qs?(this.P1(k,S,P,M,C,N,m,p,y,x),this.P1(k,S,P,M,1,!N,m,p,y,x),this.P1(k,S,P,M,-1,!N,m,p,y,x)):this.P1(k,S,P,M,C,N,k,S,k,S),w[P][M]===ke.Qs?(this.S1(k,S,P,M,0===s||s===b?1:-1,s===b||s===v,m,p,y,x),this.S1(k,S,P,M,1,!(s===b||s===v),m,p,y,x),this.S1(k,S,P,M,-1,!(s===b||s===v),m,p,y,x)):this.S1(k,S,P,M,C,N,P,M,P,M);const T=e.rt();if(r&&this.bT(P,M,s,k,S,T)){(T[0]!==P||T[1]!==M)&&(T.unshift(M),T.unshift(P)),(T[T.length-2]!==k||T[T.length-1]!==S)&&(T.push(k),T.push(S));let t=ke.ja,e=T[T.length-2],i=T[T.length-1];w[e][i]=t++;for(let n=T.length-4;n>=0;n-=2){e=T[n+2],i=T[n+3];const s=T[n],o=T[n+1];for(;s>e?e++:s<e?e--:o>i?i++:o<i&&i--,w[e][i]=t++,e!==s||i!==o;);}}else this.yo(k,S,1,!1,m,p,y,x),this.yo(k,S,-1,!1,m,p,y,x),this.yo(k,S,1,!0,m,p,y,x),this.yo(k,S,-1,!0,m,p,y,x);e.tt(T)}bT(t,e,i,n,s,o){const r=this.Ot;let a=t,l=e;for(;;){if(a===n&&l===s)return!0;let t=a,e=l;if(0===i){if(!(t<n))break;t++}else if(90===i){if(!(e<s))break;e++}else if(180===i){if(!(t>n))break;t--}else{if(!(e>s))break;e--}const o=r[t][e];if(0===o||o===ke.gN)break;a=t,l=e}for(;;){let h=i,u=a,c=l;0===i?c<s?(h=90,c++):c>s&&(h=270,c--):90===i?u<n?(h=0,u++):u>n&&(h=180,u--):180===i?c<s?(h=90,c++):c>s&&(h=270,c--):u<n?(h=0,u++):u>n&&(h=180,u--);const d=r[u][c];if(h!==i&&0!==d&&d!==ke.gN){if(o.push(a),o.push(l),this.bT(a,l,h,n,s,o))return!0;o.pop(),o.pop()}if(r[a][l]=ke.gN,0===i){if(a===t)return!1;a--}else if(90===i){if(l===e)return!1;l--}else if(180===i){if(a===t)return!1;a++}else{if(l===e)return!1;l++}}}}class Se{Le;pl;hs;Vd;constructor(t,e){u.qi(this),this.Le=t,this.pl=e,this.hs=[],this.Vd=!1}toString(){const t=this.hs;let e=this.Le.toString()+" "+t.length.toString()+":";for(let i=0;i<t.length;i++){const n=t[i];null!==n&&(e+="\n  "+n.toString())}return e}NO(t,e,i,n){const s=e.offsetY;switch(s){case 8:return 90;case 2:return 180;case 1:return 270;case 4:return 0}let o=i;switch(s){case 9:return o>180?270:90;case 6:return o>90&&o<=270?180:0}const r=180*Math.atan2(t.height,t.width)/Math.PI;switch(s){case 3:return o>r&&o<=180+r?180:270;case 5:return o>180-r&&o<=360-r?270:0;case 12:return o>r&&o<=180+r?90:0;case 10:return o>180-r&&o<=360-r?180:90;case 7:return o>90&&o<=180+r?180:o>180+r&&o<=360-r?270:0;case 13:return o>180&&o<=360-r?270:o>r&&o<=180?90:0;case 14:return o>r&&o<=180-r?90:o>180-r&&o<=270?180:0;case 11:return o>180-r&&o<=180+r?180:o>180+r?270:90}return n&&15!==s&&(o-=15,o<0&&(o+=360)),o>r&&o<180-r?90:o>=180-r&&o<=180+r?180:o>180+r&&o<360-r?270:0}Ad(){this.hs.length=0}yT(t){let e=this.hs;0===e.length&&(this.CO(),e=this.hs);for(let i=0;i<e.length;i++){const n=e[i];if(null!==n&&n.qe===t)return n}return null}CO(){if(!this.Vd){const t=this.Vd;this.Vd=!0;let e,i=null;const n=this.Le,s=n instanceof Ne?n:null;if(null===s||s.isSubGraphExpanded)e=n.isTreeExpanded?n.findLinksConnected(this.pl.portId):n.findExternalTreeLinksConnected();else{if(!s.actualBounds.isReal())return this.Vd=t,this.hs;i=s,e=i.findExternalLinksConnected()}this.hs.length=0;let o=0;const r=this.pl.getDocumentPoint(w.TopLeft,y.l()),a=this.pl.getDocumentPoint(w.BottomRight,y.l()),l=b.X(r.x,r.y,0,0);l.unionPoint(a),y.e(r),y.e(a);const h=y.X(l.x+l.width/2,l.y+l.height/2),u=this.pl.getDocumentAngle(),c=e.iterator;for(;c.next();){const t=c.value;if(!t.isVisible()||t.fromPort===t.toPort)continue;const e=t.fromPort===this.pl||null!==t.fromNode&&null!==i&&t.fromNode.isMemberOf(i),n=t.computeSpot(e,this.pl);if(!n.isSide())continue;let s;if(s=e?t.toPort:t.fromPort,null===s)continue;let r=s.part;if(null===r)continue;const a=r.findVisibleNode();null!==a&&a!==r&&(r=a,s=r.port);const d=t.computeOtherPoint(r,s);let f=h.directionPoint(d);f-=u,f<0?f+=360:f>=360&&(f-=360);const g=this.NO(l,n,f,t.isOrthogonal);let m=0;0===g?(m=4,f>180&&(f-=360)):90===g?(m=8,f>270&&(f-=360)):180===g?m=2:(m=1,f<90&&(f+=360));let p=this.hs[o];void 0===p?(p=new Pe(t,f,m),this.hs[o]=p):(p.qe=t,p.Ht=f,p.we=m),p.M1.set(d),o++}y.e(h),this.LO();const d=this.hs.length;let f=-1,g=0;for(o=0;o<d;o++){const t=this.hs[o];void 0!==t&&(t.we!==f&&(f=t.we,g=0),t.zd=g,g++)}for(f=-1,g=0,o=d-1;o>=0;o--){const t=this.hs[o];void 0!==t&&(t.we!==f&&(f=t.we,g=t.zd+1),t.Df=g)}this.AO(this.hs),this.TO(this.hs),this.Vd=t,b.e(l)}return this.hs}DO(t,e){return t===e?0:null===t?-1:null===e?1:t.we<e.we?-1:t.we>e.we?1:t.Ht<e.Ht?-1:t.Ht>e.Ht?1:0}LO(){this.hs.sort(Se.prototype.DO)}AO(t){const e=this.pl,i=this.Le.portSpreading,n=y.l(),s=y.l(),o=y.l(),r=y.l();e.getDocumentPoint(w.TopLeft,n),e.getDocumentPoint(w.TopRight,s),e.getDocumentPoint(w.BottomRight,o),e.getDocumentPoint(w.BottomLeft,r);let a=0,l=0,h=0,u=0;if(2===i)for(let y=0;y<t.length;y++){const e=t[y];if(null===e)continue;const i=e.qe.computeThickness();switch(e.we){case 8:h+=i;break;case 2:u+=i;break;case 1:a+=i;break;default:l+=i}}let c=0,d=0,f=1,g=s,m=o,p=0,x=0;for(let y=0;y<t.length;y++){const e=t[y];if(null===e)continue;if(c!==e.we){switch(c=e.we,c){case 8:g=o,m=r;break;case 2:g=r,m=n;break;case 1:g=n,m=s;break;default:g=s,m=o}switch(p=m.x-g.x,x=m.y-g.y,c){case 8:h>Math.abs(p)?(f=Math.abs(p)/h,h=Math.abs(p)):f=1;break;case 2:u>Math.abs(x)?(f=Math.abs(x)/u,u=Math.abs(x)):f=1;break;case 1:a>Math.abs(p)?(f=Math.abs(p)/a,a=Math.abs(p)):f=1;break;default:l>Math.abs(x)?(f=Math.abs(x)/l,l=Math.abs(x)):f=1}d=0}const b=e.Ed;if(2===i){let t=e.qe.computeThickness();switch(t*=f,b.set(g),c){case 8:b.x=g.x+p/2+h/2-d-t/2;break;case 2:b.y=g.y+x/2+u/2-d-t/2;break;case 1:b.x=g.x+p/2-a/2+d+t/2;break;default:b.y=g.y+x/2-l/2+d+t/2}d+=t}else{let t=.5;1===i&&(t=(e.zd+1)/(e.Df+1)),b.x=g.x+p*t,b.y=g.y+x*t}}y.e(n),y.e(s),y.e(o),y.e(r)}TO(t){for(let e=0;e<t.length;e++){const i=t[e];null!==i&&(i.b1=this.FO(i))}}FO(t){const e=t.qe,i=e.fromPort===this.pl,n=e.computeEndSegmentLength(this.Le,this.pl,w.None,i);let s=t.zd;if(s<0)return n;const o=t.Df;if(o<=1||!e.isOrthogonal)return n;const r=t.M1,a=t.Ed;(2===t.we||8===t.we)&&(s=o-1-s);const l=ve.iO,h=2===t.we||4===t.we;return(h?r.y<a.y:r.x<a.x)?n+s*l:(h?r.y===a.y:r.x===a.x)?n:n+(o-1-s)*l}}class Pe{qe;Ht;we;M1;zd;Df;Ed;b1;constructor(t,e,i){this.qe=t,this.Ht=e,this.we=i,this.M1=new y,this.zd=0,this.Df=0,this.Ed=new y,this.b1=0}toString(){return this.qe.toString()+" "+this.Ht.toString()+" "+this.we.toString()+":"+this.zd.toString()+"/"+this.Df.toString()+" "+this.Ed.toString()+" "+this.b1.toString()+" "+this.M1.toString()}}class Me{xa;ba;ka;Pa;Sa;Ma;U0;E0;V0;B0;constructor(){this.xa=w.Default,this.ba=w.Default,this.ka=NaN,this.Pa=NaN,this.Sa=NaN,this.Ma=NaN,this.U0=null,this.E0=null,this.V0=1/0,this.B0=1/0}copy(){const t=new Me;return t.xa=this.xa.N(),t.ba=this.ba.N(),t.ka=this.ka,t.Pa=this.Pa,t.Sa=this.Sa,t.Ma=this.Ma,t.U0=this.U0,t.E0=this.E0,t.V0=this.V0,t.B0=this.B0,t}}class Ce{T0;D0;F0;A0;bp;kp;constructor(){this.T0=-1/0,this.D0=0,this.F0=y.Lo,this.A0=0,this.bp="None",this.kp="None"}copy(){const t=new Ce;return t.T0=this.T0,t.D0=this.D0,t.F0=this.F0.N(),t.A0=this.A0,t.bp=this.bp,t.kp=this.kp,t}}class Ne extends me{Xd;It;ga;u0;ri;ne;constructor(t,e){let i;void 0===t||t instanceof Gt||"string"==typeof t?i=t:t&&(e=t),super(i),this.E=4608|this.E,this.Xd=new u,this.It=null,this.ne=new Le,this.ne.group=this,this.ga=new u,this.u0=null,this.ri=null,e&&Object.assign(this,e)}cloneProtected(t){super.cloneProtected(t),this.E=-32769&this.E;const e=t.findInVisualTree((t=>t instanceof Te));t.It=e instanceof Te?e:null,null!==this.ne?(t.ne=this.ne.copy(),t.ne.group=t):(null!==t.ne&&(t.ne.group=null),t.ne=null),null!==this.ri&&(t.ri=this.ri.copy())}Xo(t){super.Xo(t);const e=t.findSubGraphParts(),i=t.memberParts;for(;i.next();){const t=i.value;if(t.c(),t.invalidateLayout(8),t.clearAdornments(),t instanceof me)t.invalidateConnectedLinks(e);else if(t instanceof ve){const i=t.labelNodes;for(;i.next();)i.value.invalidateConnectedLinks(e)}}}_c(t,i,n,s,o,r,a){if(3===t&&"elements"===i){if(o instanceof Te)null===this.It?this.It=o:this.It!==o&&e.o("Cannot insert a second Placeholder into the visual tree of a Group.");else if(o instanceof Yt){const t=o.findInVisualTree((t=>t instanceof Te));t instanceof Te&&(null===this.It?this.It=t:this.It!==t&&e.o("Cannot insert a second Placeholder into the visual tree of a Group."))}}else 4===t&&"elements"===i&&null!==this.It&&(s===this.It||s instanceof Yt&&this.It.isContainedBy(s))&&(this.It=null);super._c(t,i,n,s,o,r,a)}td(t,e){if(super.td(t,e),this.isClipping&&this.type!==Yt.Spot&&this.isSubGraphExpanded){let t=this.resizeObject;t instanceof Yt&&(t=t.findMainElement()),null===this.ri&&(this.ri=new b),t.getDocumentBounds(this.ri),t instanceof Jt&&this.ri.inflate(-t.strokeWidth,-t.strokeWidth)}}ph(t,e,i,n){this.hasPlaceholder()&&(this.Zo=this.placeholder),super.ph(t,e,i,n)}ensureBounds(){this.isSubGraphExpanded&&this.memberParts.each((t=>{t.ensureBounds()})),super.ensureBounds()}Jr(){if(!super.Jr())return!1;const t=this.memberParts;for(;t.next();){const e=t.value;if(e instanceof me){if(!e.isVisible())continue;if(e.es())return!1}else if(e instanceof ve){if(!e.isVisible())continue;if(e.es()&&e.fromNode!==this&&e.toNode!==this)return!1}}return!0}hasPlaceholder(){return null!==this.It&&this.It.isVisibleObject()&&this.isSubGraphExpanded}get placeholder(){return this.It}get computesBoundsAfterDrag(){return 0!==(2048&this.E)}set computesBoundsAfterDrag(t){const e=0!==(2048&this.E);e!==t&&(this.E=2048^this.E,this.t("computesBoundsAfterDrag",e,t))}get computesBoundsIncludingLinks(){return 0!==(4096&this.E)}set computesBoundsIncludingLinks(t){const e=0!==(4096&this.E);e!==t&&(this.E=4096^this.E,this.t("computesBoundsIncludingLinks",e,t))}get computesBoundsIncludingLocation(){return 0!==(8192&this.E)}set computesBoundsIncludingLocation(t){const e=0!==(8192&this.E);e!==t&&(this.E=8192^this.E,this.t("computesBoundsIncludingLocation",e,t))}get handlesDragDropForMembers(){return 0!==(16384&this.E)}set handlesDragDropForMembers(t){const e=0!==(16384&this.E);e!==t&&(this.E=16384^this.E,this.t("handlesDragDropForMembers",e,t))}get avoidableMembers(){return 0!==(131072&this.E)}set avoidableMembers(t){const e=0!==(131072&this.E);e!==t&&(this.E=131072^this.E,this.t("avoidableMembers",e,t))}get memberParts(){return this.Xd.iterator}$2(t){if(this.Xd.add(t)){t instanceof Ne&&this.ga.add(t);const e=this.memberAdded;if(null!==e){let i=!0;const n=this.diagram;null!==n&&(i=n.K,n.K=!0),e(this,t),null!==n&&(n.K=i)}(!this.isVisible()||!this.isSubGraphExpanded)&&t.Vi(!1)}if(t instanceof ve&&!this.computesBoundsIncludingLinks)return;let e=this.It;null===e&&(e=this),e.c()}J2(t){if(this.Xd.delete(t)){t instanceof Ne&&this.ga.delete(t);const e=this.memberRemoved;if(null!==e){let i=!0;const n=this.diagram;null!==n&&(i=n.K,n.K=!0),e(this,t),null!==n&&(n.K=i)}(!this.isVisible()||!this.isSubGraphExpanded)&&t.Vi(!0)}if(t instanceof ve&&!this.computesBoundsIncludingLinks)return;let e=this.It;null===e&&(e=this),e.c()}qc(){if(this.Xd.count>0){const t=this.diagram;if(null!==t){const e=this.Xd.copy().iterator;for(;e.next();){const i=e.value;t.remove(i)}}}super.qc()}get layout(){return this.ne}set layout(t){const i=this.ne;if(i!==t){null!==t&&null!==t.diagram&&t.diagram.layout===t&&e.o("A layout cannot be both the Diagram.layout and a Group.layout: "+t),null!==i&&(i.diagram=null,i.group=null),this.ne=t;const n=this.diagram;null!==t&&(t.diagram=n,t.group=this),null!==n&&(n.jr=!0),this.t("layout",i,t),null!==n&&n.requestUpdate()}}get memberAdded(){return null!==this.Et?this.Et.gy:null}set memberAdded(t){const i=this.memberAdded;i!==t&&(null!==t&&e.S(t,Ne,"memberAdded"),this.gl().gy=t,this.t("memberAdded",i,t))}get memberRemoved(){return null!==this.Et?this.Et.my:null}set memberRemoved(t){const i=this.memberRemoved;i!==t&&(null!==t&&e.S(t,Ne,"memberRemoved"),this.gl().my=t,this.t("memberRemoved",i,t))}get memberValidation(){return null!==this.Et?this.Et.ah:null}set memberValidation(t){const i=this.memberValidation;i!==t&&(null!==t&&e.S(t,Ne,"memberValidation"),this.gl().ah=t,this.t("memberValidation",i,t))}canAddMembers(t){const e=this.diagram;if(null===e)return!1;const i=e.commandHandler,n=i.h2(t).iterator;for(;n.next();){const t=n.value;if(!i.isValidMember(this,t))return!1}return!0}addMembers(t,e){const i=this.diagram;if(null===i)return!1;const n=i.commandHandler;let s=!0;const o=n.h2(t).iterator;for(;o.next();){const t=o.value;!e||n.isValidMember(this,t)?t.containingGroup=this:s=!1}return s}get ungroupable(){return 0!==(256&this.E)}set ungroupable(t){const e=0!==(256&this.E);e!==t&&(this.E=256^this.E,this.t("ungroupable",e,t))}canUngroup(){if(!this.ungroupable)return!1;const t=this.layer;if(null===t||!t.allowUngroup)return!1;const e=t.diagram;return!(null!==e&&!e.allowUngroup)}invalidateConnectedLinks(t){const e=this.RO();if(super.invalidateConnectedLinks(t),e)return;this.IL(!0);const i=this.findExternalLinksConnected();for(;i.next();){const e=i.value;if(void 0!==t&&t.has(e))continue;const n=e.fromNode;if(null!==n&&n!==this&&n.isMemberOf(this)&&!n.isVisible())n.$i(e.fromPort),n.$i(e.toPort),e.invalidateRoute();else{const t=e.toNode;null!==t&&t!==this&&t.isMemberOf(this)&&!t.isVisible()&&(t.$i(e.fromPort),t.$i(e.toPort),e.invalidateRoute())}}}findExternalLinksConnected(){const t=null!==this.diagram&&this.diagram.yM;if(t&&null!==this.u0)return this.u0.iterator;const e=this.findSubGraphParts();e.add(this);const i=new u,n=e.iterator;for(;n.next();){const t=n.value;if(!(t instanceof me))continue;const s=t.linksConnected;for(;s.next();){const t=s.value;e.has(t)||i.add(t)}}return t&&(this.u0=i),i.iterator}findExternalNodesConnected(){const t=this.findSubGraphParts();t.add(this);const e=new u,i=t.iterator;for(;i.next();){const n=i.value;if(!(n instanceof me))continue;const s=n.linksConnected;for(;s.next();){const i=s.value,n=i.fromNode;null!==n&&(!t.has(n)||n===this)&&e.add(n);const o=i.toNode;null!==o&&(!t.has(o)||o===this)&&e.add(o)}}return e.iterator}CE(){const t=new u;return function t(e,i){null!==e&&(i.add(e),t(e.containingGroup,i))}(this,t),t}findSubGraphParts(){const t=new u;return ce.ch(t,this,!0,0,!0),t.delete(this),t}Vi(t){super.Vi(t);const e=this.memberParts;for(;e.next();)e.value.Vi(t)}collapseSubGraph(){const t=this.diagram;if(null===t||t.isCollapsingExpanding)return;t.isCollapsingExpanding=!0;const e=this.findSubGraphParts();this.kT(e,t,this),t.isCollapsingExpanding=!1}kT(t,e,i){const n=this.memberParts;for(;n.next();){const s=n.value;if(s.Vi(!1),s instanceof Ne&&s.isSubGraphExpanded&&(s.wasSubGraphExpanded=s.isSubGraphExpanded,s.kT(t,e,i)),s instanceof me)s.invalidateConnectedLinks(t),e.vc(s,i);else if(s instanceof ve){const e=s.labelNodes;for(;e.next();)e.value.invalidateConnectedLinks(t)}}this.isSubGraphExpanded=!1}expandSubGraph(){const t=this.diagram;if(null===t||t.isCollapsingExpanding)return;t.isCollapsingExpanding=!0;const e=this.findSubGraphParts();this.PT(e,t,this),t.isCollapsingExpanding=!1}PT(t,e,i){const n=this.memberParts;for(;n.next();){const s=n.value;if(s.Vi(!0),s instanceof Ne&&s.wasSubGraphExpanded&&(s.wasSubGraphExpanded=!1,s.PT(t,e,i)),s instanceof me)s.invalidateConnectedLinks(t);else if(s instanceof ve){const e=s.labelNodes;for(;e.next();)e.value.invalidateConnectedLinks(t)}}this.isSubGraphExpanded=!0}get isSubGraphExpanded(){return 0!==(512&this.E)}set isSubGraphExpanded(t){const e=0!==(512&this.E);if(e!==t){this.E=512^this.E;const i=this.diagram;this.t("isSubGraphExpanded",e,t);const n=this.subGraphExpandedChanged;if(null!==n){let t=!0;null!==i&&(t=i.K,i.K=!0),n(this),null!==i&&(i.K=t)}if(null!==i&&i.undoManager.isUndoingRedoing)return null!==this.It&&this.It.c(),void this.memberParts.each((t=>t.updateAdornments()));t?this.expandSubGraph():this.collapseSubGraph()}}get wasSubGraphExpanded(){return 0!==(1024&this.E)}set wasSubGraphExpanded(t){const e=0!==(1024&this.E);e!==t&&(this.E=1024^this.E,this.t("wasSubGraphExpanded",e,t))}get subGraphExpandedChanged(){return null!==this.Et?this.Et.py:null}set subGraphExpandedChanged(t){const i=this.subGraphExpandedChanged;i!==t&&(null!==t&&e.S(t,Ne,"subGraphExpandedChanged"),this.gl().py=t,this.t("subGraphExpandedChanged",i,t))}move(t,e){void 0===e&&(e=!1);const i=e?this.location:this.position,n=i.x,s=i.y,o=t.x,r=t.y;if((n===o||isNaN(n)&&isNaN(o))&&(s===r||isNaN(s)&&isNaN(r)))return;const a=o-(isNaN(n)?0:n),l=r-(isNaN(s)?0:s),h=y.l();super.move(t,e);const c=new u,d=this.findSubGraphParts().iterator;for(;d.next();){const t=d.value;t instanceof ve&&(t.suspendsRouting&&c.add(t),(t.Ce||t.fromNode!==this&&t.toNode!==this)&&(t.suspendsRouting=!0))}for(d.reset();d.next();){const t=d.value;if(t.Rl()||t instanceof me&&t.isLinkLabel)continue;const e=t.position,i=t.location;e.isReal()?(h.x=e.x+a,h.y=e.y+l,t.position=h):i.isReal()&&(h.x=i.x+a,h.y=i.y+l,t.location=h)}for(d.reset();d.next();){const t=d.value;if(!(t instanceof ve)||(t.suspendsRouting=c.has(t),!t.Ce&&(t.fromNode===this||t.toNode===this)))continue;const e=t.position;h.x=e.x+a,h.y=e.y+l,h.isReal()?t.move(h):t.invalidateRoute()}y.e(h)}RO(){return 0!==(65536&this.E)}IL(t){0!==(65536&this.E)!==t&&(this.E=65536^this.E)}get ma(){return 0!==(32768&this.E)}set ma(t){0!==(32768&this.E)!==t&&(this.E=32768^this.E)}}class Te extends At{ti;Yd;constructor(t){super(),this.ti=v.Bg,this.Yd=new b(NaN,NaN,NaN,NaN),t&&Object.assign(this,t)}cloneProtected(t){super.cloneProtected(t),t.ti=this.ti.N(),t.Yd=this.Yd.copy()}mh(t){if(null===this.background)return!1;const e=this.naturalBounds;return b.contains(0,0,e.width,e.height,t.x,t.y)}_u(t,i,n,s){const o=this.part;if((null===o||!(o instanceof Ne)&&!(o instanceof fe))&&e.o("Placeholder is not inside a Group or Adornment."),o instanceof Ne){const t=this.computeBorder(this.Yd),e=this.minSize,i=isFinite(e.width)?Math.max(e.width,t.width):t.width,n=isFinite(e.height)?Math.max(e.height,t.height):t.height,s=this.Ki;s.zn(i||0,n||0),this.so(0,0,s.width,s.height);const r=o.memberParts;let a=!1;for(;r.next();)if(r.value.isVisible()){a=!0;break}const l=o.diagram;if(a&&null!==l&&!l.animationManager.DS(o)&&!isNaN(t.x)&&!isNaN(t.y)){const e=y.l();e.setRectSpot(t,o.locationSpot),o.location=e,y.e(e)}}else{const t=o,e=this.Ki,i=this.ti,n=i.left+i.right,s=i.top+i.bottom,r=t.adornedObject,a=r.getDocumentAngle();t.angle=a;let l=0;r instanceof Jt&&(l=r.strokeWidth);const h=r.getDocumentScale(),u=r.naturalBounds,c=(u.width+l)*h,d=(u.height+l)*h;if(t.type!==Yt.Link){const e="Selection"===t.category?w.TopLeft:t.locationSpot,i=r.getDocumentPoint(e,y.l());t.location=i,y.e(i)}if(isNaN(c)||isNaN(d)){const t=r.getDocumentPoint(w.TopLeft,y.l()),o=b.X(t.x,t.y,0,0);o.unionPoint(r.getDocumentPoint(w.BottomRight,t)),o.unionPoint(r.getDocumentPoint(w.TopRight,t)),o.unionPoint(r.getDocumentPoint(w.BottomLeft,t)),e.zn(o.width+n||0,o.height+s||0),this.so(-i.left,-i.top,e.width,e.height),y.e(t),b.e(o)}else e.zn(c+n||0,d+s||0),this.so(-i.left,-i.top,e.width,e.height)}}ph(t,e,i,n){this.actualBounds.i(t,e,i,n)}computeBorder(t){const e=this.part,i=e.diagram,n=null===i||!i.animationManager.isAnimating;if(null!==i&&e instanceof Ne&&!e.layer.isTemporary&&e.computesBoundsAfterDrag&&this.Yd.isReal()){const n=i.toolManager.findTool("Dragging");if(n===i.currentTool){const i=n.computeBorder(e,this.Yd,t);if(null!==i)return i}}const s=b.l(),o=this.computeMemberBounds(s),r=this.ti;return e instanceof Ne&&!e.isSubGraphExpanded?t.i(o.x-r.left,o.y-r.top,0,0):t.i(o.x-r.left,o.y-r.top,Math.max(o.width+r.left+r.right,0),Math.max(o.height+r.top+r.bottom,0)),b.e(s),n&&e instanceof Ne&&e.computesBoundsIncludingLocation&&e.location.isReal()&&t.unionPoint(e.location),t}computeMemberBounds(t){if(!(this.part instanceof Ne))return t.i(0,0,0,0),t;const e=this.part;let i=1/0,n=1/0,s=-1/0,o=-1/0;const r=e.memberParts;for(;r.next();){const t=r.value;if(!t.isVisible()||t instanceof ve&&(!e.computesBoundsIncludingLinks||t.Bo()||t.fromNode===e||t.toNode===e))continue;const a=t.actualBounds;a.left<i&&(i=a.left),a.top<n&&(n=a.top),a.right>s&&(s=a.right),a.bottom>o&&(o=a.bottom)}if(isFinite(i)&&isFinite(n))t.i(i,n,s-i,o-n);else{const i=e.location;t.i(i.x,i.y,0,0)}return t}get padding(){return this.ti}set padding(t){"number"==typeof t&&(t=new v(t));const e=this.ti;e.equals(t)||(t=t.N(),this.ti=t,this.t("padding",e,t),this.c())}}class Le{L;pa;Kd;Nr;Gd;Hd;Oo;yl;jd;qd;wo;constructor(t){u.qi(this),this.L=null,this.pa=null,this.Kd=!0,this.Nr=!0,this.Gd=!1,this.Hd=new y(0,0).u(),this.Oo=!0,this.yl=null,this.jd=null,this.qd=!1,this.wo=null,t&&Object.assign(this,t)}cloneProtected(t){t.Kd=this.Kd,t.Nr=this.Nr,t.Gd=this.Gd,t.Hd.a(this.Hd),t.Oo=this.Oo,t.yl=this.yl,t.jd=this.jd,t.qd=!0}copy(){const t=new this.constructor;return this.cloneProtected(t),t}hi(t){e.cr(this,t)}toString(){let t=e.Vn(this.constructor);return t+="(",null!==this.group&&(t+=" in "+this.group),null!==this.diagram&&(t+=" for "+this.diagram),t+=")",t}get diagram(){return this.L}set diagram(t){this.L=t}get group(){return this.pa}set group(t){this.pa!==t&&(this.pa=t,null!==t&&(this.L=t.diagram))}get isOngoing(){return this.Kd}set isOngoing(t){this.Kd!==t&&(e.s(t,"boolean",Le,"isOngoing"),this.Kd=t)}get isInitial(){return this.Nr}set isInitial(t){e.s(t,"boolean",Le,"isInitial"),this.Nr=t,t||(this.qd=!0)}get isViewportSized(){return this.Gd}set isViewportSized(t){this.Gd!==t&&(e.s(t,"boolean",Le,"isViewportSized"),this.Gd=t,t&&this.invalidateLayout())}get isRouting(){return this.Oo}set isRouting(t){this.Oo!==t&&(e.s(t,"boolean",Le,"isRouting"),this.Oo=t)}get isRealtime(){return this.yl}set isRealtime(t){this.yl!==t&&(null!==t&&e.s(t,"boolean",Le,"isRealtime"),this.yl=t)}get isValidLayout(){return this.qd}set isValidLayout(t){if(this.qd!==t&&(e.s(t,"boolean",Le,"isValidLayout"),this.qd=t,!t)){const t=this.diagram;null!==t&&(t.jr=!0)}}invalidateLayout(){if(this.isValidLayout){const t=this.diagram;if(null===t||t.undoManager.isUndoingRedoing)return;const e=t.animationManager;if(e.isTicking)return;e.defaultAnimation.isAnimating&&e.stopAnimation(),(this.isOngoing&&t.Kh||this.isInitial&&!t.Kh)&&(this.isValidLayout=!1,t.requestUpdate())}}get network(){return this.wo}set network(t){this.wo!==t&&(this.wo=t,null!==t&&(t.layout=this))}createNetwork(){return new Ae(this)}makeNetwork(t){const e=this.createNetwork();return t instanceof bt?(e.addParts(t.nodes,!0),e.addParts(t.links,!0)):t instanceof Ne?e.addParts(t.memberParts):e.addParts(t.iterator),e}updateParts(){this.isValidLayout=!0;let t=this.diagram;if(null===t&&null!==this.network){const e=this.network.vertexes.iterator;for(;e.next();){const i=e.value.node;if(null!==i&&(t=i.diagram,null!==t))break}}try{null!==t&&t.startTransaction("Layout"),this.commitLayout()}finally{null!==t&&t.commitTransaction("Layout")}}commitLayout(){if(null===this.network)return;const t=this.network.vertexes.iterator;for(;t.next();)t.value.commit();if(this.isRouting){const t=this.network.edges.iterator;for(;t.next();)t.value.commit()}}doLayout(t){const e=new u;if(t instanceof bt?(this.Ah(e,t.nodes,!0,this.ma,!0,!1,!0),this.Ah(e,t.parts,!0,this.ma,!0,!1,!0)):t instanceof Ne?this.Ah(e,t.memberParts,!1,this.ma,!0,!1,!0):e.addAll(t.iterator),e.count>0){const t=this.diagram;null!==t&&t.startTransaction("Layout"),this.doMinimalNoNetworkLayout(e),null!==t&&t.commitTransaction("Layout")}this.isValidLayout=!0}doMinimalNoNetworkLayout(t){const e=t.count,i=Math.ceil(Math.sqrt(e));this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin);const n=this.arrangementOrigin.x;let s=n,o=this.arrangementOrigin.y,r=0,a=0;const l=t.iterator;for(;l.next();){const t=l.value;t.ensureBounds();const e=t.measuredBounds,h=e.width,u=e.height;t.moveTo(s,o),t instanceof Ne&&(t.ma=!1),s+=Math.max(h,50)+20,a=Math.max(a,Math.max(u,50)),r>=i-1?(r=0,s=n,o+=a+20,a=0):r++}}ma(t){return!!(!t.location.isReal()&&!t.position.isReal()||t instanceof Ne&&t.ma)}Ah(t,e,i,n,s,o,r){const a=e.iterator;for(;a.next();){const e=a.value;if((!i||e.isTopLevel)&&(null===n||n(e))&&e.canLayout())if(s&&e instanceof me){if(e.isLinkLabel)continue;e instanceof Ne&&null===e.layout?this.Ah(t,e.memberParts,!1,n,s,o,r):(e.ensureBounds(),t.add(e))}else o&&e instanceof ve?t.add(e):r&&e.Me()&&!(e instanceof me)&&(e.ensureBounds(),t.add(e))}}getLayoutBounds(t,e){const i=this.boundsComputation;return null!==i?(e||(e=new b),i(t,this,e)):!e&&t.margin.equalTo(0,0,0,0)?t.actualBounds:(e||(e=new b),e.set(t.actualBounds),e.addMargin(t.margin),e)}get boundsComputation(){return this.jd}set boundsComputation(t){this.jd!==t&&(null!==t&&e.S(t,Le,"boundsComputation"),this.jd=t,this.invalidateLayout())}collectParts(t){const e=new u;return t instanceof bt?(this.Ah(e,t.nodes,!0,null,!0,!0,!0),this.Ah(e,t.links,!0,null,!0,!0,!0),this.Ah(e,t.parts,!0,null,!0,!0,!0)):t instanceof Ne?this.Ah(e,t.memberParts,!1,null,!0,!0,!0):this.Ah(e,t.iterator,!1,null,!0,!0,!0),e}get arrangementOrigin(){return this.Hd}set arrangementOrigin(t){this.Hd.equals(t)||(this.Hd.a(t),this.invalidateLayout())}initialOrigin(t){const e=this.group;if(null!==e){if(e.hasPlaceholder()){const i=e.placeholder,n=i.getDocumentPoint(w.TopLeft);(isNaN(n.x)||isNaN(n.y))&&n.set(t);const s=i.padding;return n.x+=s.left,n.y+=s.top,n}{const i=e.position.copy();return(isNaN(i.x)||isNaN(i.y))&&i.set(t),i}}return t}}class Ae{ne;xo;Tn;ky;Py;constructor(t){u.qi(this),this.ne=t,this.xo=new u,this.Tn=new u,this.ky=new p,this.Py=new p}clear(){if(this.xo){const t=this.xo.iterator;for(;t.next();)t.value.clear()}if(this.Tn){const t=this.Tn.iterator;for(;t.next();)t.value.clear()}this.xo=new u,this.Tn=new u,this.ky=new p,this.Py=new p}toString(t){void 0===t&&(t=0);let e="LayoutNetwork"+(null!==this.layout?"("+this.layout.toString()+")":"");if(t<=0)return e;if(e+=" vertexes: "+this.xo.count+" edges: "+this.Tn.count,t>1){const i=this.xo.iterator;for(;i.next();){e+="\n    "+i.value.toString(t-1)}const n=this.Tn.iterator;for(;n.next();){e+="\n    "+n.value.toString(t-1)}}return e}get layout(){return this.ne}set layout(t){null!==t&&(this.ne=t)}get vertexes(){return this.xo}get edges(){return this.Tn}createVertex(){return new De(this)}createEdge(){return new Fe(this)}addParts(t,i,n){if(null===t)return;void 0===i&&(i=!1),e.s(i,"boolean",Ae,"addParts:toplevelonly"),void 0===n&&(n=null),null===n&&(n=t=>{if(t instanceof me)return!t.isLinkLabel;if(t instanceof ve){const e=t.fromNode;if(null===e||e.isLinkLabel)return!1;const i=t.toNode;return!(null===i||i.isLinkLabel)}return!1});const s=t.iterator;for(;s.next();){const t=s.value;if(t instanceof me&&(!i||t.isTopLevel)&&t.canLayout()&&n(t))if(t instanceof Ne&&null===t.layout)this.addParts(t.memberParts,!1);else{if(null!==this.findVertex(t))continue;const e=this.createVertex();e.node=t,this.addVertex(e)}}for(s.reset();s.next();){const t=s.value;if(!(t instanceof ve)||i&&!t.isTopLevel||!t.canLayout()||!n(t)||null!==this.findEdge(t))continue;const e=t.fromNode,o=t.toNode;if(null===e||null===o||e===o)continue;const r=this.findGroupVertex(e),a=this.findGroupVertex(o);this.linkVertexes(r,a,t)}}findGroupVertex(t){const e=t.findVisibleNode();if(null===e)return null;let i=this.findVertex(e);if(null!==i)return i;let n=e.containingGroup;for(;null!==n;){if(i=this.findVertex(n),null!==i)return i;n=n.containingGroup}return null}addVertex(t){this.xo.add(t);const e=t.node;null!==e&&this.ky.set(e,t),t.network=this}addNode(t){let e=this.findVertex(t);return null===e&&(e=this.createVertex(),e.node=t,this.addVertex(e)),e}deleteVertex(t){if(this.ST(t)){let e=t.tr;for(let t=e.count-1;t>=0;t--){const i=e.elt(t);this.deleteEdge(i)}e=t.ir;for(let t=e.count-1;t>=0;t--){const i=e.elt(t);this.deleteEdge(i)}}}ST(t){const e=this.xo.delete(t);if(e){const e=t.node;null!==e&&this.ky.delete(e)}return e}deleteNode(t){const e=this.findVertex(t);null!==e&&this.deleteVertex(e)}findVertex(t){return this.ky.get(t)}addEdge(t){this.mN(t);const e=t.toVertex;null!==e&&e.addSourceEdge(t);const i=t.fromVertex;null!==i&&i.addDestinationEdge(t)}mN(t){this.Tn.add(t);const e=t.link;null!==e&&null===this.findEdge(e)&&this.Py.set(e,t),t.network=this}addLink(t){const e=t.fromNode,i=t.toNode;let n=this.findEdge(t);return null===n?(n=this.createEdge(),n.link=t,null!==e&&(n.fromVertex=this.addNode(e)),null!==i&&(n.toVertex=this.addNode(i)),this.addEdge(n)):(n.fromVertex=null!==e?this.addNode(e):null,n.toVertex=null!==i?this.addNode(i):null),n}deleteEdge(t){const e=t.toVertex;null!==e&&e.deleteSourceEdge(t);const i=t.fromVertex;null!==i&&i.deleteDestinationEdge(t),this.pN(t)}pN(t){const e=this.Tn.delete(t);if(e){const e=t.link;null!==e&&this.Py.delete(e)}return e}deleteLink(t){const e=this.findEdge(t);null!==e&&this.deleteEdge(e)}findEdge(t){return this.Py.get(t)}linkVertexes(t,e,i){if(null===t||null===e)return null;if(t.network===this&&e.network===this){const n=this.createEdge();return n.link=i,n.fromVertex=t,n.toVertex=e,this.addEdge(n),n}return null}reverseEdge(t){const e=t.fromVertex,i=t.toVertex;null===e||null===i||(e.deleteDestinationEdge(t),i.deleteSourceEdge(t),t.reverseEdge(),e.addSourceEdge(t),i.addDestinationEdge(t))}deleteSelfEdges(){const t=e.rt(),i=this.Tn.iterator;for(;i.next();){const e=i.value;e.fromVertex===e.toVertex&&t.push(e)}const n=t.length;for(let e=0;e<n;e++)this.deleteEdge(t[e]);e.tt(t)}deleteArtificialVertexes(){const t=e.rt(),i=this.xo.iterator;for(;i.next();){const e=i.value;null===e.node&&null===e.data&&t.push(e)}let n=t.length;for(let e=0;e<n;e++)this.deleteVertex(t[e]);const s=e.rt(),o=this.Tn.iterator;for(;o.next();){const t=o.value;null===t.link&&null===t.data&&s.push(t)}n=s.length;for(let e=0;e<n;e++)this.deleteEdge(s[e]);e.tt(t),e.tt(s)}deleteUselessEdges(){const t=e.rt(),i=this.Tn.iterator;for(;i.next();){const e=i.value;(null===e.fromVertex||null===e.toVertex)&&t.push(e)}const n=t.length;for(let e=0;e<n;e++)this.deleteEdge(t[e]);e.tt(t)}isSingleton(t){return!(t.tr.count>0||t.ir.count>0)}splitIntoSubNetworks(t){void 0===t&&(t=!0),t&&(this.deleteArtificialVertexes(),this.deleteUselessEdges(),this.deleteSelfEdges());const e=new l;let i=!0;for(;i;){i=!1;const t=this.xo.iterator;for(;t.next();){const n=t.value;if(this.isSingleton(n))continue;const s=this.layout.createNetwork();e.add(s),this.vO(s,n),i=!0;break}}return e.sort(((t,e)=>null===t||null===e||t===e?0:e.vertexes.count-t.vertexes.count)),e}vO(t,e){if(null===e)return;const i=new l;for(i.add(e);i.count>0;){const e=i.first();if(i.removeAt(0),!e||e.network===t)continue;this.ST(e),t.addVertex(e);let n=e.sourceEdges;for(;n.next();){const e=n.value;e.network!==t&&(this.pN(e),t.mN(e),e.fromVertex&&i.add(e.fromVertex))}for(n=e.destinationEdges;n.next();){const e=n.value;e.network!==t&&(this.pN(e),t.mN(e),e.toVertex&&i.add(e.toVertex))}}}findAllParts(){const t=new u,e=this.xo.iterator;for(;e.next();){const i=e.value;i.node&&t.add(i.node)}const i=this.Tn.iterator;for(;i.next();){const e=i.value;e.link&&t.add(e.link)}return t}}class De{wo;ei;Le;De;We;tr;ir;constructor(t){u.qi(this),this.wo=t,this.De=new b(0,0,10,10).u(),this.We=new y(5,5).u(),this.ei=null,this.Le=null,this.tr=new l,this.ir=new l}clear(){this.ei=null,this.Le=null,this.tr=new l,this.ir=new l}toString(t){void 0===t&&(t=0);let e="LayoutVertex#"+u.us(this);if(t>0&&(e+=null!==this.node?"("+this.node.toString()+")":"",t>1)){let t="",i=!0,n=this.tr.iterator;for(;n.next();){i?i=!1:t+=",",t+=n.value.toString(0)}let s="";for(i=!0,n=this.ir.iterator;n.next();){i?i=!1:s+=",",s+=n.value.toString(0)}e+=" sources: "+t+" destinations: "+s}return e}get bo(){return this.tr.rC}get er(){return this.ir.rC}get data(){return this.ei}set data(t){if(this.ei=t,null!==t&&t.bounds){const e=t.bounds,i=e.x,n=e.y,s=e.width,o=e.height;this.We.i(s/2,o/2),this.De.i(i,n,s,o)}}get node(){return this.Le}set node(t){if(this.Le!==t){if(this.Le=t,null===t)return;t.ensureBounds();const e=this.network.layout,i=b.l(),n=e.getLayoutBounds(t,i);let s=n.x,o=n.y;const r=n.width,a=n.height;if(isNaN(s)&&(s=0),isNaN(o)&&(o=0),this.De.i(s,o,r,a),b.e(i),!(t instanceof Ne)){const e=t.locationObject.getDocumentPoint(w.Center);if(e.isReal())return void this.We.i(e.x-s,e.y-o)}this.We.i(r/2,a/2)}}get bounds(){return this.De}set bounds(t){this.De.equals(t)||this.De.a(t)}get focus(){return this.We}set focus(t){this.We.equals(t)||this.We.a(t)}get centerX(){return this.De.x+this.We.x}set centerX(t){const e=this.De;e.x+this.We.x!==t&&(e.At(),e.x=t-this.We.x,e.u())}get centerY(){return this.De.y+this.We.y}set centerY(t){const e=this.De;e.y+this.We.y!==t&&(e.At(),e.y=t-this.We.y,e.u())}get focusX(){return this.We.x}set focusX(t){const e=this.We;e.x!==t&&(e.At(),e.x=t,e.u())}get focusY(){return this.We.y}set focusY(t){const e=this.We;e.y!==t&&(e.At(),e.y=t,e.u())}get x(){return this.De.x}set x(t){const e=this.De;e.x!==t&&(e.At(),e.x=t,e.u())}get y(){return this.De.y}set y(t){const e=this.De;e.y!==t&&(e.At(),e.y=t,e.u())}get width(){return this.De.width}set width(t){const e=this.De;e.width!==t&&(e.At(),e.width=t,e.u())}get height(){return this.De.height}set height(t){const e=this.De;e.height!==t&&(e.At(),e.height=t,e.u())}commit(){const t=this.ei;if(null!==t){const i=this.bounds,n=t.bounds;return void(e.H(n)?(n.x=i.x,n.y=i.y,n.width=i.width,n.height=i.height):t.bounds=i.copy())}const i=this.node;if(null!==i){const t=this.bounds;if(!(i instanceof Ne)){const e=b.l();i.ensureBounds();const n=this.network.layout.getLayoutBounds(i,e),s=i.locationObject.getDocumentPoint(w.Center);if(n.isReal()&&s.isReal())return i.moveTo(t.x+this.focusX-(s.x-n.x)+i.margin.left,t.y+this.focusY-(s.y-n.y+i.margin.top)),void b.e(e);b.e(e)}i.moveTo(t.x+i.margin.left,t.y+i.margin.top)}}addSourceEdge(t){null!==t&&(this.tr.has(t)||this.tr.add(t))}deleteSourceEdge(t){null!==t&&this.tr.delete(t)}addDestinationEdge(t){null!==t&&(this.ir.has(t)||this.ir.add(t))}deleteDestinationEdge(t){null!==t&&this.ir.delete(t)}get network(){return this.wo}set network(t){this.wo=t}get sourceVertexes(){const t=new u,e=this.sourceEdges;for(;e.next();){const i=e.value;i.fromVertex&&t.add(i.fromVertex)}return t.iterator}get destinationVertexes(){const t=new u,e=this.destinationEdges;for(;e.next();){const i=e.value;i.toVertex&&t.add(i.toVertex)}return t.iterator}get vertexes(){const t=new u;let e=this.sourceEdges;for(;e.next();){const i=e.value;i.fromVertex&&t.add(i.fromVertex)}for(e=this.destinationEdges;e.next();){const i=e.value;i.toVertex&&t.add(i.toVertex)}return t.iterator}get sourceEdges(){return this.tr.iterator}get destinationEdges(){return this.ir.iterator}get edges(){const t=new l;let e=this.sourceEdges;for(;e.next();){const i=e.value;t.add(i)}for(e=this.destinationEdges;e.next();){const i=e.value;t.add(i)}return t.iterator}get edgesCount(){return this.tr.count+this.ir.count}static standardComparer(t,e){const i=t.Le,n=e.Le;if(i){if(n){const t=i.text,e=n.text;return t<e?-1:t>e?1:0}return 1}return null!==n?-1:0}static smartComparer(t,e){if(null!==t){if(null!==e){const i=t.Le,n=e.Le;if(null!==i){if(null!==n){const t=i.text.toLocaleLowerCase(),e=n.text.toLocaleLowerCase(),s=t.split(/([+-]?[.]?\d+(?:\.\d*)?(?:e[+-]?\d+)?)/),o=e.split(/([+-]?[.]?\d+(?:\.\d*)?(?:e[+-]?\d+)?)/);let r=0;for(;r<s.length;r++){if(""!==o[r]&&void 0!==o[r]){const t=parseFloat(s[r]),e=parseFloat(o[r]);if(isNaN(t)){if(isNaN(e)){if(0!==s[r].localeCompare(o[r]))return s[r].localeCompare(o[r]);continue}return 1}if(isNaN(e))return-1;if(t-e!==0)return t-e;continue}if(""===s[r])continue;return 1}return""!==o[r]&&void 0!==o[r]?-1:0}return 1}return null!==n?-1:0}return 1}return null!==e?-1:0}}class Fe{wo;ei;qe;Je;$e;constructor(t){u.qi(this),this.wo=t,this.ei=null,this.qe=null,this.Je=null,this.$e=null}clear(){this.ei=null,this.qe=null,this.Je=null,this.$e=null}toString(t){void 0===t&&(t=0);let e="LayoutEdge#"+u.us(this);return t>0&&(e+=null!==this.qe?"("+this.qe.toString()+")":"",t>1&&(e+=" "+(this.Je?this.Je.toString():"null")+" --\x3e "+(this.$e?this.$e.toString():"null"))),e}reverseEdge(){const t=this.Je;this.Je=this.$e,this.$e=t}commit(){}getOtherVertex(t){return this.$e===t?this.Je:this.Je===t?this.$e:null}get network(){return this.wo}set network(t){this.wo=t}get data(){return this.ei}set data(t){this.ei!==t&&(this.ei=t)}get link(){return this.qe}set link(t){this.qe!==t&&(this.qe=t)}get fromVertex(){return this.Je}set fromVertex(t){this.Je!==t&&(this.Je=t)}get toVertex(){return this.$e}set toVertex(t){this.$e!==t&&(this.$e=t)}}var Oe=(t=>(t[t.Position=0]="Position",t[t.Location=1]="Location",t))(Oe||{}),Re=(t=>(t[t.LeftToRight=10]="LeftToRight",t[t.RightToLeft=11]="RightToLeft",t))(Re||{}),Ee=(t=>(t[t.Forwards=20]="Forwards",t[t.Reverse=21]="Reverse",t[t.Ascending=22]="Ascending",t[t.Descending=23]="Descending",t))(Ee||{});class Be extends Le{Wd;Jd;Do;Dn;fi;Gi;xe;be;constructor(t){super(),this.isViewportSized=!0,this.Wd=NaN,this.Jd=NaN,this.Do=new x(NaN,NaN).u(),this.Dn=new x(10,10).u(),this.fi=1,this.Gi=10,this.xe=22,this.be=Be.standardComparer,t&&Object.assign(this,t)}cloneProtected(t){super.cloneProtected(t),t.Wd=this.Wd,t.Jd=this.Jd,t.Do.a(this.Do),t.Dn.a(this.Dn),t.fi=this.fi,t.Gi=this.Gi,t.xe=this.xe,t.be=this.be}hi(t){t in Ee?this.sorting=t:t in Re?this.arrangement=t:t in Oe?this.alignment=t:super.hi(t)}doLayout(t){this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin);const e=this.collectParts(t),i=this.diagram,n=e.copy().iterator;for(;n.next();){const t=n.value;if(!t.Rl()||null===t.fromNode&&null===t.toNode){if(t.ensureBounds(),t instanceof Ne){const i=t.memberParts;for(;i.next();){const t=i.value;e.delete(t)}}}else e.delete(t)}const s=e.toArray();if(0===s.length)return;switch(this.sorting){case 20:break;case 21:s.reverse();break;case 22:s.sort(this.comparer);break;case 23:s.sort(this.comparer),s.reverse()}let o=this.wrappingColumn;isNaN(o)&&(o=0);let r=this.wrappingWidth;if(isNaN(r)&&null!==i){const t=i.viewportBounds,e=i.padding;r=Math.max(t.width-e.left-e.right,0)}else r=Math.max(this.wrappingWidth,0);o<=0&&r<=0&&(o=1);let a=this.spacing.width;isFinite(a)||(a=0);let l=this.spacing.height;isFinite(l)||(l=0),null!==i&&i.startTransaction("Layout");const h=[];switch(this.alignment){case 0:this.OO(s,r,o,a,l,h);break;case 1:this.IO(s,r,o,a,l,h)}let u=0,c=0,d=0;for(let f=0;f<h.length;f++){const t=h[f];u=Math.min(u,t.x),c=Math.min(c,t.y),d=Math.max(d,t.x+t.width)}11===this.arrangement?this.commitLayers(h,new y(u+a/2-(d+u),c-l/2)):this.commitLayers(h,new y(u-a/2,c-l/2)),null!==i&&i.commitTransaction("Layout"),this.isValidLayout=!0}OO(t,e,i,n,s,o){const r=b.l();let a=Math.max(this.cellSize.width,1);if(!isFinite(a)){a=0;for(let e=0;e<t.length;e++){const i=t[e],n=this.getLayoutBounds(i,r);a=Math.max(a,n.width)}}a+=n,a=Math.max(a,1);let l=Math.max(this.cellSize.height,1);if(!isFinite(l)){l=0;for(let e=0;e<t.length;e++){const i=t[e],n=this.getLayoutBounds(i,r);l=Math.max(l,n.height)}}l+=s,l=Math.max(l,1);const h=this.arrangement,u=this.arrangementOrigin.x;let c=u,d=this.arrangementOrigin.y,f=0,g=0;for(let m=0;m<t.length;m++){const p=t[m],y=this.getLayoutBounds(p,r),x=Math.ceil((y.width+n)/a)*a,v=Math.ceil((y.height+s)/l)*l;let w=0;if(11===h)w=Math.abs(c-y.width);else w=c+y.width;(i>0&&f>i-1||e>0&&f>0&&w-u>e)&&(o.push(new b(0,d,e+n,g)),f=0,c=u,d+=g,g=0),g=Math.max(g,v);let k=0;if(11===h)k=-y.width;else k=0;if(11===(p.moveTo(c+k+p.margin.left,d+p.margin.top),h))c-=x;else c+=x;f++}o.push(new b(0,d,e+n,g)),b.e(r)}IO(t,e,i,n,s,o){const r=b.l();let a=Math.max(this.cellSize.width,1),l=0,h=0,u=0;const c=y.l();for(let y=0;y<t.length;y++){const e=t[y],i=this.getLayoutBounds(e,r),n=e.getRelativePoint(e.locationObject,e.locationSpot,c);l=Math.max(l,n.x),h=Math.max(h,i.width-n.x),u=Math.max(u,n.y)}const d=this.arrangement;if(11===d)l+=n;else h+=n;a=isFinite(a)?Math.max(a+n,1):Math.max(l+h,1);const f=this.arrangementOrigin.x;let g=f,m=this.arrangementOrigin.y,p=0;e>=l&&(e-=l);let x=0,v=0;const w=Math.max(this.cellSize.height,1);u=0;let k=0,P=!0;const M=y.l();for(let y=0;y<t.length;y++){const l=t[y],h=this.getLayoutBounds(l,r),C=l.getRelativePoint(l.locationObject,l.locationSpot,c);if(p>0)switch(d){case 11:{let t=(g-f-(h.width-C.x))/a;t=S.Y(Math.round(t),t)?Math.round(t):Math.floor(t),g=t*a+f;break}default:{let t=(g-f+C.x)/a;t=S.Y(Math.round(t),t)?Math.round(t):Math.ceil(t),g=t*a+f;break}}else if(11===d)x=g+C.x+h.width;else x=g-C.x;let N=0;if(11===d)N=-(g+C.x)+x;else N=g+h.width-C.x-x;if(i>0&&p>i-1||e>0&&p>0&&N>e){o.push(new b(0,P?m-u:m,e+n,k+u+s));for(let e=0;e<p&&y!==p;e++){const i=t[y-p+e],n=i.getRelativePoint(i.locationObject,i.locationSpot,M);i.moveTo(i.position.x,i.position.y+u-n.y)}k+=s,m+=P?k:k+u,u=0,k=0,p=0,g=f,P=!1}if(11===(g===f&&(v=11===d?Math.max(v,h.width-C.x):Math.min(v,-C.x)),u=Math.max(u,C.y),k=Math.max(k,h.height-C.y),isFinite(w)&&(k=Math.max(k,Math.max(h.height,w)-C.y)),P?l.moveTo(g-C.x,m-C.y):l.moveTo(g-C.x,m),d))g-=C.x+n;else g+=h.width-C.x+n;p++}if(o.push(new b(0,m,e+n,(P?k:k+u)+s)),t.length!==p)for(let y=0;y<p;y++){const e=t[t.length-p+y],i=e.getRelativePoint(e.locationObject,e.locationSpot,c);e.moveTo(e.position.x,e.position.y+u-i.y)}if(y.e(c),y.e(M),11===d)for(let y=0;y<o.length;y++){const t=o[y];t.width+=v,t.x-=v}else for(let y=0;y<o.length;y++){const t=o[y];t.x>v&&(t.width+=t.x-v,t.x=v)}b.e(r)}commitLayers(t,e){}get wrappingWidth(){return this.Wd}set wrappingWidth(t){this.Wd!==t&&(e.s(t,"number",Be,"wrappingWidth"),(t>0||isNaN(t))&&(this.Wd=t,this.isViewportSized=isNaN(t),this.invalidateLayout()))}get wrappingColumn(){return this.Jd}set wrappingColumn(t){this.Jd!==t&&(e.s(t,"number",Be,"wrappingColumn"),(t>0||isNaN(t))&&(this.Jd=t,this.invalidateLayout()))}get cellSize(){return this.Do}set cellSize(t){this.Do.equals(t)||(this.Do.a(t),this.invalidateLayout())}get spacing(){return this.Dn}set spacing(t){this.Dn.equals(t)||(this.Dn.a(t),this.invalidateLayout())}get alignment(){return this.fi}set alignment(t){this.fi!==t&&(1===t||0===t)&&(this.fi=t,this.invalidateLayout())}get arrangement(){return this.Gi}set arrangement(t){this.Gi!==t&&(10===t||11===t)&&(this.Gi=t,this.invalidateLayout())}get sorting(){return this.xe}set sorting(t){this.xe!==t&&(20===t||21===t||22===t||23===t)&&(this.xe=t,this.invalidateLayout())}get comparer(){return this.be}set comparer(t){this.be!==t&&(e.S(t,Be,"comparer"),this.be=t,this.invalidateLayout())}static standardComparer(t,e){const i=t.text,n=e.text;return i<n?-1:i>n?1:0}static smartComparer(t,e){if(null!==t){if(null!==e){const i=t.text.toLocaleLowerCase(),n=e.text.toLocaleLowerCase(),s=i.split(/([+-]?[.]?\d+(?:\.\d*)?(?:e[+-]?\d+)?)/),o=n.split(/([+-]?[.]?\d+(?:\.\d*)?(?:e[+-]?\d+)?)/);let r=0;for(;r<s.length;r++){if(""!==o[r]&&void 0!==o[r]){const t=parseFloat(s[r]),e=parseFloat(o[r]);if(isNaN(t)){if(isNaN(e)){if(0!==s[r].localeCompare(o[r]))return s[r].localeCompare(o[r]);continue}return 1}if(isNaN(e))return-1;if(t-e!==0)return t-e;continue}if(""===s[r])continue;return 1}return""!==o[r]&&void 0!==o[r]?-1:0}return 1}return null!==e?-1:0}static Position=0;static Location=1;static LeftToRight=10;static RightToLeft=11;static Forward=20;static Reverse=21;static Ascending=22;static Descending=23}class Ie{$d;Zs;Tt;ko;Zd;Qd;L;yN;constructor(){this.$d=new u,this.Zs=new u,this.Tt=new u,this.ko=new p,this.Zd=new p,this.Qd=new p,this.L=null,this.yN=!1}clear(){this.$d.clear(),this.Zs.clear(),this.Tt.clear(),this.ko.clear(),this.Zd.clear(),this.Qd.clear()}Ro(t){this.L=t}_h(t){if(t instanceof me){if(this.$d.add(t),t instanceof Ne){const e=t.containingGroup;null===e?this.diagram.qr.add(t):e.ga.add(t);const i=t.layout;null!==i&&(i.diagram=this.diagram)}}else t instanceof ve?(this.Zs.add(t),t.isAvoiding&&(this.diagram.Gm=!0)):t instanceof fe||this.Tt.add(t);const e=t.data;null!==e&&(t instanceof fe||(t instanceof ve?this.MT(e,t):this.ko.set(e,t)))}se(t){if(t.clearAdornments(),t instanceof me){if(this.$d.delete(t),t instanceof Ne){const e=t.containingGroup;null===e?this.diagram.qr.delete(t):e.ga.delete(t);const i=t.layout;null!==i&&(i.diagram=null)}}else t instanceof ve?this.Zs.delete(t):t instanceof fe||this.Tt.delete(t);const e=t.data;null!==e&&(t instanceof fe||(t instanceof ve?this.NT(e,t):this.ko.delete(e)))}MT(t,e){this.Zd.set(t,e)}NT(t,e){this.Zd.delete(t)}rebuildParts(){const t=this.diagram;if(null===t)return;const i=t.nodeTemplateMap.iterator;for(;i.next();){const t=i.value,n=i.key;(!t.Me()||t instanceof Ne)&&e.o(`Invalid node template in Diagram.nodeTemplateMap: template for "${n}" must be a Node or a simple Part, not a Group or Link: ${t}`)}const n=t.groupTemplateMap.iterator;for(;n.next();){const t=n.value,i=n.key;t instanceof Ne||e.o(`Invalid group template in Diagram.groupTemplateMap: template for "${i}" must be a Group, not a normal Node or Link: ${t}`)}const s=t.linkTemplateMap.iterator;for(;s.next();){const t=s.value,i=s.key;t instanceof ve||e.o(`Invalid link template in Diagram.linkTemplateMap: template for "${i}" must be a Link, not a normal Node or simple Part: ${t}`)}const o=e.rt(),r=t.selection.iterator;for(;r.next();){const t=r.value.data;t&&o.push(t)}const a=e.rt(),l=t.highlighteds.iterator;for(;l.next();){const t=l.value.data;t&&a.push(t)}const h=e.rt(),u=this.nodes.iterator;for(;u.next();){const t=u.value;null!==t.data&&(h.push(t.data),h.push(t.location))}const c=this.links.iterator;for(;c.next();){const t=c.value;null!==t.data&&(h.push(t.data),h.push(t.location))}const d=this.parts.iterator;for(;d.next();){const t=d.value;null!==t.data&&(h.push(t.data),h.push(t.location))}this.CT(),this.vM();for(let e=0;e<o.length;e++){const t=this.findPartForData(o[e]);null!==t&&(t.isSelected=!0)}for(let e=0;e<a.length;e++){const t=this.findPartForData(a[e]);null!==t&&(t.isHighlighted=!0)}for(let e=0;e<h.length;e+=2){const t=this.findPartForData(h[e]);null!==t&&(t.location=h[e+1])}e.tt(o),e.tt(a),e.tt(h)}vM(){const t=this.diagram.model;this.Sy(t.nodeDataArray)}Sy(t,e){const i=this.diagram.model;t.forEach((t=>{i.containsNodeData(t)&&this.LT(t,!1)})),t.forEach((t=>{i.containsNodeData(t)&&this.N1(t)})),!1!==e&&this.diagram.xb(!1)}LT(t,e){if(null==t||this.diagram.undoManager.isUndoingRedoing||this.ko.has(t))return null;void 0===e&&(e=!0);const i=this.EO(t);return null!==i&&e&&this.N1(t),i}EO(t){if(null==t||this.diagram.undoManager.isUndoingRedoing||this.ko.has(t))return null;const e=this.BO(t),i=this.findTemplateForNodeData(t,e);if(null!==i){i.zt();const n=i.copy();if(null!==n){const i=this.diagram.ge;return this.diagram.ge=!0,n.Wo=e,n.ei=t,this.addsToTemporaryLayer&&(n.fl="Tool"),this.diagram.add(n),n.ei=null,n.data=t,this.diagram.ge=i,n}}return null}insertLink(t,e,i,n){return null}N1(t){}BO(t){return this.diagram.model.getCategoryForNodeData(t)}static AT=!1;static TT=!1;findTemplateForNodeData(t,i){const n=this.diagram,s=n.model;let o=null;return s.Qc()&&s.isGroupForData(t)?(o=n.groupTemplateMap.get(i),null===o&&(o=n.groupTemplateMap.get(""),null===o&&(Ie.TT||(Ie.TT=!0,e.li('No Group template found for category "'+i+'"'),e.li("  Using default group template")),o=n.cM))):(o=n.nodeTemplateMap.get(i),null===o&&(o=n.nodeTemplateMap.get(""),null===o&&(Ie.AT||(Ie.AT=!0,e.li('No Node template found for category "'+i+'"'),e.li("  Using default node template")),o=n.lM))),o}getLinkCategoryForData(t){return""}setLinkCategoryForData(t,e){}setFromNodeForLink(t,e,i){}setToNodeForLink(t,e,i){}static DT=!1;findLinkTemplateForCategory(t){const i=this.diagram;let n=i.linkTemplateMap.get(t);return null===n&&(n=i.linkTemplateMap.get(""),null===n&&(Ie.DT||(Ie.DT=!0,e.li('No Link template found for category "'+t+'"'),e.li("  Using default link template")),n=i.hM)),n}Cv(t,e,i){t instanceof ve?(null!==e&&this.NT(e,t),null!==i&&this.MT(i,t)):t instanceof ce&&(null!==e&&this.ko.delete(e),null!==i&&this.ko.set(i,t))}CT(){const t=this.diagram.model;this.wN(t.nodeDataArray)}wN(t){t.forEach((t=>{this.C1(t)}))}C1(t){const e=this.findPartForData(t);null!==e&&(this.diagram.DM(e,!1),this.xN(e))}xN(t){}aN(t){}findPartForKey(t){if(null==t)return null;const e=this.diagram.model.findNodeDataForKey(t);return null!==e?this.ko.get(e):null}findNodeForKey(t){if(null==t)return null;const e=this.diagram.model.findNodeDataForKey(t);if(null===e)return null;const i=this.ko.get(e);return i instanceof me?i:null}findLinkForKey(t){return null}findPartForData(t){if(null===t)return null;let e=this.ko.get(t);return null!==e||(e=this.Zd.get(t)),e}findNodeForData(t){if(null===t)return null;const e=this.ko.get(t);return e instanceof me?e:null}findLinkForData(t,e){return null===t?null:this.Zd.get(t)}findNodesByExample(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];const s=new u,o=this.$d.iterator;for(;o.next();){const t=o.value,i=t.data;if(null!==i)for(let n=0;n<arguments.length;n++){const o=arguments[n];if(e.H(o)&&this.bN(i,o)){s.add(t);break}}}return s.iterator}findLinksByExample(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];const s=new u,o=this.Zs.iterator;for(;o.next();){const t=o.value,i=t.data;if(null!==i)for(let n=0;n<arguments.length;n++){const o=arguments[n];if(e.H(o)&&this.bN(i,o)){s.add(t);break}}}return s.iterator}bN(t,e){for(const i in e){const n=t[i],s=e[i];if(Array.isArray(s)){if(!Array.isArray(n))return!1;const t=n,e=s;if(t.length<e.length)return!1;for(let i=0;i<t.length;i++){const n=t[i],s=e[i];if(void 0!==s&&!this.FT(n,s))return!1}}else if(!this.FT(n,s))return!1}return!0}FT(t,i){if(e.ot(i)){if(!i(t))return!1}else if(i instanceof RegExp){if(!t||!i.test(t.toString()))return!1}else if(e.H(t)&&e.H(i)){if(!this.bN(t,i))return!1}else if(t!==i)return!1;return!0}doModelDataChanged(t){if(t.model===this.diagram.model&&this.diagram.K){this.diagram.K=!1;try{const e=t.change;""===t.modelChange&&null!==t.object&&2===e&&this.My(t.object,t.propertyName)}finally{this.diagram.K=!0}}}doModelChanged(t){const i=this.diagram;if(!i||t.model!==i.model)return;const n=t.change;if(i.AR(t),i.K){i.K=!1;try{const s=t.modelChange;if(""!==s)if(2===n){if("nodeCategory"===s){const e=t.object;if(null!==e){const i=this.findPartForData(e),n=t.newValue;null!==i&&"string"==typeof n&&(i.category=n)}}else if("nodeDataArray"===s){const e=t.oldValue;this.wN(e);const i=t.newValue;this.Sy(i)}i.isModified=!0}else if(3===n){const n=t.newValue;"nodeDataArray"===s&&e.H(n)&&this.LT(n),i.isModified=!0}else if(4===n){const n=t.oldValue;"nodeDataArray"===s&&e.H(n)&&this.C1(n),i.isModified=!0}else 1===n&&("SourceChanged"===s?null!==t.object?this.My(t.object,t.propertyName):(this.updateAllRelationshipsFromData(),this.updateAllTargetBindings()):"ModelDisplaced"===s&&this.rebuildParts());else if(2===n){const e=t.propertyName,n=t.object;n===i.model?("nodeKeyProperty"===e||"nodeCategoryProperty"===e)&&(i.undoManager.isUndoingRedoing||this.rebuildParts()):null!==n&&this.My(n,e),i.isModified=!0}else(3===n||4===n)&&(this.UO(t,i.model),i.isModified=!0)}finally{i.K=!0}}}updateAllTargetBindings(t){void 0===t&&(t="");let e=this.parts.iterator;for(;e.next();)e.value.updateTargetBindings(t);for(e=this.nodes.iterator;e.next();)e.value.updateTargetBindings(t);for(e=this.links.iterator;e.next();)e.value.updateTargetBindings(t)}updateAllThemeBindings(){let t=this.parts.iterator;for(;t.next();)t.value.Uo();for(t=this.nodes.iterator;t.next();)t.value.Uo();for(t=this.links.iterator;t.next();)t.value.Uo()}updateAllRelationshipsFromData(){const t=this.diagram.model,e=new u,i=t.nodeDataArray;for(let o=0;o<i.length;o++){const t=i[o];e.add(t)}const n=[];this.nodes.each((t=>{null!==t.data&&!e.has(t.data)&&n.push(t.data)})),this.parts.each((t=>{null!==t.data&&!e.has(t.data)&&n.push(t.data)})),n.forEach((e=>t.RT(e,!1)));for(let o=0;o<i.length;o++){const e=i[o];null===this.findPartForData(e)&&t.vT(e,!1)}this.OT();let s=this.parts.iterator;for(;s.next();)s.value.updateRelationshipsFromData();for(s=this.nodes.iterator;s.next();)s.value.updateRelationshipsFromData();for(s=this.links.iterator;s.next();)s.value.updateRelationshipsFromData()}OT(){}updateRelationshipsFromData(t){}My(t,i){if("string"==typeof i){const n=this.findPartForData(t);if(null!==n)n.updateTargetBindings(i);else{const n=this.VO(t);if(null!==n&&n.length>0){for(let e=0;e<n.length;e++)n[e].updateTargetBindings(i);const t=n[0].part;if(null!==t){const e=t.adornments;for(;e.next();)e.value.updateTargetBindings(i)}e.tt(n)}}t===this.diagram.model.modelData&&this.updateAllTargetBindings(i)}}VO(t){let i=null;const n=this.Qd.iterator;for(;n.next();){const s=n.value;for(let n=0;n<s.length;n++){const o=s[n].findItemPanelForData(t);null!==o&&(null===i&&(i=e.rt()),i.push(o))}if(null!==i)break}return i}kN(t){return this.Qd.get(t)}UO(t,e){const i=t.object;if(!Array.isArray(i))return;const n=3===t.change,s=n?t.newParam:t.oldParam,o=n?t.newValue:t.oldValue,r=this.kN(i);if(Array.isArray(r))for(let a=0;a<r.length;a++){const t=r[a];n?t.Jb(o,s,!0):t.Av(s)}}AM(t,e){null!==e&&t.$r((t=>e.BL(t)));const i=t.Ph;if(Array.isArray(i)){const e=this.kN(i);if(null===e)this.Qd.set(i,[t]);else{for(let i=0;i<e.length;i++)if(e[i]===t)return;e.push(t)}}}TM(t,e){t.$r((t=>e.DR(t)));const i=t.Ph;if(Array.isArray(i)){const e=this.kN(i);if(null!==e)for(let n=0;n<e.length;n++)if(e[n]===t)return e.splice(n,1),void(0===e.length&&this.Qd.delete(i))}}copyParts(t,e,i){void 0===i&&(i=!1);const n=new p;if(Array.isArray(t))for(let o=0;o<t.length;o++)this.L1(t[o],e,n,i);else{const s=t.iterator;for(;s.next();)this.L1(s.value,e,n,i)}if(null!==e){const t=e.model,i=e.a0().dragsLink,s=new u,o=new p,r=n.iterator;for(;r.next();){const a=r.value;if(a instanceof ve)!i&&(null===a.fromNode||null===a.toNode)&&s.add(a);else if(a instanceof me&&null!==a.data)if(t.km()){const i=a,s=r.key,l=s.findTreeParentNode();if(null!==l){const r=n.get(l);if(null!==r){t.setParentKeyForNodeData(i.data,t.getKeyForNodeData(r.data));const n=e.findLinkForData(i.data),a=s.findTreeParentLink();null!==a&&null!==n&&o.set(a,n)}}}else if(t.yb()){const i=a,s=r.key,l=t.isRelatedKeysPathTo?s.findNodesOutOf():s.findNodesInto();for(;l.next();){const r=l.value,a=n.get(r);if(null!==a){t.addRelatedKeyForNodeData(i.data,a.key);const n=e.partManager.findLinkForData(i.data,a.key),l=this.findLinkForData(s.data,r.key);null!==l&&null!==n&&o.set(l,n)}else t.removeRelatedKeyForNodeData(i.data,r.key)}}}if(s.count>0&&e.removeParts(s,!1),o.count>0){const t=o.iterator;for(;t.next();){const e=t.key,i=t.value;n.set(e,i)}}}if(null!==e&&null!==this.diagram){const t=e.model,i=t.afterCopyFunction;if(null!==i){const e=new p;n.each((t=>{null!==t.key.data&&e.set(t.key.data,t.value.data)}));const s=this.diagram.model;i(e,t,s)}}const s=n.iterator;for(;s.next();)s.value.updateTargetBindings();return n}L1(t,e,i,n){if(null===t||n&&!t.canCopy())return null;if(i.has(t))return i.get(t);const s=this.PN(t,e);if(!(s instanceof ce))return null;if(s.isSelected=!1,s.isHighlighted=!1,i.set(t,s),t instanceof me){const o=t.linksConnected;for(;o.next();){const e=o.value;if(e.fromNode===t){const t=i.get(e);null!==t&&(t.fromNode=s)}if(e.toNode===t){const t=i.get(e);null!==t&&(t.toNode=s)}}if(t instanceof Ne&&s instanceof Ne){const o=t.memberParts;for(;o.next();){const t=o.value,r=this.L1(t,e,i,n);r instanceof ve||null!==r&&(r.containingGroup=s)}}}else if(t instanceof ve&&s instanceof ve){const o=t.fromNode;if(null!==o){const t=i.get(o);null!==t&&(s.fromNode=t)}const r=t.toNode;if(null!==r){const t=i.get(r);null!==t&&(s.toNode=t)}const a=t.labelNodes;for(;a.next();){const t=a.value,o=this.L1(t,e,i,n);null!==o&&o instanceof me&&(o.labeledLink=s)}}return s}PN(t,i){let n=null;const s=t.data;if(null!==s&&null!==i){const o=i.model;if(!(t instanceof ve)){const t=o.copyNodeData(s);e.H(t)&&(o.addNodeData(t),n=i.findPartForData(t))}}else if(t.zt(),n=t.copy(),null!==n){const t=this.diagram;if(null!==i)i.add(n);else if(null!==s&&null!==t&&null!==t.commandHandler&&t.commandHandler.copiesClipboardData){const i=t.model;let o=null;n instanceof ve||(o=i.copyNodeData(s)),e.H(o)&&(n.data=o)}}return n}get nodes(){return this.$d}get links(){return this.Zs}get parts(){return this.Tt}get diagram(){return this.L}get addsToTemporaryLayer(){return this.yN}set addsToTemporaryLayer(t){this.yN=t}}var ze=(t=>(t[t.OneWay=1]="OneWay",t[t.TwoWay=2]="TwoWay",t))(ze||{});class Ve{n;SN;qa;Rf;Dh;vf;Of;If;D1;Se;gd;yf;constructor(t,i,n,s){u.qi(this),void 0===t?t="":e.s(t,"string",Ve,"constructor:targetprop"),void 0===i?i=t:e.s(i,"string",Ve,"constructor:sourceprop"),void 0===n?n=null:null!==n&&e.S(n,Ve,"constructor:conv"),this.SN=-1,this.Se=null,this.qa=t,this.gd=0,this.yf=0,this.Rf=null,this.Dh=i,this.vf=n,void 0===s?(this.Of=1,this.If=null):(this.Of=2,this.If=s),this.D1=new u,this.n=2}copy(){const t=new this.constructor;return this.cloneProtected(t),t}cloneProtected(t){t.qa=this.qa,t.gd=this.gd,t.yf=this.yf,t.Rf=this.Rf,t.Dh=this.Dh,t.vf=this.vf,t.Of=this.Of,t.If=this.If,t.n=-2&this.n}static OneWay=1;static TwoWay=2;static parseEnum(t,i){return e.S(t,Ve,"parseEnum:ctor"),n=>{let s=parseInt(n);return isNaN(s)&&(s=e.Xh(t,n),null===s)?i:s}}hi(t){t in ze?this.mode=t:e.cr(this,t)}static toString(t){return e.toString(t)}toString(){return"Binding("+this.targetProperty+":"+this.sourceProperty+(-1!==this.targetId?" "+this.targetId:"")+" "+ze[this.mode]+")"}u(){return this.n=1|this.n,this}get targetId(){return this.SN}set targetId(t){this.h&&e.D(this),this.SN=t}get targetProperty(){return this.qa}set targetProperty(t){this.h&&e.D(this),e.s(t,"string",Ve,"targetProperty"),this.qa=t}get sourceProperty(){return this.Dh}set sourceProperty(t){this.h&&e.D(this),e.s(t,"string",Ve,"sourceProperty"),this.Dh=t}get h(){return 0!==(1&this.n)}get isToData(){return 0!==(2&this.n)}get isToObject(){return 0!==(4&this.n)}get isToModel(){return 0!==(8&this.n)}get isToTheme(){return 0!==(16&this.n)}get MN(){return this.isToTheme&&!(this.isToData||this.isToObject||this.isToModel)}Qu(){return!1}get sourceName(){return this.Rf}set sourceName(t){this.h&&e.D(this),null!==t&&e.s(t,"string",Ve,"sourceName"),this.Rf=t,this.n=null!==t?-3&this.n|4:2|this.n}get converter(){return this.vf}set converter(t){this.h&&e.D(this),null!==t&&e.S(t,Ve,"converter"),this.vf=t}get backConverter(){return this.If}set backConverter(t){this.h&&e.D(this),null!==t&&e.S(t,Ve,"backConverter"),this.If=t}get mode(){return this.Of}set mode(t){this.h&&e.D(this),this.isToTheme&&2===t&&e.o("Theme Bindings cannot be TwoWay."),this.Of=t}makeTwoWay(t){return this.isToTheme&&e.o("Theme Bindings cannot be TwoWay."),this.mode=2,t&&(e.S(t,Ve,"makeTwoWay"),this.backConverter=t),this}ofObject(t){return this.h&&e.D(this),void 0===t&&(t=""),this.sourceName=t,this}ofModel(){return this.h&&e.D(this),this.n=-3&this.n&-5|8,this.Rf=null,this}fA(t,e){const i=this.sourceName;let n=null;return n=null===i||""===i?t:"/"===i?e.part:"."===i?e:".."===i?e.panel:t.findObject(i),n}check(t){const i=this.qa,n=this.Dh,s=this.vf;(this.Qu()&&null===s&&null===this.Fh&&""===i||null===s&&""===i)&&e.li("Binding error: target property is the empty string: "+this.toString()),this.Qu()&&this.MN&&""===n&&null===s&&null===this.Fh&&e.li("Binding error: theme bindings require a source property when not using a converter: "+this.toString()),t&&"string"==typeof i&&(!e.ot(["setAttribute"])&&i.length>0&&"_"!==i[0]&&!e.fw(t,i)?e.li("Binding error: undefined target property: "+i+" on "+t.toString()):"name"===i&&t instanceof At&&e.li("Binding error: cannot modify GraphObject.name on "+t.toString()))}updateTarget(t,e,i,n){const s=this.Dh;if(void 0!==i&&""!==s&&s!==i)return;const o=this.qa,r=this.vf;let a=e;if(""!==s&&!this.MN&&(a=n?n.bt(e,s):Ue.bt(e,s)),void 0===a)return;const l=t.diagram?.themeManager;if(null===r){if(""!==o){if(this.Qu()&&(a=this.zT(l,a,t,o),void 0===a))return;n?n.et(t,o,a):(e instanceof At||e instanceof $t)&&Ue.et(t,o,a)}}else try{if(""!==o){let i=r(a,t);if(this.Qu()&&(i=this.zT(l,i,t,o),void 0===i))return;n?n.et(t,o,i):(e instanceof At||e instanceof $t)&&Ue.et(t,o,i)}else r(a,t)}catch{}}updateSource(t,e,i,n){if(2!==this.Of)return;const s=this.qa;if(void 0!==i&&s!==i)return;const o=this.Dh,r=this.If,a=null!==n?n.diagram:null,l=null!==a?a.model:null;let h=t;if(""!==s&&(h=l?l.bt(t,s):Ue.bt(t,s)),void 0!==h&&!this.D1.has(t))try{if(this.D1.add(t),null===r){if(""!==o)null!==l?l.setDataProperty(e,o,h):(e instanceof At||e instanceof $t)&&(e[o]=h);else if(null!==l&&null!==n&&n.itemIndex>=0&&null!==n.panel&&Array.isArray(n.panel.itemArray)){const t=n.itemIndex,e=n.panel.itemArray;l.removeArrayItem(e,t),l.insertArrayItem(e,t,h)}}else try{if(""!==o){const t=r(h,e,l);null!==l?l.setDataProperty(e,o,t):(e instanceof At||e instanceof $t)&&(e[o]=t)}else{const t=r(h,e,l);if(void 0!==t&&null!==l&&null!==n&&n.itemIndex>=0&&null!==n.panel&&Array.isArray(n.panel.itemArray)){const e=n.itemIndex,i=n.panel.itemArray;l.removeArrayItem(i,e),l.insertArrayItem(i,e,t)}}}catch{}}finally{this.D1.delete(t)}}}class je extends Ve{Cy;Fh;Wa;constructor(t,e,i,n,s){super(t,e,n),null==i&&(i=""),void 0===s&&(s=null),this.Cy=i,this.Fh=s,this.Wa=null,this.n=16}cloneProtected(t){super.cloneProtected(t),t.Cy=this.Cy,t.Fh=this.Fh,t.Wa=this.Wa}Qu(){return!0}get themeSource(){return this.Cy}set themeSource(t){this.h&&e.D(this),null!==t&&e.s(t,"string",je,"themeSource"),this.Cy=t,this.Wa=null,this.n=null!==t?16|this.n:-17&this.n}get themeConverter(){return this.Fh}set themeConverter(t){this.h&&e.D(this),null!==t&&e.S(t,je,"themeConverter"),this.Fh=t}ofData(){return this.h&&e.D(this),this.n=2|this.n,this.Rf=null,this}zT(t,i,n,s){if(!t||(this.MN&&(i=this.Dh),!i&&0!==i))return;let o=this.themeSource;null!==this.Wa?o=this.Wa:"string"==typeof o&&o.includes(".")&&(this.Wa=o.split("."),o=this.Wa);let r=t.findValue(i,o,s);return void 0===r&&e.li(`Theme warning: ${i} could not be found when setting target property ${s}.`),e.ot(this.Fh)&&(r=this.Fh(r,n)),r}}class Ue{Nt;ig;Eo;NN;Re;wi;Rh;Ef;Bf;eg;sg;ng;og;Ly;Ja;sr;Ay;Io;F1;constructor(t,e){if(u.qi(this),this.Nt="",this.ig="",this.Eo=!1,this.NN={},this.Re=[],this.wi=new p,this.Rh="key",this.Ef=null,this.Bf=null,this.eg=!1,this.sg=!1,this.ng=!1,this.og=null,this.Ly=100,this.Ja="category",this.sr=new p,this.Ay=[],this.Io=!1,this.F1=null,this.undoManager=new B,void 0!==t&&(Array.isArray(t)?this.nodeDataArray=t:e=t),e){Object.assign(this,e);const t=e.Changed;t&&(delete this.Changed,this.addChangedListener(t))}}cloneProtected(t){t.Nt=this.Nt,t.ig=this.ig,t.Eo=this.Eo,t.Rh=this.Rh,t.Ef=this.Ef,t.Bf=this.Bf,t.eg=this.eg,t.sg=this.sg,t.ng=this.ng,t.og=this.og,t.Ly=this.Ly,t.Ja=this.Ja}copy(){const t=new this.constructor;return this.cloneProtected(t),t}clear(){this.Re=[],this.wi.clear(),this.sr.clear(),this.undoManager.clear()}toString(t){if(void 0===t&&(t=0),t>1)return this.toJson();{let i=(""!==this.name?this.name:"")+" Model";if(t>0){i+="\n node data:";const t=this.nodeDataArray,n=t.length;for(let s=0;s<n;s++){const n=t[s];i+=" "+this.getKeyForNodeData(n)+":"+e.toString(n)}}return i}}toIncrementalData(t){1!==t.change&&e.o("Model.toIncrementalData argument is not a Transaction ChangedEvent:"+t.toString());const i=t.object;if(!t.isTransactionFinished||!(i instanceof E))return null;const n=this.XT(i);return this.CN(i,"FinishedUndo"===t.propertyName,n)}CN(t,e,i){const n=this;let s=!1;const o=new u,r=new u,a=new u;t.changes.each((t=>{if(t.model===n)if("nodeDataArray"===t.modelChange)3===t.change?o.add(t.newValue):4===t.change&&a.add(t.oldValue);else if(n.containsNodeData(t.object))r.add(t.object);else if(2!==t.change||n.modelData!==t.object&&"modelData"!==t.propertyName){if(null!==t.object)if(i.has(t.object))i.get(t.object).each((t=>{n.containsNodeData(t)&&r.add(t)}));else{if(t.object instanceof Ue||n.Ba()&&n.containsLinkData(t.object))return;n.YT(t.object).each((t=>{r.add(t)}))}}else s=!0}));const l=new u;o.each((t=>{l.add(n.getKeyForNodeData(t)),e||r.add(t)}));const h=new u;a.each((t=>{h.add(n.getKeyForNodeData(t)),e&&r.add(t)}));const c=n.cloneDeep(r.toArray());let d=null;return s&&(null===d&&(d={}),d.modelData=this.cloneDeep(this.modelData)),l.count>0&&(null===d&&(d={}),e?d.removedNodeKeys=l.toArray():d.insertedNodeKeys=l.toArray()),c.length>0&&(null===d&&(d={}),d.modifiedNodeData=c),h.count>0&&(null===d&&(d={}),e?d.insertedNodeKeys=h.toArray():d.removedNodeKeys=h.toArray()),d}cloneDeep(t){return this.rg(t,!0)}rg(t,i,n,s){if(!e.H(t))return t;n||(n=new p);const o=n.get(t);if(o)return o;let r;if(Array.isArray(t)){r=[],n.set(t,r);for(let e=0;e<t.length;e++){const i=t[e];r.push(this.rg(i,!1,n,s))}}else if(t instanceof y||t instanceof x||t instanceof b||t instanceof v||t instanceof w)r=t.copy(),n.set(t,r);else{if(t instanceof Ut||t instanceof N)return t;if(t instanceof l)r=(new l).addAll(this.rg(t.toArray(),!1,n,s)),n.set(t,r);else if(t instanceof u)r=(new u).addAll(this.rg(t.toArray(),!1,n,s)),n.set(t,r);else if(t instanceof p)r=(new p).addAll(this.rg(t.toArray(),!1,n,s)),n.set(t,r);else if(t instanceof Date)r=new Date(t),n.set(t,r);else if(t instanceof RegExp)r=new RegExp(t),n.set(t,r),r.lastIndex=t.lastIndex;else if(Ue.LN(null,"",t))r=t;else if(e.ot(t.copy))r=t.copy(),n.set(t,r);else{r={},n.set(t,r);for(const e in t){if("__gohashid"===e)continue;const i=t[e];r[e]=this.rg(i,!1,n,s)}}}return r}ve(t){return JSON.stringify(t).replace(/[\u007F-\uFFFF]/g,(t=>{const e="0000"+t.charCodeAt(0).toString(16);return"\\u"+e.substring(e.length-4)}))}lg(){let t="";return""!==this.name&&(t+=',\n  "name": '+this.ve(this.name)),""!==this.dataFormat&&(t+=',\n  "dataFormat": '+this.ve(this.dataFormat)),this.isReadOnly&&(t+=',\n  "isReadOnly": '+this.isReadOnly),"key"!==this.nodeKeyProperty&&"string"==typeof this.nodeKeyProperty&&(t+=',\n  "nodeKeyProperty": '+this.ve(this.nodeKeyProperty)),this.copiesArrays&&(t+=',\n  "copiesArrays": true'),this.copiesArrayObjects&&(t+=',\n  "copiesArrayObjects": true'),this.copiesKey&&(t+=',\n  "copiesKey": true'),100!==this.pointsDigits&&(t+=',\n  "pointsDigits": '+this.pointsDigits.toString()),"category"!==this.nodeCategoryProperty&&"string"==typeof this.nodeCategoryProperty&&(t+=',\n  "nodeCategoryProperty": '+this.ve(this.nodeCategoryProperty)),t}Ty(t){t.name&&(this.name=t.name),t.dataFormat&&(this.dataFormat=t.dataFormat),t.isReadOnly&&(this.isReadOnly=!0),t.nodeKeyProperty&&(this.nodeKeyProperty=t.nodeKeyProperty),t.copiesArrays&&(this.copiesArrays=!0),t.copiesArrayObjects&&(this.copiesArrayObjects=!0),void 0!==t.copiesKey&&(this.copiesKey=t.copiesKey),void 0!==t.pointsDigits&&(this.pointsDigits=parseInt(t.pointsDigits)),t.nodeCategoryProperty&&(this.nodeCategoryProperty=t.nodeCategoryProperty)}KT(){const t=this.modelData;return',\n  "modelData": '+this.GT(t)}HT(t){const i=t.modelData;e.H(i)&&(this.replaceJsonObjects(i),this.modelData=i)}AN(){const t=this.modelData;let e=!1;for(const n in t)if(!this.R1(t,n,t[n])){e=!0;break}let i="";return e&&(i=this.KT()),i+',\n  "nodeDataArray": '+this.vh(this.nodeDataArray,!0)}TN(t){this.HT(t);const e=t.nodeDataArray;Array.isArray(e)&&(this.replaceJsonObjects(e),this.nodeDataArray=e)}DN(t,i,n){if(t===i)return!0;if(typeof t!=typeof i||e.ot(t)||e.ot(i))return!1;if(Array.isArray(t)&&Array.isArray(i)){if(n.get(t)===i)return!0;if(n.set(t,i),t.length!==i.length)return!1;for(let e=0;e<t.length;e++)if(!this.DN(t[e],i[e],n))return!1;return!0}if(e.H(t)&&e.H(i)){if(n.get(t)===i)return!0;n.set(t,i);for(const e in t){const s=t[e];if(this.R1(t,e,s))continue;const o=i[e];if(void 0===o||!this.DN(s,o,n))return!1}for(const e in i){const s=i[e];if(this.R1(i,e,s))continue;const o=t[e];if(void 0===o||!this.DN(o,s,n))return!1}return!0}return!1}static jT=',\n  "insertedNodeKeys": ';static zO=',\n  "modifiedNodeData": ';static qT=',\n  "removedNodeKeys": ';XT(t){let e=new p;const i=(t,i)=>{const n=i.part;if(!n)return;const s=n.data;if(t===s)return;let o=e.get(t);null===o?(o=new u,o.add(s),e.set(t,o)):o.add(s)};return t.changes.each((t=>{if(null!==t.diagram){const e=t.change;if(2===e){const e=t.object.panel;if(e){const t=e.data;t&&i(t,e)}}else if(3===e||4===e){const e=t.object,n=e.itemArray;n&&i(n,e)}}})),e}YT(t){const e=new u;for(let i=0;i<this.nodeDataArray.length;i++){const n=this.nodeDataArray[i];this.v1(t,n,n,e)}return e}v1(t,i,n,s){if(Array.isArray(i))for(let e=0;e<i.length;e++){const o=i[e];if(o===t)return s.add(n),!0;if(this.v1(t,o,n,s))return!0}else if(e.H(i)&&Object.getPrototypeOf(i)===Object.prototype)for(const e in i){const o=i[e];if(o===t)return s.add(n),!0;if(this.v1(t,o,n,s))return!0}return!1}FN(t,e,i){const n=this;let s=!1;const o=new u,r=new u,a=new u;t.changes.each((t=>{if(t.model===n)if("nodeDataArray"===t.modelChange)3===t.change?o.add(t.newValue):4===t.change&&a.add(t.oldValue);else if(n.containsNodeData(t.object))r.add(t.object);else if(2!==t.change||n.modelData!==t.object&&"modelData"!==t.propertyName){if(null!==t.object)if(i.has(t.object))i.get(t.object).each((t=>{n.containsNodeData(t)&&r.add(t)}));else{if(t.object instanceof Ue||n.Ba()&&n.containsLinkData(t.object))return;n.YT(t.object).each((t=>{r.add(t)}))}}else s=!0}));const l=new u;o.each((t=>{l.add(n.getKeyForNodeData(t)),e||r.add(t)}));const h=new u;a.each((t=>{h.add(n.getKeyForNodeData(t)),e&&r.add(t)}));let c="";return s&&(c+=this.KT()),l.count>0&&(c+=(e?Ue.qT:Ue.jT)+this.vh(l.toArray(),!0)),r.count>0&&(c+=Ue.zO+this.vh(r.toArray(),!0)),h.count>0&&(c+=(e?Ue.jT:Ue.qT)+this.vh(h.toArray(),!0)),c}Dy(t){(void 0!==t.name&&t.name!==this.name||void 0!==t.dataFormat&&t.dataFormat!==this.dataFormat||void 0!==t.isReadOnly&&t.isReadOnly!==this.isReadOnly||void 0!==t.nodeKeyProperty&&t.nodeKeyProperty!==this.nodeKeyProperty||void 0!==t.copiesArrays&&t.copiesArrays!==this.copiesArrays||void 0!==t.copiesArrayObjects&&t.copiesArrayObjects!==this.copiesArrayObjects||void 0!==t.copiesKey&&t.copiesKey!==this.copiesKey||void 0!==t.nodeCategoryProperty&&t.nodeCategoryProperty!==this.nodeCategoryProperty)&&e.o("applyIncrementalJson cannot change Model properties"),this.HT(t);const i=t.insertedNodeKeys,n=t.modifiedNodeData,s=new p;if(Array.isArray(n))for(let e=0;e<n.length;e++){const t=n[e],i=this.getKeyForNodeData(t);null!=i&&s.set(i,t)}if(Array.isArray(i)){const t=i.length;for(let e=0;e<t;e++){const t=i[e];let n=this.findNodeDataForKey(t);if(null===n){n=s.get(t)||this.copyNodeData({}),this.setKeyForNodeData(n,t),this.addNodeData(n)}}}if(Array.isArray(n)){const t=n.length;for(let e=0;e<t;e++){const t=n[e],i=this.getKeyForNodeData(t),s=this.findNodeDataForKey(i);if(null!==s){for(const e in t)"__gohashid"===e||e===this.nodeKeyProperty||(this.bm()||this.yb())&&e===this.nodeIsGroupProperty||this.setDataProperty(s,e,t[e]);this.hg(t,s)}}}const o=t.removedNodeKeys;if(Array.isArray(o)){const t=o.length;for(let e=0;e<t;e++){const t=o[e],i=this.findNodeDataForKey(t);null!==i&&this.removeNodeData(i)}}}toIncrementalJson(t,i){1!==t.change&&e.o("Model.toIncrementalJson argument is not a Transaction ChangedEvent:"+t.toString());const n=t.object;if(!t.isTransactionFinished||!(n instanceof E))return'{ "incremental": 0 }';void 0===i&&(i=e.Vn(this));const s=this.XT(n),o=this.FN(n,"FinishedUndo"===t.propertyName,s);return'{ "class": '+this.ve(i)+', "incremental": 1'+this.lg()+o+"}"}toIncrementalJSON(t,e){return this.toIncrementalJson(t,e)}toJson(t){return void 0===t&&(t=e.Vn(this)),'{ "class": '+this.ve(t)+this.lg()+this.AN()+"}"}toJSON(t){return this.toJson(t)}applyIncrementalJson(i){let n=null;if("string"==typeof i)try{n=t.JSON.parse(i)}catch{}else e.H(i)?n=i:e.o("Unable to modify a Model from: "+i);const s=n.incremental;"number"!=typeof s&&e.o("Unable to apply non-incremental changes to Model: "+i),0!==s&&(this.startTransaction("applyIncrementalJson"),this.Dy(n),this.commitTransaction("applyIncrementalJson"))}applyIncrementalJSON(t){return this.applyIncrementalJson(t)}static fromJson(i,n){void 0===n&&(n=null);let s=null;if("string"==typeof i)try{s=t.JSON.parse(i)}catch{}else e.H(i)?s=i:e.o("Unable to construct a Model from: "+i);if(null===n){const t=Ue.XO(s);null===t||t instanceof Ue?n=t:e.o("Unable to construct a Model of declared class: "+s.class)}return null===n&&(n=Ue.WT()),n.Ty(s),n.TN(s),n}static fromJSON(t,e){return this.fromJson(t,e)}static WT(){return new Ue}static XO(i){let n=null,s=i.class;if("string"==typeof s)try{let i=null;0===s.indexOf("go.")?i=Ue.RN(s.substring(3)):(i=Ue.RN(s),null===i&&(i=t[s])),e.ot(i)&&(n=new i)}catch{}return n}replaceJsonObjects(t){if(Array.isArray(t)){const i=t.length;for(let n=0;n<i;n++){const i=t[n];e.H(i)&&this.JT(t,n,this.replaceJsonObjects(i))}}else if(e.H(t)){for(const i in t){const n=t[i];if(e.H(n)){const e=this.replaceJsonObjects(n);if(t[i]=e,"points"===i&&Array.isArray(e)){let n=e.length%2===0;for(let t=0;t<e.length;t++)if("number"!=typeof e[t]){n=!1;break}if(n){const n=new l;for(let t=0;t<e.length/2;t++)n.add(new y(e[2*t],e[2*t+1]));n.u(),t[i]=n}}}}return this.YO(t)}return t}writeJsonValue(t){return void 0===t?"undefined":null===t?"null":!0===t?"true":!1===t?"false":"string"==typeof t?this.ve(t):"number"==typeof t?t===1/0?"9e9999":t===-1/0?"-9e9999":isNaN(t)?'{"class":"NaN"}':t.toString():t instanceof Boolean||t instanceof String||t instanceof Number?this.writeJsonValue(t.valueOf()):t instanceof Date?'{"class":"Date", "value":"'+t.toJSON()+'"}':Array.isArray(t)?this.vh(t):e.H(t)?this.GT(t):e.ot(t)?"null":'"'+t.toString()+'"'}vh(t,e){void 0===e&&(e=!1);const n=t.length;if(n<=0)return"[]";const s=new i;s.add("["),e&&n>1&&s.add("\n");for(let i=0;i<n;i++){const n=t[i];void 0!==n&&(i>0&&(s.add(","),e&&s.add("\n")),s.add(this.writeJsonValue(n)))}return e&&n>1&&s.add("\n"),s.add("]"),s.toString()}R1(t,i,n){return!(void 0!==n&&"__gohashid"!==i&&"_"!==i[0]&&!e.ot(n))}Hi(t){return isNaN(t)?"NaN":t===1/0?"9e9999":t===-1/0?"-9e9999":t}GT(t){const e=t;if(e instanceof y)t={class:"go.Point",x:this.Hi(e.x),y:this.Hi(e.y)};else if(e instanceof x)t={class:"go.Size",width:this.Hi(e.width),height:this.Hi(e.height)};else if(e instanceof b)t={class:"go.Rect",x:this.Hi(e.x),y:this.Hi(e.y),width:this.Hi(e.width),height:this.Hi(e.height)};else if(e instanceof v)t={class:"go.Margin",top:this.Hi(e.top),right:this.Hi(e.right),bottom:this.Hi(e.bottom),left:this.Hi(e.left)};else if(e instanceof w)t=e.isSpot()?{class:"go.Spot",x:this.Hi(e.x),y:this.Hi(e.y),offsetX:this.Hi(e.offsetX),offsetY:this.Hi(e.offsetY)}:{class:"go.Spot",enum:e.toString()};else if(e instanceof Ut){if(t={class:"go.Brush",type:zt[e.type]},1===e.type?t.color=e.color:(2===e.type||3===e.type)&&(t.start=e.start,t.end=e.end,3===e.type&&(0!==e.startRadius&&(t.startRadius=this.Hi(e.startRadius)),isNaN(e.endRadius)||(t.endRadius=this.Hi(e.endRadius)))),null!==e.colorStops){const i={},n=e.colorStops.iterator;for(;n.next();){const t=n.key,e=n.value;i[t]=e}t.colorStops=i}}else if(e instanceof N)t={class:"go.Geometry",type:M[e.type]},0!==e.startX&&(t.startX=this.Hi(e.startX)),0!==e.startY&&(t.startY=this.Hi(e.startY)),0!==e.endX&&(t.endX=this.Hi(e.endX)),0!==e.endY&&(t.endY=this.Hi(e.endY)),e.spot1.equals(w.TopLeft)||(t.spot1=e.spot1),e.spot2.equals(w.BottomRight)||(t.spot2=e.spot2),4===e.type&&(t.path=N.stringify(e));else if(Ue.LN(null,"",e))return"{}";let i="{",n=!0;for(const s in t){const e=this.bt(t,s);if(!this.R1(t,s,e))if(n?n=!1:i+=",",i+=this.ve(s)+":","points"===s&&e instanceof l){let t="[";const n=e.iterator;for(;n.next();){const e=n.value;t.length>1&&(t+=","),t+=this.$T(e.x),t+=",",t+=this.$T(e.y)}t+="]",i+=t}else i+=this.writeJsonValue(e)}return i+="}",i}$T(t){if(t===1/0)return"9e9999";if(t===-1/0)return"-9e9999";if(isNaN(t))return"0";const e=this.pointsDigits;return e>16?t.toString():t.toFixed(e)}get pointsDigits(){return this.Ly}set pointsDigits(t){t<0?t=0:t>100&&(t=100),this.Ly=t}ji(t){return"number"==typeof t?t:"NaN"===t?NaN:"9e9999"===t?1/0:"-9e9999"===t?-1/0:parseFloat(t)}YO(t){if(!e.H(t))return t;let i=t.class||"";if("string"!=typeof i||""===i)return t;if("NaN"===i)return NaN;if("Date"===i)return new Date(t.value);if(0!==i.indexOf("go."))return t;i=i.substring(3);let n=t;if("Point"===i)n=new y(this.ji(t.x),this.ji(t.y));else if("Size"===i)n=new x(this.ji(t.width),this.ji(t.height));else if("Rect"===i)n=new b(this.ji(t.x),this.ji(t.y),this.ji(t.width),this.ji(t.height));else if("Margin"===i)n=new v(this.ji(t.top),this.ji(t.right),this.ji(t.bottom),this.ji(t.left));else if("Spot"===i)n="string"==typeof t.enum?w.parse(t.enum):new w(this.ji(t.x),this.ji(t.y),this.ji(t.offsetX),this.ji(t.offsetY));else if("Brush"===i){const i=new Ut;i.type=e.Xh(zt,t.type)??1,"string"==typeof t.color&&(i.color=t.color),t.start instanceof w&&(i.start=t.start),t.end instanceof w&&(i.end=t.end),"number"==typeof t.startRadius&&(i.startRadius=this.ji(t.startRadius)),"number"==typeof t.endRadius&&(i.endRadius=this.ji(t.endRadius));const s=t.colorStops;if(e.H(s))for(const t in s){const e=parseFloat(t);i.addColorStop(e,s[t])}n=i}else if("Geometry"===i){let i=null;i="string"==typeof t.path?N.parse(t.path):new N,i.type=e.Xh(M,t.type)??1,"number"==typeof t.startX&&(i.startX=this.ji(t.startX)),"number"==typeof t.startY&&(i.startY=this.ji(t.startY)),"number"==typeof t.endX&&(i.endX=this.ji(t.endX)),"number"==typeof t.endY&&(i.endY=this.ji(t.endY)),t.spot1 instanceof w&&(i.spot1=t.spot1),t.spot2 instanceof w&&(i.spot2=t.spot2),n=i}else if("EnumValue"===i){let i=t.classType;0===i.indexOf("go.")&&(i=i.substring(3));const s=Ue.RN(i);e.ot(s)&&(n=e.Xh(s,t.name))}return n}get name(){return this.Nt}set name(t){const i=this.Nt;i!==t&&(e.s(t,"string",Ue,"name"),this.Nt=t,this.t("name",i,t))}get dataFormat(){return this.ig}set dataFormat(t){const i=this.ig;i!==t&&(e.s(t,"string",Ue,"dataFormat"),this.ig=t,this.t("dataFormat",i,t))}get isReadOnly(){return this.Eo}set isReadOnly(t){const i=this.Eo;i!==t&&(e.s(t,"boolean",Ue,"isReadOnly"),this.Eo=t,this.t("isReadOnly",i,t))}get modelData(){return this.NN}set modelData(t){const i=this.modelData;i!==t&&(e.lc(t,Ue,"modelData"),this.containsNodeData(t)&&e.o("Model.modelData Object must not be used by the rest of the model: "+t),this.NN=t,this.t("modelData",i,t),this.updateTargetBindings(t))}addChangedListener(t){return e.S(t,Ue,"addChangedListener:listener"),this.Ay.push(t),this}removeChangedListener(t){e.S(t,Ue,"removeChangedListener:listener");const i=this.Ay.indexOf(t);i>=0&&this.Ay.splice(i,1)}RM(t){this.skipsUndoManager||this.undoManager.handleChanged(t),this.ZT(t)}ZT(t){this.Ay.forEach((e=>e(t)))}rF(t){this.ZT(t)}raiseChangedEvent(t,e,i,n,s,o,r){this.Bt("",t,e,i,n,s,o,r)}raiseChanged(t,e,i,n,s){this.Bt("",2,t,this,e,i,n,s)}t(t,e,i,n,s){this.Bt("",2,t,this,e,i,n,s)}raiseDataChanged(t,e,i,n,s,o){this.Bt("",2,e,t,i,n,s,o)}Bt(t,e,i,n,s,o,r,a){void 0===r&&(r=null),void 0===a&&(a=null);const l=new R;l.model=this,l.change=e,l.modelChange=t,l.propertyName=i,l.object=n,l.oldValue=s,l.oldParam=r,l.newValue=o,l.newParam=a,this.RM(l)}get undoManager(){return this.F1}set undoManager(t){const e=this.F1;e!==t&&(null!==e&&e.removeModel(this),this.F1=t,null!==t&&t.addModel(this))}get skipsUndoManager(){return this.Io}set skipsUndoManager(t){e.s(t,"boolean",Ue,"skipsUndoManager"),this.Io=t}changeState(t,i){if(null!==t&&t.model===this)if(2===t.change){const e=t.object,n=t.propertyName,s=t.getValue(i);if(n===this.nodeKeyProperty&&this.containsNodeData(e)){const n=t.getValue(!i);void 0!==n&&this.wi.delete(n),void 0!==s&&this.wi.set(s,e)}this.et(e,n,s)}else if(3===t.change){const n=t.newParam;if("nodeDataArray"===t.modelChange){const s=t.newValue;if(e.H(s)&&"number"==typeof n){const t=this.getKeyForNodeData(s);i?(this.Re[n]===s&&this.Po(this.Re,n),void 0!==t&&this.wi.delete(t)):(this.Re[n]!==s&&this.nr(this.Re,n,s),void 0!==t&&this.wi.set(t,s))}}else if(""===t.modelChange){let e=t.object;if(e&&!Array.isArray(e)&&t.propertyName&&(e=this.bt(e,t.propertyName)),Array.isArray(e)&&"number"==typeof n){const s=t.newValue;i?this.Po(e,n):this.nr(e,n,s)}}else e.o("unknown ChangeType.Insert modelChange: "+t.toString())}else if(4===t.change){const n=t.oldParam;if("nodeDataArray"===t.modelChange){const s=t.oldValue;if(e.H(s)&&"number"==typeof n){const t=this.getKeyForNodeData(s);i?(this.Re[n]!==s&&this.nr(this.Re,n,s),void 0!==t&&this.wi.set(t,s)):(this.Re[n]===s&&this.Po(this.Re,n),void 0!==t&&this.wi.delete(t))}}else if(""===t.modelChange){let e=t.object;if(e&&!Array.isArray(e)&&t.propertyName&&(e=this.bt(e,t.propertyName)),Array.isArray(e)&&"number"==typeof n){const s=t.oldValue;i?this.nr(e,n,s):this.Po(e,n)}}else e.o("unknown ChangeType.Remove modelChange: "+t.toString())}else 1===t.change||e.o("unknown ChangedEvent: "+t.toString())}startTransaction(t){return this.undoManager.startTransaction(t)}commitTransaction(t){return this.undoManager.commitTransaction(t)}rollbackTransaction(){return this.undoManager.rollbackTransaction()}commit(t,e){let i=e;void 0===i&&(i="");const n=this.skipsUndoManager;null===i&&(this.skipsUndoManager=!0,i=""),this.undoManager.startTransaction(i);let s=!1;try{t(this),s=!0}finally{s?this.undoManager.commitTransaction(i):this.undoManager.rollbackTransaction(),this.skipsUndoManager=n}}updateTargetBindings(t,e){void 0===e&&(e=""),this.Bt("SourceChanged",1,e,t,null,null)}get nodeKeyProperty(){return this.Rh}set nodeKeyProperty(t){const i=this.Rh;i!==t&&(this.Fn(t,Ue,"nodeKeyProperty"),""===t&&e.o("Model.nodeKeyProperty may not be the empty string"),this.wi.count>0&&e.o("Cannot set Model.nodeKeyProperty when there is existing node data"),this.Rh=t,this.t("nodeKeyProperty",i,t))}Fn(t,i,n){"string"!=typeof t&&!e.ot(t)&&e.te(t,"string or function",i,n)}getKeyForNodeData(t){if(null===t)return;const i=this.Rh;if(""===i)return;const n=this.bt(t,i);if(void 0!==n){if(this.isKeyType(n))return n;e.o("Key value for node data "+t+" is not a number or a string: "+n)}}setKeyForNodeData(t,i){if((null==i||!this.isKeyType(i))&&e.te(i,"number or string",Ue,"setKeyForNodeData:key"),null===t)return;const n=this.Rh;if(""===n)return;if(!this.containsNodeData(t))return void this.et(t,n,i);const s=this.bt(t,n);if(s!==i){if(null!==this.findNodeDataForKey(i))return;this.et(t,n,i),void 0!==s&&this.wi.delete(s),this.wi.set(i,t),this.Bt("nodeKey",2,n,t,s,i),"string"==typeof n&&this.updateTargetBindings(t,n),this.Fy(s,i)}}get makeUniqueKeyFunction(){return this.Ef}set makeUniqueKeyFunction(t){const i=this.Ef;i!==t&&(null!==t&&e.S(t,Ue,"makeUniqueKeyFunction"),this.Ef=t,this.t("makeUniqueKeyFunction",i,t))}isKeyType(t){return"number"==typeof t||"string"==typeof t}containsNodeData(t){if(null===t)return!1;const e=this.getKeyForNodeData(t);return void 0!==e&&this.wi.get(e)===t}findNodeDataForKey(t){return null===t&&e.o("Model.findNodeDataForKey:key must not be null"),void 0!==t&&this.isKeyType(t)?this.wi.get(t):null}get nodeDataArray(){return this.Re}set nodeDataArray(t){const i=this.Re;if(i!==t){this.vN(t,Ue,"nodeDataArray"),this.wi.clear(),this.ON();const n=t.length;for(let i=0;i<n;i++){const n=t[i];e.H(n)||e.o("Model.nodeDataArray must only contain Objects, not: "+n),n===this.modelData&&e.o("nodeDataArray Objects must not be the shared Model.modelData")}this.Re=t;const s=new l;for(let e=0;e<n;e++){const i=t[e],n=this.getKeyForNodeData(i);void 0===n||null!==this.wi.get(n)?s.add(i):this.wi.set(n,i)}const o=s.iterator;for(;o.next();){const t=o.value;this.makeNodeDataKeyUnique(t);const e=this.getKeyForNodeData(t);void 0!==e&&this.wi.set(e,t)}this.Bt("nodeDataArray",2,"nodeDataArray",this,i,t);for(let e=0;e<n;e++){const i=t[e];this.ag(i),this.cg(i)}}}O1(t){return void 0!==t&&this.wi.has(t)}makeNodeDataKeyUnique(t){if(null===t)return;const e=this.Rh;if(""===e)return;let i=this.getKeyForNodeData(t);if(void 0!==i&&!this.O1(i))return;const n=this.Ef;if(null===n||(i=n(this,t),null==i||this.O1(i))){if("string"==typeof i){let n=2;for(;this.O1(i+n);)n++;this.et(t,e,i+n)}else if(void 0===i||"number"==typeof i){let i=-this.wi.count-1;for(;this.O1(i);)i--;this.et(t,e,i)}}else this.et(t,e,i)}addNodeData(t){null!==t&&(t===this.modelData&&e.o("Model.addNodeData cannot add the shared Model.modelData Object"),this.containsNodeData(t)||this.vT(t,!0))}vT(t,i){let n=this.getKeyForNodeData(t);if(void 0===n)this.makeNodeDataKeyUnique(t),n=this.getKeyForNodeData(t);else{if(this.wi.get(n)===t)return;this.makeNodeDataKeyUnique(t),n=this.getKeyForNodeData(t)}void 0===n&&e.o("Model.makeNodeDataKeyUnique failed on "+t+".  Data not added to Model."),this.wi.set(n,t);let s=null;i&&(s=this.Re.length,this.nr(this.Re,s,t)),this.Bt("nodeDataArray",3,"nodeDataArray",this,null,t,null,s),this.ag(t),this.cg(t)}addNodeDataCollection(t){if(Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++)this.addNodeData(t[i])}else{const e=t.iterator;for(;e.next();){const t=e.value;this.addNodeData(t)}}}removeNodeData(t){null!==t&&this.RT(t,!0)}RT(t,e){const i=this.getKeyForNodeData(t);void 0!==i&&this.wi.delete(i);let n=null;if(e){if(n=this.Re.indexOf(t),n<0)return;this.Po(this.Re,n)}this.Bt("nodeDataArray",4,"nodeDataArray",this,t,null,n,null),this.Ry(t)}removeNodeDataCollection(t){if(Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++)this.removeNodeData(t[i])}else{const e=t.iterator;for(;e.next();){const t=e.value;this.removeNodeData(t)}}}mergeNodeDataArray(t){if(t===this.nodeDataArray||!Array.isArray(t))return;const e=new u;e.addAll(this.wi.iteratorKeys);const i=new u,n=t.length;for(let o=0;o<n;o++){const e=t[o],n=this.getKeyForNodeData(e);if(void 0!==n){i.add(n);const t=this.findNodeDataForKey(n);if(t===e)continue;if(null!==t)this.assignAllDataProperties(t,e),this.hg(e,t);else{const t=this.cloneDeep(e);this.setKeyForNodeData(t,n),this.addNodeData(t)}}else{const t=this.cloneDeep(e);this.addNodeData(t),i.add(this.getKeyForNodeData(t))}}const s=e.iterator;for(;s.next();){const t=s.value;if(!i.has(t)){const e=this.findNodeDataForKey(t);e&&this.removeNodeData(e)}}}Fy(t,e){if(void 0===e)return;const i=this.Ny(t);i instanceof u&&this.sr.set(e,i)}ON(){}ag(t){}cg(t){}Ry(t){}tn(t,e){if(void 0===t)return;let i=this.sr.get(t);null===i&&(i=new u,this.sr.set(t,i)),i.add(e)}_s(t,e){if(void 0===t)return;const i=this.sr.get(t);i instanceof u&&(null==e?this.sr.delete(t):(i.delete(e),0===i.count&&this.sr.delete(t)))}Ny(t){if(void 0===t)return null;const e=this.sr.get(t);return e instanceof u?e:null}LE(t){void 0===t?this.sr.clear():this.sr.delete(t)}get copyNodeDataFunction(){return this.Bf}set copyNodeDataFunction(t){const i=this.Bf;i!==t&&(null!==t&&e.S(t,Ue,"copyNodeDataFunction"),this.Bf=t,this.t("copyNodeDataFunction",i,t))}get copiesArrays(){return this.eg}set copiesArrays(t){const i=this.eg;i!==t&&(null!==t&&e.s(t,"boolean",Ue,"copiesArrays"),this.eg=t,this.t("copiesArrays",i,t))}get copiesArrayObjects(){return this.sg}set copiesArrayObjects(t){const i=this.sg;i!==t&&(null!==t&&e.s(t,"boolean",Ue,"copiesArrayObjects"),this.sg=t,this.t("copiesArrayObjects",i,t))}get copiesKey(){return this.ng}set copiesKey(t){const i=this.ng;i!==t&&(null!==t&&e.s(t,"boolean",Ue,"copiesKey"),this.ng=t,this.t("copiesKey",i,t))}copyNodeData(t){if(null===t)return null;let i=null;const n=this.Bf;return i=null!==n?n(t,this):this.I1(t,!0),e.H(i),i}I1(t,i){if(e.H(t)){if(Array.isArray(t)){if(this.copiesArrays){const e=t,i=[];for(let t=0;t<e.length;t++){const n=e[t],s=this.I1(n,this.copiesArrayObjects);i.push(s)}return i}return t}if(t instanceof y||t instanceof x||t instanceof b||t instanceof v||t instanceof w)return t.copy();if(i){const i=t,n=i.constructor,s=n?new n:{},o=this.copiesKey||"string"!=typeof this.nodeKeyProperty?null:this.nodeKeyProperty;for(const t in i){if("__gohashid"===t){s.__gohashid=void 0;continue}if(t===o){s[o]=void 0;continue}const n=this.bt(i,t);if(e.H(n))if(Ue.LN(i,t,n))this.et(s,t,n);else{const e=this.I1(n,!1);this.et(s,t,e)}else s[t]=n}return s}return t}return t}get afterCopyFunction(){return this.og}set afterCopyFunction(t){const i=this.og;i!==t&&(null!==t&&e.S(t,Ue,"afterCopyFunction"),this.og=t,this.t("afterCopyFunction",i,t))}static LN(t,i,n){const s=e.Vn(n);return n instanceof Ue||n instanceof B||n instanceof E||n instanceof R||n instanceof At||n instanceof $t||n instanceof bt||n instanceof EventTarget||"Layer"===s||"RowColumnDefinition"===s||s.indexOf("Animation")>=0||s.indexOf("Tool")>=0||s.indexOf("CommandHandler")>=0||s.indexOf("Layout")>=0}static QT=!1;setDataProperty(t,i,n){if(this.containsNodeData(t)){if(i===this.nodeKeyProperty)return void this.setKeyForNodeData(t,n);if(i===this.nodeCategoryProperty)return void this.setCategoryForNodeData(t,n)}else!Ue.QT&&t instanceof At&&(Ue.QT=!0,e.li('Model.setDataProperty is modifying a GraphObject, "'+t.toString()+'"'),e.li("  Is that really your intent?"));const s=this.bt(t,i);s!==n&&(this.et(t,i,n),this.raiseDataChanged(t,i,s,n))}set(t,e,i){this.setDataProperty(t,e,i)}assignAllDataProperties(t,e){if(!e)return;const i=this.containsNodeData(t);for(const n in e)"__gohashid"!==n&&(i&&n===this.nodeKeyProperty||this.setDataProperty(t,n,e[n]))}addArrayItem(t,e){this.insertArrayItem(t,-1,e)}insertArrayItem(t,e,i){e<0&&(e=t.length),t=this.nr(t,e,i),this.Bt("",3,"",t,null,i,null,e)}removeArrayItem(t,i){void 0===i&&(i=-1),t===this.Re&&e.o("Model.removeArrayItem should not be called on the Model.nodeDataArray"),-1===i&&(i=t.length-1);const n=t[i];t=this.Po(t,i),this.Bt("",4,"",t,n,null,i,null)}get nodeCategoryProperty(){return this.Ja}set nodeCategoryProperty(t){const e=this.Ja;e!==t&&(this.Fn(t,Ue,"nodeCategoryProperty"),this.Ja=t,this.t("nodeCategoryProperty",e,t))}getCategoryForNodeData(t){if(null===t)return"";const i=this.Ja;if(""===i)return"";const n=this.bt(t,i);return void 0===n?"":"string"==typeof n?n:void e.o("getCategoryForNodeData found a non-string category for "+t+": "+n)}setCategoryForNodeData(t,i){if(e.s(i,"string",Ue,"setCategoryForNodeData:cat"),null===t)return;const n=this.Ja;if(""===n)return;if(!this.containsNodeData(t))return void this.et(t,n,i);let s=this.bt(t,n);void 0===s&&(s=""),s!==i&&(this.et(t,n,i),this.Bt("nodeCategory",2,n,t,s,i))}hg(t,e){this.setCategoryForNodeData(e,this.getCategoryForNodeData(t))}get type(){return"Model"}km(){return!1}bm(){return!1}yb(){return!1}Ba(){return!1}Uw(){return!1}Qc(){return!1}static bM(){return new Ue}bt(t,e){return Ue.bt(t,e)}static bt(t,i){if(!t||!i)return null;let n;try{e.ot(i)?n=i(t):e.ot(t.getAttribute)?(n=t.getAttribute(i),null===n&&(n=void 0)):n=t[i]}catch{}return n}et(t,e,i){Ue.et(t,e,i)}static et(t,i,n){if(t&&i){try{e.ot(i)?i(t,n):e.ot(t.setAttribute)?t.setAttribute(i,n):t[i]=n}catch{}return t}}vN(t,i,n){Array.isArray(t)||e.te(t,"Array",i,n)}JT(t,e,i){return t[e]=i,t}nr(t,e,i){return e>=t.length?t.push(i):t.splice(e,0,i),t}Po(t,e){return e>=t.length?t.pop():t.splice(e,1),t}static RN(e){return Ue.IN[e]?Ue.IN[e]:void 0!==t.go&&t.go[e]?t.go[e]:null}static wl(t,e){Ue.IN[e]=t}static IN={};static#t=(()=>(Ue.wl(Ut,"Brush"),Ue.wl(N,"Geometry"),Ue.wl(v,"Margin"),Ue.wl(y,"Point"),Ue.wl(b,"Rect"),Ue.wl(x,"Size"),Ue.wl(w,"Spot"),Ue.wl(Ue,"Model")))()}Ue.fromJSON=Ue.fromJson=Ue.fromJson;class Ge extends Ue{Ns;or;vi;Oh;Uf;Vf;vl;So;Mo;$a;Za;Qa;en;zf;Rn;fg;constructor(t,e,i){if(super(),this.Ns=[],this.or=new u,this.vi=new p,this.Oh="",this.Uf=null,this.Vf=null,this.vl=null,this.So="from",this.Mo="to",this.$a="",this.Za="",this.Qa="category",this.en="",this.zf="isGroup",this.Rn="group",this.fg=!1,void 0!==e&&(this.linkDataArray=e),void 0!==t&&(Array.isArray(t)?this.nodeDataArray=t:i=t),i){Object.assign(this,i);const t=i.Changed;t&&(delete this.Changed,this.addChangedListener(t))}}cloneProtected(t){super.cloneProtected(t),t.Oh=this.Oh,t.Uf=this.Uf,t.Vf=this.Vf,t.So=this.So,t.Mo=this.Mo,t.$a=this.$a,t.Za=this.Za,t.Qa=this.Qa,t.en=this.en,t.zf=this.zf,t.Rn=this.Rn,t.fg=this.fg}clear(){this.Ns=[],this.vi.clear(),this.or.clear(),super.clear()}toString(t){if(void 0===t&&(t=0),t>=2)return this.toJson();{let e=(""!==this.name?this.name:"")+" GraphLinksModel";if(t>0){e+="\n node data:";let t=this.nodeDataArray,i=t.length,n=0;for(n=0;n<i;n++){const i=t[n];e+=" "+this.getKeyForNodeData(i)+":"+Ve.toString(i)}for(e+="\n link data:",t=this.linkDataArray,i=t.length,n=0;n<i;n++){const i=t[n];e+=" "+this.Fe(i,!0)+"--\x3e"+this.Fe(i,!1)}}return e}}CN(t,e,i){if(""===this.linkKeyProperty){const t=this.skipsUndoManager;this.skipsUndoManager=!0,this.linkKeyProperty="key",this.skipsUndoManager=t}let n=super.CN(t,e,i);const s=this,o=new u,r=new u,a=new u;t.changes.each((t=>{if(t.model===s)if("linkDataArray"===t.modelChange)3===t.change?o.add(t.newValue):4===t.change&&a.add(t.oldValue);else if(s.containsLinkData(t.object))r.add(t.object);else if(null!==t.object)if(null!==t.object&&i.has(t.object))i.get(t.object).each((t=>{s.containsLinkData(t)&&r.add(t)}));else{if(t.object instanceof Ue||s.containsNodeData(t.object))return;s._T(t.object).each((t=>r.add(t)))}}));const l=new u;o.each((t=>{l.add(s.getKeyForLinkData(t)),e||r.add(t)}));const h=new u;a.each((t=>{h.add(s.getKeyForLinkData(t)),e&&r.add(t)}));const c=s.cloneDeep(r.toArray());return l.count>0&&(null===n&&(n={}),e?n.removedLinkKeys=l.toArray():n.insertedLinkKeys=l.toArray()),c.length>0&&(null===n&&(n={}),n.modifiedLinkData=c),h.count>0&&(null===n&&(n={}),e?n.insertedLinkKeys=h.toArray():n.removedLinkKeys=h.toArray()),n}lg(){const t=super.lg();let e="";return"category"!==this.linkCategoryProperty&&"string"==typeof this.linkCategoryProperty&&(e+=',\n  "linkCategoryProperty": '+this.ve(this.linkCategoryProperty)),""!==this.linkKeyProperty&&"string"==typeof this.linkKeyProperty&&(e+=',\n  "linkKeyProperty": '+this.ve(this.linkKeyProperty)),"from"!==this.linkFromKeyProperty&&"string"==typeof this.linkFromKeyProperty&&(e+=',\n  "linkFromKeyProperty": '+this.ve(this.linkFromKeyProperty)),"to"!==this.linkToKeyProperty&&"string"==typeof this.linkToKeyProperty&&(e+=',\n  "linkToKeyProperty": '+this.ve(this.linkToKeyProperty)),""!==this.linkFromPortIdProperty&&"string"==typeof this.linkFromPortIdProperty&&(e+=',\n  "linkFromPortIdProperty": '+this.ve(this.linkFromPortIdProperty)),""!==this.linkToPortIdProperty&&"string"==typeof this.linkToPortIdProperty&&(e+=',\n  "linkToPortIdProperty": '+this.ve(this.linkToPortIdProperty)),""!==this.linkLabelKeysProperty&&"string"==typeof this.linkLabelKeysProperty&&(e+=',\n  "linkLabelKeysProperty": '+this.ve(this.linkLabelKeysProperty)),"isGroup"!==this.nodeIsGroupProperty&&"string"==typeof this.nodeIsGroupProperty&&(e+=',\n  "nodeIsGroupProperty": '+this.ve(this.nodeIsGroupProperty)),"group"!==this.nodeGroupKeyProperty&&"string"==typeof this.nodeGroupKeyProperty&&(e+=',\n  "nodeGroupKeyProperty": '+this.ve(this.nodeGroupKeyProperty)),t+e}Ty(t){super.Ty(t),t.linkKeyProperty&&(this.linkKeyProperty=t.linkKeyProperty),t.linkFromKeyProperty&&(this.linkFromKeyProperty=t.linkFromKeyProperty),t.linkToKeyProperty&&(this.linkToKeyProperty=t.linkToKeyProperty),t.linkFromPortIdProperty&&(this.linkFromPortIdProperty=t.linkFromPortIdProperty),t.linkToPortIdProperty&&(this.linkToPortIdProperty=t.linkToPortIdProperty),t.linkCategoryProperty&&(this.linkCategoryProperty=t.linkCategoryProperty),t.linkLabelKeysProperty&&(this.linkLabelKeysProperty=t.linkLabelKeysProperty),t.nodeIsGroupProperty&&(this.nodeIsGroupProperty=t.nodeIsGroupProperty),t.nodeGroupKeyProperty&&(this.nodeGroupKeyProperty=t.nodeGroupKeyProperty)}AN(){return super.AN()+(',\n  "linkDataArray": '+this.vh(this.linkDataArray,!0))}TN(t){super.TN(t);const e=t.linkDataArray;Array.isArray(e)&&(this.replaceJsonObjects(e),this.linkDataArray=e)}tD=',\n  "insertedLinkKeys": ';KO=',\n  "modifiedLinkData": ';iD=',\n  "removedLinkKeys": ';_T(t){const e=new u;for(let i=0;i<this.linkDataArray.length;i++){const n=this.linkDataArray[i];this.v1(t,n,n,e)}return e}FN(t,e,i){if(""===this.linkKeyProperty){const t=this.skipsUndoManager;this.skipsUndoManager=!0,this.linkKeyProperty="key",this.skipsUndoManager=t}const n=super.FN(t,e,i),s=this,o=new u,r=new u,a=new u;t.changes.each((t=>{if(t.model===s)if("linkDataArray"===t.modelChange)3===t.change?o.add(t.newValue):4===t.change&&a.add(t.oldValue);else if(s.containsLinkData(t.object))r.add(t.object);else if(null!==t.object)if(null!==t.object&&i.has(t.object))i.get(t.object).each((t=>{s.containsLinkData(t)&&r.add(t)}));else{if(t.object instanceof Ue||s.containsNodeData(t.object))return;s._T(t.object).each((t=>r.add(t)))}}));const l=new u;o.each((t=>{l.add(s.getKeyForLinkData(t)),e||r.add(t)}));const h=new u;a.each((t=>{h.add(s.getKeyForLinkData(t)),e&&r.add(t)}));let c=n;return l.count>0&&(c+=(e?this.iD:this.tD)+this.vh(l.toArray(),!0)),r.count>0&&(c+=this.KO+this.vh(r.toArray(),!0)),h.count>0&&(c+=(e?this.tD:this.iD)+this.vh(h.toArray(),!0)),c}Dy(t){(void 0!==t.linkCategoryProperty&&t.linkCategoryProperty!==this.linkCategoryProperty||void 0!==t.linkKeyProperty&&t.linkKeyProperty!==this.linkKeyProperty||void 0!==t.linkFromKeyProperty&&t.linkFromKeyProperty!==this.linkFromKeyProperty||void 0!==t.linkToKeyProperty&&t.linkToKeyProperty!==this.linkToKeyProperty||void 0!==t.linkFromPortIdProperty&&t.linkFromPortIdProperty!==this.linkFromPortIdProperty||void 0!==t.linkToPortIdProperty&&t.linkToPortIdProperty!==this.linkToPortIdProperty||void 0!==t.linkLabelKeysProperty&&t.linkLabelKeysProperty!==this.linkLabelKeysProperty||void 0!==t.nodeIsGroupProperty&&t.nodeIsGroupProperty!==this.nodeIsGroupProperty||void 0!==t.nodeGroupKeyProperty&&t.nodeGroupKeyProperty!==this.nodeGroupKeyProperty)&&e.o("applyIncrementalJson cannot change Model properties"),super.Dy(t);const i=t.insertedLinkKeys;if(Array.isArray(i)){const t=i.length;for(let e=0;e<t;e++){const t=i[e];let n=this.findLinkDataForKey(t);null===n&&(n=this.copyLinkData({}),this.setKeyForLinkData(n,t),this.addLinkData(n))}}const n=t.modifiedLinkData;if(Array.isArray(n)){const t=n.length;for(let e=0;e<t;e++){const t=n[e],i=this.getKeyForLinkData(t),s=this.findLinkDataForKey(i);if(null!==s){for(const e in t)"__gohashid"===e||e===this.linkKeyProperty||this.setDataProperty(s,e,t[e]);this.eD(t,s)}}}const s=t.removedLinkKeys;if(Array.isArray(s)){const t=s.length;for(let e=0;e<t;e++){const t=s[e],i=this.findLinkDataForKey(t);null!==i&&this.removeLinkData(i)}}}changeState(t,i){if(null!==t&&t.model===this){if(2===t.change){const e=t.object,n=t.propertyName;if(n===this.linkKeyProperty&&this.containsLinkData(e)){const s=t.getValue(i),o=t.getValue(!i);return void 0!==o&&this.vi.delete(o),void 0!==s&&this.vi.set(s,e),void this.et(e,n,s)}}else if(3===t.change){let n=t.newParam;if("linkDataArray"===t.modelChange){const s=t.newValue;if(e.H(s)&&"number"==typeof n){const t=this.getKeyForLinkData(s);i?(this.or.delete(s),this.Ns[n]===s&&this.Po(this.linkDataArray,n),void 0!==t&&this.vi.delete(t)):(this.or.add(s),this.Ns[n]!==s&&this.nr(this.Ns,n,s),void 0!==t&&this.vi.set(t,s))}return}if("linkLabelKeys"===t.modelChange){const e=t.object,s=this.getLabelKeysForLinkData(e);return void(Array.isArray(s)&&"number"==typeof n&&(i?(n=s.indexOf(t.newValue),n>=0&&this.Po(s,n)):s.indexOf(t.newValue)<0&&this.nr(s,n,t.newValue)))}}else if(4===t.change){let n=t.oldParam;if("linkDataArray"===t.modelChange){const s=t.oldValue;if(e.H(s)&&"number"==typeof n){const t=this.getKeyForLinkData(s);i?(this.or.add(s),this.Ns[n]!==s&&this.nr(this.Ns,n,s),void 0!==t&&this.vi.set(t,s)):(this.or.delete(s),this.Ns[n]===s&&this.Po(this.linkDataArray,n),void 0!==t&&this.vi.delete(t))}return}if("linkLabelKeys"===t.modelChange){const e=t.object,s=this.getLabelKeysForLinkData(e);return void(Array.isArray(s)&&"number"==typeof n&&(i?s.indexOf(t.oldValue)<0&&this.nr(s,n,t.oldValue):(n=s.indexOf(t.oldValue),n>=0&&this.Po(s,n))))}}super.changeState(t,i)}}get archetypeNodeData(){return this.vl}set archetypeNodeData(t){const i=this.vl;i!==t&&(null!==t&&e.lc(t,Ge,"archetypeNodeData"),this.vl=t,this.t("archetypeNodeData",i,t))}EN(t){if(void 0===t)return;const e=this.vl;if(null!==e){let i=this.findNodeDataForKey(t);null===i&&(i=this.copyNodeData(e),this.et(i,this.nodeKeyProperty,t),this.addNodeData(i))}return t}get linkFromKeyProperty(){return this.So}set linkFromKeyProperty(t){const e=this.So;e!==t&&(this.Fn(t,Ge,"linkFromKeyProperty"),this.So=t,this.t("linkFromKeyProperty",e,t))}getFromKeyForLinkData(t){return this.Fe(t,!0)}setFromKeyForLinkData(t,e){this._d(t,e,!0)}get linkToKeyProperty(){return this.Mo}set linkToKeyProperty(t){const e=this.Mo;e!==t&&(this.Fn(t,Ge,"linkToKeyProperty"),this.Mo=t,this.t("linkToKeyProperty",e,t))}getToKeyForLinkData(t){return this.Fe(t,!1)}setToKeyForLinkData(t,e){this._d(t,e,!1)}Fe(t,i){if(null===t)return;const n=i?this.So:this.Mo;if(""===n)return;const s=this.bt(t,n);if(void 0!==s){if(this.isKeyType(s))return s;e.o((i?"FromKey":"ToKey")+" value for link data "+t+" is not a number or a string: "+s)}}_d(t,i,n){if(null===i&&(i=void 0),void 0!==i&&!this.isKeyType(i)&&e.te(i,"number or string",Ge,n?"setFromKeyForLinkData:key":"setToKeyForLinkData:key"),null===t)return;const s=n?this.So:this.Mo;if(""===s)return;if(i=this.EN(i),!this.containsLinkData(t))return void this.et(t,s,i);const o=this.bt(t,s);o!==i&&(this._s(o,t),this.et(t,s,i),null===this.findNodeDataForKey(i)&&this.tn(i,t),this.Bt(n?"linkFromKey":"linkToKey",2,s,t,o,i),"string"==typeof s&&this.updateTargetBindings(t,s))}get linkFromPortIdProperty(){return this.$a}set linkFromPortIdProperty(t){const e=this.$a;e!==t&&(this.Fn(t,Ge,"linkFromPortIdProperty"),this.$a=t,this.t("linkFromPortIdProperty",e,t))}getFromPortIdForLinkData(t){return this.A1(t,!0)}setFromPortIdForLinkData(t,e){this.tg(t,e,!0)}get linkToPortIdProperty(){return this.Za}set linkToPortIdProperty(t){const e=this.Za;e!==t&&(this.Fn(t,Ge,"linkToPortIdProperty"),this.Za=t,this.t("linkToPortIdProperty",e,t))}getToPortIdForLinkData(t){return this.A1(t,!1)}setToPortIdForLinkData(t,e){this.tg(t,e,!1)}A1(t,e){if(null===t)return"";const i=e?this.$a:this.Za;if(""===i)return"";const n=this.bt(t,i);return void 0===n?"":n}tg(t,i,n){if(e.s(i,"string",Ge,n?"setFromPortIdForLinkData:portname":"setToPortIdForLinkData:portname"),null===t)return;const s=n?this.$a:this.Za;if(""===s)return;if(!this.containsLinkData(t))return void this.et(t,s,i);let o=this.bt(t,s);void 0===o&&(o=""),o!==i&&(this.et(t,s,i),this.Bt(n?"linkFromPortId":"linkToPortId",2,s,t,o,i),"string"==typeof s&&this.updateTargetBindings(t,s))}get linkLabelKeysProperty(){return this.en}set linkLabelKeysProperty(t){const e=this.en;e!==t&&(this.Fn(t,Ge,"linkLabelKeysProperty"),this.en=t,this.t("linkLabelKeysProperty",e,t))}getLabelKeysForLinkData(t){if(null===t)return Ge.EmptyArray;const e=this.en;if(""===e)return Ge.EmptyArray;const i=this.bt(t,e);return void 0===i?Ge.EmptyArray:i}setLabelKeysForLinkData(t,e){if(this.vN(e,Ge,"setLabelKeysForLinkData:arr"),null===t)return;const i=this.en;if(""===i)return;if(!this.containsLinkData(t))return void this.et(t,i,e);let n=this.bt(t,i);if(void 0===n&&(n=Ge.EmptyArray),n!==e){if(Array.isArray(n)){const e=n.length;for(let i=0;i<e;i++){const e=n[i];this._s(e,t)}}this.et(t,i,e);const s=e.length;for(let i=0;i<s;i++){const n=e[i];null===this.findNodeDataForKey(n)&&this.tn(n,t)}this.Bt("linkLabelKeys",2,i,t,n,e),"string"==typeof i&&this.updateTargetBindings(t,i)}}addLabelKeyForLinkData(t,i){if(null==i||(this.isKeyType(i)||e.te(i,"number or string",Ge,"addLabelKeyForLinkData:key"),null===t))return;const n=this.en;if(""===n)return;const s=this.bt(t,n);if(void 0===s){const e=[];e.push(i),this.setLabelKeysForLinkData(t,e)}else if(Array.isArray(s)){let e=s.indexOf(i);if(e>=0)return;e=s.length,s.push(i),this.containsLinkData(t)&&(null===this.findNodeDataForKey(i)&&this.tn(i,t),this.Bt("linkLabelKeys",3,n,t,null,i,null,e))}else e.o(n+" property is not an Array; cannot addLabelKeyForLinkData: "+t)}removeLabelKeyForLinkData(t,i){if(null==i||(this.isKeyType(i)||e.te(i,"number or string",Ge,"removeLabelKeyForLinkData:key"),null===t))return;const n=this.en;if(""===n)return;const s=this.bt(t,n);if(Array.isArray(s)){const e=s.indexOf(i);if(e<0)return;this.Po(s,e),this.containsLinkData(t)&&(this._s(i,t),this.Bt("linkLabelKeys",4,n,t,i,null,e,null))}else void 0!==s&&e.o(n+" property is not an Array; cannot removeLabelKeyforLinkData: "+t)}get linkDataArray(){return this.Ns}set linkDataArray(t){const i=this.Ns;if(i!==t){this.vN(t,Ge,"linkDataArray"),this.vi.clear();const n=t.length;for(let i=0;i<n;i++){const n=t[i];e.H(n)||e.o("GraphLinksModel.linkDataArray must only contain Objects, not: "+n)}if(this.Ns=t,""!==this.linkKeyProperty){const e=new l;for(let s=0;s<n;s++){const i=t[s],n=this.getKeyForLinkData(i);void 0===n||null!==this.vi.get(n)?e.add(i):this.vi.set(n,i)}const i=e.iterator;for(;i.next();){const t=i.value;this.makeLinkDataKeyUnique(t);const e=this.getKeyForLinkData(t);void 0!==e&&this.vi.set(e,t)}}const s=new u;for(let e=0;e<n;e++){const i=t[e];s.add(i)}this.or=s,this.Bt("linkDataArray",2,"linkDataArray",this,i,t);for(let e=0;e<n;e++){const i=t[e];this.BN(i)}}}get linkKeyProperty(){return this.Oh}set linkKeyProperty(t){const e=this.Oh;if(e!==t){this.Fn(t,Ge,"linkKeyProperty"),this.Oh=t,this.vi.clear();const i=this.linkDataArray.length;for(let t=0;t<i;t++){const e=this.linkDataArray[t];let i=this.getKeyForLinkData(e);void 0===i&&(this.makeLinkDataKeyUnique(e),i=this.getKeyForLinkData(e)),void 0!==i&&this.vi.set(i,e)}this.t("linkKeyProperty",e,t)}}getKeyForLinkData(t){if(null===t)return;const i=this.Oh;if(""===i)return;const n=this.bt(t,i);if(void 0!==n){if(this.isKeyType(n))return n;e.o("Key value for link data "+t+" is not a number or a string: "+n)}}setKeyForLinkData(t,i){if((null==i||!this.isKeyType(i))&&e.te(i,"number or string",Ge,"setKeyForLinkData:key"),null===t)return;const n=this.Oh;if(""===n)return;if(!this.containsLinkData(t))return void this.et(t,n,i);const s=this.bt(t,n);if(s!==i){if(null!==this.findLinkDataForKey(i))return;this.et(t,n,i),void 0!==s&&this.vi.delete(s),this.vi.set(i,t),this.Bt("linkKey",2,n,t,s,i),"string"==typeof n&&this.updateTargetBindings(t,n)}}get makeUniqueLinkKeyFunction(){return this.Uf}set makeUniqueLinkKeyFunction(t){const i=this.Uf;i!==t&&(null!==t&&e.S(t,Ge,"makeUniqueLinkKeyFunction"),this.Uf=t,this.t("makeUniqueLinkKeyFunction",i,t))}findLinkDataForKey(t){return null===t&&e.o("GraphLinksModel.findLinkDataForKey:key must not be null"),void 0!==t&&this.isKeyType(t)?this.vi.get(t):null}E1(t){return void 0!==t&&this.vi.has(t)}makeLinkDataKeyUnique(t){if(null===t)return;const e=this.Oh;if(""===e)return;let i=this.getKeyForLinkData(t);if(void 0!==i&&!this.E1(i))return;const n=this.Uf;if(null===n||(i=n(this,t),null==i||this.E1(i))){if("string"==typeof i){let n=2;for(;this.E1(i+n);)n++;this.et(t,e,i+n)}else if(void 0===i||"number"==typeof i){let i=-this.vi.count-1;for(;this.E1(i);)i--;this.et(t,e,i)}}else this.et(t,e,i)}containsLinkData(t){return null!==t&&this.or.has(t)}addLinkData(t){null!==t&&(this.containsLinkData(t)||this.VT(t,!0))}VT(t,i){if(""!==this.linkKeyProperty){let i=this.getKeyForLinkData(t);if(void 0===i)this.makeLinkDataKeyUnique(t),i=this.getKeyForLinkData(t);else{if(this.vi.get(i)===t)return;this.makeLinkDataKeyUnique(t),i=this.getKeyForLinkData(t)}void 0===i&&e.o("GraphLinksModel.makeLinkDataKeyUnique failed on "+t+". Data not added to model."),this.vi.set(i,t)}this.or.add(t);let n=null;i&&(n=this.Ns.length,this.nr(this.Ns,n,t)),this.Bt("linkDataArray",3,"linkDataArray",this,null,t,null,n),this.BN(t)}addLinkDataCollection(t){if(Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++)this.addLinkData(t[i])}else{const e=t.iterator;for(;e.next();){const t=e.value;this.addLinkData(t)}}}removeLinkData(t){null!==t&&this.UT(t,!0)}UT(t,e){this.or.delete(t);const i=this.getKeyForLinkData(t);void 0!==i&&this.vi.delete(i);let n=null;if(e){if(n=this.Ns.indexOf(t),n<0)return;this.Po(this.Ns,n)}this.Bt("linkDataArray",4,"linkDataArray",this,t,null,n,null),this.GO(t)}removeLinkDataCollection(t){if(Array.isArray(t)){const e=t.length;for(let i=0;i<e;i++)this.removeLinkData(t[i])}else{const e=t.iterator;for(;e.next();){const t=e.value;this.removeLinkData(t)}}}mergeLinkDataArray(t){if(""===this.linkKeyProperty&&e.o("GraphLinksModel.linkKeyProperty must not be an empty string for .mergeLinkDataArray() to succeed."),t===this.linkDataArray||!Array.isArray(t))return;const i=new u;i.addAll(this.vi.iteratorKeys);const n=new u,s=t.length;for(let e=0;e<s;e++){const i=t[e],s=this.getKeyForLinkData(i);if(void 0!==s){n.add(s);const t=this.findLinkDataForKey(s);if(t===i)continue;if(null!==t)this.assignAllDataProperties(t,i),this.eD(i,t);else{const t=this.cloneDeep(i);this.setKeyForLinkData(t,s),this.addLinkData(t)}}else{const t=this.cloneDeep(i);this.addLinkData(t),n.add(this.getKeyForLinkData(t))}}const o=i.iterator;for(;o.next();){const t=o.value;if(!n.has(t)){const e=this.findLinkDataForKey(t);e&&this.removeLinkData(e)}}}BN(t){let e=this.Fe(t,!0);e=this.EN(e),null===this.findNodeDataForKey(e)&&this.tn(e,t),e=this.Fe(t,!1),e=this.EN(e),null===this.findNodeDataForKey(e)&&this.tn(e,t);const i=this.getLabelKeysForLinkData(t);if(Array.isArray(i)){const n=i.length;for(let s=0;s<n;s++)e=i[s],null===this.findNodeDataForKey(e)&&this.tn(e,t)}}GO(t){let e=this.Fe(t,!0);this._s(e,t),e=this.Fe(t,!1),this._s(e,t);const i=this.getLabelKeysForLinkData(t);if(Array.isArray(i)){const n=i.length;for(let s=0;s<n;s++)e=i[s],this._s(e,t)}}get copyLinkDataFunction(){return this.Vf}set copyLinkDataFunction(t){const i=this.Vf;i!==t&&(null!==t&&e.S(t,Ge,"copyLinkDataFunction"),this.Vf=t,this.t("copyLinkDataFunction",i,t))}copyLinkData(t){if(null===t)return null;let i=null;const n=this.Vf;return i=null!==n?n(t,this):this.I1(t,!0),e.H(i)&&(""!==this.So&&this.et(i,this.So,void 0),""!==this.Mo&&this.et(i,this.Mo,void 0),""!==this.en&&this.et(i,this.en,[])),i}get nodeIsGroupProperty(){return this.zf}set nodeIsGroupProperty(t){const e=this.zf;e!==t&&(this.Fn(t,Ge,"nodeIsGroupProperty"),this.zf=t,this.t("nodeIsGroupProperty",e,t))}isGroupForNodeData(t){if(null===t)return!1;const e=this.zf;return""!==e&&!!this.bt(t,e)}isGroupForData(t){return this.isGroupForNodeData(t)}get nodeGroupKeyProperty(){return this.Rn}set nodeGroupKeyProperty(t){const e=this.Rn;e!==t&&(this.Fn(t,Ge,"nodeGroupKeyProperty"),this.Rn=t,this.t("nodeGroupKeyProperty",e,t))}get copiesGroupKeyOfNodeData(){return this.fg}set copiesGroupKeyOfNodeData(t){this.fg!==t&&(e.s(t,"boolean",Ge,"copiesGroupKeyOfNodeData"),this.fg=t)}getGroupKeyForNodeData(t){if(null===t)return;const i=this.Rn;if(""===i)return;const n=this.bt(t,i);if(void 0!==n){if(this.isKeyType(n))return n;e.o("GroupKey value for node data "+t+" is not a number or a string: "+n)}}getGroupForData(t){return this.getGroupKeyForNodeData(t)}setGroupKeyForNodeData(t,i){if(null===i&&(i=void 0),void 0!==i&&!this.isKeyType(i)&&e.te(i,"number or string",Ge,"setGroupKeyForNodeData:key"),null===t)return;const n=this.Rn;if(""===n)return;if(!this.containsNodeData(t))return void this.et(t,n,i);const s=this.bt(t,n);s!==i&&(this._s(s,t),this.et(t,n,i),null===this.findNodeDataForKey(i)&&this.tn(i,t),this.Bt("nodeGroupKey",2,n,t,s,i),"string"==typeof n&&this.updateTargetBindings(t,n))}setGroupForData(t,e){this.setGroupKeyForNodeData(t,e)}copyNodeData(t){if(null===t)return null;const e=super.copyNodeData(t);return!this.copiesGroupKeyOfNodeData&&""!==this.Rn&&void 0!==this.bt(e,this.Rn)&&this.et(e,this.Rn,void 0),e}setDataProperty(t,e,i){if(this.containsNodeData(t)){if(e===this.nodeKeyProperty)return void this.setKeyForNodeData(t,i);if(e===this.nodeCategoryProperty)return void this.setCategoryForNodeData(t,i);if(e===this.nodeGroupKeyProperty)return void this.setGroupKeyForNodeData(t,i)}else if(this.containsLinkData(t)){if(e===this.linkFromKeyProperty)return void this._d(t,i,!0);if(e===this.linkToKeyProperty)return void this._d(t,i,!1);if(e===this.linkFromPortIdProperty)return void this.tg(t,i,!0);if(e===this.linkToPortIdProperty)return void this.tg(t,i,!1);if(e===this.linkKeyProperty)return void this.setKeyForLinkData(t,i);if(e===this.linkCategoryProperty)return void this.setCategoryForLinkData(t,i);if(e===this.linkLabelKeysProperty)return void this.setLabelKeysForLinkData(t,i)}const n=this.bt(t,e);n!==i&&(this.et(t,e,i),this.raiseDataChanged(t,e,n,i))}assignAllDataProperties(t,e){if(!e)return;const i=this.containsNodeData(t),n=this.containsLinkData(t);for(const s in e)if("__gohashid"!==s&&(!i||s!==this.nodeKeyProperty)){if(i&&s===this.nodeIsGroupProperty&&this.bt(t,s)===e[s])continue;if(n&&s===this.linkKeyProperty)continue;this.setDataProperty(t,s,e[s])}}Fy(t,e){super.Fy(t,e);const i=this.wi.iterator;for(;i.next();){const n=i.value;this.UN(n,t,e)}const n=this.or.iterator;for(;n.next();){const i=n.value;this.HO(i,t,e)}}UN(t,e,i){if(this.getGroupKeyForNodeData(t)===e){const n=this.Rn;this.et(t,n,i),this.Bt("nodeGroupKey",2,n,t,e,i),"string"==typeof n&&this.updateTargetBindings(t,n)}}HO(t,e,i){if(this.Fe(t,!0)===e){const n=this.So;this.et(t,n,i),this.Bt("linkFromKey",2,n,t,e,i),"string"==typeof n&&this.updateTargetBindings(t,n)}if(this.Fe(t,!1)===e){const n=this.Mo;this.et(t,n,i),this.Bt("linkToKey",2,n,t,e,i),"string"==typeof n&&this.updateTargetBindings(t,n)}const n=this.getLabelKeysForLinkData(t);if(Array.isArray(n)){const s=n.length,o=this.en;for(let r=0;r<s;r++)n[r]===e&&(this.JT(n,r,i),this.Bt("linkLabelKeys",3,o,t,e,i,r,r))}}ON(){super.ON();const t=this.linkDataArray,e=t.length;for(let i=0;i<e;i++){const e=t[i];this.BN(e)}}ag(t){super.ag(t);const i=this.getKeyForNodeData(t),n=this.Ny(i);if(null!==n){const t=e.rt(),s=n.iterator;for(;s.next();){const e=s.value;if(this.containsNodeData(e)){if(this.getGroupKeyForNodeData(e)===i){const n=this.Rn;this.Bt("nodeGroupKey",2,n,e,i,i),"string"==typeof n&&this.updateTargetBindings(e,n),t.push(e)}}else{if(this.Fe(e,!0)===i){const n=this.So;this.Bt("linkFromKey",2,n,e,i,i),"string"==typeof n&&this.updateTargetBindings(e,n),t.push(e)}if(this.Fe(e,!1)===i){const n=this.Mo;this.Bt("linkToKey",2,n,e,i,i),"string"==typeof n&&this.updateTargetBindings(e,n),t.push(e)}const n=this.getLabelKeysForLinkData(e);if(Array.isArray(n)){const s=n.length,o=this.en;for(let r=0;r<s;r++)n[r]===i&&(this.Bt("linkLabelKeys",3,o,e,i,i,r,r),t.push(e))}}}for(let e=0;e<t.length;e++)this._s(i,t[e]);e.tt(t)}}cg(t){super.cg(t);const e=this.getGroupKeyForNodeData(t);null===this.findNodeDataForKey(e)&&this.tn(e,t)}Ry(t){super.Ry(t);const e=this.getGroupKeyForNodeData(t);this._s(e,t)}get linkCategoryProperty(){return this.Qa}set linkCategoryProperty(t){const e=this.Qa;e!==t&&(this.Fn(t,Ge,"linkCategoryProperty"),this.Qa=t,this.t("linkCategoryProperty",e,t))}getCategoryForLinkData(t){if(null===t)return"";const i=this.Qa;if(""===i)return"";const n=this.bt(t,i);return void 0===n?"":"string"==typeof n?n:void e.o("getCategoryForLinkData found a non-string category for "+t+": "+n)}getLinkCategoryForData(t){return this.getCategoryForLinkData(t)}setCategoryForLinkData(t,i){if(e.s(i,"string",Ge,"setCategoryForLinkData:cat"),null===t)return;const n=this.Qa;if(""===n)return;if(!this.containsLinkData(t))return void this.et(t,n,i);let s=this.bt(t,n);void 0===s&&(s=""),s!==i&&(this.et(t,n,i),this.Bt("linkCategory",2,n,t,s,i),"string"==typeof n&&this.updateTargetBindings(t,n))}setLinkCategoryForData(t,e){this.setCategoryForLinkData(t,e)}hg(t,e){super.hg(t,e),this.setGroupKeyForNodeData(e,this.getGroupKeyForNodeData(t))}eD(t,e){this.setCategoryForLinkData(e,this.getCategoryForLinkData(t)),this.setFromKeyForLinkData(e,this.getFromKeyForLinkData(t)),this.setToKeyForLinkData(e,this.getToKeyForLinkData(t)),this.setLabelKeysForLinkData(e,this.getLabelKeysForLinkData(t)),this.setFromPortIdForLinkData(e,this.getFromPortIdForLinkData(t)),this.setToPortIdForLinkData(e,this.getToPortIdForLinkData(t))}get type(){return"GraphLinksModel"}bm(){return!0}Ba(){return!0}Uw(){return!0}Qc(){return!0}static EmptyArray=(()=>Object.freeze([]))()}Ue.wl(Ge,"GraphLinksModel"),Ue.WT=()=>new Ge,Ue.bM=()=>new Ge;class Ke extends Ue{vn;ug;_a;constructor(t,e){if(super(),this.vn="parent",this.ug=!1,this._a="parentLinkCategory",void 0!==t&&(Array.isArray(t)?this.nodeDataArray=t:e=t),e){Object.assign(this,e);const t=e.Changed;t&&(delete this.Changed,this.addChangedListener(t))}}cloneProtected(t){super.cloneProtected(t),t.vn=this.vn,t.ug=this.ug,t._a=this._a}toString(t){if(void 0===t&&(t=0),t>=2)return this.toJson();{let e=(""!==this.name?this.name:"")+" TreeModel";if(t>0){e+="\n node data:";const t=this.nodeDataArray,i=t.length;for(let n=0;n<i;n++){const i=t[n];e+=" "+this.getKeyForNodeData(i)+":"+Ve.toString(i)}}return e}}lg(){const t=super.lg();let e="";return"parent"!==this.nodeParentKeyProperty&&"string"==typeof this.nodeParentKeyProperty&&(e+=',\n  "nodeParentKeyProperty": '+this.ve(this.nodeParentKeyProperty)),t+e}Ty(t){super.Ty(t),t.nodeParentKeyProperty&&(this.nodeParentKeyProperty=t.nodeParentKeyProperty)}Dy(t){void 0!==t.nodeParentKeyProperty&&t.nodeParentKeyProperty!==this.nodeParentKeyProperty&&e.o("applyIncrementalJson cannot change Model properties"),super.Dy(t)}maybeEnsureLinkReference(t){return t}get nodeParentKeyProperty(){return this.vn}set nodeParentKeyProperty(t){const e=this.vn;e!==t&&(this.Fn(t,Ke,"nodeParentKeyProperty"),this.vn=t,this.t("nodeParentKeyProperty",e,t))}get copiesParentKeyOfNodeData(){return this.ug}set copiesParentKeyOfNodeData(t){this.ug!==t&&(e.s(t,"boolean",Ke,"copiesParentKeyOfNodeData"),this.ug=t)}getParentKeyForNodeData(t){if(null===t)return;const i=this.vn;if(""===i)return;const n=this.bt(t,i);if(void 0!==n){if(this.isKeyType(n))return n;e.o("ParentKey value for node data "+t+" is not a number or a string: "+n)}}setParentKeyForNodeData(t,i){if(null===i&&(i=void 0),void 0!==i&&!this.isKeyType(i)&&e.te(i,"number or string",Ke,"setParentKeyForNodeData:key"),null===t)return;const n=this.vn;if(""===n)return;if(i=this.maybeEnsureLinkReference(i),!this.containsNodeData(t))return void this.et(t,n,i);const s=this.bt(t,n);s!==i&&(this._s(s,t),this.et(t,n,i),null===this.findNodeDataForKey(i)&&this.tn(i,t),this.Bt("nodeParentKey",2,n,t,s,i),"string"==typeof n&&this.updateTargetBindings(t,n))}get parentLinkCategoryProperty(){return this._a}set parentLinkCategoryProperty(t){const e=this._a;e!==t&&(this.Fn(t,Ke,"parentLinkCategoryProperty"),this._a=t,this.t("parentLinkCategoryProperty",e,t))}get linkCategoryProperty(){return this.parentLinkCategoryProperty}set linkCategoryProperty(t){this.parentLinkCategoryProperty=t}getParentLinkCategoryForNodeData(t){if(null===t)return"";const i=this._a;if(""===i)return"";const n=this.bt(t,i);return void 0===n?"":"string"==typeof n?n:void e.o("getParentLinkCategoryForNodeData found a non-string category for "+t+": "+n)}getLinkCategoryForData(t){return this.getParentLinkCategoryForNodeData(t)}setParentLinkCategoryForNodeData(t,i){if(e.s(i,"string",Ke,"setParentLinkCategoryForNodeData:cat"),null===t)return;const n=this._a;if(""===n)return;if(!this.containsNodeData(t))return void this.et(t,n,i);let s=this.bt(t,n);void 0===s&&(s=""),s!==i&&(this.et(t,n,i),this.Bt("parentLinkCategory",2,n,t,s,i),"string"==typeof n&&this.updateTargetBindings(t,n))}setLinkCategoryForData(t,e){this.setParentLinkCategoryForNodeData(t,e)}copyNodeData(t){if(null===t)return null;const e=super.copyNodeData(t);return!this.copiesParentKeyOfNodeData&&""!==this.vn&&void 0!==this.bt(e,this.vn)&&this.et(e,this.vn,void 0),e}setDataProperty(t,e,i){if(this.containsNodeData(t)){if(e===this.nodeKeyProperty)return void this.setKeyForNodeData(t,i);if(e===this.nodeCategoryProperty)return void this.setCategoryForNodeData(t,i);if(e===this.nodeParentKeyProperty)return void this.setParentKeyForNodeData(t,i);if(e===this.parentLinkCategoryProperty)return void this.setParentLinkCategoryForNodeData(t,i)}const n=this.bt(t,e);n!==i&&(this.et(t,e,i),this.raiseDataChanged(t,e,n,i))}Fy(t,e){super.Fy(t,e);const i=this.wi.iterator;for(;i.next();){const n=i.value;this.UN(n,t,e)}}UN(t,e,i){if(this.getParentKeyForNodeData(t)===e){const n=this.vn;this.et(t,n,i),this.Bt("nodeParentKey",2,n,t,e,i),"string"==typeof n&&this.updateTargetBindings(t,n)}}ag(t){super.ag(t);const i=this.getKeyForNodeData(t),n=this.Ny(i);if(null!==n){const t=e.rt(),s=n.iterator;for(;s.next();){const e=s.value;if(this.containsNodeData(e)&&this.getParentKeyForNodeData(e)===i){const n=this.vn;this.Bt("nodeParentKey",2,n,e,i,i),"string"==typeof n&&this.updateTargetBindings(e,n),t.push(e)}}for(let e=0;e<t.length;e++)this._s(i,t[e]);e.tt(t)}}cg(t){super.cg(t);let e=this.getParentKeyForNodeData(t);e=this.maybeEnsureLinkReference(e),null===this.findNodeDataForKey(e)&&this.tn(e,t)}Ry(t){super.Ry(t);const e=this.getParentKeyForNodeData(t);this._s(e,t)}hg(t,e){super.hg(t,e),this.setParentLinkCategoryForNodeData(e,this.getParentLinkCategoryForNodeData(t)),this.setParentKeyForNodeData(e,this.getParentKeyForNodeData(t))}get type(){return"TreeModel"}km(){return!0}Uw(){return!0}}Ue.wl(Ke,"TreeModel");var Xe=(t=>(t[t.ConstantSpacing=0]="ConstantSpacing",t[t.ConstantDistance=1]="ConstantDistance",t[t.ConstantAngle=2]="ConstantAngle",t[t.Packed=3]="Packed",t))(Xe||{}),Ye=(t=>(t[t.Clockwise=10]="Clockwise",t[t.Counterclockwise=11]="Counterclockwise",t[t.BidirectionalLeft=12]="BidirectionalLeft",t[t.BidirectionalRight=13]="BidirectionalRight",t))(Ye||{}),_e=(t=>(t[t.Forwards=20]="Forwards",t[t.Reverse=21]="Reverse",t[t.Ascending=22]="Ascending",t[t.Descending=23]="Descending",t[t.Optimized=24]="Optimized",t))(_e||{}),He=(t=>(t[t.Pythagorean=30]="Pythagorean",t[t.Circular=31]="Circular",t))(He||{});class qe extends Le{ce;Xf;B1;dg;U1;Ih;VN;zN;XN;Cs;vy;Oy;tc;Iy;sD;gg;mg;pg;Yf;Gi;P;xe;be;Dn;yg;constructor(t){super(),this.ce=0,this.Xf=0,this.B1=0,this.dg=360,this.U1=0,this.Ih=0,this.VN=new y,this.zN=30,this.XN=0,this.Cs=0,this.vy=0,this.Oy=new We,this.tc=0,this.Iy=0,this.sD=600,this.gg=NaN,this.mg=1,this.pg=0,this.Yf=360,this.Gi=0,this.P=10,this.xe=24,this.be=De.standardComparer,this.Dn=6,this.yg=30,t&&Object.assign(this,t)}cloneProtected(t){super.cloneProtected(t),t.gg=this.gg,t.mg=this.mg,t.pg=this.pg,t.Yf=this.Yf,t.Gi=this.Gi,t.P=this.P,t.xe=this.xe,t.be=this.be,t.Dn=this.Dn,t.yg=this.yg}hi(t){t in _e?this.sorting=t:t in Ye?this.direction=t:t in Xe?this.arrangement=t:t in He?this.nodeDiameterFormula=t:super.hi(t)}createNetwork(){return new $e(this)}jO(t,e,i){t=this.qO(t);let n=this.U1,s=this.zN,o=this.ce,r=this.Xf,a=this.B1,h=this.dg,u=this.Ih,c=this.XN,d=this.Cs,f=this.vy;if(n=this.arrangement,s=this.nodeDiameterFormula,o=this.radius,(!isFinite(o)||o<=0)&&(o=NaN),r=this.aspectRatio,(!isFinite(r)||r<=0)&&(r=1),a=this.startAngle,isFinite(a)||(a=0),h=this.sweepAngle,(!isFinite(h)||h>360||h<1)&&(h=360),u=this.spacing,isFinite(u)||(u=NaN),3===n&&31===s?n=0:3===n&&31!==s&&(s=31,n=this.arrangement),(12===this.direction||13===this.direction)&&24!==this.sorting){for(let n=0;!(n>=t.length||(e.add(t.elt(n)),n+1>=t.length));n+=2)i.add(t.elt(n+1));12===this.direction?(3===this.arrangement&&e.reverse(),(t=new l).addAll(e),t.addAll(i)):(3===this.arrangement&&i.reverse(),(t=new l).addAll(i),t.addAll(e))}const g=t.length;c=0;let m=0;for(let l=0;l<t.length;l++){const e=a+h*m*(10===this.direction?1:-1)/g;let i=t.elt(l).diameter;isNaN(i)&&(i=t.elt(l).Eh(e)),h<360&&(0===l||l===t.length-1)&&(i/=2),c+=i,m++}if(isNaN(o)||3===n){if(isNaN(u)&&(u=6),0!==n&&3!==n){let e=-1/0;for(let i=0;i<g;i++){const n=t.elt(i),s=t.elt(i===g-1?0:i+1);isNaN(n.diameter)&&n.Eh(0),isNaN(s.diameter)&&s.Eh(0),e=Math.max(e,(n.diameter+s.diameter)/2)}if(f=e+u,2===n){const t=(e+u)/(2*Math.PI/g);r>1?(o=t,d=o*r):(d=t,o=d)}else o=this.V1(f*(h>=360?g:g-1),r,a*Math.PI/180,h*Math.PI/180)}else o=this.V1(c+(h>=360?g:g-1)*(3!==n?u:1.6*u),r,a*Math.PI/180,h*Math.PI/180);d=o*r}else{d=o*r;const e=this.YN(o,d,a*Math.PI/180,h*Math.PI/180);if(isNaN(u))0===n&&(u=(e-c)/(h>=360?g:g-1));else if(0===n){const t=(e-c)/(h>=360?g:g-1);t<u?(o=this.V1(c+u*(h>=360?g:g-1),r,a*Math.PI/180,h*Math.PI/180),d=o*r):u=t}else{let i=-1/0;for(let e=0;e<g;e++){const n=t.elt(e),s=t.elt(e===g-1?0:e+1);isNaN(n.diameter)&&n.Eh(0),isNaN(s.diameter)&&s.Eh(0),i=Math.max(i,(n.diameter+s.diameter)/2)}const n=i+u,s=this.V1(n*(h>=360?g:g-1),r,a*Math.PI/180,h*Math.PI/180);s>o?(o=s,d=o*r,f=n):f=e/(h>=360?g:g-1)}}return this.U1=n,this.zN=s,this.ce=o,this.Xf=r,this.B1=a,this.dg=h,this.Ih=u,this.XN=c,this.Cs=d,this.vy=f,t}doLayout(t){null===this.network&&(this.network=this.makeNetwork(t)),this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin);const e=this.network.vertexes;if(e.count<=1){if(1===e.count){const t=e.first();t.centerX=0,t.centerY=0}return this.updateParts(),this.network=null,void(this.isValidLayout=!0)}let i=new l;i.addAll(e.iterator);const n=new l,s=new l;i=this.jO(i,n,s);const o=this.U1,r=this.ce,a=this.B1,h=this.dg,u=this.Ih,c=this.Cs,d=this.vy;if(12!==this.direction&&13!==this.direction||3!==o)if(12===this.direction||13===this.direction){let t=0;switch(o){case 1:t=180*this.z1(r,c,a,d)/Math.PI;break;case 0:{let e=0,i=0;const o=n.first();null!==o&&(e=o.Eh(Math.PI/2));const l=s.first();null!==l&&(i=l.Eh(Math.PI/2)),t=180*this.z1(r,c,a,u+(e+i)/2)/Math.PI;break}case 2:t=h/i.length}if(12===this.direction){switch(o){case 1:this.Ey(n,h/2,a,11);break;case 0:this.By(n,h/2,a,11);break;case 2:this.Uy(n,h/2,a,11)}switch(o){case 1:this.Ey(s,h/2,a+t,10);break;case 0:this.By(s,h/2,a+t,10);break;case 2:this.Uy(s,h/2,a+t,10)}}else{switch(o){case 1:this.Ey(s,h/2,a,11);break;case 0:this.By(s,h/2,a,11);break;case 2:this.Uy(s,h/2,a,11)}switch(o){case 1:this.Ey(n,h/2,a+t,10);break;case 0:this.By(n,h/2,a+t,10);break;case 2:this.Uy(n,h/2,a+t,10)}}}else switch(o){case 1:this.Ey(i,h,a,this.direction);break;case 0:this.By(i,h,a,this.direction);break;case 2:this.Uy(i,h,a,this.direction);break;case 3:this.nD(i,h,a,this.direction)}else this.nD(i,h,a-h/2,10);this.updateParts(),this.network=null,this.isValidLayout=!0}Uy(t,e,i,n){const s=this.dg,o=this.ce,r=this.Cs,a=i*Math.PI/180,l=e*Math.PI/180,h=t.length;for(let u=0;u<h;u++){const e=a+(10===n?u*l/(s>=360?h:h-1):-u*l/h),i=t.elt(u),c=o*Math.tan(e)/r,d=Math.sqrt((o*o+r*r*c*c)/(1+c*c));i.centerX=d*Math.cos(e),i.centerY=d*Math.sin(e),i.actualAngle=180*e/Math.PI}}By(t,e,i,n){const s=this.ce,o=this.Cs,r=this.Ih;let a=i*Math.PI/180;const l=t.length;for(let h=0;h<l;h++){const e=t.elt(h),i=t.elt(h===l-1?0:h+1),u=s*Math.cos(a),c=o*Math.sin(a);e.centerX=u,e.centerY=c,e.actualAngle=180*a/Math.PI,isNaN(e.diameter)&&e.Eh(0),isNaN(i.diameter)&&i.Eh(0);const d=(e.diameter+i.diameter)/2,f=this.z1(s,o,10===n?a:-a,d+r);a+=10===n?f:-f}}Ey(t,e,i,n){const s=this.ce,o=this.Cs,r=this.vy;let a=i*Math.PI/180;const l=t.length;for(let h=0;h<l;h++){const e=t.elt(h);e.centerX=s*Math.cos(a),e.centerY=o*Math.sin(a),e.actualAngle=180*a/Math.PI;const i=this.z1(s,o,10===n?a:-a,r);a+=10===n?i:-i}}nD(t,e,i,n){let s=this.Iy;const o=this.dg;if(this.tc=0,this.Oy=new We,e<360){for(s=i+(10===n?o:-o);s<0;)s+=360;s%=360,s>180&&(s-=360),s*=Math.PI/180,this.Iy=s,this.oD(t,e,i,n)}else this.rD(t,e,i,n);this.Oy.commit(t)}rD(t,e,i,n){const s=this.ce,o=this.Cs,r=this.Ih,a=this.Xf;let l=s*Math.cos(i*Math.PI/180),h=o*Math.sin(i*Math.PI/180);const u=t.toArray();if(3===u.length)return u[0].centerX=s,u[0].centerY=0,u[1].centerX=u[0].centerX-u[0].width/2-u[1].width/2-r,u[1].y=u[0].y,u[2].centerX=(u[0].centerX+u[1].centerX)/2,void(u[2].y=u[0].y-u[2].height-r);if(4===u.length)return u[0].centerX=s,u[0].centerY=0,u[2].centerX=-u[0].centerX,u[2].centerY=u[0].centerY,u[1].centerX=0,u[1].y=Math.min(u[0].y,u[2].y)-u[1].height-r,u[3].centerX=0,void(u[3].y=Math.max(u[0].y+u[0].height+r,u[2].y+u[2].height+r));const c=y.l();for(let y=0;y<u.length&&(u[y].centerX=l,u[y].centerY=h,!(y>=u.length-1));y++)this.lD(l,h,u,y,n,c)||this.hD(l,h,u,y,n,c),l=c.x,h=c.y;if(y.e(c),this.tc++,this.tc>23)return;const d=u[0].centerX,f=u[0].centerY,g=u[u.length-1].centerX,m=u[u.length-1].centerY;let p=Math.abs(d-g)-((u[0].width+u[u.length-1].width)/2+r);const x=Math.abs(f-m)-((u[0].height+u[u.length-1].height)/2+r);let b=0;if(Math.abs(x)<1){const t=Math.abs(d-g),e=(u[0].width+u[u.length-1].width)/2;t<e&&(b=0),p=t-e}else b=x>0?x:Math.abs(p)<1?0:p;let v=!1;v=Math.abs(g)>Math.abs(m)?g>0!=f>m:m>0!=d<g,v=10===n?v:!v,v&&(b=-Math.abs(b),b=Math.min(b,-u[u.length-1].width),b=Math.min(b,-u[u.length-1].height)),this.Oy.WO(b,u),Math.abs(b)>1&&(this.tc<8?this.ce-=b/(2*Math.PI):u.length<5&&b>10?this.ce/=2:this.ce-=b>0?1.7:-2.3,this.Cs=this.ce*a,this.rD(t,e,i,n))}oD(t,e,i,n){const s=this.ce,o=this.Cs,r=this.Xf;let a=s*Math.cos(i*Math.PI/180),l=o*Math.sin(i*Math.PI/180);const h=y.l(),u=t.toArray();for(let g=0;g<u.length&&(u[g].centerX=a,u[g].centerY=l,!(g>=u.length-1));g++)this.lD(a,l,u,g,n,h)||this.hD(a,l,u,g,n,h),a=h.x,l=h.y;if(y.e(h),this.tc++,this.tc>23)return;const c=Math.atan2(l,a);let d=10===n?this.Iy-c:c-this.Iy;d=Math.abs(d)<Math.abs(d-2*Math.PI)?d:d-2*Math.PI;const f=d*(s+o)/2;this.Oy.JO(f,u),Math.abs(f)>1&&(this.tc<8?this.ce-=f/(2*Math.PI):this.ce-=f>0?1.7:-2.3,this.Cs=this.ce*r,this.oD(t,e,i,n))}lD(t,e,i,n,s,o){const r=this.Ih,a=this.ce,l=this.Cs;let h=0,u=0;const c=(i[n].width+i[n+1].width)/2+r;let d=!1;if(e>=0!=(10===s)){if(h=t+c,h>a){if(h=t-c,h<-a)return o.x=h,o.y=u,!1;d=!0}}else if(h=t-c,h<-a){if(h=t+c,h>a)return o.x=h,o.y=u,!1;d=!0}return u=Math.sqrt(1-Math.min(1,h*h/(a*a)))*l,e<0!==d&&(u=-u),Math.abs(e-u)>(i[n].height+i[n+1].height)/2?(o.x=h,o.y=u,!1):(o.x=h,o.y=u,!0)}hD(t,e,i,n,s,o){const r=this.Ih,a=this.ce,l=this.Cs;let h=0,u=0;const c=(i[n].height+i[n+1].height)/2+r;let d=!1;if(t>=0!=(10===s)){if(u=e-c,u<-l){if(u=e+c,u>l)return o.x=h,o.y=u,!1;d=!0}}else if(u=e+c,u>l){if(u=e-c,u<-l)return o.x=h,o.y=u,!1;d=!0}return h=Math.sqrt(1-Math.min(1,u*u/(l*l)))*a,t<0!==d&&(h=-h),Math.abs(t-h)>(i[n].width+i[n+1].width)/2?(o.x=h,o.y=u,!1):(o.x=h,o.y=u,!0)}commitLayout(){this.commitNodes(),this.isRouting&&this.commitLinks()}commitNodes(){const t=null!==this.group&&this.group.hasPlaceholder(),e=t?this.group.location.copy():null;let i=this.actualCenter;t?i=new y(0,0):(i.x=this.arrangementOrigin.x+this.ce,i.y=this.arrangementOrigin.y+this.Cs);const n=this.network.vertexes.iterator;for(;n.next();){const t=n.value;t.x+=i.x,t.y+=i.y,t.commit()}if(t){this.group.ensureBounds();const t=this.group.position.copy(),i=this.group.location.copy(),n=e.subtract(i.subtract(t));this.group.move(n),this.VN=n.subtract(t)}}commitLinks(){const t=this.network.edges.iterator;for(;t.next();)t.value.commit()}YN(t,e,i,n){const s=this.sD;if(Math.abs(this.Xf-1)<.001)return void 0!==i&&void 0!==n?n*t:2*Math.PI*t;const o=t>e?Math.sqrt(t*t-e*e)/t:Math.sqrt(e*e-t*t)/e;let r=0,a=0;a=void 0!==i&&void 0!==n?n/(s+1):Math.PI/(2*(s+1));let l=0;for(let h=0;h<=s;h++){l=void 0!==i&&void 0!==n?i+h*n/s:h*Math.PI/(2*s);const t=Math.sin(l);r+=Math.sqrt(1-o*o*t*t)*a}return void 0!==i&&void 0!==n?(t>e?t:e)*r:4*(t>e?t:e)*r}V1(t,e,i,n){let s=0;return s=void 0!==i&&void 0!==n?this.YN(1,e,i,n):this.YN(1,e),t/s}z1(t,e,i,n){if(Math.abs(this.Xf-1)<.001)return n/t;const s=t>e?Math.sqrt(t*t-e*e)/t:Math.sqrt(e*e-t*t)/e;let o=0;const r=2*Math.PI/(700*this.network.vertexes.count);t>e&&(i+=Math.PI/2);for(let a=0;;a++){const l=i+a*r,h=Math.sin(l);if(o+=(t>e?t:e)*Math.sqrt(1-s*s*h*h)*r,o>=n)return a*r}}qO(t){switch(this.sorting){case 20:break;case 21:t.reverse();break;case 22:t.sort(this.comparer);break;case 23:t.sort(this.comparer),t.reverse();break;case 24:return this.$O(this.ZO(t));default:e.o("Invalid sorting type.")}return t}ZO(t){const e=[];for(let n=0;n<t.length;n++)e.push(0);const i=new l;for(let n=0;n<t.length;n++){let s=-1,o=-1;if(0===n)for(let e=0;e<t.length;e++){const i=t.elt(e).edgesCount;i>s&&(s=i,o=e)}else for(let i=0;i<t.length;i++){const t=e[i];t>s&&(s=t,o=i)}i.add(t.elt(o)),e[o]=-1;const r=t.elt(o);let a=0;const l=r.sourceEdges;for(;l.next();){const i=l.value.fromVertex;a=t.indexOf(i),!(a<0)&&e[a]>=0&&e[a]++}const h=r.destinationEdges;for(;h.next();){const i=h.value.toVertex;a=t.indexOf(i),!(a<0)&&e[a]>=0&&e[a]++}}return i}$O(t){const e=[];for(let l=0;l<t.length;l++){const i=t.elt(l);e[l]=[];let n=0;const s=i.destinationEdges;for(;s.next();){const i=s.value.toVertex;n=t.indexOf(i),n!==l&&e[l].indexOf(n)<0&&e[l].push(n)}const o=i.sourceEdges;for(;o.next();){const i=o.value.fromVertex;n=t.indexOf(i),n!==l&&e[l].indexOf(n)<0&&e[l].push(n)}}const i=[];for(let l=0;l<e.length;l++)i[l]=0;const n=[],s=[],o=[],r=[],a=new l;let h=0;for(let l=0;l<e.length;l++){const u=e[l].length;if(1===u){r.push(l);continue}if(0===u){a.add(t.elt(l));continue}if(0===h){n.push(l),h++;continue}let c=1/0,d=1/0,f=-1;const g=[];for(let t=0;t<n.length;t++)e[n[t]].indexOf(n[t===n.length-1?0:t+1])<0&&g.push(t===n.length-1?0:t+1);if(0===g.length)for(let t=0;t<n.length;t++)g.push(t);for(let t=0;t<g.length;t++){const r=g[t],a=this.QO(e[l],s,o,i,r,n);let h=0;for(let t=0;t<e[l].length;t++){const i=e[l][t],s=n.indexOf(i);if(s>=0){const t=Math.abs(r-(s>=r?s+1:s));h+=t<n.length+1-t?t:n.length+1-t}}for(let t=0;t<s.length;t++){let e=i[s[t]],a=i[o[t]];if(e>=r&&e++,a>=r&&a++,e>a){const t=a;a=e,e=t}a-e<(n.length+2)/2==(e<r&&r<=a)&&h++}(a<c||a===c&&h<d)&&(c=a,d=h,f=r)}n.splice(f,0,l);for(let t=0;t<n.length;t++)i[n[t]]=t;for(let t=0;t<e[l].length;t++){const i=e[l][t];n.indexOf(i)>=0&&(s.push(l),o.push(i))}h++}let u=!1;const c=n.length;for(;;){u=!0;for(let t=0;t<r.length;t++){const i=r[t],s=e[i][0],o=n.indexOf(s);if(o>=0){let a=0;for(let t=0;t<e[s].length;t++){const i=e[s][t],r=n.indexOf(i);if(r<0||r===o)continue;const l=r>o?r-o:o-r;a+=r<o!=l>c-l?1:-1}n.splice(a<0?o:o+1,0,i),r.splice(t,1),t--}else u=!1}if(u)break;n.push(r[0]),r.splice(0,1)}for(let l=0;l<n.length;l++){const e=n[l];a.add(t.elt(e))}return a}QO(t,e,i,n,s,o){let r=0;for(let a=0;a<e.length;a++){const l=e[a],h=i[a],u=n[l],c=n[h];let d=0,f=0;if(u<c?(d=u,f=c):(d=c,f=u),d<s&&s<=f)for(let e=0;e<t.length;e++){const i=t[e];o.indexOf(i)<0||d<n[i]&&n[i]<f||d===n[i]||f===n[i]||r++}else for(let e=0;e<t.length;e++){const i=t[e];o.indexOf(i)<0||!(d<n[i]&&n[i]<f)||d===n[i]||f===n[i]||r++}}return r}get radius(){return this.gg}set radius(t){this.gg!==t&&(e.s(t,"number",qe,"radius"),(t>0||isNaN(t))&&(this.gg=t,this.invalidateLayout()))}get aspectRatio(){return this.mg}set aspectRatio(t){this.mg!==t&&(e.s(t,"number",qe,"aspectRatio"),t>0&&(this.mg=t,this.invalidateLayout()))}get startAngle(){return this.pg}set startAngle(t){this.pg!==t&&(e.s(t,"number",qe,"startAngle"),this.pg=t,this.invalidateLayout())}get sweepAngle(){return this.Yf}set sweepAngle(t){this.Yf!==t&&(e.s(t,"number",qe,"sweepAngle"),this.Yf=t>0&&t<=360?t:360,this.invalidateLayout())}get arrangement(){return this.Gi}set arrangement(t){this.Gi!==t&&(3===t||0===t||1===t||2===t)&&(this.Gi=t,this.invalidateLayout())}get direction(){return this.P}set direction(t){this.P!==t&&(10===t||11===t||12===t||13===t)&&(this.P=t,this.invalidateLayout())}get sorting(){return this.xe}set sorting(t){this.xe!==t&&(this.xe=t,this.invalidateLayout())}get comparer(){return this.be}set comparer(t){this.be!==t&&(e.S(t,qe,"comparer"),this.be=t,this.invalidateLayout())}get spacing(){return this.Dn}set spacing(t){this.Dn!==t&&(e.s(t,"number",qe,"spacing"),this.Dn=t,this.invalidateLayout())}get nodeDiameterFormula(){return this.yg}set nodeDiameterFormula(t){this.yg!==t&&(30===t||31===t)&&(this.yg=t,this.invalidateLayout())}get actualXRadius(){return this.ce}get actualYRadius(){return this.Cs}get actualSpacing(){return this.Ih}get actualCenter(){return this.VN}static ConstantSpacing=0;static ConstantDistance=1;static ConstantAngle=2;static Packed=3;static Clockwise=10;static Counterclockwise=11;static BidirectionalLeft=12;static BidirectionalRight=13;static Forwards=20;static Reverse=21;static Ascending=22;static Descending=23;static Optimized=24;static Pythagorean=30;static Circular=31}class We{Kf;ic;Gf;constructor(){this.Kf=-1/0,this.ic=null,this.Gf=null}WO(t,e){if(t>0&&this.Kf<0||Math.abs(t)<Math.abs(this.Kf)&&!(t<0&&this.Kf>0)){this.Kf=t,this.ic=[],this.Gf=[];for(let t=0;t<e.length;t++)this.ic[t]=e[t].bounds.x,this.Gf[t]=e[t].bounds.y}}JO(t,e){if(Math.abs(t)<Math.abs(this.Kf)){this.Kf=t,this.ic=[],this.Gf=[];for(let t=0;t<e.length;t++)this.ic[t]=e[t].bounds.x,this.Gf[t]=e[t].bounds.y}}commit(t){if(null!==this.ic&&null!==this.Gf)for(let e=0;e<this.ic.length;e++){const i=t.elt(e);i.x=this.ic[e],i.y=this.Gf[e]}}}class $e extends Ae{constructor(t){super(t)}createVertex(){return new Je(this)}createEdge(){return new Ze(this)}}class Je extends De{No;X1;constructor(t){super(t),this.No=NaN,this.X1=NaN}Eh(t){const e=this.network;if(null===e)return NaN;const i=e.layout;if(null===i)return NaN;if(3===i.arrangement){if(31===i.nodeDiameterFormula)return this.No=Math.max(this.width,this.height),this.No;{const e=Math.abs(Math.sin(t)),i=Math.abs(Math.cos(t));return 0===e?this.width:0===i?this.height:(this.No=Math.min(this.height/e,this.width/i),this.No)}}return 31===i.nodeDiameterFormula?(this.No=Math.max(this.width,this.height),this.No):(this.No=Math.sqrt(this.width*this.width+this.height*this.height),this.No)}get diameter(){return this.No}set diameter(t){this.No!==t&&(e.s(t,"number",Je,"diameter"),this.No=t)}get actualAngle(){return this.X1}set actualAngle(t){this.X1!==t&&(e.s(t,"number",Je,"actualAngle"),this.X1=t)}}class Ze extends Fe{constructor(t){super(t)}}class Qe extends Le{Vy;Bh;Ls;wg;On;Oe;xg;bg;kg;Hf;Pg;Sg;jf;qf;Wf;Jf;Mg;Ng;$f;ec;constructor(t){super(),this.Vy=0,this.Bh=0,this.Ls=new x(100,100).u(),this.wg=!1,this.On=!0,this.Oe=!1,this.xg=100,this.bg=300,this.kg=1,this.Hf=1e3,this.Pg=10,this.Sg=Math,this.jf=.05,this.qf=50,this.Wf=150,this.Jf=0,this.Mg=10,this.Ng=5,this.$f=NaN,this.ec=10,t&&Object.assign(this,t)}cloneProtected(t){super.cloneProtected(t),t.Ls.a(this.Ls),t.wg=this.wg,t.On=this.On,t.Oe=this.Oe,t.xg=this.xg,t.bg=this.bg,t.kg=this.kg,t.Hf=this.Hf,t.Pg=this.Pg,t.Sg=this.Sg,t.jf=this.jf,t.qf=this.qf,t.Wf=this.Wf,t.Jf=this.Jf,t.Mg=this.Mg,t.Ng=this.Ng,t.$f=this.$f,t.ec=this.ec}createNetwork(){return new ti(this)}doLayout(t){this.network=this.makeNetwork(t);let e=this.network.vertexes.iterator;const i=this.maxIterations;if(this.network.vertexes.count>0){for(this.network.deleteSelfEdges(),e=this.network.vertexes.iterator;e.next();){const t=e.value;t.charge=this.electricalCharge(t),t.mass=this.gravitationalMass(t)}const t=this.network.edges.iterator;for(;t.next();){const e=t.value;e.stiffness=this.springStiffness(e),e.length=this.springLength(e)}if(this.KN(),this.Bh=0,this.needsPrelayout()){const t=this.network,e=t.splitIntoSubNetworks(!1);let i=e.iterator;for(;i.next();){const t=i.value;this.doConnectedSubnetLayout(t)}for(i=e.iterator,this._O(i,t),i=e.iterator;i.next();){const e=i.value,n=e.vertexes.iterator;for(;n.next();){const e=n.value;t.addVertex(e)}const s=e.edges.iterator;for(;s.next();){const e=s.value;t.addEdge(e)}}}else this.aD(this.network,this.maxIterations);this.updateParts()}this.maxIterations=i,this.isValidLayout=!0}needsPrelayout(){if(null===this.network||this.network.vertexes.count<3)return!1;let t=0,e=0;const i=this.network.vertexes.first().bounds,n=this.network.vertexes.iterator;for(;n.next();){const s=n.value,o=s.bounds;if(isNaN(s.x)||isNaN(s.y)||o.intersectsRect(i)&&(t++,t>2))return!0;if(e>10)return!1;e++}return!1}doConnectedSubnetLayout(t){let e=t.vertexes.iterator;for(;e.next();){const t=e.value;t.hierarchicalVertexes.add(t)}let i=t,n=this.$f;if(isNaN(n)&&(n=t.edges.count/t.vertexes.count),n<t.vertexes.count)for(;i.vertexes.count>Math.max(100,Math.sqrt(n*t.vertexes.count));)i=this.coarsenNetwork(i);let s=0;e=i.vertexes.iterator;let o=this.randomNumberGenerator;for(null===o&&(this.randomNumberGenerator=o=new ni(0));e.next();){e.value.idInCluster=s++;const t=10*(o.random()-.5),i=10*(o.random()-.5);this.isFixed(e.value)||(e.value.x=t,e.value.y=i);const n=e.value.hierarchicalVertexes.iterator;for(;n.next();)this.isFixed(n.value)||(n.value.x=t,n.value.y=i)}const r=this.computePairwiseDistances(i);this.tI(i,r,this.maxPrelayoutIterations,t.vertexes.count),this.aD(t,this.maxIterations)}computePairwiseDistances(t){const e=t.vertexes.count,i=new Array(e);for(let r=0;r<e;r++)i[r]=new Array(e).fill(-1),i[r][r]=0;const n=t.vertexes.iterator;let s=new Map,o=[];for(;n.next();){const t=n.value;for(o=[t],s=new Map,s.set(t.idInCluster,0);o.length>0;){const t=o.shift(),e=t.vertexes.iterator;for(;e.next();){const i=e.value;s.has(i.idInCluster)||(s.set(i.idInCluster,s.get(t.idInCluster)+1),o.push(i))}}for(let n=0;n<e;n++){const e=Math.min(i[t.idInCluster][n],i[n][t.idInCluster]),o=s.get(n);(e<0||o<e)&&(i[t.idInCluster][n]=o,i[n][t.idInCluster]=o)}}return i}coarsenNetwork(t){const e=this.createNetwork(),i=new Map;let n=0,s=t.vertexes.iterator;for(;s.next();)s.value.idInCluster=n++;for(s=t.vertexes.iterator;s.next();){const t=s.value;if(i.has(t.idInCluster))continue;let n=Number.MAX_SAFE_INTEGER,o=null;const r=t.vertexes.iterator;for(;r.next();){const t=r.value;i.has(t.idInCluster)||t.hierarchicalVertexes.length<n&&(n=t.hierarchicalVertexes.length,o=t)}const a=e.createVertex();a.hierarchicalVertexes.addAll(t.hierarchicalVertexes),null!=o&&a.hierarchicalVertexes.addAll(o.hierarchicalVertexes),i.set(t.idInCluster,a),null!=o&&i.set(o.idInCluster,a),e.addVertex(a)}const o=t.edges.iterator;for(;o.next();){const t=o.value,n=i.get(t.fromVertex.idInCluster),s=i.get(t.toVertex.idInCluster);if(n===s)continue;const r=e.createEdge();r.fromVertex=n||null,r.toVertex=s||null,e.addEdge(r)}return e}Mw(t,e){let i=!0;const n=t.vertexes.iterator;for(;n.next();){const t=n.value;i?(i=!1,e.set(t.bounds)):e.unionRect(t.bounds)}return e}_O(t,i){const n=this.arrangementSpacing,s=t.count;let o=!0,r=0,a=0;const l=e.rt();for(let e=0;e<s+i.vertexes.count+2;e++)l[e]=null;let h=0;t.reset();const u=b.l();let c;for(;t.next();){const e=t.value;if(this.Mw(e,u),o)o=!1,r=u.x+u.width/2,a=u.y+u.height/2,l[0]=new y(u.x+u.width+n.width,u.y),l[1]=new y(u.x,u.y+u.height+n.height),h=2;else{const t=this.cD(l,h,r,a,u.width,u.height,n),i=l[t],s=new y(i.x+u.width+n.width,i.y),o=new y(i.x,i.y+u.height+n.height);t+1<h&&l.splice(t+1,0,null),l[t]=s,l[t+1]=o,h++;const d=i.x-u.x,f=i.y-u.y;for(c=e.vertexes.iterator;c.next();){const t=c.value;this.isFixed(t)||(t.centerX+=d,t.centerY+=f)}}}for(b.e(u),c=i.vertexes.iterator;c.next();){const t=c.value,e=t.bounds;if(h<2){r=e.x+e.width/2,a=e.y+e.height/2,l[0]=new y(e.x+e.width+n.width,e.y),l[1]=new y(e.x,e.y+e.height+n.height),h=2;continue}const i=this.cD(l,h,r,a,e.width,e.height,n),s=l[i],o=new y(s.x+e.width+n.width,s.y),u=new y(s.x,s.y+e.height+n.height);i+1<h&&l.splice(i+1,0,null),l[i]=o,l[i+1]=u,h++,this.isFixed(t)||(t.centerX=s.x+t.width/2,t.centerY=s.y+t.height/2)}e.tt(l)}cD(t,e,i,n,s,o,r){let a=9e19,l=-1;t:for(let h=0;h<e;h++){const u=t[h],c=u.x-i,d=u.y-n,f=c*c+d*d;if(f<a){for(let e=h-1;e>=0;e--)if(t[e].y>u.y&&t[e].x-u.x<s+r.width)continue t;for(let i=h+1;i<e;i++)if(t[i].x>u.x&&t[i].y-u.y<o+r.height)continue t;l=h,a=f}}return l}KN(){if(!this.comments)return;const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value;this.addComments(e)}}addComments(t){const e=t.node;if(null!==e){const i=e.findNodesConnected();for(;i.next();){const e=i.value;if("Comment"!==e.category||!e.isVisible())continue;let n=this.network.findVertex(e);null===n&&(n=this.network.addNode(e)),n.charge=this.defaultCommentElectricalCharge;let s=null;const o=n.destinationEdges;for(;o.next();){const e=o.value;if(e.toVertex===t){s=e;break}}if(null===s){const e=n.sourceEdges;for(;e.next();){const i=e.value;if(i.fromVertex===t){s=i;break}}}null===s&&(s=this.network.linkVertexes(t,n,null)),s.length=this.defaultCommentSpringLength}}}GN(t,e){const i=t.bounds,n=i.x,s=i.y,o=i.width,r=i.height,a=e.bounds,l=a.x,h=a.y,u=a.width,c=a.height;if(n+o<l){if(s>h+c){const t=n+o-l,e=s-h-c;return S.xw(t*t+e*e)}if(s+r<h){const t=n+o-l,e=s+r-h;return S.xw(t*t+e*e)}return l-(n+o)}if(n>l+u){if(s>h+c){const t=n-l-u,e=s-h-c;return S.xw(t*t+e*e)}if(s+r<h){const t=n-l-u,e=s+r-h;return S.xw(t*t+e*e)}return n-(l+u)}return s>h+c?s-(h+c):s+r<h?h-(s+r):.1}aD(t,e){const i=this.Bh+e;for(;this.Bh<i&&(this.Bh++,this.iI(t)););}iI(t){const e=t.vertexes.toArray();if(e.length<=0)return!1;const i=e[0];i.forceX=0,i.forceY=0;let n=i.centerX,s=n,o=i.centerY,r=o;for(let g=1;g<e.length;g++){const t=e[g];t.forceX=0,t.forceY=0;const i=t.centerX,a=t.centerY;n=Math.min(n,i),s=Math.max(s,i),o=Math.min(o,a),r=Math.max(r,a)}const a=s-n>r-o;a?e.sort(((t,e)=>null===t||null===e||t===e?0:t.centerX-e.centerX)):e.sort(((t,e)=>null===t||null===e||t===e?0:t.centerY-e.centerY));const l=this.Hf;let h=0,u=0,c=0;for(let g=0;g<e.length;g++){const t=e[g],i=t.bounds,n=t.focus,s=i.x+n.x,o=i.y+n.y;u=t.charge*this.electricalFieldX(s,o),c=t.charge*this.electricalFieldY(s,o),u+=t.mass*this.gravitationalFieldX(s,o),c+=t.mass*this.gravitationalFieldY(s,o),t.forceX+=u,t.forceY+=c;for(let r=g+1;r<e.length;r++){const i=e[r];if(!this.shouldInteract(t,i)||r===g)continue;const n=i.bounds,d=i.focus,f=n.x+d.x,m=n.y+d.y;if(s-f>l||f-s>l){if(a)break;continue}if(o-m>l||m-o>l){if(!a)break;continue}const p=this.GN(t,i),y=2*t.charge,x=2*i.charge;if(p>1)h=y*x/(p*p),u=h*(s-f)/p,c=h*(o-m)/p;else{let e=this.randomNumberGenerator;null===e&&(this.randomNumberGenerator=e=new ni(0));const n=e.random(),r=e.random();if(s>f)u=Math.abs(i.bounds.right-t.bounds.x),u=y*x*(1+u)*n;else if(s<f)u=Math.abs(i.bounds.x-t.bounds.right),u=-y*x*(1+u)*n;else{const e=Math.max(i.width,t.width);u=y*x*((1+e)*n-e/2)}if(o>m)c=Math.abs(i.bounds.bottom-t.bounds.y),c=y*x*(1+c)*r;else if(s<f)c=Math.abs(i.bounds.y-t.bounds.bottom),c=-y*x*(1+c)*r;else{const e=Math.max(i.height,t.height);c=y*x*((1+e)*r-e/2)}}t.forceX+=u,t.forceY+=c,i.forceX-=u,i.forceY-=c}}const d=t.edges.iterator;for(;d.next();){const t=d.value,e=t.fromVertex,i=t.toVertex,n=e.bounds,s=e.focus,o=n.x+s.x,r=n.y+s.y,a=i.bounds,l=i.focus,f=a.x+l.x,g=a.y+l.y,m=this.GN(e,i);m>1&&(h=.1*t.stiffness*(m-t.length),u=.5*h*(e.width+i.height)*(o-f)/m,c=.5*h*(e.width+i.height)*(r-g)/m),e.forceX-=u,e.forceY-=c,i.forceX+=u,i.forceY+=c}let f=0;for(let g=0;g<e.length;g++){const t=e[g];this.isFixed(t)?this.moveFixedVertex(t):f=Math.max(f,this.moveVertex(t)||0)}return f>this.epsilonDistance*this.epsilonDistance}tI(t,e,i,n){const s=this.Bh+i,o=Math.sqrt(n);this.Vy=this.ec*t.vertexes.count;const r=t.vertexes.toArray();let a=0,l=0,h=0;for(;this.Bh<s;){this.Bh++,l=a,a=0;for(let t=0;t<r.length;t++){r[t].forceX=0,r[t].forceY=0;for(let n=0;n<r.length;n++){if(t===n)continue;const i=this.GN(r[t],r[n]),s=e[r[t].idInCluster][r[n].idInCluster],a=(i-this.ec*o*s)/i;r[t].forceX+=a*(r[n].x-r[t].x),r[t].forceY+=a*(r[n].y-r[t].y)}const i=Math.sqrt(r[t].forceX*r[t].forceX+r[t].forceY*r[t].forceY);if(i>0){r[t].forceX=this.Vy*r[t].forceX/i,r[t].forceY=this.Vy*r[t].forceY/i,this.isFixed(r[t])||(r[t].x+=r[t].forceX,r[t].y+=r[t].forceY);const e=r[t].hierarchicalVertexes.iterator;for(;e.next();){const i=e.value;this.isFixed(i)||(i.centerX+=r[t].forceX,i.centerY+=r[t].forceY)}}a+=i*i}if(a>=l){if(h++,h>=5)break}else h=0;this.Vy*=.95}}moveVertex(t){let e=t.forceX,i=t.forceY;const n=this.moveLimit;return e<-n?e=-n:e>n&&(e=n),i<-n?i=-n:i>n&&(i=n),t.centerX+=e,t.centerY+=i,e*e+i*i}shouldInteract(t,e){return!0}moveFixedVertex(t){}commitLayout(){this.zy(),this.commitNodes(),this.isRouting&&this.commitLinks()}zy(){if(!this.setsPortSpots)return;const t=this.network.edges.iterator;for(;t.next();){const e=t.value.link;null!==e&&(e.fromSpot=w.Default,e.toSpot=w.Default)}}commitNodes(){let t=0,e=0;if(this.arrangesToOrigin){const i=b.l();this.Mw(this.network,i);const n=this.arrangementOrigin;t=n.x-i.x,e=n.y-i.y,b.e(i)}const i=b.l(),n=this.network.vertexes.iterator;for(;n.next();){const s=n.value;(0!==t||0!==e)&&(i.a(s.bounds),i.x+=t,i.y+=e,s.bounds=i),s.commit()}b.e(i)}commitLinks(){const t=this.network.edges.iterator;for(;t.next();)t.value.commit()}springStiffness(t){const e=t.stiffness;return isNaN(e)?this.jf:e}springLength(t){const e=t.length;return isNaN(e)?this.qf:e}electricalCharge(t){const e=t.charge;return isNaN(e)?this.Wf:e}electricalFieldX(t,e){return 0}electricalFieldY(t,e){return 0}gravitationalMass(t){const e=t.mass;return isNaN(e)?this.Jf:e}gravitationalFieldX(t,e){return 0}gravitationalFieldY(t,e){return 0}isFixed(t){return t.isFixed}get currentIteration(){return this.Bh}get arrangementSpacing(){return this.Ls}set arrangementSpacing(t){this.Ls.equals(t)||(this.Ls.a(t),this.invalidateLayout())}get arrangesToOrigin(){return this.wg}set arrangesToOrigin(t){this.wg!==t&&(e.s(t,"boolean",Qe,"arrangesToOrigin"),this.wg=t,this.invalidateLayout())}get setsPortSpots(){return this.On}set setsPortSpots(t){this.On!==t&&(e.s(t,"boolean",Qe,"setsPortSpots"),this.On=t,this.invalidateLayout())}get comments(){return this.Oe}set comments(t){this.Oe!==t&&(e.s(t,"boolean",Qe,"comments"),this.Oe=t,this.invalidateLayout())}get maxPrelayoutIterations(){return this.xg}set maxPrelayoutIterations(t){this.xg!==t&&(e.s(t,"number",Qe,"maxPrelayoutIterations"),t>=0&&(this.xg=t,this.invalidateLayout()))}get maxIterations(){return this.bg}set maxIterations(t){this.bg!==t&&(e.s(t,"number",Qe,"maxIterations"),t>=0&&(this.bg=t,this.invalidateLayout()))}get epsilonDistance(){return this.kg}set epsilonDistance(t){this.kg!==t&&(e.s(t,"number",Qe,"epsilonDistance"),t>0&&(this.kg=t,this.invalidateLayout()))}get infinityDistance(){return this.Hf}set infinityDistance(t){this.Hf!==t&&(e.s(t,"number",Qe,"infinityDistance"),t>1&&(this.Hf=t,this.invalidateLayout()))}get moveLimit(){return this.Pg}set moveLimit(t){this.Pg!==t&&(e.s(t,"number",Qe,"moveLimit"),this.Pg=t,this.invalidateLayout())}get randomNumberGenerator(){return this.Sg}set randomNumberGenerator(t){this.Sg!==t&&(null!==t&&!e.ot(t.random)&&e.o('ForceDirectedLayout.randomNumberGenerator must have a "random()" function on it: '+t),this.Sg=t)}get defaultSpringStiffness(){return this.jf}set defaultSpringStiffness(t){this.jf!==t&&(e.s(t,"number",Qe,"defaultSpringStiffness"),this.jf=t,this.invalidateLayout())}get defaultSpringLength(){return this.qf}set defaultSpringLength(t){this.qf!==t&&(e.s(t,"number",Qe,"defaultSpringLength"),this.qf=t,this.invalidateLayout())}get defaultElectricalCharge(){return this.Wf}set defaultElectricalCharge(t){this.Wf!==t&&(e.s(t,"number",Qe,"defaultElectricalCharge"),this.Wf=t,this.invalidateLayout())}get defaultGravitationalMass(){return this.Jf}set defaultGravitationalMass(t){this.Jf!==t&&(e.s(t,"number",Qe,"defaultGravitationalMass"),this.Jf=t,this.invalidateLayout())}get defaultCommentSpringLength(){return this.Mg}set defaultCommentSpringLength(t){this.Mg!==t&&(e.s(t,"number",Qe,"defaultCommentSpringLength"),this.Mg=t,this.invalidateLayout())}get defaultCommentElectricalCharge(){return this.Ng}set defaultCommentElectricalCharge(t){this.Ng!==t&&(e.s(t,"number",Qe,"defaultCommentElectricalCharge"),this.Ng=t,this.invalidateLayout())}get prelayoutQuality(){return this.$f}set prelayoutQuality(t){this.$f!==t&&(e.s(t,"number",Qe,"prelayoutQuality"),this.$f=t,this.invalidateLayout())}get prelayoutSpread(){return this.ec}set prelayoutSpread(t){this.ec!==t&&(e.s(t,"number",Qe,"prelayoutSpread"),this.ec=t,this.invalidateLayout())}}class ti extends Ae{constructor(t){super(t)}createVertex(){return new ei(this)}createEdge(){return new ii(this)}}class ei extends De{Y1;K1;G1;H1;j1;hierarchicalVertexes;idInCluster;constructor(t){super(t),this.Y1=!1,this.K1=NaN,this.G1=NaN,this.H1=0,this.j1=0,this.hierarchicalVertexes=new l,this.idInCluster=-1}get isFixed(){return this.Y1}set isFixed(t){this.Y1!==t&&(e.s(t,"boolean",ei,"isFixed"),this.Y1=t)}get charge(){return this.K1}set charge(t){this.K1!==t&&(e.s(t,"number",ei,"charge"),this.K1=t)}get mass(){return this.G1}set mass(t){this.G1!==t&&(e.s(t,"number",ei,"mass"),this.G1=t)}get forceX(){return this.H1}set forceX(t){this.H1!==t&&(e.s(t,"number",ei,"forceX"),this.H1=t)}get forceY(){return this.j1}set forceY(t){this.j1!==t&&(e.s(t,"number",ei,"forceY"),this.j1=t)}}class ii extends Fe{q1;W1;constructor(t){super(t),this.q1=NaN,this.W1=NaN}get stiffness(){return this.q1}set stiffness(t){this.q1!==t&&(e.s(t,"number",ii,"stiffness"),this.q1=t)}get length(){return this.W1}set length(t){this.W1!==t&&(e.s(t,"number",ii,"length"),this.W1=t)}}class ni{I;R;Q;M;A;seed;constructor(t){void 0===t&&(t=42),this.seed=t,this.A=48271,this.M=2147483647,this.Q=this.M/this.A,this.R=this.M%this.A,this.I=1/this.M,this.random()}random(){const t=this.seed/this.Q,e=this.seed%this.Q,i=this.A*e-this.R*t;return this.seed=i>0?i:i+this.M,this.seed*this.I}}var si=(t=>(t[t.DepthFirst=0]="DepthFirst",t[t.Greedy=1]="Greedy",t[t.FromLayers=2]="FromLayers",t))(si||{}),oi=(t=>(t[t.OptimalLinkLength=10]="OptimalLinkLength",t[t.LongestPathSink=11]="LongestPathSink",t[t.LongestPathSource=12]="LongestPathSource",t))(oi||{}),ri=(t=>(t[t.DepthFirstOut=20]="DepthFirstOut",t[t.DepthFirstIn=21]="DepthFirstIn",t[t.Naive=22]="Naive",t))(ri||{}),ai=(t=>(t[t.None=30]="None",t[t.Less=31]="Less",t[t.More=32]="More",t))(ai||{}),li=(t=>(t[t.None=0]="None",t[t.Expand=1]="Expand",t[t.Straighten=2]="Straighten",t[t.Median=4]="Median",t[t.MaybeExpand=8]="MaybeExpand",t[t.All=15]="All",t))(li||{}),hi=(t=>(t[t.None=0]="None",t[t.UpperLeft=1]="UpperLeft",t[t.UpperRight=2]="UpperRight",t[t.LowerLeft=4]="LowerLeft",t[t.LowerRight=8]="LowerRight",t[t.All=15]="All",t))(hi||{});class ui extends Le{As;Zi;P;Zf;Qf;_f;sc;tu;rr;iu;On;Mt;Xy;Kt;Cg;Ts;di;sn;Ds;Fs;Vt;Lg;nc;Ag;nn;eu;lr;In;En;HN;constructor(t){super(),this.As=25,this.Zi=25,this.P=0,this.Zf=0,this.Qf=10,this._f=20,this.sc=4,this.tu=31,this.rr=15,this.iu=10,this.On=!0,this.Mt=-1,this.Xy=-1,this.Kt=-1,this.Cg=0,this.Ts=0,this.di=null,this.sn=null,this.Ds=null,this.Fs=null,this.Vt=null,this.Lg=0,this.nc=null,this.Ag=null,this.nn=0,this.eu=null,this.lr=new y,this.In=[],this.In.length=100,this.En=15,this.HN=0,t&&Object.assign(this,t)}cloneProtected(t){super.cloneProtected(t),t.As=this.As,t.Zi=this.Zi,t.P=this.P,t.Zf=this.Zf,t.Qf=this.Qf,t._f=this._f,t.sc=this.sc,t.tu=this.tu,t.rr=this.rr,t.iu=this.iu,t.On=this.On,t.En=this.En}hi(t){t in ai?this.aggressiveOption=t:t in si?this.cycleRemoveOption=t:t in ri?this.initializeOption=t:t in oi?this.layeringOption=t:super.hi(t)}createNetwork(){return new ci(this)}doLayout(t){null===this.network&&(this.network=this.makeNetwork(t)),this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin),this.eI(),this.network.vertexes.count>0&&(this.network.deleteSelfEdges(),2!==this.cycleRemoveOption&&this.removeCycles(),this.sI(),2===this.cycleRemoveOption&&this.removeCycles(),this.nI(),this.oI(),this.rI(),this.reduceCrossings(),this.straightenAndPack(),this.updateParts()),this.network=null,this.isValidLayout=!0}linkMinLength(t){return 1}linkLengthWeight(t){return 1}linkStraightenWeight(t){const e=t.fromVertex.node||t.fromVertex.data,i=t.toVertex.node||t.toVertex.data;return null===e&&null===i?8:null===e||null===i?4:1}nodeMinLayerSpace(t,e){return null===t.node&&null===t.data?0:90===this.P||270===this.P?e?t.focus.y+10:t.bounds.height-t.focus.y+10:e?t.focus.x+10:t.bounds.width-t.focus.x+10}nodeMinColumnSpace(t,e){if(null===t.node&&null===t.data)return 0;const i=e?t.J1:t.$1;if(null!==i)return i;const n=this.P;return 90===n||270===n?e?t.J1=t.focus.x/this.Zi+1|0:t.$1=(t.bounds.width-t.focus.x)/this.Zi+1|0:e?t.J1=t.focus.y/this.Zi+1|0:t.$1=(t.bounds.height-t.focus.y)/this.Zi+1|0}Qi(){null===this.nc&&(this.nc=[]);let t=0;const e=this.network.vertexes.iterator;for(;e.next();){const i=e.value;this.nc[t]=i.layer,t++,this.nc[t]=i.column,t++,this.nc[t]=i.index,t++}return this.nc}Ze(t){let e=0;const i=this.network.vertexes.iterator;for(;i.next();){const n=i.value;n.layer=t[e],e++,n.column=t[e],e++,n.index=t[e],e++}}fD(t,e){const i=this.Uh(t),n=this.di[t];(null===this.Ag||this.Ag.length<n*n)&&(this.Ag=[]);const s=this.Ag;for(let o=0;o<n;o++){let r=0;const a=i[o],l=a.near;let h=0;null!==l&&l!==a&&l.layer===a.layer&&(r+=Math.max(0,Math.abs(l.index-a.index)-1));let u,c,d,f,g,m=0,p=0,y=0,x=0,b=0,v=0,w=0,k=0;if(e>=0)for(u=i[o].bo,m=0;m<u.length;m++)if(c=u[m],c.valid&&c.fromVertex.layer!==t)for(p=c.fromVertex.index,y=c.portToPos,x=c.portFromPos,b=m+1;b<u.length;b++)f=u[b],f.valid&&f.fromVertex.layer!==t&&(v=f.fromVertex.index,w=f.portToPos,k=f.portFromPos,y<w&&(p>v||p===v&&x>k)&&r++,w<y&&(v>p||v===p&&k>x)&&r++);if(e<=0)for(u=i[o].er,m=0;m<u.length;m++)if(c=u[m],c.valid&&c.toVertex.layer!==t)for(p=c.toVertex.index,y=c.portToPos,x=c.portFromPos,b=m+1;b<u.length;b++)f=u[b],f.valid&&f.toVertex.layer!==t&&(v=f.toVertex.index,w=f.portToPos,k=f.portFromPos,x<k&&(p>v||p===v&&y>w)&&r++,k<x&&(v>p||v===p&&w>y)&&r++);for(s[o*n+o]=r,h=o+1;h<n;h++){let r=0,a=0;if(e>=0)for(d=i[o].bo,g=i[h].bo,m=0;m<d.length;m++)if(c=d[m],c.valid&&c.fromVertex.layer!==t)for(p=c.fromVertex.index,y=c.portToPos,x=c.portFromPos,b=0;b<g.length;b++)f=g[b],f.valid&&f.fromVertex.layer!==t&&(v=f.fromVertex.index,w=f.portToPos,k=f.portFromPos,(p<v||p===v&&x<k)&&a++,(v<p||v===p&&k<x)&&r++);if(e<=0)for(d=i[o].er,g=i[h].er,m=0;m<d.length;m++)if(c=d[m],c.valid&&c.toVertex.layer!==t)for(p=c.toVertex.index,y=c.portToPos,x=c.portFromPos,b=0;b<g.length;b++)f=g[b],f.valid&&f.toVertex.layer!==t&&(v=f.toVertex.index,w=f.portToPos,k=f.portFromPos,(p<v||p===v&&y<w)&&a++,(v<p||v===p&&w<y)&&r++);s[o*n+h]=r,s[h*n+o]=a}}return this.Vh(t,i),s}countCrossings(){let t=0;for(let e=0;e<=this.Mt;e++){const i=this.fD(e,1),n=this.di[e];for(let e=0;e<n;e++)for(let s=e;s<n;s++)t+=i[e*n+s]}return t}lI(t,e,i){const n=this.Uh(t),s=this.di[t];let o=0;for(let r=0;r<s;r++){let s=null;e<=0&&(s=n[r].bo);let a=null;e>=0&&(a=n[r].er);let l,h=0,u=0;if(null!==s)for(let e=0;e<s.length;e++)l=s[e],l.valid&&l.fromVertex.layer!==t&&(h=l.fromVertex.column+l.portFromColOffset,u=l.toVertex.column+l.portToColOffset,o+=i?Math.abs(h-u)*this.linkStraightenWeight(l):Math.abs(h-u));if(null!==a)for(let e=0;e<a.length;e++)l=a[e],l.valid&&l.toVertex.layer!==t&&(h=l.fromVertex.column+l.portFromColOffset,u=l.toVertex.column+l.portToColOffset,o+=i?(Math.abs(h-u)+1)*this.linkStraightenWeight(l):Math.abs(h-u))}return this.Vh(t,n),o}Z1(t){let e=0;for(let i=0;i<=this.Mt;i++)e+=this.lI(i,1,t);return e}Yy(){let t=1/0;this.Kt=-1;const e=this.network.vertexes.iterator;for(;e.next();){const i=e.value;t=Math.min(t,i.column-this.nodeMinColumnSpace(i,!0)),this.Kt=Math.max(this.Kt,i.column+this.nodeMinColumnSpace(i,!1))}for(e.reset();e.next();){e.value.column-=t}this.Kt-=t}Ky(t,e){const i=this.Uh(t),n=this.di[t],s=[];for(let o=0;o<n;o++){const n=i[o];let r=null;e<=0&&(r=n.bo);let a=null;e>=0&&(a=n.er);let l=0,h=0;const u=n.near;let c;if(null!==u&&u.layer===n.layer&&(l+=u.column-1,h++),null!==r)for(let e=0;e<r.length;e++){c=r[e];const i=c.fromVertex;c.valid&&!c.rev&&i.layer!==t&&(l+=i.column,h++)}if(null!==a)for(let e=0;e<a.length;e++){c=a[e];const i=c.toVertex;c.valid&&!c.rev&&i.layer!==t&&(l+=i.column,h++)}s[o]=0===h?-1:l/h}return this.Vh(t,i),s}uD(t,e){const i=this.Uh(t),n=this.di[t],s=[];for(let o=0;o<n;o++){const n=i[o];let r=null;e<=0&&(r=n.bo);let a=null;e>=0&&(a=n.er);let l=0;const h=[],u=n.near;let c;if(null!==u&&u.layer===n.layer&&(h[l]=u.column-1,l++),null!==r)for(let e=0;e<r.length;e++){c=r[e];const i=c.fromVertex;c.valid&&!c.rev&&i.layer!==t&&(h[l]=i.column+c.portFromColOffset,l++)}if(null!==a)for(let e=0;e<a.length;e++){c=a[e];const i=c.toVertex;c.valid&&!c.rev&&i.layer!==t&&(h[l]=i.column+c.portToColOffset,l++)}if(0===l)s[o]=-1;else{h.sort(((t,e)=>t-e));const t=l>>1;s[o]=1&l?h[t]:h[t-1]+h[t]>>1}}return this.Vh(t,i),s}Gy(t,e,i,n,s){if(t.component===i){t.component=e;let o=0,r=0;if(n){const a=t.destinationEdges;for(;a.next();){const l=a.value,h=l.toVertex;o=t.layer-h.layer,r=this.linkMinLength(l),o===r&&this.Gy(h,e,i,n,s)}}if(s){const a=t.sourceEdges;for(;a.next();){const l=a.value,h=l.fromVertex;o=h.layer-t.layer,r=this.linkMinLength(l),o===r&&this.Gy(h,e,i,n,s)}}}}jN(t,e,i,n,s){if(t.component===i){if(t.component=e,n){const o=t.destinationEdges;for(;o.next();){const t=o.value.toVertex;this.jN(t,e,i,n,s)}}if(s){const o=t.sourceEdges;for(;o.next();){const t=o.value.fromVertex;this.jN(t,e,i,n,s)}}}}removeCycles(){const t=this.network.edges.iterator;for(;t.next();){t.value.rev=!1}switch(this.Zf){default:case 1:this.hI();break;case 0:this.aI();break;case 2:this.cI()}}cI(){const t=this.network,e=t.vertexes.iterator;let i=1/0;for(;e.next();){const t=e.value;i=Math.min(i,t.layer)}if(i<1/0){if(i<0)for(e.reset();e.next();){e.value.layer-=i}const n=[];for(e.reset();e.next();){const t=e.value,i=n[t.layer];void 0===i?n[t.layer]=[t]:i.push(t)}let s=0;for(let t=0;t<n.length;t++){const e=n[t];if(e&&0!==e.length){if(t>0)for(let t=0;t<e.length;t++){e[t].layer-=s}}else s++}const o=t.edges.iterator;for(;o.next();){const e=o.value,i=e.fromVertex,n=e.toVertex;i.layer<n.layer&&(t.reverseEdge(e),e.rev=!0)}}}hI(){const t=this.network;let e=0,i=t.vertexes.count-1;const n=[];n.length=i+1;const s=t.vertexes.iterator;for(;s.next();){s.value._i=!0}for(;null!==this.fI(t);){let s;for(s=this.dD(t);null!==s;)n[i]=s,i--,s._i=!1,s=this.dD(t);for(s=this.gD(t);null!==s;)n[e]=s,e++,s._i=!1,s=this.gD(t);s=this.uI(t),null!==s&&(n[e]=s,e++,s._i=!1)}for(let r=0;r<t.vertexes.count;r++)n[r].index=r;const o=t.edges.iterator;for(;o.next();){const e=o.value,i=e.fromVertex,n=e.toVertex;i.index>n.index&&(t.reverseEdge(e),e.rev=!0)}}fI(t){const e=t.vertexes.iterator;for(;e.next();){const t=e.value;if(t._i)return t}return null}dD(t){const e=t.vertexes.iterator;for(;e.next();){const t=e.value;if(t._i){let e=!0;const i=t.destinationEdges;for(;i.next();)if(i.value.toVertex._i){e=!1;break}if(e)return t}}return null}gD(t){const e=t.vertexes.iterator;for(;e.next();){const t=e.value;if(t._i){let e=!0;const i=t.sourceEdges;for(;i.next();)if(i.value.fromVertex._i){e=!1;break}if(e)return t}}return null}uI(t){let e=null,i=0;const n=this.network.vertexes.iterator;for(;n.next();){const t=n.value;if(t._i){let n=0;const s=t.destinationEdges;for(;s.next();)s.value.toVertex._i&&n++;let o=0;const r=t.sourceEdges;for(;r.next();)r.value.fromVertex._i&&o++;(null===e||i<n-o)&&(e=t,i=n-o)}}return e}aI(){const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value;e.su=-1,e.$n=-1}const e=this.network.edges.iterator;for(;e.next();){e.value.forest=!1}for(this.Lg=0,t.reset();t.next();){const e=t.value;0===e.sourceEdges.count&&this.qN(e)}for(t.reset();t.next();){const e=t.value;-1===e.su&&this.qN(e)}for(e.reset();e.next();){const t=e.value;if(!t.forest){const e=t.fromVertex,i=e.su,n=e.$n,s=t.toVertex,o=s.su,r=s.$n;o<i&&n<r&&(this.network.reverseEdge(t),t.rev=!0)}}}qN(t){t.su=this.Lg,this.Lg++;const e=t.destinationEdges;for(;e.next();){const t=e.value,i=t.toVertex;-1===i.su&&(t.forest=!0,this.qN(i))}t.$n=this.Lg,this.Lg++}sI(){const t=this.network.vertexes.iterator;for(;t.next();){t.value.layer=-1}for(this.Mt=-1,this.assignLayers(),t.reset();t.next();){const e=t.value;this.Mt=Math.max(this.Mt,e.layer)}}assignLayers(){switch(this.Qf){case 11:this.mD();break;case 12:this.dI();break;default:this.gI()}}mD(){const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value,i=this.pD(e);this.Mt=Math.max(i,this.Mt)}}pD(t){let e=0;if(-1===t.layer){const i=t.destinationEdges;for(;i.next();){const t=i.value,n=t.toVertex,s=this.linkMinLength(t);e=Math.max(e,this.pD(n)+s)}t.layer=e}else e=t.layer;return e}dI(){let t=0;const e=this.network.vertexes.iterator;for(;e.next();){const i=e.value;t=this.yD(i),this.Mt=Math.max(t,this.Mt)}for(e.reset();e.next();){const t=e.value;t.layer=this.Mt-t.layer}}yD(t){let e=0;if(-1===t.layer){const i=t.sourceEdges;for(;i.next();){const t=i.value,n=t.fromVertex,s=this.linkMinLength(t);e=Math.max(e,this.yD(n)+s)}t.layer=e}else e=t.layer;return e}gI(){this.mD();const t=this.network.vertexes.iterator;for(;t.next();){t.value._i=!1}for(t.reset();t.next();){const e=t.value;0===e.sourceEdges.count&&this.wD(e)}let e=1/0;for(t.reset();t.next();){const i=t.value;e=Math.min(e,i.layer)}for(this.Mt=-1,t.reset();t.next();){const i=t.value;i.layer-=e,this.Mt=Math.max(this.Mt,i.layer)}}wD(t){if(!t._i){t._i=!0;const e=t.destinationEdges;for(;e.next();){const t=e.value.toVertex;this.wD(t)}this.mI(t),this.pI(t)}}mI(t){const e=this.network.vertexes.iterator;for(;e.next();){e.value.component=-1}const i=t.bo;let n=i.length;for(let s=0;s<n;s++){const t=i[s],e=t.fromVertex,n=t.toVertex,o=this.linkMinLength(t);e.layer-n.layer>o&&this.Gy(e,0,-1,!0,!1)}for(this.Gy(t,1,-1,!0,!0);0!==t.component;){let i=0,s=1/0,o=0,r=null;const a=this.network.vertexes.iterator;for(;a.next();){const t=a.value;if(1===t.component){let e=0,a=!1;const l=t.bo;n=l.length;for(let o=0;o<n;o++){const n=l[o],r=n.fromVertex;if(e+=this.linkLengthWeight(n),1!==r.component){i+=this.linkLengthWeight(n);const e=r.layer-t.layer,o=this.linkMinLength(n);s=Math.min(s,e-o)}}const h=t.er;n=h.length;for(let t=0;t<n;t++){const n=h[t],s=n.toVertex;e-=this.linkLengthWeight(n),1!==s.component?i-=this.linkLengthWeight(n):a=!0}(null===r||e<o)&&!a&&(r=t,o=e)}}if(i>0){for(e.reset();e.next();){const t=e.value;1===t.component&&(t.layer+=s)}t.component=0}else r.component=0}}pI(t){const e=this.network.vertexes.iterator;for(;e.next();){e.value.component=-1}for(this.Gy(t,1,-1,!0,!1);0!==t.component;){let i=0,n=1/0,s=0,o=null;const r=this.network.vertexes.iterator;for(;r.next();){const t=r.value;if(1===t.component){let e=0,r=!1;const a=t.bo;let l=a.length;for(let t=0;t<l;t++){const n=a[t],s=n.fromVertex;e+=this.linkLengthWeight(n),1!==s.component?i+=this.linkLengthWeight(n):r=!0}const h=t.er;l=h.length;for(let s=0;s<l;s++){const o=h[s],r=o.toVertex;if(e-=this.linkLengthWeight(o),1!==r.component){i-=this.linkLengthWeight(o);const e=t.layer-r.layer,s=this.linkMinLength(o);n=Math.min(n,e-s)}}(null===o||e>s)&&!r&&(o=t,s=e)}}if(i<0){for(e.reset();e.next();){const t=e.value;1===t.component&&(t.layer-=n)}t.component=0}else o.component=0}}nI(){const t=this.network,e=[],i=t.edges.iterator;for(;i.next();){const t=i.value;t.valid=!1,e.push(t)}for(let n=0;n<e.length;n++){const i=e[n];let s=i.fromVertex;const o=i.toVertex;if(i.valid||(null===s.node&&null===s.data||null===o.node&&null===o.data)&&s.layer===o.layer)continue;let r=0,a=0,l=0,h=0;if(null!==i.link){const t=i.link;if(null===t)continue;const e=s.node,n=o.node;if(null===e||null===n)continue;let u=t.fromNode,c=t.toNode,d=t.fromPort;for(;null!==d&&!d.isVisibleObject();)d=d.panel;let f=t.toPort;for(;null!==f&&!f.isVisibleObject();)f=f.panel;if(i.rev){const t=u,e=d;u=c,d=f,c=t,f=e}const g=s.focus,m=o.focus,p=i.rev?o.bounds:s.bounds,x=y.l();e!==u?p.isReal()&&u.isVisible()?u.actualBounds.isReal()?(u.getRelativePoint(d,w.Center,x),x.x+=u.actualBounds.x-p.x,x.y+=u.actualBounds.y-p.y):(u.getRelativePoint(d,w.Center,x),x.isReal()||x.a(g)):x.a(g):p.isReal()?(u.getRelativePoint(d,w.Center,x),x.isReal()||x.a(g)):x.a(g);const b=i.rev?s.bounds:o.bounds,v=y.l();n!==c?b.isReal()&&c.isVisible()?c.actualBounds.isReal()?(c.getRelativePoint(f,w.Center,v),v.x+=c.actualBounds.x-b.x,v.y+=c.actualBounds.y-b.y):(c.getRelativePoint(f,w.Center,v),v.isReal()||v.a(m)):v.a(m):b.isReal()?(c.getRelativePoint(f,w.Center,v),v.isReal()||v.a(m)):v.a(m),90===this.P||270===this.P?(r=Math.round((x.x-g.x)/this.Zi),l=x.x,a=Math.round((v.x-m.x)/this.Zi),h=v.x):(r=Math.round((x.y-g.y)/this.Zi),l=x.y,a=Math.round((v.y-m.y)/this.Zi),h=v.y),y.e(x),y.e(v),i.portFromColOffset=r,i.portFromPos=l,i.portToColOffset=a,i.portToPos=h}else i.portFromColOffset=0,i.portFromPos=0,i.portToColOffset=0,i.portToPos=0;let u=s.layer;const c=o.layer,d=this.yI(i),f=1===d||3===d,g=2===d||3===d;let m,p,x,b=null;g&&(b=this.wI(s,o),x=1,p=t.createVertex(),p.node=null,p.Q1=1,p.layer=u,p.near=s,t.addVertex(p),m=t.linkVertexes(s,p,i.link),m.valid=!1,m.rev=i.rev,m.portFromColOffset=r,m.portToColOffset=0,m.portFromPos=l,m.portToPos=0,s=p);let v=1;if(f&&v--,u-c>v&&u>0){for(i.valid=!1,p=t.createVertex(),p.node=null,p.Q1=2,p.layer=u-1,b&&x<b.length&&p.layer===b[x].layer&&(p.near=b[x++]),t.addVertex(p),m=t.linkVertexes(s,p,i.link),m.valid=!0,m.rev=i.rev,m.portFromColOffset=g?0:r,m.portToColOffset=0,m.portFromPos=g?0:l,m.portToPos=0,s=p,u--;u-c>v&&u>0;)p=t.createVertex(),p.node=null,p.Q1=3,p.layer=u-1,b&&x<b.length&&p.layer===b[x].layer&&(p.near=b[x++]),t.addVertex(p),m=t.linkVertexes(s,p,i.link),m.valid=!0,m.rev=i.rev,m.portFromColOffset=0,m.portToColOffset=0,m.portFromPos=0,m.portToPos=0,s=p,u--;m=t.linkVertexes(p,o,i.link),m.valid=!f,f&&(p.near=o),m.rev=i.rev,m.portFromColOffset=0,m.portToColOffset=a,m.portFromPos=0,m.portToPos=h}else i.valid=!0}}yI(t){let e=0;const i=t.link;if(null!==i){const n=i.fromPort,s=i.toPort;if(null!==n&&null!==s){const o=i.fromNode,r=i.toNode;if(null!==o&&null!==r){const a=this._1(!0),l=this._1(!1),h=this.setsPortSpots?a:i.computeSpot(!0,n),u=this.setsPortSpots?l:i.computeSpot(!1,s),c=i.isOrthogonal;if(h.isSide()&&h.includesSide(l)&&u.isSide()&&u.includesSide(a))return 0;const d=i.getLinkPoint(o,n,h,!0,c,r,s,y.l()),f=i.getLinkDirection(o,n,d,h,!0,c,r,s);y.e(d),(!h.isNone()&&f===this.xD(t,!0)||this.setsPortSpots&&null!==o&&1===o.ports.count&&t.rev)&&(e+=1);const g=i.getLinkPoint(r,s,u,!1,c,o,n,y.l()),m=i.getLinkDirection(r,s,g,u,!1,c,o,n);y.e(g),(!u.isNone()&&m===this.xD(t,!1)||this.setsPortSpots&&null!==r&&1===r.ports.count&&t.rev)&&(e+=2)}}}return e}xD(t,e){return 90===this.P?e&&!t.rev||!e&&t.rev?270:90:180===this.P?e&&!t.rev||!e&&t.rev?0:180:270===this.P?e&&!t.rev||!e&&t.rev?90:270:e&&!t.rev||!e&&t.rev?180:0}wI(t,e){const i=[];return i.push(e),this.bD(t,i)?i.reverse():[]}bD(t,e){const i=e[e.length-1].sourceEdges.iterator;for(;i.next();){const n=i.value;if(n.rev||!n.valid)continue;const s=n.fromVertex;if(e.push(s),s===t||this.bD(t,e))return!0;e.pop()}return!1}oI(){const t=this.di=[];for(let i=0;i<=this.Mt;i++)t[i]=0;const e=this.network.vertexes.iterator;for(;e.next();){e.value.index=-1}this.initializeIndices(),this.Xy=-1,this.Cg=0,this.Ts=0;for(let i=0;i<=this.Mt;i++)t[i]>t[this.Ts]&&(this.Xy=t[i]-1,this.Ts=i),t[i]<t[this.Cg]&&(this.Cg=i);this.eu=[];for(let i=0;i<t.length;i++)this.eu[i]=[];for(e.reset();e.next();){const t=e.value,i=t.layer;this.eu[i][t.index]=t}}initializeIndices(){switch(this._f){default:case 22:this.xI();break;case 20:this.bI();break;case 21:this.kI()}}xI(){let t=null;const e=this.network.vertexes.iterator;for(;e.next();){const i=e.value;if(i.near&&(null===t&&(t=new Map),i.layer===i.near.layer)){const e=t.get(i.near)||[];e.push(i),t.set(i.near,e)}}for(e.reset();e.next();){const i=e.value;if(i.near)continue;const n=i.layer;if(i.index=this.di[n],this.di[n]++,!t)continue;const s=t.get(i);Array.isArray(s)&&s.forEach((t=>{t.index=this.di[n],this.di[n]++}))}}bI(){let t=null;const e=this.network.vertexes.iterator;for(;e.next();){const i=e.value;if(i.near&&(null===t&&(t=new Map),i.layer===i.near.layer)){const e=t.get(i.near)||[];e.push(i),t.set(i.near,e)}}for(let i=this.Mt;i>=0;i--)for(e.reset();e.next();){const n=e.value;n.layer===i&&-1===n.index&&this.kD(n,t)}}kD(t,e){if(t.near)return;const i=t.layer;if(t.index=this.di[i],this.di[i]++,e){const n=e.get(t);Array.isArray(n)&&n.forEach((t=>{t.index=this.di[i],this.di[i]++}))}const n=t.er;let s=!0;for(;s;){s=!1;for(let t=0;t<n.length-1;t++){const e=n[t],i=n[t+1];e.portFromColOffset>i.portFromColOffset&&(s=!0,n[t]=i,n[t+1]=e)}}for(let o=0;o<n.length;o++){const t=n[o];if(t.valid){const i=t.toVertex;-1===i.index&&this.kD(i,e)}}}kI(){let t=null;const e=this.network.vertexes.iterator;for(;e.next();){const i=e.value;if(i.near&&(null===t&&(t=new Map),i.layer===i.near.layer)){const e=t.get(i.near)||[];e.push(i),t.set(i.near,e)}}for(let i=0;i<=this.Mt;i++)for(e.reset();e.next();){const n=e.value;n.layer===i&&-1===n.index&&this.PD(n,t)}}PD(t,e){if(t.near)return;const i=t.layer;if(t.index=this.di[i],this.di[i]++,e){const n=e.get(t);Array.isArray(n)&&n.forEach((t=>{t.index=this.di[i],this.di[i]++}))}const n=t.bo;let s,o,r=!0,a=0;for(;r;)for(r=!1,a=0;a<n.length-1;a++){const t=n[a],e=n[a+1];t.portToColOffset>e.portToColOffset&&(r=!0,n[a]=e,n[a+1]=t)}for(a=0;a<n.length;a++)o=n[a],o.valid&&(s=o.fromVertex,-1===s.index&&this.PD(s,e))}rI(){this.Kt=-1;for(let t=0;t<=this.Mt;t++){const e=this.Uh(t);let i=0;const n=this.di[t];for(let t=0;t<n;t++){const n=e[t];i+=this.nodeMinColumnSpace(n,!0),n.column=i,i+=1,i+=this.nodeMinColumnSpace(n,!1)}this.Kt=Math.max(this.Kt,i-1),this.Vh(t,e)}}reduceCrossings(){let t=this.countCrossings(),e=this.Qi(),i=0,n=0,s=0;for(i=0;i<this.sc;i++){for(n=0;n<=this.Mt;n++)this.tk(n,1),this.as(n,1,!1,1);for(s=this.countCrossings(),s<t&&(t=s,e=this.Qi()),n=this.Mt;n>=0;n--)this.tk(n,-1),this.as(n,-1,!1,-1);s=this.countCrossings(),s<t&&(t=s,e=this.Qi())}for(this.Ze(e),i=0;i<this.sc;i++){for(n=0;n<=this.Mt;n++)this.tk(n,0),this.as(n,0,!1,0);for(s=this.countCrossings(),s<t&&(t=s,e=this.Qi()),n=this.Mt;n>=0;n--)this.tk(n,0),this.as(n,0,!1,0);s=this.countCrossings(),s<t&&(t=s,e=this.Qi())}this.Ze(e);let o=!1,r=0,a=0,l=0,h=0;switch(this.tu){case 30:break;case 32:for(l=t+1;(h=this.countCrossings())<l;)for(l=h,r=this.Mt;r>=0;r--)for(a=0;a<=r;a++){for(o=!0;o;)for(o=!1,n=r;n>=a;n--)o=this.as(n,-1,!1,-1)||o;for(s=this.countCrossings(),s>=t?this.Ze(e):(t=s,e=this.Qi()),o=!0;o;)for(o=!1,n=r;n>=a;n--)o=this.as(n,1,!1,1)||o;for(s=this.countCrossings(),s>=t?this.Ze(e):(t=s,e=this.Qi()),o=!0;o;)for(o=!1,n=a;n<=r;n++)o=this.as(n,1,!1,1)||o;for(s>=t?this.Ze(e):(t=s,e=this.Qi()),o=!0;o;)for(o=!1,n=a;n<=r;n++)o=this.as(n,-1,!1,-1)||o;for(s>=t?this.Ze(e):(t=s,e=this.Qi()),o=!0;o;)for(o=!1,n=r;n>=a;n--)o=this.as(n,0,!1,0)||o;for(s>=t?this.Ze(e):(t=s,e=this.Qi()),o=!0;o;)for(o=!1,n=a;n<=r;n++)o=this.as(n,0,!1,0)||o;s>=t?this.Ze(e):(t=s,e=this.Qi())}break;default:for(r=this.Mt,a=0,l=t+1;(h=this.countCrossings())<l;){for(l=h,o=!0;o;)for(o=!1,n=r;n>=a;n--)o=this.as(n,-1,!1,-1)||o;for(s=this.countCrossings(),s>=t?this.Ze(e):(t=s,e=this.Qi()),o=!0;o;)for(o=!1,n=r;n>=a;n--)o=this.as(n,1,!1,1)||o;for(s=this.countCrossings(),s>=t?this.Ze(e):(t=s,e=this.Qi()),o=!0;o;)for(o=!1,n=a;n<=r;n++)o=this.as(n,1,!1,1)||o;for(s>=t?this.Ze(e):(t=s,e=this.Qi()),o=!0;o;)for(o=!1,n=a;n<=r;n++)o=this.as(n,-1,!1,-1)||o;for(s>=t?this.Ze(e):(t=s,e=this.Qi()),o=!0;o;)for(o=!1,n=r;n>=a;n--)o=this.as(n,0,!1,0)||o;for(s>=t?this.Ze(e):(t=s,e=this.Qi()),o=!0;o;)for(o=!1,n=a;n<=r;n++)o=this.as(n,0,!1,0)||o;s>=t?this.Ze(e):(t=s,e=this.Qi())}}this.Ze(e)}tk(t,e){let i=0,n=!1;const s=this.Uh(t),o=this.di[t],r=this.uD(t,e),a=this.Ky(t,e);for(i=0;i<o;i++)-1===a[i]&&(a[i]=s[i].column),-1===r[i]&&(r[i]=s[i].column);let l,h=!0;for(;h;)for(h=!1,i=0;i<o-1;i++)if(r[i+1]<r[i]||r[i+1]===r[i]&&a[i+1]<a[i]){n=!0,h=!0;const t=r[i];r[i]=r[i+1],r[i+1]=t;const e=a[i];a[i]=a[i+1],a[i+1]=e,l=s[i],s[i]=s[i+1],s[i+1]=l}let u=0;for(i=0;i<o;i++)l=s[i],l.index=i,u+=this.nodeMinColumnSpace(l,!0),l.column=u,u+=1,u+=this.nodeMinColumnSpace(l,!1);return this.Vh(t,s),n}as(t,e,i,n){const s=this.Uh(t),o=this.di[t],r=this.fD(t,e);let a,l,h=0;if(!i||n>0)for(a=[],h=0;h<o;h++)a[h]=-1;else a=this.Ky(t,-1);if(!i||n<0)for(l=[],h=0;h<o;h++)l[h]=-1;else l=this.Ky(t,1);let u=!1,c=!0;for(;c;)for(c=!1,h=0;h<o-1;h++){const e=r[s[h].index*o+s[h+1].index],d=r[s[h+1].index*o+s[h].index];let f=0,g=0;const m=s[h].column,p=s[h+1].column,y=this.nodeMinColumnSpace(s[h],!0),x=this.nodeMinColumnSpace(s[h],!1),b=m-y+this.nodeMinColumnSpace(s[h+1],!0),v=p-x+this.nodeMinColumnSpace(s[h+1],!1);let w,k,S=0,P=0,M=0,C=0,N=0,T=0,L=0,A=0,D=0;const F=s[h].sourceEdges.iterator;if(i&&n<=0)for(;F.next();){const e=F.value;w=e.fromVertex,e.valid&&w.layer!==t&&(M=this.linkStraightenWeight(e),C=e.portFromColOffset,N=e.portToColOffset,T=w.column,S+=(Math.abs(m+N-(T+C))+1)*M,P+=(Math.abs(v+N-(T+C))+1)*M)}for(F.reset();F.next();){const e=F.value;if(w=e.fromVertex,e.valid&&w.layer===t){for(A=0;A<s.length&&s[A]!==w;)A++;A<h&&(f+=2*(h-A),g+=2*(h+1-A)),A===h+1&&(f+=1),A>h+1&&(f+=4*(A-h),g+=4*(A-(h+1)))}}const O=s[h].destinationEdges.iterator;if(i&&n>=0)for(;O.next();){const e=O.value;k=e.toVertex,e.valid&&k.layer!==t&&(M=this.linkStraightenWeight(e),C=e.portFromColOffset,N=e.portToColOffset,L=k.column,S+=(Math.abs(m+C-(L+N))+1)*M,P+=(Math.abs(v+C-(L+N))+1)*M)}for(O.reset();O.next();){const e=O.value;if(k=e.toVertex,e.valid&&k.layer===t){for(D=0;D<s.length&&s[D]!==k;)D++;D===h+1&&(g+=1)}}const R=s[h+1].sourceEdges.iterator;if(i&&n<=0)for(;R.next();){const e=R.value;w=e.fromVertex,e.valid&&w.layer!==t&&(M=this.linkStraightenWeight(e),C=e.portFromColOffset,N=e.portToColOffset,T=w.column,S+=(Math.abs(p+N-(T+C))+1)*M,P+=(Math.abs(b+N-(T+C))+1)*M)}for(R.reset();R.next();){const e=R.value;if(w=e.fromVertex,e.valid&&w.layer===t){for(A=0;A<s.length&&s[A]!==w;)A++;A<h&&(f+=2*(h+1-A),g+=2*(h-A)),A===h&&(g+=1),A>h+1&&(f+=4*(A-(h+1)),g+=4*(A-h))}}const E=s[h+1].destinationEdges.iterator;if(i&&n>=0)for(;E.next();){const e=E.value;k=e.toVertex,e.valid&&k.layer!==t&&(M=this.linkStraightenWeight(e),C=e.portFromColOffset,N=e.portToColOffset,L=k.column,S+=(Math.abs(p+C-(L+N))+1)*M,P+=(Math.abs(b+C-(L+N))+1)*M)}for(E.reset();E.next();){const e=E.value;if(k=e.toVertex,e.valid&&k.layer===t){for(D=0;D<s.length&&s[D]!==k;)D++;D===h&&(f+=1)}}let B=0,I=0;const z=a[s[h].index],V=l[s[h].index],j=a[s[h+1].index],U=l[s[h+1].index];if(-1!==z&&(B+=Math.abs(z-m),I+=Math.abs(z-v)),-1!==V&&(B+=Math.abs(V-m),I+=Math.abs(V-v)),-1!==j&&(B+=Math.abs(j-p),I+=Math.abs(j-b)),-1!==U&&(B+=Math.abs(U-p),I+=Math.abs(U-b)),g<f-.5||g===f&&d<e-.5||g===f&&d===e&&P<S-.5||g===f&&d===e&&P===S&&I<B-.5){u=!0,c=!0,s[h].column=v,s[h+1].column=b;const t=s[h];s[h]=s[h+1],s[h+1]=t}}for(h=0;h<o;h++)s[h].index=h;return this.Vh(t,s),u}straightenAndPack(){if(0!==this.En)return void this.SI();let t=0,e=!1,i=0!==(1&this.rr);const n=0!==(8&this.rr);if(this.network.edges.count>1e3&&n&&(i=!1),i){const e=[];let i=0;for(i=0;i<=this.Mt;i++)e[i]=0;let n=0;const s=this.network.vertexes.iterator;for(;s.next();){const i=s.value;t=i.layer,n=i.column;const o=this.nodeMinColumnSpace(i,!1);e[t]=Math.max(e[t],n+o)}const o=8;for(s.reset();s.next();){const i=s.value;t=i.layer,n=i.column,i.column=((this.Kt-e[t])*o>>1)+n*o}this.Kt*=o}if(2&this.rr){e=!0;let i=0;for(;e&&i<this.iu;){for(e=!1,t=this.Ts+1;t<=this.Mt;t++)e=this.Tg(t,1)||e;for(t=this.Ts-1;t>=0;t--)e=this.Tg(t,-1)||e;e=this.Tg(this.Ts,0)||e,i++}}if(4&this.rr){for(t=this.Ts+1;t<=this.Mt;t++)this.WN(t,1);for(t=this.Ts-1;t>=0;t--)this.WN(t,-1);this.WN(this.Ts,0)}if(i&&(this.SD(-1),this.SD(1)),2&this.rr){e=!0;let i=0;for(;e&&i<this.iu;){for(e=!1,e=this.Tg(this.Ts,0)||e,t=this.Ts+1;t<=this.Mt;t++)e=this.Tg(t,0)||e;for(t=this.Ts-1;t>=0;t--)e=this.Tg(t,0)||e;i++}}}Tg(t,e){let i=!1;for(;this.MI(t,e);)i=!0;return i}MI(t,e){let i=0;const n=this.Uh(t),s=this.di[t],o=this.Ky(t,-1);if(e>0)for(i=0;i<s;i++)o[i]=-1;const r=this.Ky(t,1);if(e<0)for(i=0;i<s;i++)r[i]=-1;let a=!1,l=!0;for(;l;)for(l=!1,i=0;i<s;i++){const h=n[i].column,u=this.nodeMinColumnSpace(n[i],!0),c=this.nodeMinColumnSpace(n[i],!1);let d=0;d=i-1<0||h-n[i-1].column-1>u+this.nodeMinColumnSpace(n[i-1],!1)?h-1:h;let f=0;f=i+1>=s||n[i+1].column-h-1>c+this.nodeMinColumnSpace(n[i+1],!0)?h+1:h;let g=0,m=0,p=0,y=0,x=0,b=0;if(e<=0){const e=n[i].sourceEdges.iterator;for(;e.next();){const i=e.value,n=i.fromVertex;if(i.valid&&n.layer!==t){y=this.linkStraightenWeight(i),x=i.portFromColOffset,b=i.portToColOffset;const t=n.column;g+=(Math.abs(h+b-(t+x))+1)*y,m+=(Math.abs(d+b-(t+x))+1)*y,p+=(Math.abs(f+b-(t+x))+1)*y}}}if(e>=0){const e=n[i].destinationEdges.iterator;for(;e.next();){const i=e.value,n=i.toVertex;if(i.valid&&n.layer!==t){y=this.linkStraightenWeight(i),x=i.portFromColOffset,b=i.portToColOffset;const t=n.column;g+=(Math.abs(h+x-(t+b))+1)*y,m+=(Math.abs(d+x-(t+b))+1)*y,p+=(Math.abs(f+x-(t+b))+1)*y}}}let v=0,w=0,k=0;const S=o[n[i].index],P=r[n[i].index];-1!==S&&(v+=Math.abs(S-h),w+=Math.abs(S-d),k+=Math.abs(S-f)),-1!==P&&(v+=Math.abs(P-h),w+=Math.abs(P-d),k+=Math.abs(P-f)),m<g||m===g&&w<v?(a=!0,l=!0,n[i].column=d):(p<g||p===g&&k<v)&&(a=!0,l=!0,n[i].column=f)}return this.Vh(t,n),this.Yy(),a}WN(t,e){let i=0;const n=this.Uh(t),s=this.di[t],o=this.uD(t,e),r=[];for(i=0;i<s;i++)r[i]=o[i];let a=!1,l=!0;for(;l;)for(l=!1,i=0;i<s;i++){const t=n[i].column,e=this.nodeMinColumnSpace(n[i],!0),o=this.nodeMinColumnSpace(n[i],!1);let h=0,u=0,c=0,d=0,f=0;-1===r[i]?0===i&&i===s-1?h=t:0===i?(u=n[i+1].column,h=u-t===o+this.nodeMinColumnSpace(n[i+1],!0)?t-1:t):i===s-1?(c=n[i-1].column,h=t-c===e+this.nodeMinColumnSpace(n[i-1],!1)?t+1:t):(c=n[i-1].column,f=c+this.nodeMinColumnSpace(n[i-1],!1)+e+1,u=n[i+1].column,d=u-this.nodeMinColumnSpace(n[i+1],!0)-o-1,h=(f+d)/2|0):0===i&&i===s-1?h=r[i]:0===i?(u=n[i+1].column,d=u-this.nodeMinColumnSpace(n[i+1],!0)-o-1,h=Math.min(r[i],d)):i===s-1?(c=n[i-1].column,f=c+this.nodeMinColumnSpace(n[i-1],!1)+e+1,h=Math.max(r[i],f)):(c=n[i-1].column,f=c+this.nodeMinColumnSpace(n[i-1],!1)+e+1,u=n[i+1].column,d=u-this.nodeMinColumnSpace(n[i+1],!0)-o-1,f<r[i]&&r[i]<d?h=r[i]:f>=r[i]?h=f:d<=r[i]&&(h=d)),h!==t&&(a=!0,l=!0,n[i].column=h)}return this.Vh(t,n),this.Yy(),a}NI(){for(let t=0;t<=this.Kt;t++)for(;this.CI(t,1););this.Yy()}CI(t,e){let i=!0;const n=this.network.vertexes.iterator;for(;n.next();){const e=n.value,s=this.nodeMinColumnSpace(e,!0),o=this.nodeMinColumnSpace(e,!1);if(e.column-s<=t&&e.column+o>=t){i=!1;break}}let s=!1;if(i){if(e>0)for(n.reset();n.next();){const e=n.value;e.column>t&&(e.column-=1,s=!0)}if(e<0)for(n.reset();n.next();){const e=n.value;e.column<t&&(e.column+=1,s=!0)}}return s}LI(){this.NI();for(let t=0;t<this.Kt;t++)for(;this.AI(t,1););this.Yy()}AI(t,e){let i=t;e>0&&(i=t+1),e<0&&(i=t-1);let n=0;const s=[],o=[];for(n=0;n<=this.Mt;n++)s[n]=!1,o[n]=!1;const r=this.network.vertexes.iterator;for(;r.next();){const e=r.value,n=e.column-this.nodeMinColumnSpace(e,!0),a=e.column+this.nodeMinColumnSpace(e,!1);n<=t&&a>=t&&(s[e.layer]=!0),n<=i&&a>=i&&(o[e.layer]=!0)}let a=!0,l=!1;for(n=0;n<=this.Mt;n++)a=a&&!(s[n]&&o[n]);if(a){if(e>0)for(r.reset();r.next();){const e=r.value;e.column>t&&(e.column-=1,l=!0)}if(e<0)for(r.reset();r.next();){const e=r.value;e.column<t&&(e.column+=1,l=!0)}}return l}SD(t){this.LI();let e,i=0,n=0,s=0,o=0;if(t>0)for(i=0;i<=this.Kt;i++)for(e=this.Qi(),n=this.Z1(!0),s=n+1;n<s;)s=n,this.MD(i,1),o=this.Z1(!0),o>n?this.Ze(e):o<n&&(n=o,e=this.Qi());if(t<0)for(i=this.Kt;i>=0;i--)for(e=this.Qi(),n=this.Z1(!0),s=n+1;n<s;)s=n,this.MD(i,-1),o=this.Z1(!0),o>n?this.Ze(e):o<n&&(n=o,e=this.Qi());this.Yy()}MD(t,e){this.nn=0;const i=this.network.vertexes.iterator;for(;i.next();){i.value.component=-1}if(e>0)for(i.reset();i.next();){const e=i.value;e.column-this.nodeMinColumnSpace(e,!0)<=t&&(e.component=this.nn)}if(e<0)for(i.reset();i.next();){const e=i.value;e.column+this.nodeMinColumnSpace(e,!1)>=t&&(e.component=this.nn)}for(this.nn++,i.reset();i.next();){const t=i.value;-1===t.component&&(this.jN(t,this.nn,-1,!0,!0),this.nn++)}let n=0;const s=[];for(n=0;n<this.nn*this.nn;n++)s[n]=!1;const o=[];for(n=0;n<(this.Mt+1)*(this.Kt+1);n++)o[n]=-1;for(i.reset();i.next();){const t=i.value,e=t.layer,n=Math.max(0,t.column-this.nodeMinColumnSpace(t,!0)),s=Math.min(this.Kt,t.column+this.nodeMinColumnSpace(t,!1));for(let i=n;i<=s;i++)o[e*(this.Kt+1)+i]=t.component}for(let u=0;u<=this.Mt;u++){if(e>0)for(let t=0;t<this.Kt;t++)-1!==o[u*(this.Kt+1)+t]&&-1!==o[u*(this.Kt+1)+t+1]&&o[u*(this.Kt+1)+t]!==o[u*(this.Kt+1)+t+1]&&(s[o[u*(this.Kt+1)+t]*this.nn+o[u*(this.Kt+1)+t+1]]=!0);if(e<0)for(let t=this.Kt;t>0;t--)-1!==o[u*(this.Kt+1)+t]&&-1!==o[u*(this.Kt+1)+t-1]&&o[u*(this.Kt+1)+t]!==o[u*(this.Kt+1)+t-1]&&(s[o[u*(this.Kt+1)+t]*this.nn+o[u*(this.Kt+1)+t-1]]=!0)}const r=[];for(n=0;n<this.nn;n++)r[n]=!0;const a=[];a.push(0);let l=0;for(;0!==a.length;)if(l=a[a.length-1],a.pop(),r[l])for(r[l]=!1,n=0;n<this.nn;n++)s[l*this.nn+n]&&a.splice(0,0,n);let h=!1;if(e>0)for(i.reset();i.next();){const t=i.value;r[t.component]&&(t.column-=1,h=!0)}if(e<0)for(i.reset();i.next();){const t=i.value;r[t.component]&&(t.column+=1,h=!0)}return h}SI(){const t=e.rt(),i=this.eu.length;for(let e=0;e<=i;e++)t[e]=[];const n=this.network.vertexes.iterator;for(;n.next();){const e=n.value;t[i-e.layer][e.index]=e}const s=new u;this.TI(t,s);let o=null,r=null,a=null,l=null;const h=0!==(1&this.En),c=0!==(2&this.En),d=0!==(4&this.En),f=0!==(8&this.En);h&&(this.ll(t,s,!0),o=this.ik(t,!0,!1)),t.reverse(),d&&(this.ll(t,s,!1),a=this.ik(t,!1,!1));for(const e of t)e.reverse();f&&(this.ll(t,s,!1),l=this.ik(t,!1,!0)),t.reverse(),c&&(this.ll(t,s,!0),r=this.ik(t,!0,!0)),e.tt(t),this.DI(o,r,a,l),this.network.vertexes.each((t=>{const i=t,n=e.rt();h&&n.push(o.get(i)),c&&n.push(r.get(i)),d&&n.push(a.get(i)),f&&n.push(l.get(i)),n.sort(((t,e)=>t-e));const s=n.length,u=Math.floor((s-1)/2),g=Math.ceil((s-1)/2),m=(n[u]+n[g])/2;e.tt(n),i.fe=m}))}TI(t,e){const i=t.length;for(let n=1;n<i-1;n++){let i=0,s=0;const o=t[n],r=t[n+1];for(let t=0;s<r.length;t++){const n=r[t],a=this.FI(n);if(t===r.length-1||a){let l=o.length-1;for(a&&(l=n.getProperSourceVertexes()[0].index);s<=t;){const t=r[s].getProperSourceEdges();for(const n of t){const t=n.fromVertex.index;(t<i||t>l)&&e.add(n)}s++}i=l}}}}FI(t){if(null===t.node){const e=t.getProperSourceVertexes();if(e.length>0)return null===e[0].node}return!1}ll(t,e,i){this.RI(t);for(const n of t){let t=-1;for(const s of n){const n=i?s.getProperSourceVertexes():s.getProperDestinationVertexes(),o=n.length;if(o>0){n.sort(((t,e)=>t.zh-e.zh));const r=(o-1)/2;for(let o=Math.floor(r),a=Math.ceil(r);o<=a;o++)if(s.Bn===s){const r=n[o];let a;a=i?r.getDestinationEdge(s):s.getDestinationEdge(r),!e.has(a)&&t<r.zh&&(r.Bn=s,s.oc=r.oc,s.Bn=r.oc,t=r.zh)}}}}}RI(t){for(let e=0;e<t.length;e++){const i=t[e];for(let t=0;t<i.length;t++){const n=i[t];n.oc=n,n.Bn=n,n.ND=e,n.zh=t}}}ik(t,e,i){const n=90===this.P||270===this.P;for(const o of t)for(const t of o)t.Qe=t,t.nu=1/0,t.fe=NaN,t.Un=0;this.vI(t,e,i);for(const o of t)for(const e of o)e.oc===e&&this.CD(e,t);for(let o=0;o<t.length;o++){if(t[o].length<=0)continue;const e=t[o][0];if(e.Qe===e){e.Qe.nu===1/0&&(e.Qe.nu=0);let i,s=o,r=0;do{for(i=t[s][r];i.Bn!==i.oc;)if(i=i.Bn,s++,i.zh>0){const e=this.LD(i,t),s=n?e.width:e.height,o=i.Qe.nu+i.fe+i.Un-(e.fe+e.Un+s+this.columnSpacing);e.Qe.nu=Math.min(e.Qe.nu,o)}r=i.zh+1}while(s<t.length&&r<t[s].length&&i.Qe===t[s][r].Qe)}}const s=new p;for(const o of t)for(const t of o){t.fe=t.fe+t.Qe.nu+t.Un;const e=n?t.width:t.height;s.set(t,i?-t.fe-e:t.fe)}return s}vI(t,e,i){const n=90===this.P||270===this.P;for(const s of t)for(const t of s)if(t.oc===t){let s=0,o=t;for(;o.Bn!==t;){const t=o.Bn,r=n?o.width:o.height,a=n?t.width:t.height;let l,h,u,c;e?(u=o.getDestinationEdge(t),l=u.portFromPos,h=u.portToPos,null!==u.link&&(o.node&&o.node!==u.link.fromNode&&(l=n?o.focusX:o.focusY),t.node&&t.node!==u.link.toNode&&(h=n?t.focusX:t.focusY)),c=i?o.Un+(r-l)-(a-h):o.Un+l-h):(u=t.getDestinationEdge(o),l=u.portToPos,h=u.portFromPos,null!==u.link&&(o.node&&o.node!==u.link.toNode&&(l=n?o.focusX:o.focusY),t.node&&t.node!==u.link.fromNode&&(h=n?t.focusX:t.focusY)),c=i?o.Un+(r-l)-(a-h):o.Un+l-h),t.Un=c,s=Math.min(s,c),o=o.Bn}o=t;do{o.Un=o.Un-s,o=o.Bn}while(o!==t)}}CD(t,e){if(!isNaN(t.fe))return;t.fe=0;let i=t;do{if(i.zh>0){const n=this.LD(i,e),s=n.oc;this.CD(s,e),t.Qe===t&&(t.Qe=s.Qe);const o=90===this.P||270===this.P?n.width:n.height;if(t.Qe===s.Qe){const e=s.fe+n.Un+o-i.Un+this.columnSpacing;t.fe=Math.max(t.fe,e)}}i=i.Bn}while(i!==t);for(;i.Bn!==t;)i=i.Bn,i.fe=t.fe,i.Qe=t.Qe}LD(t,i){const n=t.ND,s=t.zh;return s<1&&e.o("Could not determine previous vertex in layer"),i[n][s-1]}DI(){let t=-1;const i=e.rt(),n=e.rt();let s=1/0;for(let e=0;e<4;e++){if(!(e<0||arguments.length<=e?void 0:arguments[e]))continue;const o=this.OI(e<0||arguments.length<=e?void 0:arguments[e],i,n,e);o<s&&(t=e,s=o)}for(let e=0;e<4;e++){const s=e<0||arguments.length<=e?void 0:arguments[e];if(!s)continue;const o=0===e||2===e?i[t]-i[e]:n[t]-n[e];0!==o&&s.each((t=>{s.set(t.key,t.value+o)}))}e.tt(i),e.tt(n)}OI(t,e,i,n){if(!t||0===t.count)return e[n]=0,i[n]=0,1/0;let s=1/0,o=-1/0;return t.each((t=>{const e=t.key,i=t.value,n=90===this.P||270===this.P?e.width:e.height;i<s&&(s=i),i+n>o&&(o=i+n)})),e[n]=s,i[n]=o,o-s}commitLayout(){this.zy(),this.commitNodes(),this.JN(),this.isRouting&&this.commitLinks()}zy(){if(!this.setsPortSpots)return;const t=this._1(!0),e=this._1(!1),i=this.network.edges.iterator;for(;i.next();){const n=i.value.link;null!==n&&(n.fromSpot=t,n.toSpot=e)}}_1(t){return 270===this.P?t?w.MiddleTop:w.MiddleBottom:90===this.P?t?w.MiddleBottom:w.MiddleTop:180===this.P?t?w.MiddleLeft:w.MiddleRight:t?w.MiddleRight:w.MiddleLeft}commitNodes(){this.sn=[],this.Ds=[],this.Fs=[],this.Vt=[];for(let f=0;f<=this.Mt;f++)this.sn[f]=0,this.Ds[f]=0,this.Fs[f]=0,this.Vt[f]=0;const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value,i=e.layer;this.sn[i]=Math.max(this.sn[i],this.nodeMinLayerSpace(e,!0)),this.Ds[i]=Math.max(this.Ds[i],this.nodeMinLayerSpace(e,!1))}let e=0;const i=this.As;for(let f=0;f<=this.Mt;f++){let t=i;this.sn[f]+this.Ds[f]<=0&&(t=0),f>0&&(e+=t/2),90===this.P||0===this.P?(e+=this.Ds[f],this.Fs[f]=e,e+=this.sn[f]):(e+=this.sn[f],this.Fs[f]=e,e+=this.Ds[f]),f<this.Mt&&(e+=t/2),this.Vt[f]=e}const n=e,s=this.arrangementOrigin;for(let f=0;f<=this.Mt;f++)270===this.P?this.Fs[f]=s.y+this.Fs[f]:90===this.P?(this.Fs[f]=s.y+n-this.Fs[f],this.Vt[f]=n-this.Vt[f]):180===this.P?this.Fs[f]=s.x+this.Fs[f]:(this.Fs[f]=s.x+n-this.Fs[f],this.Vt[f]=n-this.Vt[f]);const o=0!==this.En;t.reset();const r=270===this.P||90===this.P;let a=1/0,l=1/0,h=1/0,u=-1/0;for(;t.next();){const e=t.value,i=e.layer,n=0|e.column;let c=0,d=0;r?(c=s.x+this.Zi*n,d=this.Fs[i]):(c=this.Fs[i],d=s.y+this.Zi*n),e.centerX=c,e.centerY=d,o&&isFinite(e.fe)&&(r?e.node?e.x=s.x+e.fe:e.centerX=s.x+e.fe:e.node?e.y=s.y+e.fe:e.centerY=s.y+e.fe),a=Math.min(e.x,a),l=Math.min(e.y,l),r?(h=a,u=Math.max(u,e.bounds.right)):(h=l,u=Math.max(u,e.bounds.bottom))}this.HN=u-h;const c=s.x-a,d=s.y-l;for(this.lr=new y(o&&r?0:c,o&&!r?0:d),t.reset();t.next();){const e=t.value;e.x+=c,e.y+=d,e.commit()}}JN(){let t=0;const e=this.As;for(let s=0;s<=this.Mt;s++)t+=this.sn[s],t+=this.Ds[s];t+=this.Mt*e;const i=[],n=0!==this.En?this.HN:this.Zi*this.Kt;for(let s=this.maxLayer;s>=0;s--)270===this.P?0===s?i.push(new b(0,0,n,Math.abs(this.Vt[0]))):i.push(new b(0,this.Vt[s-1],n,Math.abs(this.Vt[s-1]-this.Vt[s]))):90===this.P?0===s?i.push(new b(0,this.Vt[0],n,Math.abs(this.Vt[0]-t))):i.push(new b(0,this.Vt[s],n,Math.abs(this.Vt[s-1]-this.Vt[s]))):180===this.P?0===s?i.push(new b(0,0,Math.abs(this.Vt[0]),n)):i.push(new b(this.Vt[s-1],0,Math.abs(this.Vt[s-1]-this.Vt[s]),n)):0===s?i.push(new b(this.Vt[0],0,Math.abs(this.Vt[0]-t),n)):i.push(new b(this.Vt[s],0,Math.abs(this.Vt[s-1]-this.Vt[s]),n));this.commitLayers(i,this.lr)}commitLayers(t,e){}commitLinks(){const t=this.network.edges.iterator;let e;for(;t.next();)e=t.value.link,null!==e&&(e.startRoute(),e.clearPoints(),e.commitRoute());for(t.reset();t.next();)e=t.value.link,null!==e&&e.updateRoute();for(t.reset();t.next();){const i=t.value;if(e=i.link,null===e||0===e.pointsCount)continue;e.startRoute();const n=e;let s=n.fromNode,o=n.toNode,r=n.fromPort,a=n.toPort;if(null!==s){const t=s.findVisibleNode();null!==t&&t!==s&&(s=t,r=t.port)}if(null!==o){const t=o.findVisibleNode();null!==t&&t!==o&&(o=t,a=t.port)}const l=e.computeSpot(!0,r),h=e.computeSpot(!1,a);let u=i.fromVertex,c=i.toVertex;if(i.valid){if(9===e.curve&&4===e.pointsCount)if(u.column===c.column&&0===this.alignOption){const t=e.getLinkPoint(s,r,l,!0,!1,o,a),i=e.getLinkPoint(o,a,h,!1,!1,s,r);t.isReal()||t.set(s.actualBounds.center),i.isReal()||i.set(o.actualBounds.center),e.clearPoints(),e.addPointAt(t.x,t.y),e.addPointAt((2*t.x+i.x)/3,(2*t.y+i.y)/3),e.addPointAt((t.x+2*i.x)/3,(t.y+2*i.y)/3),e.addPointAt(i.x,i.y)}else{let t=!1,i=!1;if(null!==r&&l===w.None&&(t=!0),null!==a&&h===w.None&&(i=!0),t||i){let n=null;t&&(n=e.getLinkPointFromPoint(s,r,r.getDocumentPoint(w.Center),e.getPoint(3),!0),n.isReal()||n.set(s.actualBounds.center),e.setPointAt(0,n.x,n.y));let l=null;if(i&&(l=e.getLinkPointFromPoint(o,a,a.getDocumentPoint(w.Center),e.getPoint(0),!1),l.isReal()||l.set(o.actualBounds.center),e.setPointAt(3,l.x,l.y)),n){const t=e.getPoint(2);e.setPointAt(1,(2*n.x+t.x)/3,(2*n.y+t.y)/3)}if(l){const t=e.getPoint(1);e.setPointAt(2,(2*l.x+t.x)/3,(2*l.y+t.y)/3)}}}e.commitRoute();continue}if(u.layer===c.layer){e.commitRoute();continue}let d=!1,f=!1;const g=this.As;let m=0,p=e.firstPickIndex+1;if(e.isOrthogonal)f=!0,m=e.pointsCount,m>4&&e.points.removeRange(2,m-3);else if(9===e.curve)d=!0,m=e.pointsCount,m>4&&e.points.removeRange(2,m-3),4===m&&(p=2);else{m=e.pointsCount;const t=l===w.None,i=h===w.None;m>2&&t&&i?e.points.removeRange(1,m-2):m>3&&t&&!i?e.points.removeRange(1,m-3):m>3&&!t&&i?e.points.removeRange(2,m-2):m>4&&!t&&!i&&e.points.removeRange(2,m-3)}let y,x,b=0,v=0,k=0,S=0,P=0,M=0,C=0;if(i.rev){let t=0;for(;null!==c&&u!==c;){y=null,x=null;const n=c.sourceEdges.iterator;for(;n.next();){const t=n.value;if(t.link===i.link&&(y=t.fromVertex,x=t.toVertex,null===y.node))break}if(null===y)break;if(y!==u)if(b=e.getPoint(p-1).x,v=e.getPoint(p-1).y,k=y.centerX,S=y.centerY,f)180===this.P||0===this.P?p===e.firstPickIndex+1?(e.insertPointAt(p++,b,v),e.insertPointAt(p++,b,S)):(null!==x?x.centerY:v)!==S&&(P=this.Vt[y.layer-1]+this.lr.x,e.insertPointAt(p++,P,v),e.insertPointAt(p++,P,S)):p===e.firstPickIndex+1?(e.insertPointAt(p++,b,v),e.insertPointAt(p++,k,v)):(null!==x?x.centerX:b)!==k&&(P=this.Vt[y.layer-1]+this.lr.y,e.insertPointAt(p++,b,P),e.insertPointAt(p++,k,P));else if(p===e.firstPickIndex+1)if(M=Math.max(10,this.sn[c.layer]),C=Math.max(10,this.Ds[c.layer]),d)180===this.P?k<=c.bounds.x?(t=c.bounds.x,e.insertPointAt(p++,t-M,S),e.insertPointAt(p++,t,S),e.insertPointAt(p++,t+C,S)):(e.insertPointAt(p++,k-M,S),e.insertPointAt(p++,k,S),e.insertPointAt(p++,k+C,S)):90===this.P?S>=c.bounds.bottom?(t=c.bounds.y+c.bounds.height,e.insertPointAt(p++,k,t+C),e.insertPointAt(p++,k,t),e.insertPointAt(p++,k,t-M)):(e.insertPointAt(p++,k,S+C),e.insertPointAt(p++,k,S),e.insertPointAt(p++,k,S-M)):270===this.P?S<=c.bounds.y?(t=c.bounds.y,e.insertPointAt(p++,k,t-M),e.insertPointAt(p++,k,t),e.insertPointAt(p++,k,t+C)):(e.insertPointAt(p++,k,S-M),e.insertPointAt(p++,k,S),e.insertPointAt(p++,k,S+C)):0===this.P&&(k>=c.bounds.right?(t=c.bounds.x+c.bounds.width,e.insertPointAt(p++,t+C,S),e.insertPointAt(p++,t,S),e.insertPointAt(p++,t-M,S)):(e.insertPointAt(p++,k+C,S),e.insertPointAt(p++,k,S),e.insertPointAt(p++,k-M,S)));else{e.insertPointAt(p++,b,v);let t=0;180===this.P||0===this.P?((180===this.P?k>=c.bounds.right:k<=c.bounds.x)&&(t=(0===this.P?-M:C)/2),e.insertPointAt(p++,b+t,S)):((270===this.P?S>=c.bounds.bottom:S<=c.bounds.y)&&(t=(90===this.P?-M:C)/2),e.insertPointAt(p++,k,v+t)),e.insertPointAt(p++,k,S)}else M=Math.max(10,this.sn[y.layer]),C=Math.max(10,this.Ds[y.layer]),d?180===this.P?(e.insertPointAt(p++,k-M-g,S),e.insertPointAt(p++,Math.min(k-M+g/2,k),S),e.insertPointAt(p++,k,S),e.insertPointAt(p++,k,S),e.insertPointAt(p++,Math.max(k+C-g/2,k),S),e.insertPointAt(p++,k+C+g,S)):90===this.P?(e.insertPointAt(p++,k,S+C+g),e.insertPointAt(p++,k,Math.max(S+C-g/2,S)),e.insertPointAt(p++,k,S),e.insertPointAt(p++,k,S),e.insertPointAt(p++,k,Math.min(S-M+g/2,S)),e.insertPointAt(p++,k,S-M-g)):270===this.P?(e.insertPointAt(p++,k,S-M-g),e.insertPointAt(p++,k,Math.min(S-M+g/2,S)),e.insertPointAt(p++,k,S),e.insertPointAt(p++,k,S),e.insertPointAt(p++,k,Math.max(S+C-g/2,S)),e.insertPointAt(p++,k,S+C+g)):(e.insertPointAt(p++,k+C+g,S),e.insertPointAt(p++,Math.max(k+C-g/2,k),S),e.insertPointAt(p++,k,S),e.insertPointAt(p++,k,S),e.insertPointAt(p++,Math.min(k-M+g/2,k),S),e.insertPointAt(p++,k-M-g,S)):(180===this.P||90===this.P||this.P,e.insertPointAt(p++,k,S));c=y}if(null===a||l!==w.None||f)if(b=e.getPoint(p-1).x,v=e.getPoint(p-1).y,k=e.getPoint(p).x,S=e.getPoint(p).y,f){const i=this.Ds[u.layer];let n=0;180===this.P||0===this.P?(n=v,n>=u.bounds.y&&n<=u.bounds.bottom&&(180===this.P?k>=u.bounds.x:k<=u.bounds.right)&&(t=u.centerX+(180===this.P?-i:i),n=n<u.bounds.y+u.bounds.height/2?u.bounds.y-this.Zi/2:u.bounds.bottom+this.Zi/2,e.insertPointAt(p++,t,v),e.insertPointAt(p++,t,n)),e.insertPointAt(p++,k,n),e.insertPointAt(p++,k,S)):(n=b,n>=u.bounds.x&&n<=u.bounds.right&&(270===this.P?S>=u.bounds.y:S<=u.bounds.bottom)&&(t=u.centerY+(270===this.P?-i:i),n=n<u.bounds.x+u.bounds.width/2?u.bounds.x-this.Zi/2:u.bounds.right+this.Zi/2,e.insertPointAt(p++,b,t),e.insertPointAt(p++,n,t)),e.insertPointAt(p++,n,S),e.insertPointAt(p++,k,S))}else if(d)M=Math.max(10,this.sn[u.layer]),C=Math.max(10,this.Ds[u.layer]),180===this.P&&k>=u.bounds.x?(t=u.bounds.x+u.bounds.width,e.setPointAt(p-2,t,v),e.setPointAt(p-1,t+C,v)):90===this.P&&S<=u.bounds.bottom?(t=u.bounds.y,e.setPointAt(p-2,b,t),e.setPointAt(p-1,b,t-M)):270===this.P&&S>=u.bounds.y?(t=u.bounds.y+u.bounds.height,e.setPointAt(p-2,b,t),e.setPointAt(p-1,b,t+C)):0===this.P&&k<=u.bounds.right&&(t=u.bounds.x,e.setPointAt(p-2,t,v),e.setPointAt(p-1,t-M,v));else{M=Math.max(10,this.sn[u.layer]),C=Math.max(10,this.Ds[u.layer]);let t=0;180===this.P||0===this.P?((180===this.P?k<=u.bounds.x:k>=u.bounds.right)&&(t=(0===this.P?C:-M)/2),e.insertPointAt(p++,k+t,v)):((270===this.P?S<=u.bounds.y:S>=u.bounds.bottom)&&(t=(90===this.P?C:-M)/2),e.insertPointAt(p++,b,S+t)),e.insertPointAt(p++,k,S)}}else{for(;null!==u&&u!==c;){y=null,x=null;const t=u.destinationEdges.iterator;for(;t.next();){const e=t.value;if(e.link===i.link&&(y=e.toVertex,x=e.fromVertex,null!==x.node&&(x=null),null===y.node))break}if(null===y)break;y!==c&&(b=e.getPoint(p-1).x,v=e.getPoint(p-1).y,k=y.centerX,S=y.centerY,f?180===this.P||0===this.P?(null!==x?x.centerY:v)!==S&&(P=this.Vt[y.layer]+this.lr.x,p===e.firstPickIndex+1&&(P=0===this.P?Math.max(P,b):Math.min(P,b)),e.insertPointAt(p++,P,v),e.insertPointAt(p++,P,S)):(null!==x?x.centerX:b)!==k&&(P=this.Vt[y.layer]+this.lr.y,p===e.firstPickIndex+1&&(P=90===this.P?Math.max(P,v):Math.min(P,v)),e.insertPointAt(p++,b,P),e.insertPointAt(p++,k,P)):(M=Math.max(10,this.sn[y.layer]),C=Math.max(10,this.Ds[y.layer]),d?180===this.P?(e.insertPointAt(p++,k+C+g,S),e.insertPointAt(p++,Math.max(k+C-g/2,k),S),e.insertPointAt(p++,k,S),e.insertPointAt(p++,k,S),e.insertPointAt(p++,Math.min(k-M+g/2,k),S),e.insertPointAt(p++,k-M-g,S)):90===this.P?(e.insertPointAt(p++,k,S-M-g),e.insertPointAt(p++,k,Math.min(S-M+g/2,S)),e.insertPointAt(p++,k,S),e.insertPointAt(p++,k,S),e.insertPointAt(p++,k,Math.max(S+C-g/2,S)),e.insertPointAt(p++,k,S+C+g)):270===this.P?(e.insertPointAt(p++,k,S+C+g),e.insertPointAt(p++,k,Math.max(S+C-g/2,S)),e.insertPointAt(p++,k,S),e.insertPointAt(p++,k,S),e.insertPointAt(p++,k,Math.min(S-M+g/2,S)),e.insertPointAt(p++,k,S-M-g)):(e.insertPointAt(p++,k-M-g,S),e.insertPointAt(p++,Math.min(k-M+g/2,k),S),e.insertPointAt(p++,k,S),e.insertPointAt(p++,k,S),e.insertPointAt(p++,Math.max(k+C-g/2,k),S),e.insertPointAt(p++,k+C+g,S)):180===this.P?(e.insertPointAt(p++,k+C,S),e.insertPointAt(p++,k-M,S)):90===this.P?(e.insertPointAt(p++,k,S-M),e.insertPointAt(p++,k,S+C)):270===this.P?(e.insertPointAt(p++,k,S+C),e.insertPointAt(p++,k,S-M)):(e.insertPointAt(p++,k-M,S),e.insertPointAt(p++,k+C,S)))),u=y}f&&(b=e.getPoint(p-1).x,v=e.getPoint(p-1).y,k=e.getPoint(p).x,S=e.getPoint(p).y,180===this.P||0===this.P?v!==S&&(P=0===this.P?Math.min(Math.max((k+b)/2,this.Vt[c.layer]+this.lr.x),k):Math.max(Math.min((k+b)/2,this.Vt[c.layer]+this.lr.x),k),e.insertPointAt(p++,P,v),e.insertPointAt(p++,P,S)):b!==k&&(P=90===this.P?Math.min(Math.max((S+v)/2,this.Vt[c.layer]+this.lr.y),S):Math.max(Math.min((S+v)/2,this.Vt[c.layer]+this.lr.y),S),e.insertPointAt(p++,b,P),e.insertPointAt(p++,k,P)))}if(null!==n&&d&&e.pointsCount>=4){if(null!==r){const t=l===w.None?e.getLinkPointFromPoint(s,r,r.getDocumentPoint(w.Center),e.getPoint(3),!0):e.getPoint(0);if(l===w.None){const i=e.getPoint(2),n=e.getPoint(3);90===this.direction||270===this.direction?(e.setPointAt(1,(t.x+i.x)/2,i.y),e.setPointAt(2,n.x,(i.y+n.y)/2)):(e.setPointAt(1,i.x,(t.y+i.y)/2),e.setPointAt(2,(i.x+n.x)/2,n.y))}t.isReal()||t.set(s.actualBounds.center),e.setPointAt(0,t.x,t.y)}if(null!==a){const t=h===w.None?e.getLinkPointFromPoint(o,a,a.getDocumentPoint(w.Center),e.getPoint(e.pointsCount-4),!1):e.getPoint(e.pointsCount-1);if(h===w.None){const i=e.getPoint(e.pointsCount-3),n=e.getPoint(e.pointsCount-4);90===this.direction||270===this.direction?(e.setPointAt(e.pointsCount-2,(t.x+i.x)/2,i.y),e.setPointAt(e.pointsCount-2,n.x,(i.y+n.y)/2)):(e.setPointAt(e.pointsCount-2,i.x,(t.y+i.y)/2),e.setPointAt(e.pointsCount-3,(i.x+n.x)/2,n.y))}t.isReal()||t.set(o.actualBounds.center),e.setPointAt(e.pointsCount-1,t.x,t.y)}}e.commitRoute(),i.commit()}}eI(){this.Xy=-1,this.Cg=0,this.Ts=0,this.nc=null,this.Ag=null,this.eu=null;for(let t=0;t<this.In.length;t++)this.In[t]=null}Uh(t){let e;const i=this.di[t];if(i>=this.In.length){const t=[];for(let e=0;e<this.In.length;e++)t[e]=this.In[e];this.In=t}void 0===this.In[i]||null===this.In[i]?e=[]:(e=this.In[i],this.In[i]=null);const n=this.eu[t];for(let s=0;s<n.length;s++){const t=n[s];e[t.index]=t}return e}Vh(t,e){this.In[this.di[t]]=e}get layerSpacing(){return this.As}set layerSpacing(t){this.As!==t&&(e.s(t,"number",ui,"layerSpacing"),t>=0&&(this.As=t,this.invalidateLayout()))}get columnSpacing(){return this.Zi}set columnSpacing(t){this.Zi!==t&&(e.s(t,"number",ui,"columnSpacing"),t>0&&(this.Zi=t,this.invalidateLayout()))}get direction(){return this.P}set direction(t){this.P!==t&&(e.s(t,"number",ui,"direction"),0===t||90===t||180===t||270===t?(this.P=t,this.invalidateLayout()):e.o("LayeredDigraphLayout.direction must be 0, 90, 180, or 270"))}get cycleRemoveOption(){return this.Zf}set cycleRemoveOption(t){this.Zf!==t&&(1===t||0===t||2===t)&&(this.Zf=t,this.invalidateLayout())}get layeringOption(){return this.Qf}set layeringOption(t){this.Qf!==t&&(10===t||11===t||12===t)&&(this.Qf=t,this.invalidateLayout())}get initializeOption(){return this._f}set initializeOption(t){this._f!==t&&(20===t||21===t||22===t)&&(this._f=t,this.invalidateLayout())}get iterations(){return this.sc}set iterations(t){this.sc!==t&&t>=0&&(this.sc=t,this.invalidateLayout())}get aggressiveOption(){return this.tu}set aggressiveOption(t){this.tu!==t&&(30===t||31===t||32===t)&&(this.tu=t,this.invalidateLayout())}get packOption(){return this.rr}set packOption(t){this.rr!==t&&(e.s(t,"number",ui,"packOption"),t>=0&&t<8&&(this.rr=t,this.invalidateLayout()))}get packIterations(){return this.iu}set packIterations(t){this.iu=t}get alignOption(){return this.En}set alignOption(t){this.En!==t&&(e.s(t,"number",ui,"align"),t>=0&&t<16&&(this.En=t,this.invalidateLayout()))}get setsPortSpots(){return this.On}set setsPortSpots(t){this.On!==t&&(e.s(t,"boolean",ui,"setsPortSpots"),this.On=t,this.invalidateLayout())}get maxLayer(){return this.Mt}get maxIndex(){return this.Xy}get maxColumn(){return this.Kt}get minIndexLayer(){return this.Cg}get maxIndexLayer(){return this.Ts}static CycleDepthFirst=0;static CycleGreedy=1;static CycleFromLayers=2;static LayerOptimalLinkLength=10;static LayerLongestPathSink=11;static LayerLongestPathSource=12;static InitDepthFirstOut=20;static InitDepthFirstIn=21;static InitNaive=22;static AggressiveNone=30;static AggressiveLess=31;static AggressiveMore=32;static PackNone=0;static PackExpand=1;static PackStraighten=2;static PackMedian=4;static PackAll=15;static AlignNone=0;static AlignUpperLeft=1;static AlignUpperRight=2;static AlignLowerLeft=4;static AlignLowerRight=8;static AlignAll=15}class ci extends Ae{constructor(t){super(t)}createVertex(){return new di(this)}createEdge(){return new fi(this)}}class di extends De{$o;Qr;Ft;ek;sk;_i;su;$n;Q1;J1;$1;oc;Bn;ND;zh;Qe;nu;fe;Un;Hy=null;jy=null;qy=null;Wy=null;constructor(t){super(t),this.$o=-1,this.Qr=-1,this.Ft=-1,this.ek=NaN,this.sk=null,this._i=!1,this.su=NaN,this.$n=NaN,this.Q1=0,this.J1=null,this.$1=null}static AD(t,e){return t.index-e.index}getProperSourceEdges(){if(!this.qy){const t=[];for(const e of this.bo){const i=e;i.valid&&t.push(i)}this.qy=t}return this.qy}getProperDestinationEdges(){if(!this.Wy){const t=[];for(const e of this.er){const i=e;i.valid&&t.push(i)}this.Wy=t}return this.Wy}getDestinationEdge(t){const i=this.getProperDestinationEdges();for(const e of i)if(e.toVertex===t)return e;e.o("Unable to find destination edge to given vertex")}getProperSourceVertexes(){if(!this.Hy){const t=[];for(const e of this.bo){const i=e;!i.valid||i.fromVertex.layer<=i.toVertex.layer||t.push(i.fromVertex)}t.sort(di.AD),this.Hy=t}return this.Hy}getProperDestinationVertexes(){if(!this.jy){const t=[];for(const e of this.er){const i=e;!i.valid||i.fromVertex.layer<=i.toVertex.layer||t.push(i.toVertex)}t.sort(di.AD),this.jy=t}return this.jy}addSourceEdge(t){super.addSourceEdge(t),this.Hy=null,this.qy=null}deleteSourceEdge(t){super.deleteSourceEdge(t),this.Hy=null,this.qy=null}addDestinationEdge(t){super.addDestinationEdge(t),this.jy=null,this.Wy=null}deleteDestinationEdge(t){super.deleteDestinationEdge(t),this.jy=null,this.Wy=null}get layer(){return this.$o}set layer(t){this.$o!==t&&(e.s(t,"number",di,"layer"),this.$o=t)}get column(){return this.Qr}set column(t){this.Qr!==t&&(e.s(t,"number",di,"column"),this.Qr=t)}get index(){return this.Ft}set index(t){this.Ft!==t&&(e.s(t,"number",di,"index"),this.Ft=t)}get component(){return this.ek}set component(t){this.ek!==t&&(e.s(t,"number",di,"component"),this.ek=t)}get near(){return this.sk}set near(t){this.sk!==t&&(this.sk=t)}}class fi extends Fe{_i;nk;ok;rk;lk;hk;ak;constructor(t){super(t),this._i=!1,this.nk=!1,this.ok=!1,this.rk=NaN,this.lk=NaN,this.hk=0,this.ak=0}get fromVertex(){return this.Je}set fromVertex(t){this.Je!==t&&(this.Je=t)}get toVertex(){return this.$e}set toVertex(t){this.$e!==t&&(this.$e=t)}get valid(){return this._i}set valid(t){this._i!==t&&(e.s(t,"boolean",fi,"valid"),this._i=t)}get rev(){return this.nk}set rev(t){this.nk!==t&&(e.s(t,"boolean",fi,"rev"),this.nk=t)}get forest(){return this.ok}set forest(t){this.ok!==t&&(e.s(t,"boolean",fi,"forest"),this.ok=t)}get portFromPos(){return this.rk}set portFromPos(t){this.rk!==t&&(e.s(t,"number",fi,"portFromPos"),this.rk=t)}get portToPos(){return this.lk}set portToPos(t){this.lk!==t&&(e.s(t,"number",fi,"portToPos"),this.lk=t)}get portFromColOffset(){return this.hk}set portFromColOffset(t){this.hk!==t&&(e.s(t,"number",fi,"portFromColOffset"),this.hk=t)}get portToColOffset(){return this.ak}set portToColOffset(t){this.ak!==t&&(e.s(t,"number",fi,"portToColOffset"),this.ak=t)}}var gi=(t=>(t[t.Default=0]="Default",t[t.Destination=1]="Destination",t[t.Source=2]="Source",t))(gi||{}),mi=(t=>(t[t.Forwards=10]="Forwards",t[t.Reverse=11]="Reverse",t[t.Ascending=12]="Ascending",t[t.Descending=13]="Descending",t))(mi||{}),pi=(t=>(t[t.CenterSubtrees=20]="CenterSubtrees",t[t.CenterChildren=21]="CenterChildren",t[t.Start=22]="Start",t[t.End=23]="End",t[t.Bus=24]="Bus",t[t.BusBranching=25]="BusBranching",t[t.TopLeftBus=26]="TopLeftBus",t[t.BottomRightBus=27]="BottomRightBus",t[t.Custom=28]="Custom",t))(pi||{}),yi=(t=>(t[t.None=30]="None",t[t.Block=31]="Block",t))(yi||{}),xi=(t=>(t[t.Layered=40]="Layered",t[t.LastParents=41]="LastParents",t[t.Alternating=42]="Alternating",t[t.RootOnly=43]="RootOnly",t))(xi||{}),bi=(t=>(t[t.Vertical=50]="Vertical",t[t.Horizontal=51]="Horizontal",t[t.FixedRoots=52]="FixedRoots",t))(bi||{}),vi=(t=>(t[t.Individual=60]="Individual",t[t.Siblings=61]="Siblings",t[t.Uniform=62]="Uniform",t))(vi||{});class wi extends Le{Oi;Di;ou;Dg;$N;Oe;Gi;Ls;V;z;ck;cs;constructor(t){super(),this.Oi=new u,this.Di=0,this.cs=1,this.ou=40,this.Dg=60,this.$N=[],this.Oe=!0,this.Gi=50,this.Ls=new x(10,10).u();const e=new ki(this);this.V=new Si(e),this.z=new Si(e),this.ck=[],t&&Object.assign(this,t)}cloneProtected(t){super.cloneProtected(t),t.Di=this.Di,t.ou=this.ou,t.Dg=this.Dg,t.Oe=this.Oe,t.Gi=this.Gi,t.Ls.a(this.Ls),t.V.copyInheritedPropertiesFrom(this.V),t.z.copyInheritedPropertiesFrom(this.z)}hi(t){t in pi?this.alignment=t:t in bi?this.arrangement=t:t in yi?this.compaction=t:t in gi?this.path=t:t in mi?this.sorting=t:t in xi?this.treeStyle=t:super.hi(t)}createNetwork(){return new ki(this)}makeNetwork(t){const e=this.createNetwork(),i=t=>{if(t instanceof me)return!t.isLinkLabel&&"Comment"!==t.category;if(t instanceof ve){const e=t.fromNode;if(null===e||e.isLinkLabel||"Comment"===e.category)return!1;const i=t.toNode;return!(null===i||i.isLinkLabel||"Comment"===i.category)}return!1};return t instanceof bt?(e.addParts(t.nodes,!0,i),e.addParts(t.links,!0,i)):t instanceof Ne?e.addParts(t.memberParts,!1,i):e.addParts(t.iterator,!1,i),e}doLayout(t){null===this.network&&(this.network=this.makeNetwork(t)),52!==this.arrangement&&(this.arrangementOrigin=this.initialOrigin(this.arrangementOrigin));let e=this.diagram;null===e&&t instanceof bt&&(e=t),0===this.path&&null!==e?this.cs=e.isTreePathToChildren?1:2:this.cs=0===this.path?1:this.path,this.network.vertexes.count>0&&(this.VI(),this.zI(),this.XI(),this.YI(),this.KN(),this.KI(),this.arrangeTrees(),this.updateParts()),this.network=null,this.Oi=new u,this.isValidLayout=!0}VI(){this.network.deleteSelfEdges();const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value;e.initialized=!1,e.level=0,e.parent=null,e.children=[]}if(this.Oi.count>0){const t=new u,e=this.Oi.iterator;for(;e.next();){const i=e.value;if(i instanceof me){const e=this.network.findVertex(i);null!==e&&t.add(e)}else i instanceof Si&&t.add(i)}this.Oi=t}0===this.Oi.count&&this.findRoots();const e=this.Oi.copy().iterator;for(;e.next();){const t=e.value;t.initialized||(t.initialized=!0,this.ZN(t))}let i=this.network.vertexes,n=null;for(;n=this.GI(i),n.count>0;){const t=this.TD(n);null!==t&&this.Oi.add(t),t.initialized=!0,this.ZN(t),i=n}}GI(t){const e=new u,i=t.iterator;for(;i.next();){const t=i.value;t.initialized||e.add(t)}return e}findRoots(){const t=this.network.vertexes,i=t.iterator;for(;i.next();){const t=i.value;switch(this.cs){case 1:0===t.sourceEdges.count&&this.Oi.add(t);break;case 2:0===t.destinationEdges.count&&this.Oi.add(t);break;default:e.o("Unhandled path value "+this.cs.toString())}}if(0===this.Oi.count){const e=this.TD(t);null!==e&&this.Oi.add(e)}}TD(t){let i=999999,n=null;const s=t.iterator;for(;s.next();){const t=s.value;switch(this.cs){case 1:t.sourceEdges.count<i&&(i=t.sourceEdges.count,n=t);break;case 2:t.destinationEdges.count<i&&(i=t.destinationEdges.count,n=t);break;default:e.o("Unhandled path value "+this.cs.toString())}}return n}ZN(t){if(null===t)return;switch(this.cs){case 1:if(t.destinationEdges.count>0){const e=new l,i=t.destinationVertexes;for(;i.next();){const n=i.value;this.DD(t,n)&&e.add(n)}e.count>0&&(t.children=e.toArray())}break;case 2:if(t.sourceEdges.count>0){const e=new l,i=t.sourceVertexes;for(;i.next();){const n=i.value;this.DD(t,n)&&e.add(n)}e.count>0&&(t.children=e.toArray())}break;default:e.o("Unhandled path value"+this.cs.toString())}const i=t.children,n=i.length;for(let e=0;e<n;e++){const n=i[e];n.initialized=!0,n.level=t.level+1,n.parent=t,this.Oi.delete(n)}for(let e=0;e<n;e++){const t=i[e];this.ZN(t)}}DD(t,e){return!e.initialized||!(this.HI(e,t)||e.level>t.level)&&(this.jI(e.parent,e),!0)}HI(t,e){if(null===e)return!1;let i=e.parent;for(;null!==i&&i!==t;)i=i.parent;return i===t}jI(t,e){if(null===t||null===e)return;const i=t.children;let n=0;for(let s=0;s<i.length;s++)i[s]===e&&n++;if(n>0){const s=new Array(i.length-n);let o=0;for(let t=0;t<i.length;t++)i[t]!==e&&(s[o++]=i[t]);t.children=s}}zI(){const t=this.Oi.iterator;for(;t.next();){const e=t.value;e instanceof Si&&this.FD(e)}}FD(t){if(null===t)return;this.initializeTreeVertexValues(t),25===t.alignment&&this.sortTreeVertexChildren(t);let e=0,i=t.childrenCount,n=0;const s=t.children,o=s.length;for(let r=0;r<o;r++){const t=s[r];this.FD(t),e+=t.descendantCount+1,i=Math.max(i,t.maxChildrenCount),n=Math.max(n,t.maxGenerationCount)}t.descendantCount=e,t.maxChildrenCount=i,t.maxGenerationCount=i>0?n+1:0}qI(t){switch(this.ou){default:case 40:return null!==t.parent?t.parent:this.V;case 43:return null===t.parent?this.V:null===t.parent.parent?this.z:t.parent;case 42:return null!==t.parent?null!==t.parent.parent?t.parent.parent:this.z:this.V;case 41:{let e=!0;if(0===t.childrenCount)e=!1;else{const i=t.children,n=i.length;for(let t=0;t<n;t++)if(i[t].childrenCount>0){e=!1;break}}return e&&null!==t.parent?this.z:null!==t.parent?t.parent:this.V}}}initializeTreeVertexValues(t){const e=this.qI(t);if(t.copyInheritedPropertiesFrom(e),null!==t.parent&&25===t.parent.alignment){let e=t.angle;const i=t.parent.children;let n=0;for(;n<i.length&&t!==i[n];)n++;n%2===0?n!==i.length-1&&(e=90===e?180:180===e?270:270===e?180:270):e=90===e?0:180===e?90:270===e?0:90,t.angle=e}t.initialized=!0}XI(){const t=this.Oi.iterator;for(;t.next();){const e=t.value;e instanceof Si&&this.RD(e)}}RD(t){if(null===t)return;this.assignTreeVertexValues(t);const e=t.children,i=e.length;for(let n=0;n<i;n++){const t=e[n];this.RD(t)}}assignTreeVertexValues(t){}YI(){const t=this.Oi.iterator;for(;t.next();){const e=t.value;e instanceof Si&&this.vD(e)}}vD(t){if(null===t)return;25!==t.alignment&&this.sortTreeVertexChildren(t);const e=t.children,i=e.length;for(let n=0;n<i;n++){const t=e[n];this.vD(t)}}sortTreeVertexChildren(t){switch(t.sorting){default:case 10:break;case 11:t.children.reverse();break;case 12:t.children.sort(t.comparer);break;case 13:t.children.sort(t.comparer),t.children.reverse()}}KN(){if(!this.comments)return;const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value;this.addComments(e)}}addComments(t){const e=t.angle,i=t.parent;let n=0,s=21,o=!1;null!==i&&(n=i.angle,s=i.alignment,o=this.isBusAlignment(s));const r=90===e||270===e,a=90===n||270===n,l=0===t.childrenCount;let h=0,u=0,c=0;const d=t.commentSpacing;if(null!==t.node){const e=t.node.findNodesConnected();for(;e.next();){const i=e.value;if("Comment"!==i.category||!i.canLayout())continue;null===t.comments&&(t.comments=[]),t.comments.push(i),i.ensureBounds();const n=i.measuredBounds;r&&!l||!o&&!a&&l||o&&a&&l?(h=Math.max(h,n.width),u+=n.height+Math.abs(c)):(h+=n.width+Math.abs(c),u=Math.max(u,n.height)),c=d}}if(null!==t.comments){r&&!l||!o&&!a&&l||o&&a&&l?(h+=Math.abs(t.commentMargin),u=Math.max(0,u-t.height)):(u+=Math.abs(t.commentMargin),h=Math.max(0,h-t.width));const e=b.X(0,0,t.bounds.width+h,t.bounds.height+u);t.bounds=e,b.e(e)}}isBusAlignment(t){return 24===t||25===t||26===t||27===t}Jy(t){return 24===t||25===t}QN(t){const e=t.parent;if(null!==e){const i=e.alignment;if(this.isBusAlignment(i)){if(this.Jy(i)){const i=e.children;let n=0;for(;n<i.length&&t!==i[n];)n++;return n%2===0}return 26===i}}return!1}layoutComments(t){if(null!==t.comments){const e=t.node.measuredBounds,i=t.parent,n=t.angle;let s=0,o=21,r=!1;null!==i&&(s=i.angle,o=i.alignment,r=this.isBusAlignment(o));const a=90===n||270===n,l=90===s||270===s,h=0===t.childrenCount,u=this.QN(t);let c=0;const d=t.comments,f=d.length,g=y.l();for(let p=0;p<f;p++){const e=d[p],i=e.measuredBounds;if(a&&!h||!r&&!l&&h||r&&l&&h){if(s>135&&!r||l&&u)if(t.commentMargin>=0){g.i(t.bounds.x-t.commentMargin-i.width,t.bounds.y+c),e.move(g);const n=e.findLinksInto();for(;n.next();){const t=n.value;t.fromSpot=w.MiddleLeft,t.toSpot=w.MiddleRight}}else{g.i(t.bounds.x+2*t.focus.x-t.commentMargin,t.bounds.y+c),e.move(g);const i=e.findLinksInto();for(;i.next();){const t=i.value;t.fromSpot=w.MiddleRight,t.toSpot=w.MiddleLeft}}else if(t.commentMargin>=0){g.i(t.bounds.x+2*t.focus.x+t.commentMargin,t.bounds.y+c),e.move(g);const i=e.findLinksInto();for(;i.next();){const t=i.value;t.fromSpot=w.MiddleRight,t.toSpot=w.MiddleLeft}}else{g.i(t.bounds.x+t.commentMargin-i.width,t.bounds.y+c),e.move(g);const n=e.findLinksInto();for(;n.next();){const t=n.value;t.fromSpot=w.MiddleLeft,t.toSpot=w.MiddleRight}}t.commentSpacing>=0?c+=i.height+t.commentSpacing:c+=t.commentSpacing-i.height}else{if(s>135&&!r||!l&&u)if(t.commentMargin>=0){g.i(t.bounds.x+c,t.bounds.y-t.commentMargin-i.height),e.move(g);const n=e.findLinksInto();for(;n.next();){const t=n.value;t.fromSpot=w.MiddleTop,t.toSpot=w.MiddleBottom}}else{g.i(t.bounds.x+c,t.bounds.y+2*t.focus.y-t.commentMargin),e.move(g);const i=e.findLinksInto();for(;i.next();){const t=i.value;t.fromSpot=w.MiddleBottom,t.toSpot=w.MiddleTop}}else if(t.commentMargin>=0){g.i(t.bounds.x+c,t.bounds.y+2*t.focus.y+t.commentMargin),e.move(g);const i=e.findLinksInto();for(;i.next();){const t=i.value;t.fromSpot=w.MiddleBottom,t.toSpot=w.MiddleTop}}else{g.i(t.bounds.x+c,t.bounds.y+t.commentMargin-i.height),e.move(g);const n=e.findLinksInto();for(;n.next();){const t=n.value;t.fromSpot=w.MiddleTop,t.toSpot=w.MiddleBottom}}t.commentSpacing>=0?c+=i.width+t.commentSpacing:c+=t.commentSpacing-i.width}}y.e(g);const m=c-t.commentSpacing-(a?e.height:e.width);if(1===this.cs){const e=t.destinationEdges;for(;e.next();){const t=e.value.link;null!==t&&!t.isAvoiding&&(t.fromEndSegmentLength=m>0?m:NaN)}}else{const e=t.sourceEdges;for(;e.next();){const t=e.value.link;null!==t&&!t.isAvoiding&&(t.toEndSegmentLength=m>0?m:NaN)}}}}KI(){if(62===this.layerStyle){const t=[];let e=this.network.vertexes.iterator;for(;e.next();){const i=e.value;let n=i.parent;null===n&&(n=i);const s=0===n.angle||180===n.angle;let o=t[i.level];void 0===o&&(o=0),t[i.level]=Math.max(o,s?i.width:i.height)}for(let i=0;i<t.length;i++)void 0===t[i]&&(t[i]=0);for(this.$N=t,e=this.network.vertexes.iterator;e.next();){const i=e.value;let n=i.parent;null===n&&(n=i),0===n.angle||180===n.angle?(180===n.angle&&(i.focusX+=t[i.level]-i.width),i.width=t[i.level]):(270===n.angle&&(i.focusY+=t[i.level]-i.height),i.height=t[i.level])}}else if(61===this.layerStyle){const t=this.network.vertexes.iterator;for(;t.next();){const e=t.value,i=0===e.angle||180===e.angle;let n=-1;for(let t=0;t<e.children.length;t++){const s=e.children[t];n=Math.max(n,i?s.width:s.height)}if(n>=0)for(let t=0;t<e.children.length;t++){const s=e.children[t];i?(180===e.angle&&(s.focusX+=n-s.width),s.width=n):(270===e.angle&&(s.focusY+=n-s.height),s.height=n)}}}const t=this.Oi.iterator;for(;t.next();){const e=t.value;e instanceof Si&&this.layoutTree(e)}}layoutTree(t){if(null===t)return;const e=t.children,i=e.length;for(let n=0;n<i;n++){const t=e[n];this.layoutTree(t)}if(30===t.compaction)this.OD(t);else 25===t.alignment?this.OD(t):this.WI(t)}OD(t){if(0===t.childrenCount){let e=!1,i=0,n=21;null!==t.parent&&(i=t.parent.angle,n=t.parent.alignment,e=this.isBusAlignment(n));const s=this.QN(t);return t.B.i(0,0),t.yt.i(t.width,t.height),void(null===t.parent||null===t.comments||(180!==i&&270!==i||e)&&!s?t.ft.i(0,0):180===i&&!e||(90===i||270===i)&&s?t.ft.i(t.width-2*t.focus.x,0):t.ft.i(0,t.height-2*t.focus.y))}const e=this.orthoAngle(t),i=90===e||270===e;let n=0;const s=t.children,o=s.length;for(let D=0;D<o;D++){const t=s[D];n=Math.max(n,i?t.yt.width:t.yt.height)}const r=t.alignment,a=22===r,l=23===r,h=this.isBusAlignment(r),u=Math.max(0,t.breadthLimit),c=this.computeLayerSpacing(t),d=t.nodeSpacing,f=this.computeNodeIndent(t),g=a||l?0:f/2,m=t.rowSpacing;let p=0;(a||l)&&(p=Math.max(0,t.rowIndent));const y=t.width,x=t.height;let b=0,v=0,w=0,k=0,S=0,P=0,M=0,C=0,N=0,T=0;if(h&&!this.Jy(r)&&e>135&&s.reverse(),this.Jy(r))if(o>1)for(let D=0;D<o;D++){const t=s[D],e=t.yt;D%2===0&&D!==o-1?N=Math.max(N,(i?e.width:e.height)+this.computeBusNodeSpacing(t)-d):D%2!==0&&(T=Math.max(T,(i?e.width:e.height)+this.computeBusNodeSpacing(t)-d))}else 1===o&&(N=i?s[0].yt.width:s[0].yt.height);if(h)switch(r){case 24:case 25:let r;r=e<135?this.ID(t,s,N,T,b,v):this.ED(t,s,N,T,b,v),N=r.x,b=r.width,v=r.height;break;case 26:for(let t=0;t<o;t++){const e=s[t],o=e.yt,r=0===M?0:m;i?(e.B.i(n-o.width,S+r),b=Math.max(b,o.width),v=Math.max(v,S+r+o.height),S+=r+o.height):(e.B.i(k+r,n-o.height),b=Math.max(b,k+r+o.width),v=Math.max(v,o.height),k+=r+o.width),M++}break;case 27:for(let e=0;e<o;e++){const n=s[e],o=n.yt,r=0===M?0:m;i?(n.B.i(d/2+t.focus.x,S+r),b=Math.max(b,o.width),v=Math.max(v,S+r+o.height),S+=r+o.height):(n.B.i(k+r,d/2+t.focus.y),b=Math.max(b,k+r+o.width),v=Math.max(v,o.height),k+=r+o.width),M++}}else for(let D=0;D<o;D++){const o=s[D],a=o.yt;if(i){u>0&&M>0&&k+d+a.width>u&&(k<n&&this.rc(t,r,n-k,0,C,D-1),P++,M=0,C=D,w=v,k=0,S=e>135?-v-m:v+m);const i=0===M?g:d;this.fk(o,0,S),o.B.i(k+i,S),b=Math.max(b,k+i+a.width),v=Math.max(v,w+(0===P?0:m)+a.height),k+=i+a.width}else{u>0&&M>0&&S+d+a.height>u&&(S<n&&this.rc(t,r,0,n-S,C,D-1),P++,M=0,C=D,w=b,S=0,k=e>135?-b-m:b+m);const i=0===M?g:d;this.fk(o,k,0),o.B.i(k,S+i),v=Math.max(v,S+i+a.height),b=Math.max(b,w+(0===P?0:m)+a.width),S+=i+a.height}M++}P>0&&(i?(v+=Math.max(0,c),k<b&&this.rc(t,r,b-k,0,C,o-1),p>0&&(l||this.ru(t,p,0,0,o-1),b+=p)):(b+=Math.max(0,c),S<v&&this.rc(t,r,0,v-S,C,o-1),p>0&&(l||this.ru(t,0,p,0,o-1),v+=p)));let L=0,A=0;switch(r){case 20:i?L+=b/2-t.focus.x-f/2:A+=v/2-t.focus.y-f/2;break;default:case 21:if(P>0)i?L+=b/2-t.focus.x-f/2:A+=v/2-t.focus.y-f/2;else{const e=o;if(i){const i=s[0].B.x+s[0].ft.x;L+=i+(s[e-1].B.x+s[e-1].ft.x+2*s[e-1].focus.x-i)/2-t.focus.x-f/2}else{const i=s[0].B.y+s[0].ft.y;A+=i+(s[e-1].B.y+s[e-1].ft.y+2*s[e-1].focus.y-i)/2-t.focus.y-f/2}}break;case 22:i?(L-=f,b+=f):(A-=f,v+=f);break;case 23:i?(L+=b-t.width+f,b+=f):(A+=v-t.height+f,v+=f);break;case 24:case 25:i?L+=o>1?N+d/2-t.focus.x:s[0].focus.x-t.focus.x+s[0].ft.x:A+=o>1?N+d/2-t.focus.y:s[0].focus.y-t.focus.y+s[0].ft.y;break;case 26:i?L+=b+d/2-t.focus.x:A+=v+d/2-t.focus.y;break;case 27:break;case 28:const e=this.customAlignment(t,L,A,b,v);L=e[0],A=e[1],b=e[2],v=e[3]}for(let D=0;D<o;D++){const t=s[D];i?t.B.i(t.B.x+t.ft.x-L,t.B.y+(e>135?(h?-v:-t.yt.height)+t.ft.y-c:x+c+t.ft.y)):t.B.i(t.B.x+(e>135?(h?-b:-t.yt.width)+t.ft.x-c:y+c+t.ft.x),t.B.y+t.ft.y-A)}i?(b=this._N(t,b,L),L<0&&(L=0),e>135&&(A+=v+c),v=Math.max(Math.max(v,x),v+x+c)):(e>135&&(L+=b+c),b=Math.max(Math.max(b,y),b+y+c),v=this.tC(t,v,A),A<0&&(A=0)),t.ft.i(L,A),t.yt.i(b,v)}customAlignment(t,e,i,n,s){return[e,i,n,s]}ID(t,e,i,n,s,o){const r=e.length;if(0===r)return new b(i,0,s,o);if(1===r){const t=e[0];return s=t.yt.width,o=t.yt.height,new b(i,0,s,o)}const a=t.nodeSpacing,l=t.rowSpacing,h=90===this.orthoAngle(t);let u=0,c=0,d=0;for(let m=0;m<r;m++){if(m%2!==0||r>1&&m===r-1)continue;const t=e[m],n=t.yt,f=0===u?0:l;if(h){const e=this.computeBusNodeSpacing(t)-a;t.B.i(i-(n.width+e),d+f),s=Math.max(s,n.width+e),o=Math.max(o,d+f+n.height),d+=f+n.height}else{const e=this.computeBusNodeSpacing(t)-a;t.B.i(c+f,i-(n.height+e)),o=Math.max(o,n.height+e),s=Math.max(s,c+f+n.width),c+=f+n.width}u++}u=0;const f=c,g=d;h?(c=i+a,d=0):(c=0,d=i+a);for(let m=0;m<r;m++){if(m%2===0)continue;const t=e[m],i=t.yt,n=0===u?0:l;if(h){const e=this.computeBusNodeSpacing(t)-a;t.B.i(c+e,d+n),s=Math.max(s,c+i.width+e),o=Math.max(o,d+n+i.height),d+=n+i.height}else{const e=this.computeBusNodeSpacing(t)-a;t.B.i(c+n,d+e),s=Math.max(s,c+n+i.width),o=Math.max(o,d+i.height+e),c+=n+i.width}u++}if(r>1&&r%2===1){const n=e[r-1],l=n.yt,u=this.computeBusLastRowSpacing(n,h?Math.max(Math.abs(g),Math.abs(d)):Math.max(Math.abs(f),Math.abs(c)));if(h){n.B.i(i+a/2-n.focus.x-n.ft.x,o+u);const e=i+a/2-n.focus.x-n.ft.x;s=Math.max(s,e+l.width),e<0&&(s-=e),o=Math.max(o,Math.max(g,d)+u+l.height),n.B.x<0&&(i=this.uk(t,n.B.x,!1,i,a))}else{n.B.i(s+u,i+a/2-n.focus.y-n.ft.y),s=Math.max(s,Math.max(f,c)+u+l.width);const e=i+a/2-n.focus.y-n.ft.y;o=Math.max(o,e+l.height),e<0&&(o-=e),n.B.y<0&&(i=this.uk(t,n.B.y,!0,i,a))}}return new b(i,0,s,o)}ED(t,e,i,n,s,o){const r=e.length;if(0===r)return new b(i,0,s,o);if(1===r){const t=e[0];return s=t.yt.width,o=t.yt.height,new b(i,0,s,o)}const a=t.nodeSpacing,l=t.rowSpacing,h=270===this.orthoAngle(t);let u=0,c=0,d=0;for(let m=0;m<r;m++){if(m%2!==0||r>1&&m===r-1)continue;const t=e[m],n=t.yt,f=0===u?0:l;if(h){const e=this.computeBusNodeSpacing(t)-a;d-=f+n.height,t.B.i(i-(n.width+e),d),s=Math.max(s,n.width+e),o=Math.max(o,Math.abs(d))}else{const e=this.computeBusNodeSpacing(t)-a;c-=f+n.width,t.B.i(c,i-(n.height+e)),o=Math.max(o,n.height+e),s=Math.max(s,Math.abs(c))}u++}u=0;const f=c,g=d;h?(c=i+a,d=0):(c=0,d=i+a);for(let m=0;m<r;m++){if(m%2===0)continue;const t=e[m],i=t.yt,n=0===u?0:l;if(h){const e=this.computeBusNodeSpacing(t)-a;d-=n+i.height,t.B.i(c+e,d),s=Math.max(s,c+i.width+e),o=Math.max(o,Math.abs(d))}else{const e=this.computeBusNodeSpacing(t)-a;c-=n+i.width,t.B.i(c,d+e),o=Math.max(o,d+i.height+e),s=Math.max(s,Math.abs(c))}u++}if(r>1&&r%2===1){const n=e[r-1],l=n.yt,u=this.computeBusLastRowSpacing(n,h?Math.max(Math.abs(g),Math.abs(d)):Math.max(Math.abs(f),Math.abs(c)));if(h){n.B.i(i+a/2-n.focus.x-n.ft.x,-o-l.height-u);const e=i+a/2-n.focus.x-n.ft.x;s=Math.max(s,e+l.width),e<0&&(s-=e),o=Math.max(o,Math.abs(Math.min(g,d))+u+l.height),n.B.x<0&&(i=this.uk(t,n.B.x,!1,i,a))}else{n.B.i(-s-l.width-u,i+a/2-n.focus.y-n.ft.y),s=Math.max(s,Math.abs(Math.min(f,c))+u+l.width);const e=i+a/2-n.focus.y-n.ft.y;o=Math.max(o,e+l.height),e<0&&(o-=e),n.B.y<0&&(i=this.uk(t,n.B.y,!0,i,a))}}for(let m=0;m<r;m++){const t=e[m];h?t.B.i(t.B.x,t.B.y+o):t.B.i(t.B.x+s,t.B.y)}return new b(i,0,s,o)}computeBusNodeSpacing(t){return null===t.parent?0:t.parent.nodeSpacing}computeBusLastRowSpacing(t,e){return null===t.parent?0:t.parent.rowSpacing}uk(t,e,i,n,s){const o=t.children,r=o.length;for(let l=0;l<r;l++)i?o[l].B.i(o[l].B.x,o[l].B.y-e):o[l].B.i(o[l].B.x-e,o[l].B.y);const a=o[r-1];return Math.max(n,i?a.ft.y+a.focus.y-s/2:a.ft.x+a.focus.x-s/2)}_N(t,e,i){switch(t.alignment){case 21:case 20:let n=e;return i+t.width>n&&(n=i+t.width),i<0&&(n-=i),n;case 22:return t.width>e?t.width:e;case 23:return 2*t.focus.x>e?t.width:e+t.width-2*t.focus.x;case 24:case 25:const s=Math.min(0,i),o=Math.max(e,i+t.width);return Math.max(t.width,o-s);case 26:return t.width-t.focus.x+t.nodeSpacing/2+e;case 27:return Math.max(t.width,t.focus.x+t.nodeSpacing/2+e);default:return e}}tC(t,e,i){switch(t.alignment){case 21:case 20:let n=e;return i+t.height>n&&(n=i+t.height),i<0&&(n-=i),n;case 22:return t.height>e?t.height:e;case 23:return 2*t.focus.y>e?t.height:e+t.height-2*t.focus.y;case 24:case 25:const s=Math.min(0,i),o=Math.max(e,i+t.height);return Math.max(t.height,o-s);case 26:return t.height-t.focus.y+t.nodeSpacing/2+e;case 27:return Math.max(t.height,t.focus.y+t.nodeSpacing/2+e);default:return e}}iC(t,i,n){switch(t){case 20:case 21:i/=2,n/=2;break;case 22:i=0,n=0;break;case 23:break;default:e.o("Unhandled alignment value "+t.toString())}return new y(i,n)}rc(t,e,i,n,s,o){const r=this.iC(e,i,n);this.ru(t,r.x,r.y,s,o)}ru(t,e,i,n,s){if(0===e&&0===i)return;const o=t.children;for(let r=n;r<=s;r++){const t=o[r].B;t.x+=e,t.y+=i}}fk(t,i,n){const s=t.parent;switch(this.cs){case 1:{const e=t.sourceEdges;for(;e.next();){const t=e.value;t.fromVertex===s&&t.relativePoint.i(i,n)}break}case 2:{const e=t.destinationEdges;for(;e.next();){const t=e.value;t.toVertex===s&&t.relativePoint.i(i,n)}break}default:e.o("Unhandled path value "+this.cs.toString())}}WI(t){if(0===t.childrenCount){const e=t.parent;let i=!1,n=0,s=21;null!==e&&(n=e.angle,s=e.alignment,i=this.isBusAlignment(s));const o=this.QN(t);return t.B.i(0,0),t.yt.i(t.width,t.height),null===t.parent||null===t.comments||(180!==n&&270!==n||i)&&!o?t.ft.i(0,0):180===n&&!i||(90===n||270===n)&&o?t.ft.i(t.width-2*t.focus.x,0):t.ft.i(0,t.height-2*t.focus.y),t.Fg=null,void(t.Rg=null)}const i=this.orthoAngle(t),n=90===i||270===i;let s=0;const o=t.children,r=o.length;for(let e=0;e<r;e++){const t=o[e];s=Math.max(s,n?t.yt.width:t.yt.height)}const a=t.alignment,l=22===a,h=23===a,u=this.isBusAlignment(a),c=Math.max(0,t.breadthLimit),d=this.computeLayerSpacing(t),f=t.nodeSpacing,g=this.computeNodeIndent(t),m=t.rowSpacing;let p=0;(l||h)&&(p=Math.max(0,t.rowIndent));const y=t.width,x=t.height;let b=0,v=0,w=0,k=null,S=null,P=0,M=0,C=0,N=0,T=0,L=0,A=0,D=0,F=0;if(u&&!this.Jy(a)&&i>135&&o.reverse(),this.Jy(a))if(r>1)for(let e=0;e<r;e++)e%2===0&&e!==r-1?D=Math.max(D,n?o[e].yt.width:o[e].yt.height):e%2!==0&&(F=Math.max(F,n?o[e].yt.width:o[e].yt.height));else 1===r&&(D=n?o[0].yt.width:o[0].yt.height);if(u){switch(a){case 24:let e;e=i<135?this.ID(t,o,D,F,b,v):this.ED(t,o,D,F,b,v),D=e.x,b=e.width,v=e.height;break;case 26:for(let t=0;t<r;t++){const e=o[t],i=e.yt,r=0===L?0:m;n?(e.B.i(s-i.width,N+r),b=Math.max(b,i.width),v=Math.max(v,N+r+i.height),N+=r+i.height):(e.B.i(C+r,s-i.height),b=Math.max(b,C+r+i.width),v=Math.max(v,i.height),C+=r+i.width),L++}break;case 27:for(let i=0;i<r;i++){const e=o[i],s=e.yt,r=0===L?0:m;n?(e.B.i(f/2+t.focus.x,N+r),b=Math.max(b,s.width),v=Math.max(v,N+r+s.height),N+=r+s.height):(e.B.i(C+r,f/2+t.focus.y),b=Math.max(b,C+r+s.width),v=Math.max(v,s.height),C+=r+s.width),L++}}k=this.ue(2),S=this.ue(2),n?(k[0].i(0,0),k[1].i(0,v),S[0].i(b,0),S[1].i(b,v)):(k[0].i(0,0),k[1].i(b,0),S[0].i(0,v),S[1].i(b,v))}else for(let V=0;V<r;V++){const r=o[V],l=r.yt;if(n){c>0&&L>0&&C+f+l.width>c&&(C<s&&this.rc(t,a,s-C,0,A,V-1),T++,L=0,A=V,w=v,C=0,N=i>135?-v-m:v+m),this.fk(r,0,N);let n=0;if(0===L)k=r.Fg,S=r.Rg,P=l.width,M=l.height,(null===k||null===S||i!==this.orthoAngle(r))&&(k=this.ue(2),S=this.ue(2),k[0].i(0,0),k[1].i(0,M),S[0].i(P,0),S[1].i(P,M));else{const i=e.rt(),s=this.BD(t,r,k,S,P,M,i);n=s.x,k=i[0],S=i[1],P=s.width,M=s.height,e.tt(i),C<l.width&&n<0&&(this.ru(t,-n,0,A,V-1),this.dk(k,-n,0),this.dk(S,-n,0),n=0)}r.B.i(n,N),b=Math.max(b,P),v=Math.max(v,w+(0===T?0:m)+l.height),C=P}else{c>0&&L>0&&N+f+l.height>c&&(N<s&&this.rc(t,a,0,s-N,A,V-1),T++,L=0,A=V,w=b,N=0,C=i>135?-b-m:b+m),this.fk(r,C,0);let n=0;if(0===L)k=r.Fg,S=r.Rg,P=l.width,M=l.height,(null===k||null===S||i!==this.orthoAngle(r))&&(k=this.ue(2),S=this.ue(2),k[0].i(0,0),k[1].i(P,0),S[0].i(0,M),S[1].i(P,M));else{const i=e.rt(),s=this.BD(t,r,k,S,P,M,i);n=s.x,k=i[0],S=i[1],P=s.width,M=s.height,e.tt(i),N<l.height&&n<0&&(this.ru(t,0,-n,A,V-1),this.dk(k,0,-n),this.dk(S,0,-n),n=0)}r.B.i(C,n),v=Math.max(v,M),b=Math.max(b,w+(0===T?0:m)+l.width),N=M}L++}T>0&&(n?(v+=Math.max(0,d),C<b&&this.rc(t,a,b-C,0,A,r-1),p>0&&(h||this.ru(t,p,0,0,r-1),b+=p)):(b+=Math.max(0,d),N<v&&this.rc(t,a,0,v-N,A,r-1),p>0&&(h||this.ru(t,0,p,0,r-1),v+=p)));let O=0,R=0;switch(a){case 20:n?O+=b/2-t.focus.x-g/2:R+=v/2-t.focus.y-g/2;break;default:case 21:if(T>0)n?O+=b/2-t.focus.x-g/2:R+=v/2-t.focus.y-g/2;else{const e=r;if(n){const i=o[0].B.x+o[0].ft.x;O+=i+(o[e-1].B.x+o[e-1].ft.x+2*o[e-1].focus.x-i)/2-t.focus.x-g/2}else{const i=o[0].B.y+o[0].ft.y;R+=i+(o[e-1].B.y+o[e-1].ft.y+2*o[e-1].focus.y-i)/2-t.focus.y-g/2}}break;case 22:n?(O-=g,b+=g):(R-=g,v+=g);break;case 23:n?(O+=b-t.width+g,b+=g):(R+=v-t.height+g,v+=g);break;case 24:n?O+=r>1?D+f/2-t.focus.x:o[0].focus.x-t.focus.x+o[0].ft.x:R+=r>1?D+f/2-t.focus.y:o[0].focus.y-t.focus.y+o[0].ft.y;break;case 26:n?O+=b+f/2-t.focus.x:R+=v+f/2-t.focus.y;break;case 27:break;case 28:const e=this.customAlignment(t,O,R,b,v);O=e[0],R=e[1],b=e[2],v=e[3]}for(let e=0;e<r;e++){const t=o[e];n?t.B.i(t.B.x+t.ft.x-O,t.B.y+(i>135?(u?-v:-t.yt.height)+t.ft.y-d:x+d+t.ft.y)):t.B.i(t.B.x+(i>135?(u?-b:-t.yt.width)+t.ft.x-d:y+d+t.ft.x),t.B.y+t.ft.y-R)}let E,B,I=0,z=0;if(u)n?(b=this._N(t,b,O),O<0&&(O=0),i>135&&(R+=v+d),v+=x+d,27===a&&(I+=f/2+t.focus.x),z+=x+d):(i>135&&(O+=b+d),b+=y+d,v=this.tC(t,v,R),R<0&&(R=0),27===a&&(z+=f/2+t.focus.y),I+=y+d);else if(n){if(null===t.comments){if(y>b){const t=this.iC(a,y-b,0);I=t.x,z=t.y,b=y,O=0}}else b=this._N(t,b,O);O<0&&(I-=O,O=0),i>135&&(R+=v+d),v=Math.max(Math.max(v,x),v+x+d),z+=x+d}else{if(i>135&&(O+=b+d),b=Math.max(Math.max(b,y),b+y+d),null===t.comments){if(x>v){const t=this.iC(a,0,x-v);I=t.x,z=t.y,v=x,R=0}}else v=this.tC(t,v,R);R<0&&(z-=R,R=0),I+=y+d}if(T>0)E=this.ue(4),B=this.ue(4),n?(E[2].i(0,x+d),E[3].i(E[2].x,v),B[2].i(b,E[2].y),B[3].i(B[2].x,E[3].y)):(E[2].i(y+d,0),E[3].i(b,E[2].y),B[2].i(E[2].x,v),B[3].i(E[3].x,B[2].y));else{E=this.ue(k.length+2),B=this.ue(S.length+2);for(let t=0;t<k.length;t++){const e=k[t];E[t+2].i(e.x+I,e.y+z)}for(let t=0;t<S.length;t++){const e=S[t];B[t+2].i(e.x+I,e.y+z)}}n?(E[0].i(O,0),E[1].i(E[0].x,x),E[2].y<E[1].y&&(E[2].x>E[0].x?E[2].a(E[1]):E[1].a(E[2])),E[3].y<E[2].y&&(E[3].x>E[0].x?E[3].a(E[2]):E[2].a(E[3])),B[0].i(O+y,0),B[1].i(B[0].x,x),B[2].y<B[1].y&&(B[2].x<B[0].x?B[2].a(B[1]):B[1].a(B[2])),B[3].y<B[2].y&&(B[3].x<B[0].x?B[3].a(B[2]):B[2].a(B[3])),E[2].y-=d/2,B[2].y-=d/2):(E[0].i(0,R),E[1].i(y,E[0].y),E[2].x<E[1].x&&(E[2].y>E[0].y?E[2].a(E[1]):E[1].a(E[2])),E[3].x<E[2].x&&(E[3].y>E[0].y?E[3].a(E[2]):E[2].a(E[3])),B[0].i(0,R+x),B[1].i(y,B[0].y),B[2].x<B[1].x&&(B[2].y<B[0].y?B[2].a(B[1]):B[1].a(B[2])),B[3].x<B[2].x&&(B[3].y<B[0].y?B[3].a(B[2]):B[2].a(B[3])),E[2].x-=d/2,B[2].x-=d/2),this.on(k),this.on(S),t.Fg=E,t.Rg=B,t.ft.i(O,R),t.yt.i(b,v)}dk(t,e,i){for(let n=0;n<t.length;n++){const s=t[n];s.x+=e,s.y+=i}}BD(t,e,i,n,s,o,r){const a=this.orthoAngle(t),l=90===a||270===a,h=t.nodeSpacing,u=i,c=n,d=s,f=o;let g=e.Fg,m=e.Rg;const p=e.yt,y=l?Math.max(f,p.height):Math.max(d,p.width);if((null===g||a!==this.orthoAngle(e))&&(g=this.ue(2),m=this.ue(2),l?(g[0].i(0,0),g[1].i(0,p.height),m[0].i(p.width,0),m[1].i(m[0].x,g[1].y)):(g[0].i(0,0),g[1].i(p.width,0),m[0].i(0,p.height),m[1].i(g[1].x,m[0].y))),l){const t=d;let e=t-this.JI(c,g,t);return e+=h,i=this.$I(u,g,e),n=this.ZI(c,m,e),s=Math.max(0,e)+p.width,o=y,this.on(u),this.on(g),this.on(c),this.on(m),r[0]=i,r[1]=n,new b(e,0,s,o)}{const t=f;let e=t-this.QI(c,g,t);return e+=h,i=this._I(u,g,e),n=this.tE(c,m,e),s=y,o=Math.max(0,e)+p.height,this.on(u),this.on(g),this.on(c),this.on(m),r[0]=i,r[1]=n,new b(e,0,s,o)}}_I(t,e,i){if(null===t||t.length<2||null===e||e.length<2)return null;const n=this.ue(t.length+e.length);let s=0,o=0,r=0;for(;o<e.length&&e[o].x<t[0].x;){const t=e[o++];n[r++].i(t.x,t.y+i)}for(;s<t.length;){const e=t[s++];n[r++].i(e.x,e.y)}const a=t[t.length-1].x;for(;o<e.length&&e[o].x<=a;)o++;for(;o<e.length&&e[o].x>a;){const t=e[o++];n[r++].i(t.x,t.y+i)}const l=this.ue(r);for(s=0;s<r;s++)l[s].a(n[s]);return this.on(n),l}$I(t,e,i){if(null===t||t.length<2||null===e||e.length<2)return null;const n=this.ue(t.length+e.length);let s=0,o=0,r=0;for(;o<e.length&&e[o].y<t[0].y;){const t=e[o++];n[r++].i(t.x+i,t.y)}for(;s<t.length;){const e=t[s++];n[r++].i(e.x,e.y)}const a=t[t.length-1].y;for(;o<e.length&&e[o].y<=a;)o++;for(;o<e.length&&e[o].y>a;){const t=e[o++];n[r++].i(t.x+i,t.y)}const l=this.ue(r);for(s=0;s<r;s++)l[s].a(n[s]);return this.on(n),l}tE(t,e,i){if(null===t||t.length<2||null===e||e.length<2)return null;const n=this.ue(t.length+e.length);let s=0,o=0,r=0;for(;s<t.length&&t[s].x<e[0].x;){const e=t[s++];n[r++].i(e.x,e.y)}for(;o<e.length;){const t=e[o++];n[r++].i(t.x,t.y+i)}const a=e[e.length-1].x;for(;s<t.length&&t[s].x<=a;)s++;for(;s<t.length&&t[s].x>a;){const e=t[s++];n[r++].i(e.x,e.y)}const l=this.ue(r);for(s=0;s<r;s++)l[s].a(n[s]);return this.on(n),l}ZI(t,e,i){if(null===t||t.length<2||null===e||e.length<2)return null;const n=this.ue(t.length+e.length);let s=0,o=0,r=0;for(;s<t.length&&t[s].y<e[0].y;){const e=t[s++];n[r++].i(e.x,e.y)}for(;o<e.length;){const t=e[o++];n[r++].i(t.x+i,t.y)}const a=e[e.length-1].y;for(;s<t.length&&t[s].y<=a;)s++;for(;s<t.length&&t[s].y>a;){const e=t[s++];n[r++].i(e.x,e.y)}const l=this.ue(r);for(s=0;s<r;s++)l[s].a(n[s]);return this.on(n),l}QI(t,e,i){let n=9999999;if(null===t||t.length<2||null===e||e.length<2)return n;let s=0,o=0;for(;s<t.length&&o<e.length;){const r=t[s],a=e[o],l=a.x;let h=a.y;h+=i;let u=r;s+1<t.length&&(u=t[s+1]);let c=a,d=c.x,f=c.y;o+1<e.length&&(c=e[o+1],d=c.x,f=c.y,f+=i);let g=n;r.x===l?g=h-r.y:r.x>l&&r.x<d?g=h+(r.x-l)/(d-l)*(f-h)-r.y:l>r.x&&l<u.x&&(g=h-(r.y+(l-r.x)/(u.x-r.x)*(u.y-r.y))),g<n&&(n=g),u.x<=r.x?s++:d<=l?o++:(u.x<=d&&s++,d<=u.x&&o++)}return n}JI(t,e,i){let n=9999999;if(null===t||t.length<2||null===e||e.length<2)return n;let s=0,o=0;for(;s<t.length&&o<e.length;){const r=t[s],a=e[o];let l=a.x;const h=a.y;l+=i;let u=r;s+1<t.length&&(u=t[s+1]);let c=a,d=c.x,f=c.y;o+1<e.length&&(c=e[o+1],d=c.x,f=c.y,d+=i);let g=n;r.y===h?g=l-r.x:r.y>h&&r.y<f?g=l+(r.y-h)/(f-h)*(d-l)-r.x:h>r.y&&h<u.y&&(g=l-(r.x+(h-r.y)/(u.y-r.y)*(u.x-r.x))),g<n&&(n=g),u.y<=r.y?s++:f<=h?o++:(u.y<=f&&s++,f<=u.y&&o++)}return n}ue(t){const e=this.ck[t];if(void 0!==e){const t=e.pop();if(void 0!==t)return t}const i=[];for(let n=0;n<t;n++)i[n]=new y;return i}on(t){if(!t)return;const e=t.length;let i=this.ck[e];void 0===i&&(i=[],this.ck[e]=i),i.push(t)}arrangeTrees(){if(52===this.Gi){const t=this.Oi.iterator;for(;t.next();){const e=t.value;if(!(e instanceof Si))continue;const i=e.node;if(null===i)continue;const n=i.position;let s=n.x,o=n.y;isFinite(s)||(s=0),isFinite(o)||(o=0),this.eC(e,s,o)}}else{const t=[],e=this.Oi.iterator;for(;e.next();){const i=e.value;i instanceof Si&&t.push(i)}switch(this.sorting){default:case 10:break;case 11:t.reverse();break;case 12:t.sort(this.comparer);break;case 13:t.sort(this.comparer),t.reverse()}const i=this.arrangementOrigin;let n=i.x,s=i.y;for(let o=0;o<t.length;o++){const e=t[o];if(50===(this.eC(e,n+e.ft.x,s+e.ft.y),this.Gi))s+=e.yt.height+this.Ls.height;else n+=e.yt.width+this.Ls.width}}}eC(t,e,i){if(null===t)return;t.x=e,t.y=i;const n=t.children,s=n.length;for(let o=0;o<s;o++){const t=n[o];this.eC(t,e+t.B.x,i+t.B.y)}}commitLayout(){this.zy(),this.commitNodes(),this.JN(),this.isRouting&&this.commitLinks()}commitNodes(){const t=this.network.vertexes.iterator;for(;t.next();)t.value.commit();for(t.reset();t.next();){const e=t.value;this.layoutComments(e)}}JN(){if(62!==this.layerStyle)return;const t=this.$N,e=[];let i=null;const n=this.network.vertexes.iterator;for(;n.next();){const t=n.value;null===i?i=t.bounds.copy():i.unionRect(t.bounds);let s=e[t.level];s=void 0===s?this.computeLayerSpacing(t):Math.max(s,this.computeLayerSpacing(t)),e[t.level]=s}for(let l=0;l<e.length;l++)void 0===e[l]&&(e[l]=0);let s;90===this.angle||270===this.angle?(i.inflate(this.nodeSpacing/2,this.layerSpacing),s=new y(-this.nodeSpacing/2,-this.layerSpacing/2)):(i.inflate(this.layerSpacing,this.nodeSpacing/2),s=new y(-this.layerSpacing/2,-this.nodeSpacing/2));const o=[],r=90===this.angle||270===this.angle?i.width:i.height;let a=0;if(180===this.angle||270===this.angle)for(let l=0;l<t.length;l++)a+=t[l]+e[l];for(let l=0;l<t.length;l++){const i=t[l]+e[l];270===this.angle?(a-=i,o.push(new b(0,a,r,i))):90===this.angle?(o.push(new b(0,a,r,i)),a+=i):180===this.angle?(a-=i,o.push(new b(a,0,i,r))):(o.push(new b(a,0,i,r)),a+=i)}this.commitLayers(o,s)}commitLayers(t,e){}commitLinks(){const t=this.network.edges.iterator;for(;t.next();)t.value.commit()}zy(){const t=this.Oi.iterator;for(;t.next();){const e=t.value;e instanceof Si&&this.UD(e)}}UD(t){if(null===t)return;this.setPortSpots(t);const e=t.children,i=e.length;for(let n=0;n<i;n++){const t=e[n];this.UD(t)}}setPortSpots(t){const e=t.alignment;if(this.isBusAlignment(e))this.iE(t,e);else{const e=this.orthoAngle(t);if(1===this.cs){const i=t.destinationEdges;for(;i.next();){const n=i.value.link;if(null!==n){if(t.setsPortSpot)if(t.portSpot.isDefault())switch(e){case 0:n.fromSpot=w.MiddleRight;break;case 90:n.fromSpot=w.MiddleBottom;break;case 180:n.fromSpot=w.MiddleLeft;break;default:n.fromSpot=w.MiddleTop}else n.fromSpot=t.portSpot;if(t.setsChildPortSpot)if(t.childPortSpot.isDefault())switch(e){case 0:n.toSpot=w.MiddleLeft;break;case 90:n.toSpot=w.MiddleTop;break;case 180:n.toSpot=w.MiddleRight;break;default:n.toSpot=w.MiddleBottom}else n.toSpot=t.childPortSpot}}}else{const i=t.sourceEdges;for(;i.next();){const n=i.value.link;if(null!==n){if(t.setsPortSpot)if(t.portSpot.isDefault())switch(e){case 0:n.toSpot=w.MiddleRight;break;case 90:n.toSpot=w.MiddleBottom;break;case 180:n.toSpot=w.MiddleLeft;break;default:n.toSpot=w.MiddleTop}else n.toSpot=t.portSpot;if(t.setsChildPortSpot)if(t.childPortSpot.isDefault())switch(e){case 0:n.fromSpot=w.MiddleLeft;break;case 90:n.fromSpot=w.MiddleTop;break;case 180:n.fromSpot=w.MiddleRight;break;default:n.fromSpot=w.MiddleBottom}else n.fromSpot=t.childPortSpot}}}}}iE(t,e){const i=1===this.cs,n=this.orthoAngle(t);let s;switch(n){case 0:s=w.MiddleRight;break;case 90:s=w.MiddleBottom;break;case 180:s=w.MiddleLeft;break;default:s=w.MiddleTop}const o=t.children,r=o.length;switch(e){case 24:case 25:for(let e=0;e<r;e++){const a=o[e],l=(i?a.sourceEdges:a.destinationEdges).first();if(null===l)continue;const h=l.link;if(null!==h){let o=90===n||270===n?w.MiddleLeft:w.MiddleTop;if(1===r||e===r-1&&r%2===1)switch(n){case 0:o=w.MiddleLeft;break;case 90:o=w.MiddleTop;break;case 180:o=w.MiddleRight;break;default:o=w.MiddleBottom}else e%2===0&&(o=90===n||270===n?w.MiddleRight:w.MiddleBottom);i?(t.setsPortSpot&&(h.fromSpot=s),t.setsChildPortSpot&&(h.toSpot=o)):(t.setsPortSpot&&(h.fromSpot=o),t.setsChildPortSpot&&(h.toSpot=s))}}break;case 26:{const e=90===n||270===n?w.MiddleRight:w.MiddleBottom,o=i?t.destinationEdges:t.sourceEdges;for(;o.next();){const n=o.value.link;null!==n&&(i?(t.setsPortSpot&&(n.fromSpot=s),t.setsChildPortSpot&&(n.toSpot=e)):(t.setsPortSpot&&(n.fromSpot=e),t.setsChildPortSpot&&(n.toSpot=s)))}break}case 27:{const e=90===n||270===n?w.MiddleLeft:w.MiddleTop,o=i?t.destinationEdges:t.sourceEdges;for(;o.next();){const n=o.value.link;null!==n&&(i?(t.setsPortSpot&&(n.fromSpot=s),t.setsChildPortSpot&&(n.toSpot=e)):(t.setsPortSpot&&(n.fromSpot=e),t.setsChildPortSpot&&(n.toSpot=s)))}break}}}orthoAngle(t){const e=t.angle;return e<=45?0:e<=135?90:e<=225?180:e<=315?270:0}computeLayerSpacing(t){const e=this.orthoAngle(t),i=90===e||270===e;let n=t.layerSpacing;if(t.layerSpacingParentOverlap>0){const e=Math.min(1,t.layerSpacingParentOverlap);n-=i?t.height*e:t.width*e}return n<(i?-t.height:-t.width)&&(n=i?-t.height:-t.width),n}computeNodeIndent(t){const e=this.orthoAngle(t),i=90===e||270===e;let n=t.nodeIndent;if(t.nodeIndentPastParent>0){const e=Math.min(1,t.nodeIndentPastParent);n+=i?t.width*e:t.height*e}return n=Math.max(0,n),n}get roots(){return this.Oi}set roots(t){this.Oi!==t&&(this.Oi=t,this.invalidateLayout())}get path(){return this.Di}set path(t){this.Di!==t&&(this.Di=t,this.invalidateLayout())}get treeStyle(){return this.ou}set treeStyle(t){this.ou!==t&&(40===t||42===t||41===t||43===t)&&(this.ou=t,this.invalidateLayout())}get layerStyle(){return this.Dg}set layerStyle(t){this.Dg!==t&&(60===t||61===t||62===t)&&(this.Dg=t,this.invalidateLayout())}get comments(){return this.Oe}set comments(t){this.Oe!==t&&(e.s(t,"boolean",wi,"comments"),this.Oe=t,this.invalidateLayout())}get arrangement(){return this.Gi}set arrangement(t){this.Gi!==t&&(50===t||51===t||52===t)&&(this.Gi=t,this.invalidateLayout())}get arrangementSpacing(){return this.Ls}set arrangementSpacing(t){this.Ls.equals(t)||(this.Ls.a(t),this.invalidateLayout())}get rootDefaults(){return this.V}set rootDefaults(t){this.V!==t&&(this.V=t,this.invalidateLayout())}get alternateDefaults(){return this.z}set alternateDefaults(t){this.z!==t&&(this.z=t,this.invalidateLayout())}get sorting(){return this.V.sorting}set sorting(t){this.V.sorting!==t&&(this.V.sorting=t,this.invalidateLayout())}get comparer(){return this.V.comparer}set comparer(t){this.V.comparer!==t&&(e.S(t,wi,"comparer"),this.V.comparer=t,this.invalidateLayout())}get angle(){return this.V.angle}set angle(t){this.V.angle!==t&&(e.s(t,"number",wi,"angle"),0===t||90===t||180===t||270===t?(this.V.angle=t,this.invalidateLayout()):e.o("TreeLayout.angle must be 0, 90, 180, or 270"))}get alignment(){return this.V.alignment}set alignment(t){this.V.alignment!==t&&(this.V.alignment=t,this.invalidateLayout())}get nodeIndent(){return this.V.nodeIndent}set nodeIndent(t){this.V.nodeIndent!==t&&(e.s(t,"number",wi,"nodeIndent"),t>=0&&(this.V.nodeIndent=t,this.invalidateLayout()))}get nodeIndentPastParent(){return this.V.nodeIndentPastParent}set nodeIndentPastParent(t){this.V.nodeIndentPastParent!==t&&(e.s(t,"number",wi,"nodeIndentPastParent"),t>=0&&t<=1&&(this.V.nodeIndentPastParent=t,this.invalidateLayout()))}get nodeSpacing(){return this.V.nodeSpacing}set nodeSpacing(t){this.V.nodeSpacing!==t&&(e.s(t,"number",wi,"nodeSpacing"),this.V.nodeSpacing=t,this.invalidateLayout())}get layerSpacing(){return this.V.layerSpacing}set layerSpacing(t){this.V.layerSpacing!==t&&(e.s(t,"number",wi,"layerSpacing"),this.V.layerSpacing=t,this.invalidateLayout())}get layerSpacingParentOverlap(){return this.V.layerSpacingParentOverlap}set layerSpacingParentOverlap(t){this.V.layerSpacingParentOverlap!==t&&(e.s(t,"number",wi,"layerSpacingParentOverlap"),t>=0&&t<=1&&(this.V.layerSpacingParentOverlap=t,this.invalidateLayout()))}get compaction(){return this.V.compaction}set compaction(t){this.V.compaction!==t&&(30===t||31===t)&&(this.V.compaction=t,this.invalidateLayout())}get breadthLimit(){return this.V.breadthLimit}set breadthLimit(t){this.V.breadthLimit!==t&&(e.s(t,"number",wi,"breadthLimit"),t>=0&&(this.V.breadthLimit=t,this.invalidateLayout()))}get rowSpacing(){return this.V.rowSpacing}set rowSpacing(t){this.V.rowSpacing!==t&&(e.s(t,"number",wi,"rowSpacing"),this.V.rowSpacing=t,this.invalidateLayout())}get rowIndent(){return this.V.rowIndent}set rowIndent(t){this.V.rowIndent!==t&&(e.s(t,"number",wi,"rowIndent"),t>=0&&(this.V.rowIndent=t,this.invalidateLayout()))}get commentSpacing(){return this.V.commentSpacing}set commentSpacing(t){this.V.commentSpacing!==t&&(e.s(t,"number",wi,"commentSpacing"),this.V.commentSpacing=t,this.invalidateLayout())}get commentMargin(){return this.V.commentMargin}set commentMargin(t){this.V.commentMargin!==t&&(e.s(t,"number",wi,"commentMargin"),this.V.commentMargin=t,this.invalidateLayout())}get setsPortSpot(){return this.V.setsPortSpot}set setsPortSpot(t){this.V.setsPortSpot!==t&&(e.s(t,"boolean",wi,"setsPortSpot"),this.V.setsPortSpot=t,this.invalidateLayout())}get portSpot(){return this.V.portSpot}set portSpot(t){this.V.portSpot.equals(t)||(this.V.portSpot=t,this.invalidateLayout())}get setsChildPortSpot(){return this.V.setsChildPortSpot}set setsChildPortSpot(t){this.V.setsChildPortSpot!==t&&(e.s(t,"boolean",wi,"setsChildPortSpot"),this.V.setsChildPortSpot=t,this.invalidateLayout())}get childPortSpot(){return this.V.childPortSpot}set childPortSpot(t){this.V.childPortSpot.equals(t)||(this.V.childPortSpot=t,this.invalidateLayout())}get alternateSorting(){return this.z.sorting}set alternateSorting(t){this.z.sorting!==t&&(this.z.sorting=t,this.invalidateLayout())}get alternateComparer(){return this.z.comparer}set alternateComparer(t){this.z.comparer!==t&&(e.S(t,wi,"alternateComparer"),this.z.comparer=t,this.invalidateLayout())}get alternateAngle(){return this.z.angle}set alternateAngle(t){this.z.angle!==t&&(e.s(t,"number",wi,"alternateAngle"),(0===t||90===t||180===t||270===t)&&(this.z.angle=t,this.invalidateLayout()))}get alternateAlignment(){return this.z.alignment}set alternateAlignment(t){this.z.alignment!==t&&(this.z.alignment=t,this.invalidateLayout())}get alternateNodeIndent(){return this.z.nodeIndent}set alternateNodeIndent(t){this.z.nodeIndent!==t&&(e.s(t,"number",wi,"alternateNodeIndent"),t>=0&&(this.z.nodeIndent=t,this.invalidateLayout()))}get alternateNodeIndentPastParent(){return this.z.nodeIndentPastParent}set alternateNodeIndentPastParent(t){this.z.nodeIndentPastParent!==t&&(e.s(t,"number",wi,"alternateNodeIndentPastParent"),t>=0&&t<=1&&(this.z.nodeIndentPastParent=t,this.invalidateLayout()))}get alternateNodeSpacing(){return this.z.nodeSpacing}set alternateNodeSpacing(t){this.z.nodeSpacing!==t&&(e.s(t,"number",wi,"alternateNodeSpacing"),this.z.nodeSpacing=t,this.invalidateLayout())}get alternateLayerSpacing(){return this.z.layerSpacing}set alternateLayerSpacing(t){this.z.layerSpacing!==t&&(e.s(t,"number",wi,"alternateLayerSpacing"),this.z.layerSpacing=t,this.invalidateLayout())}get alternateLayerSpacingParentOverlap(){return this.z.layerSpacingParentOverlap}set alternateLayerSpacingParentOverlap(t){this.z.layerSpacingParentOverlap!==t&&(e.s(t,"number",wi,"alternateLayerSpacingParentOverlap"),t>=0&&t<=1&&(this.z.layerSpacingParentOverlap=t,this.invalidateLayout()))}get alternateCompaction(){return this.z.compaction}set alternateCompaction(t){this.z.compaction!==t&&(30===t||31===t)&&(this.z.compaction=t,this.invalidateLayout())}get alternateBreadthLimit(){return this.z.breadthLimit}set alternateBreadthLimit(t){this.z.breadthLimit!==t&&(e.s(t,"number",wi,"alternateBreadthLimit"),t>=0&&(this.z.breadthLimit=t,this.invalidateLayout()))}get alternateRowSpacing(){return this.z.rowSpacing}set alternateRowSpacing(t){this.z.rowSpacing!==t&&(e.s(t,"number",wi,"alternateRowSpacing"),this.z.rowSpacing=t,this.invalidateLayout())}get alternateRowIndent(){return this.z.rowIndent}set alternateRowIndent(t){this.z.rowIndent!==t&&(e.s(t,"number",wi,"alternateRowIndent"),t>=0&&(this.z.rowIndent=t,this.invalidateLayout()))}get alternateCommentSpacing(){return this.z.commentSpacing}set alternateCommentSpacing(t){this.z.commentSpacing!==t&&(e.s(t,"number",wi,"alternateCommentSpacing"),this.z.commentSpacing=t,this.invalidateLayout())}get alternateCommentMargin(){return this.z.commentMargin}set alternateCommentMargin(t){this.z.commentMargin!==t&&(e.s(t,"number",wi,"alternateCommentMargin"),this.z.commentMargin=t,this.invalidateLayout())}get alternateSetsPortSpot(){return this.z.setsPortSpot}set alternateSetsPortSpot(t){this.z.setsPortSpot!==t&&(e.s(t,"boolean",wi,"alternateSetsPortSpot"),this.z.setsPortSpot=t,this.invalidateLayout())}get alternatePortSpot(){return this.z.portSpot}set alternatePortSpot(t){this.z.portSpot.equals(t)||(this.z.portSpot=t,this.invalidateLayout())}get alternateSetsChildPortSpot(){return this.z.setsChildPortSpot}set alternateSetsChildPortSpot(t){this.z.setsChildPortSpot!==t&&(e.s(t,"boolean",wi,"alternateSetsChildPortSpot"),this.z.setsChildPortSpot=t,this.invalidateLayout())}get alternateChildPortSpot(){return this.z.childPortSpot}set alternateChildPortSpot(t){this.z.childPortSpot.equals(t)||(this.z.childPortSpot=t,this.invalidateLayout())}static PathDefault=0;static PathDestination=1;static PathSource=2;static SortingForwards=10;static SortingReverse=11;static SortingAscending=12;static SortingDescending=13;static AlignmentCenterSubtrees=20;static AlignmentCenterChildren=21;static AlignmentStart=22;static AlignmentEnd=23;static AlignmentBus=24;static AlignmentBusBranching=25;static AlignmentTopLeftBus=26;static AlignmentBottomRightBus=27;static CompactionNone=30;static CompactionBlock=31;static StyleLayered=40;static StyleLastParents=41;static StyleAlternating=42;static StyleRootOnly=43;static ArrangementVertical=50;static ArrangementHorizontal=51;static ArrangementFixedRoots=52;static LayerIndividual=60;static LayerSiblings=61;static LayerUniform=62}class ki extends Ae{constructor(t){super(t)}createVertex(){return new Si(this)}createEdge(){return new Pi(this)}}class Si extends De{B;yt;ft;gk;mk;pk;yk;wk;xk;bk;Oe;Fg;Rg;xe;be;Ht;fi;$y;Zy;Qy;As;_y;tw;iw;ew;sw;nw;ow;rw;lw;hw;aw;constructor(t){super(t),this.gk=!1,this.mk=null,this.pk=[],this.yk=0,this.wk=0,this.xk=0,this.bk=0,this.Oe=null,this.B=new y(0,0),this.yt=new x(0,0),this.ft=new y(0,0),this.Fg=null,this.Rg=null,this.xe=10,this.be=De.standardComparer,this.Ht=0,this.fi=21,this.$y=0,this.Zy=0,this.Qy=20,this.As=50,this._y=0,this.tw=31,this.iw=0,this.ew=25,this.sw=10,this.nw=10,this.ow=20,this.rw=!0,this.lw=w.Default,this.hw=!0,this.aw=w.Default}copyInheritedPropertiesFrom(t){null!==t&&(this.xe=t.sorting,this.be=t.comparer,this.Ht=t.angle,this.fi=t.alignment,this.$y=t.nodeIndent,this.Zy=t.nodeIndentPastParent,this.Qy=t.nodeSpacing,this.As=t.layerSpacing,this._y=t.layerSpacingParentOverlap,this.tw=t.compaction,this.iw=t.breadthLimit,this.ew=t.rowSpacing,this.sw=t.rowIndent,this.nw=t.commentSpacing,this.ow=t.commentMargin,this.rw=t.setsPortSpot,this.lw=t.portSpot,this.hw=t.setsChildPortSpot,this.aw=t.childPortSpot)}get initialized(){return this.gk}set initialized(t){this.gk!==t&&(e.s(t,"boolean",Si,"initialized"),this.gk=t)}get parent(){return this.mk}set parent(t){this.mk!==t&&(this.mk=t)}get children(){return this.pk}set children(t){if(this.pk!==t){if(null!==t&&!Array.isArray(t)&&e.te(t,"Array",Si,"children:value"),null!==t){const e=t.length;for(let i=0;i<e;i++){t[i]}}this.pk=t}}get level(){return this.yk}set level(t){this.yk!==t&&(e.s(t,"number",Si,"level"),this.yk=t)}get descendantCount(){return this.wk}set descendantCount(t){this.wk!==t&&(e.s(t,"number",Si,"descendantCount"),this.wk=t)}get maxChildrenCount(){return this.xk}set maxChildrenCount(t){this.xk!==t&&(e.s(t,"number",Si,"maxChildrenCount"),this.xk=t)}get maxGenerationCount(){return this.bk}set maxGenerationCount(t){this.bk!==t&&(e.s(t,"number",Si,"maxGenerationCount"),this.bk=t)}get comments(){return this.Oe}set comments(t){if(this.Oe!==t){if(null!==t&&!Array.isArray(t)&&e.te(t,"Array",Si,"comments:value"),null!==t){const e=t.length;for(let i=0;i<e;i++){t[i]}}this.Oe=t}}get sorting(){return this.xe}set sorting(t){this.xe!==t&&(this.xe=t)}get comparer(){return this.be}set comparer(t){this.be!==t&&(e.S(t,Si,"comparer"),this.be=t)}get angle(){return this.Ht}set angle(t){this.Ht!==t&&(e.s(t,"number",Si,"angle"),this.Ht=t)}get alignment(){return this.fi}set alignment(t){this.fi!==t&&(this.fi=t)}get nodeIndent(){return this.$y}set nodeIndent(t){this.$y!==t&&(e.s(t,"number",Si,"nodeIndent"),this.$y=t)}get nodeIndentPastParent(){return this.Zy}set nodeIndentPastParent(t){this.Zy!==t&&(e.s(t,"number",Si,"nodeIndentPastParent"),this.Zy=t)}get nodeSpacing(){return this.Qy}set nodeSpacing(t){this.Qy!==t&&(e.s(t,"number",Si,"nodeSpacing"),this.Qy=t)}get layerSpacing(){return this.As}set layerSpacing(t){this.As!==t&&(e.s(t,"number",Si,"layerSpacing"),this.As=t)}get layerSpacingParentOverlap(){return this._y}set layerSpacingParentOverlap(t){this._y!==t&&(e.s(t,"number",Si,"layerSpacingParentOverlap"),this._y=t)}get compaction(){return this.tw}set compaction(t){this.tw!==t&&(this.tw=t)}get breadthLimit(){return this.iw}set breadthLimit(t){this.iw!==t&&(e.s(t,"number",Si,"breadthLimit"),this.iw=t)}get rowSpacing(){return this.ew}set rowSpacing(t){this.ew!==t&&(e.s(t,"number",Si,"rowSpacing"),this.ew=t)}get rowIndent(){return this.sw}set rowIndent(t){this.sw!==t&&(e.s(t,"number",Si,"rowIndent"),this.sw=t)}get commentSpacing(){return this.nw}set commentSpacing(t){this.nw!==t&&(e.s(t,"number",Si,"commentSpacing"),this.nw=t)}get commentMargin(){return this.ow}set commentMargin(t){this.ow!==t&&(e.s(t,"number",Si,"commentMargin"),this.ow=t)}get setsPortSpot(){return this.rw}set setsPortSpot(t){this.rw!==t&&(e.s(t,"boolean",Si,"setsPortSpot"),this.rw=t)}get portSpot(){return this.lw}set portSpot(t){this.lw.equals(t)||(this.lw=t)}get setsChildPortSpot(){return this.hw}set setsChildPortSpot(t){this.hw!==t&&(e.s(t,"boolean",Si,"setsChildPortSpot"),this.hw=t)}get childPortSpot(){return this.aw}set childPortSpot(t){this.aw.equals(t)||(this.aw=t)}get childrenCount(){return this.children.length}get relativePosition(){return this.B}set relativePosition(t){this.B.set(t)}get subtreeSize(){return this.yt}set subtreeSize(t){this.yt.set(t)}get subtreeOffset(){return this.ft}set subtreeOffset(t){this.ft.set(t)}}class Pi extends Fe{kk;constructor(t){super(t),this.kk=new y(0,0)}commit(){const t=this.link;if(null===t||t.isAvoiding)return;const i=this.network.layout;let n=null,s=null;switch(i.cs){case 1:n=this.fromVertex,s=this.toVertex;break;case 2:n=this.toVertex,s=this.fromVertex;break;default:e.o("Unhandled path value "+i.cs.toString())}if(null===n||null===s)return;const o=this.kk;if(0===o.x&&0===o.y)return void this.eE(n,s);const r=n.bounds,a=i.orthoAngle(n),l=i.computeLayerSpacing(n),h=n.rowSpacing;t.updateRoute();const u=9===t.curve,c=t.isOrthogonal;let d,f,g=0;if(t.startRoute(),c||u){for(g=2;t.pointsCount>4;)t.removePoint(2);d=t.getPoint(1),f=t.getPoint(2)}else{for(g=1;t.pointsCount>3;)t.removePoint(1);d=t.getPoint(0),f=t.getPoint(t.pointsCount-1)}const m=t.getPoint(t.pointsCount-1);let p=0;0===a?(23===n.alignment?(p=r.bottom+o.y,0===o.y&&d.y>m.y+n.rowIndent&&(p=Math.min(p,Math.max(d.y,p-i.computeNodeIndent(n))))):22===n.alignment?(p=r.top+o.y,0===o.y&&d.y<m.y-n.rowIndent&&(p=Math.max(p,Math.min(d.y,p+i.computeNodeIndent(n))))):p=r.y+r.height/2+o.y,u?(t.insertPointAt(g,d.x,p),g++,t.insertPointAt(g,r.right+l,p),g++,t.insertPointAt(g,r.right+l+(o.x-h)/3,p),g++,t.insertPointAt(g,r.right+l+2*(o.x-h)/3,p),g++,t.insertPointAt(g,r.right+l+(o.x-h),p),g++,t.insertPointAt(g,f.x,p),g++):(c&&(t.insertPointAt(g,r.right+l/2,d.y),g++),t.insertPointAt(g,r.right+l/2,p),g++,t.insertPointAt(g,r.right+l+o.x-(c?h/2:h),p),g++,c&&(t.insertPointAt(g,t.getPoint(g-1).x,f.y),g++))):90===a?(23===n.alignment?(p=r.right+o.x,0===o.x&&d.x>m.x+n.rowIndent&&(p=Math.min(p,Math.max(d.x,p-i.computeNodeIndent(n))))):22===n.alignment?(p=r.left+o.x,0===o.x&&d.x<m.x-n.rowIndent&&(p=Math.max(p,Math.min(d.x,p+i.computeNodeIndent(n))))):p=r.x+r.width/2+o.x,u?(t.insertPointAt(g,p,d.y),g++,t.insertPointAt(g,p,r.bottom+l),g++,t.insertPointAt(g,p,r.bottom+l+(o.y-h)/3),g++,t.insertPointAt(g,p,r.bottom+l+2*(o.y-h)/3),g++,t.insertPointAt(g,p,r.bottom+l+(o.y-h)),g++,t.insertPointAt(g,p,f.y),g++):(c&&(t.insertPointAt(g,d.x,r.bottom+l/2),g++),t.insertPointAt(g,p,r.bottom+l/2),g++,t.insertPointAt(g,p,r.bottom+l+o.y-(c?h/2:h)),g++,c&&(t.insertPointAt(g,f.x,t.getPoint(g-1).y),g++))):180===a?(23===n.alignment?(p=r.bottom+o.y,0===o.y&&d.y>m.y+n.rowIndent&&(p=Math.min(p,Math.max(d.y,p-i.computeNodeIndent(n))))):22===n.alignment?(p=r.top+o.y,0===o.y&&d.y<m.y-n.rowIndent&&(p=Math.max(p,Math.min(d.y,p+i.computeNodeIndent(n))))):p=r.y+r.height/2+o.y,u?(t.insertPointAt(g,d.x,p),g++,t.insertPointAt(g,r.left-l,p),g++,t.insertPointAt(g,r.left-l+(o.x+h)/3,p),g++,t.insertPointAt(g,r.left-l+2*(o.x+h)/3,p),g++,t.insertPointAt(g,r.left-l+(o.x+h),p),g++,t.insertPointAt(g,f.x,p),g++):(c&&(t.insertPointAt(g,r.left-l/2,d.y),g++),t.insertPointAt(g,r.left-l/2,p),g++,t.insertPointAt(g,r.left-l+o.x+(c?h/2:h),p),g++,c&&(t.insertPointAt(g,t.getPoint(g-1).x,f.y),g++))):270===a?(23===n.alignment?(p=r.right+o.x,0===o.x&&d.x>m.x+n.rowIndent&&(p=Math.min(p,Math.max(d.x,p-i.computeNodeIndent(n))))):22===n.alignment?(p=r.left+o.x,0===o.x&&d.x<m.x-n.rowIndent&&(p=Math.max(p,Math.min(d.x,p+i.computeNodeIndent(n))))):p=r.x+r.width/2+o.x,u?(t.insertPointAt(g,p,d.y),g++,t.insertPointAt(g,p,r.top-l),g++,t.insertPointAt(g,p,r.top-l+(o.y+h)/3),g++,t.insertPointAt(g,p,r.top-l+2*(o.y+h)/3),g++,t.insertPointAt(g,p,r.top-l+(o.y+h)),g++,t.insertPointAt(g,p,f.y),g++):(c&&(t.insertPointAt(g,d.x,r.top-l/2),g++),t.insertPointAt(g,p,r.top-l/2),g++,t.insertPointAt(g,p,r.top-l+o.y+(c?h/2:h)),g++,c&&(t.insertPointAt(g,f.x,t.getPoint(g-1).y),g++))):e.o("Invalid angle "+a),t.commitRoute()}eE(t,e){const i=this.link;if(null===i)return;const n=this.network.layout,s=n.orthoAngle(t);if(s===n.orthoAngle(e))return;const o=n.computeLayerSpacing(t),r=t.bounds,a=e.bounds;if(0===s&&a.left-r.right<o+1||90===s&&a.top-r.bottom<o+1||180===s&&r.left-a.right<o+1||270===s&&r.top-a.bottom<o+1)return;i.updateRoute();const l=9===i.curve,h=i.isOrthogonal,u=this.fromVertex,c=n.isBusAlignment(u.alignment);if(i.startRoute(),0===s){const t=r.right+o/2;if(l){if(4===i.pointsCount){const e=i.getPoint(3).y;i.setPointAt(1,t-20,i.getPoint(1).y),i.insertPointAt(2,t-20,e),i.insertPointAt(3,t,e),i.insertPointAt(4,t+20,e),i.setPointAt(5,i.getPoint(5).x,e)}}else h?c?i.setPointAt(3,i.getPoint(2).x,i.getPoint(4).y):6===i.pointsCount&&(i.setPointAt(2,t,i.getPoint(2).y),i.setPointAt(3,t,i.getPoint(3).y)):4===i.pointsCount?i.insertPointAt(2,t,i.getPoint(2).y):3===i.pointsCount?i.setPointAt(1,t,i.getPoint(2).y):2===i.pointsCount&&i.insertPointAt(1,t,i.getPoint(1).y)}else if(90===s){const t=r.bottom+o/2;if(l){if(4===i.pointsCount){const e=i.getPoint(3).x;i.setPointAt(1,i.getPoint(1).x,t-20),i.insertPointAt(2,e,t-20),i.insertPointAt(3,e,t),i.insertPointAt(4,e,t+20),i.setPointAt(5,e,i.getPoint(5).y)}}else h?c?i.setPointAt(3,i.getPoint(2).x,i.getPoint(4).y):6===i.pointsCount&&(i.setPointAt(2,i.getPoint(2).x,t),i.setPointAt(3,i.getPoint(3).x,t)):4===i.pointsCount?i.insertPointAt(2,i.getPoint(2).x,t):3===i.pointsCount?i.setPointAt(1,i.getPoint(2).x,t):2===i.pointsCount&&i.insertPointAt(1,i.getPoint(1).x,t)}else if(180===s){const t=r.left-o/2;if(l){if(4===i.pointsCount){const e=i.getPoint(3).y;i.setPointAt(1,t+20,i.getPoint(1).y),i.insertPointAt(2,t+20,e),i.insertPointAt(3,t,e),i.insertPointAt(4,t-20,e),i.setPointAt(5,i.getPoint(5).x,e)}}else h?c?i.setPointAt(3,i.getPoint(2).x,i.getPoint(4).y):6===i.pointsCount&&(i.setPointAt(2,t,i.getPoint(2).y),i.setPointAt(3,t,i.getPoint(3).y)):4===i.pointsCount?i.insertPointAt(2,t,i.getPoint(2).y):3===i.pointsCount?i.setPointAt(1,t,i.getPoint(2).y):2===i.pointsCount&&i.insertPointAt(1,t,i.getPoint(1).y)}else if(270===s){const t=r.top-o/2;if(l){if(4===i.pointsCount){const e=i.getPoint(3).x;i.setPointAt(1,i.getPoint(1).x,t+20),i.insertPointAt(2,e,t+20),i.insertPointAt(3,e,t),i.insertPointAt(4,e,t-20),i.setPointAt(5,e,i.getPoint(5).y)}}else h?c?i.setPointAt(3,i.getPoint(2).x,i.getPoint(4).y):6===i.pointsCount&&(i.setPointAt(2,i.getPoint(2).x,t),i.setPointAt(3,i.getPoint(3).x,t)):4===i.pointsCount?i.insertPointAt(2,i.getPoint(2).x,t):3===i.pointsCount?i.setPointAt(1,i.getPoint(2).x,t):2===i.pointsCount&&i.insertPointAt(1,i.getPoint(1).x,t)}i.commitRoute()}get fromVertex(){return this.Je}set fromVertex(t){this.Je!==t&&(this.Je=t)}get toVertex(){return this.$e}set toVertex(t){this.$e!==t&&(this.$e=t)}get relativePoint(){return this.kk}set relativePoint(t){this.kk.set(t)}}class Mi{constructor(){}static Light=(()=>({colors:{text:"#0a0a0a",comment:"#ca8a04",link:"#0a0a0a",group:"#a3a3a344",outline:"#a3a3a3",selection:"#0ea5e9",div:"#fff",gridMinor:"#e5e5e5",gridMajor:"#a3a3a3",overviewBox:"#c026d3",tempLink:"#2563eb",tempPort:"#c026d3",adornmentFill:"#0ea5e9",adornmentStroke:"#1e40af",dragSelect:"#c026d3"},fonts:{normal:"10pt sans-serif",bold:"bold 12pt sans-serif"},numbers:{group:1,selection:3},margins:{group:new v(5)},arrowheads:{toArrow:"Standard"}}))();static Dark=(()=>({colors:{text:"#f5f5f5",comment:"#facc15",link:"#f5f5f5",group:"#a3a3a388",outline:"#a3a3a3",selection:"#38bdf8",div:"#171717",gridMinor:"#262626",gridMajor:"#404040",overviewBox:"#e879f9",tempLink:"#60a5fa",tempPort:"#e879f9",adornmentFill:"#38bdf8",adornmentStroke:"#2563eb",dragSelect:"#e879f9"},fonts:{normal:"10pt sans-serif",bold:"bold 12pt sans-serif"},numbers:{group:1,selection:3},margins:{group:new v(5)},arrowheads:{toArrow:"Standard"}}))()}class Ci{ss=(()=>new Set)();lu=(()=>new p)();Pk="light";Sk="light";Mk=!1;vg="light";VD=t=>{const e=t.matches?"dark":"light";e!==this.vg&&(this.vg=e,"system"===this.Sk&&this.cw())};constructor(e){e&&Object.assign(this,e),e?.themeMap||(this.lu.set("light",{colors:{...Mi.Light.colors},fonts:{...Mi.Light.fonts},numbers:{...Mi.Light.numbers},margins:{...Mi.Light.margins},arrowheads:{...Mi.Light.arrowheads}}),this.lu.set("dark",{colors:{...Mi.Dark.colors},fonts:{...Mi.Dark.fonts},numbers:{...Mi.Dark.numbers},margins:{...Mi.Dark.margins},arrowheads:{...Mi.Dark.arrowheads}})),t.matchMedia&&(this.vg=t.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")}get themeMap(){return this.lu}set themeMap(t){this.lu!==t&&(this.lu=t,this.cw())}get defaultTheme(){return this.Pk}set defaultTheme(t){this.Pk!==t&&(e.s(t,"string",Ci,"defaultTheme"),this.Pk=t,this.cw())}get currentTheme(){return this.Sk}set currentTheme(t){this.Sk!==t&&(e.s(t,"string",Ci,"currentTheme"),this.Sk=t,this.cw())}get changesDivBackground(){return this.Mk}set changesDivBackground(t){if(this.Mk!==t&&(this.Mk=t,t))for(const e of this.ss)e.setDivBackground(this.findValue("div","","fill")),e.v("ThemeChanged",this)}get preferredColorScheme(){return this.vg}addDiagram(t){return this.ss.add(t),this.sC(t),this}removeDiagram(t){return this.ss.delete(t),this.sC(t),this}iR(){0===this.ss.size&&t.matchMedia&&t.matchMedia("(prefers-color-scheme: dark)")?.addEventListener("change",this.VD)}eR(){0===this.ss.size&&t.matchMedia&&t.matchMedia("(prefers-color-scheme: dark)")?.removeEventListener("change",this.VD)}set(t,e){""===t&&(t=this.Pk),"system"===t&&(t=this.vg);let i=this.lu.get(t);return i=i?this.zD(i,e):e,this.lu.set(t,i),this.cw(),this}findValue(t,e,i){return this.getValue(this.findTheme(this.currentTheme),t,e,i)||this.getValue(this.findTheme(this.defaultTheme),t,e,i)}getValue(t,e,i,n){if(!t)return;null==i&&(i="");let s=t;const o=t=>{if(void 0===s||""===t)return;if("number"==typeof t||!Array.isArray(t)&&!t.includes("."))return s[t];const e=Array.isArray(t)?t:t.split(".");for(let i=0;i<e.length;i++){const t=e[i];if(""!==t&&(s=s[t],void 0===s))return}return s},r=()=>{if(""===i||(s=o(i),void 0!==s))return s=Array.isArray(s)&&"number"==typeof e?s[e%s.length]:o(e),s};if(s=r(),void 0===s&&"string"==typeof n&&n.length>0){let e=t.targetPropertyMap?.get(n);if(e?s=t[e]:(e=Ci.sE.get(n),s=e?t[e]:t.colors),s=r(),void 0!==s)return s}return s}findTheme(t){return this.themeMap.get("system"===t?this.vg:t)}sC(t){const e=t.skipsUndoManager;t.skipsUndoManager=!0,t.updateAllThemeBindings(),this.Mk&&t.setDivBackground(this.findValue("div","","fill")),t.skipsUndoManager=e,t.v("ThemeChanged",this)}cw(){for(const t of this.ss)this.sC(t)}zD(t,i){for(const n in i)if(e.fw(i,n))try{i[n].constructor===Object?t[n]=this.zD(t[n]??{},i[n]):t[n]=i[n]}catch{delete t[n]}return t}static sE=(()=>new Map([["background","colors"],["defaultColumnSeparatorStroke","colors"],["defaultRowSeparatorStroke","colors"],["shadowColor","colors"],["fill","colors"],["stroke","colors"],["font","fonts"],["angle","numbers"],["fromEndSegmentLength","numbers"],["fromShortLength","numbers"],["height","numbers"],["opacity","numbers"],["scale","numbers"],["toEndSegmentLength","numbers"],["toShortLength","numbers"],["width","numbers"],["defaultColumnSeparatorStrokeWidth","numbers"],["defaultRowSeparatorStrokeWidth","numbers"],["shadowBlur","numbers"],["corner","numbers"],["curviness","numbers"],["smoothness","numbers"],["parameter1","numbers"],["parameter2","numbers"],["strokeWidth","numbers"],["strokeDashOffset","numbers"],["maxLines","numbers"],["spacingAbove","numbers"],["spacingBelow","numbers"],["position","points"],["shadowOffset","points"],["desiredSize","sizes"],["maxSize","sizes"],["minSize","sizes"],["margin","margins"],["defaultSeparatorPadding","margins"],["padding","margins"],["alignment","spots"],["alignmentFocus","spots"],["fromSpot","spots"],["toSpot","spots"],["defaultAlignment","spots"],["spot1","spots"],["spot2","spots"],["verticalAlignment","spots"],["imageAlignment","spots"],["fromArrow","arrowheads"],["toArrow","arrowheads"]]))()}class Ni{Nt;L;Bi;yl;constructor(){this.L=bt.ym(),this.Nt="",this.Bi=!0,this.yl=!0}get name(){return this.Nt}set name(t){this.Nt=t}get isEnabled(){return this.Bi}set isEnabled(t){this.Bi=t}get isRealtime(){return this.yl}set isRealtime(t){this.yl=t}get diagram(){return this.L}set diagram(t){this.L!==t&&(this.L=t,t.Cl=!0,t.requestUpdate())}invalidateRouter(){null!==this.L&&(this.L.Cl=!0,this.L.requestUpdate())}canRoute(t){if(!this.isEnabled)return!1;const e=this.diagram;return!(e&&(!this.isRealtime&&e.xu||e.animationManager.isTicking))}routeLinks(t,e){}toString(){return""!==this.name?this.name+" Router":e.Vn(this.constructor)}}class Ti extends Ni{constructor(t){super(),this.name="AvoidsNodes",t&&Object.assign(this,t)}canRoute(t){return!!(t instanceof bt?t.Gm:t.diagram.Gm)&&super.canRoute(t)}routeLinks(t,e){const i=e instanceof bt?null:e,n=t.iterator,s=this.diagram.getPositions(!0,i,null);for(;n.next();){const t=n.value;if(!t.isAvoiding||t.containingGroup!==i||null===t.toNode||null===t.fromNode||t.pointsCount<4)continue;t.startRoute();const e=t.pointsCount,o=t.getPoint(1),r=t.getPoint(e-2),a=t.fromNode.actualBounds.copy();a.inflate(ve.Ya,ve.Ya),a.unionPoint(t.getPoint(0));const l=t.toNode.actualBounds.copy();l.inflate(ve.Ya,ve.Ya),l.unionPoint(t.getPoint(e-1)),this.nE(t,a,l,s)&&this.oE(t,o,t.rN,r,t.lN,a,l,s),t.commitRoute()}}nE(t,e,i,n){const s=t.diagram,o=t.pointsCount;if(null===s||t.fromNode===t.toNode||t.layer.isTemporary||e.containsPoint(t.getPoint(o-1))&&!t.toNode.isMemberOf(t.fromNode)||i.containsPoint(t.getPoint(0))&&!t.fromNode.isMemberOf(t.toNode)||!t.isOrthogonal)return!1;if(17===t.segmentIndex)return!0;const r=t.getPoint(1),a=t.getPoint(o-2),l=t.getPoint(2);if(!n.isUnoccupied(Math.min(r.x,l.x),Math.min(r.y,l.y),Math.abs(r.x-l.x),Math.abs(r.y-l.y)))return!0;for(let u=2;u<o-3;u++){const e=t.getPoint(u),i=t.getPoint(u+1);if(!n.isUnoccupied(Math.min(e.x,i.x),Math.min(e.y,i.y),Math.abs(e.x-i.x),Math.abs(e.y-i.y)))return!0}const h=t.getPoint(o-3);return!n.isUnoccupied(Math.min(h.x,a.x),Math.min(h.y,a.y),Math.abs(h.x-a.x),Math.abs(h.y-a.y))}oE(t,e,i,n,s,o,r,a){const l=e,h=n;let u=null,c=null;if(t.diagram.isVirtualized){const o=a.bounds.copy(),r=t.getPoint(2),l=t.getPoint(t.pointsCount-3);o.inflate(-a.cellWidth,-a.cellHeight);const h=y.l();a.Ud(e.x,e.y)||(S.kl(o.x,o.y,o.x+o.width,o.y+o.height,e.x,e.y,r.x,r.y,h)?(u=e=h.copy(),i=h.directionPoint(r)):S.kl(o.x,o.y,o.x+o.width,o.y+o.height,r.x,r.y,l.x,l.y,h)?(u=e=h.copy(),i=h.directionPoint(l)):S.kl(o.x,o.y,o.x+o.width,o.y+o.height,l.x,l.y,n.x,n.y,h)&&(u=e=h.copy(),i=h.directionPoint(n))),a.Ud(n.x,n.y)||(S.kl(o.x,o.y,o.x+o.width,o.y+o.height,n.x,n.y,l.x,l.y,h)?(c=n=h.copy(),s=l.directionPoint(h)):S.kl(o.x,o.y,o.x+o.width,o.y+o.height,l.x,l.y,r.x,r.y,h)?(c=n=h.copy(),s=r.directionPoint(h)):S.kl(o.x,o.y,o.x+o.width,o.y+o.height,r.x,r.y,e.x,e.y,h)&&(c=n=h.copy(),s=e.directionPoint(h))),y.e(h)}const d=o.copy().unionRect(r);d.inflate(a.cellWidth*a.Jc,a.cellHeight*a.Jc),a.xT(e,i,n,s,d,!0);let f=a.po(n.x,n.y);if(!a.by&&f>=ke.Bd&&(a.tA(),d.inflate(a.cellWidth*a.VM,a.cellHeight*a.zM),a.xT(e,i,n,s,d,!1),f=a.po(n.x,n.y)),!a.by&&f<ke.Bd&&!a.SO(n.x,n.y)){t.points.removeRange(2,t.pointsCount-3),this.nC(t,a,n.x,n.y,s,!0);const o=0,r=90,d=180,f=270,g=t.getPoint(2);if(t.pointsCount<4)i===o||i===d?(g.x=e.x,g.y=n.y):(g.x=n.x,g.y=e.y),t.setPointAt(2,g.x,g.y),t.insertPointAt(3,g.x,g.y);else{const n=t.getPoint(3);if(i===o||i===d)if(S.f(g.x,n.x)){const s=i===o?Math.max(g.x,e.x):Math.min(g.x,e.x);t.setPointAt(2,s,e.y),t.setPointAt(3,s,n.y)}else S.f(g.y,n.y)?(Math.abs(e.y-g.y)<=a.cellHeight/2&&(t.setPointAt(2,g.x,e.y),t.setPointAt(3,n.x,e.y)),t.insertPointAt(2,g.x,e.y)):t.setPointAt(2,e.x,g.y);else if(i===r||i===f)if(S.f(g.y,n.y)){const s=i===r?Math.max(g.y,e.y):Math.min(g.y,e.y);t.setPointAt(2,e.x,s),t.setPointAt(3,n.x,s)}else S.f(g.x,n.x)?(Math.abs(e.x-g.x)<=a.cellWidth/2&&(t.setPointAt(2,e.x,g.y),t.setPointAt(3,e.x,n.y)),t.insertPointAt(2,e.x,g.y)):t.setPointAt(2,g.x,e.y)}if(null!==u){const e=t.getPoint(1),n=t.getPoint(2);e.x!==n.x&&e.y!==n.y?i===o||i===d?t.insertPointAt(2,e.x,n.y):t.insertPointAt(2,n.x,e.y):i===o||i===d?t.insertPointAt(2,l.x,u.y):t.insertPointAt(2,u.x,l.y)}null!==c&&(s===o||s===d?t.insertPointAt(t.pointsCount-2,h.x,c.y):t.insertPointAt(t.pointsCount-2,c.x,h.y))}}nC(t,e,i,n,s,o){const r=e.cellWidth,a=e.cellHeight;let l=e.po(i,n),h=i,u=n,c=h,d=u;for(0===s?c+=r:90===s?d+=a:180===s?c-=r:d-=a,t.cN&&l>ke.ja&&e.po(c,d)!==l-1&&(e.po(h-r,u)===l-1?(s=180,c=h-r,d=u):e.po(h+r,u)===l-1?(s=0,c=h+r,d=u):e.po(h,u-a)===l-1?(s=270,c=h,d=u-a):e.po(h,u+a)===l-1&&(s=90,c=h,d=u+a));l>ke.ja&&e.po(c,d)===l-1;)h=c,u=d,0===s?c+=r:90===s?d+=a:180===s?c-=r:d-=a,l-=1;if(o?l>ke.ja&&(180===s||0===s?h=Math.floor(h/r)*r+r/2:(90===s||270===s)&&(u=Math.floor(u/a)*a+a/2)):(h=Math.floor(h/r)*r+r/2,u=Math.floor(u/a)*a+a/2),l>ke.ja){let i=s,n=h,o=u;if(0===s?(i=90,o+=a):90===s?(i=180,n-=r):180===s?(i=270,o-=a):270===s&&(i=0,n+=r),e.po(n,o)===l-1)this.nC(t,e,n,o,i,!1);else{let n=h,o=u;0===s?(i=270,o-=a):90===s?(i=0,n+=r):180===s?(i=90,o+=a):270===s&&(i=180,n-=r),e.po(n,o)===l-1&&this.nC(t,e,n,o,i,!1)}}t.insertPointAt(t.pointsCount-2,h,u)}}j.prototype.initializeStandardTools=function(){this.Qt("Action",new J,this.mouseDownTools),this.Qt("Relinking",new Y,this.mouseDownTools),this.Qt("LinkReshaping",new H,this.mouseDownTools),this.Qt("Rotating",new W,this.mouseDownTools),this.Qt("Resizing",new q,this.mouseDownTools),this.Qt("Linking",new X,this.mouseMoveTools),this.Qt("Dragging",new U,this.mouseMoveTools),this.Qt("DragSelecting",new Q,this.mouseMoveTools),this.Qt("Panning",new tt,this.mouseMoveTools),this.Qt("ContextMenu",new nt,this.mouseUpTools),this.Qt("TextEditing",new at,this.mouseUpTools),this.Qt("ClickCreating",new Z,this.mouseUpTools),this.Qt("ClickSelecting",new $,this.mouseUpTools)},bt.xM("GraphLinksModel",class extends Ie{vM(){const t=this.diagram.model;this.Sy(t.nodeDataArray),this.IT(t.linkDataArray)}Sy(t){super.Sy(t,!1);const e=this.links.iterator;for(;e.next();)e.value.Ld();this.diagram.xb(!1)}IT(t){t.forEach((t=>{this.ET(t)})),this.diagram.xb(!1)}ET(t){if(null==t||this.diagram.undoManager.isUndoingRedoing||this.findLinkForData(t))return null;const e=this.getLinkCategoryForData(t),i=this.findLinkTemplateForCategory(e);if(null!==i){i.zt();const n=i.copy();if(null!==n){const i=this.diagram.ge;this.diagram.ge=!0,n.Wo=e,n.ei=t;const s=this.diagram.model,o=s.A1(t,!0);""!==o&&(n.fromPortId=o);const r=s.Fe(t,!0);if(void 0!==r){const t=this.findNodeForKey(r);t instanceof me&&(n.fromNode=t)}const a=s.A1(t,!1);""!==a&&(n.toPortId=a);const l=s.Fe(t,!1);if(void 0!==l){const t=this.findNodeForKey(l);t instanceof me&&(n.toNode=t)}const h=s.getLabelKeysForLinkData(t);return Array.isArray(h)&&h.forEach((t=>{const e=this.findNodeForKey(t);null!==e&&(e.labeledLink=n)})),this.addsToTemporaryLayer&&(n.fl="Tool"),this.diagram.add(n),n.ei=null,n.data=t,this.diagram.ge=i,n}}return null}CT(){const t=this.diagram.model;this.BT(t.linkDataArray),this.wN(t.nodeDataArray)}BT(t){t.forEach((t=>{this.C1(t)}))}getLinkCategoryForData(t){return this.diagram.model.getCategoryForLinkData(t)}setLinkCategoryForData(t,e){return this.diagram.model.setCategoryForLinkData(t,e)}setFromNodeForLink(t,e){const i=this.diagram.model,n=null!==e?e.data:null;i.setFromKeyForLinkData(t.data,i.getKeyForNodeData(n))}setToNodeForLink(t,e){const i=this.diagram.model,n=null!==e?e.data:null;i.setToKeyForLinkData(t.data,i.getKeyForNodeData(n))}aN(t){this.diagram.model.removeLinkData(t.data)}findPartForKey(t){const e=super.findPartForKey(t);if(null===e){const e=this.diagram.model.findLinkDataForKey(t);if(null!==e)return this.findLinkForData(e)}return e}findLinkForKey(t){if(null==t)return null;const e=this.diagram.model.findLinkDataForKey(t);return null!==e?this.findLinkForData(e):null}doModelChanged(t){if(super.doModelChanged(t),!this.diagram)return;const i=this.diagram;if(t.model!==i.model)return;const n=t.change;if(i.K){i.K=!1;try{const s=t.modelChange;if(""!==s){if(2===n){if("linkFromKey"===s){const e=t.object,i=this.findLinkForData(e);if(null!==i){const e=t.newValue,n=this.findNodeForKey(e);i.fromNode=n}}else if("linkToKey"===s){const e=t.object,i=this.findLinkForData(e);if(null!==i){const e=t.newValue,n=this.findNodeForKey(e);i.toNode=n}}else if("linkFromPortId"===s){const e=t.object,i=this.findLinkForData(e);if(null!==i){const e=t.newValue;"string"==typeof e&&(i.fromPortId=e)}}else if("linkToPortId"===s){const e=t.object,i=this.findLinkForData(e);if(null!==i){const e=t.newValue;"string"==typeof e&&(i.toPortId=e)}}else if("nodeGroupKey"===s){const e=t.object,i=this.findPartForData(e);if(null!==i){const e=t.newValue;if(void 0!==e){const t=this.findNodeForKey(e);i.containingGroup=t instanceof Ne?t:null}else i.containingGroup=null}}else if("linkLabelKeys"===s){const e=t.object,i=this.findLinkForData(e);if(null!==i){const e=t.oldValue,n=t.newValue;Array.isArray(e)&&e.forEach((t=>{if(n.indexOf(t)>=0)return;const e=this.findNodeForKey(t);null!==e&&(e.labeledLink=null)})),Array.isArray(n)&&n.forEach((t=>{const e=this.findNodeForKey(t);null!==e&&(e.labeledLink=i)}))}}else if("linkCategory"===s){const e=t.object,i=this.findLinkForData(e),n=t.newValue;null!==i&&"string"==typeof n&&(i.category=n)}else if("linkDataArray"===s){const e=t.oldValue;this.BT(e);const i=t.newValue;this.IT(i)}i.isModified=!0}else if(3===n){const n=t.newValue;if("linkDataArray"===s&&e.H(n))this.ET(n);else if("linkLabelKeys"===s&&t.model.isKeyType(n)){const e=t.object,i=this.findLinkForData(e),s=this.findNodeForKey(n);null!==i&&null!==s&&(s.labeledLink=i)}i.isModified=!0}else if(4===n){const n=t.oldValue;if("linkDataArray"===s&&e.H(n))this.C1(n);else if("linkLabelKeys"===s&&t.model.isKeyType(n)){const t=this.findNodeForKey(n);null!==t&&(t.labeledLink=null)}i.isModified=!0}}else if(2===n){const e=t.propertyName,n=t.object;n===i.model&&("linkFromKeyProperty"===e||"linkToKeyProperty"===e||"linkFromPortIdProperty"===e||"linkToPortIdProperty"===e||"linkLabelKeysProperty"===e||"nodeIsGroupProperty"===e||"nodeGroupKeyProperty"===e||"linkCategoryProperty"===e)&&(i.undoManager.isUndoingRedoing||this.rebuildParts()),i.isModified=!0}}finally{i.K=!0}}}OT(){const t=this.diagram.model,e=new u,i=t.linkDataArray;i.forEach((t=>{e.add(t)}));const n=[];this.links.each((t=>{null!==t.data&&!e.has(t.data)&&n.push(t.data)})),n.forEach((e=>{t.UT(e,!1)})),i.forEach((e=>{null===this.findLinkForData(e)&&t.VT(e,!1)}))}updateRelationshipsFromData(t){const e=t.data;if(null===e)return;const i=t.diagram;if(null===i)return;const n=i.model;if(t instanceof ve){let s=n.Fe(e,!0),o=i.findNodeForKey(s);t.fromNode=o,s=n.Fe(e,!1),o=i.findNodeForKey(s),t.toNode=o;const r=n.getLabelKeysForLinkData(e);if(r.length>0||t.labelNodes.count>0){if(1===r.length&&1===t.labelNodes.count){const e=r[0],i=t.labelNodes.first();if(n.getKeyForNodeData(i.data)===e)return}const e=(new u).addAll(r),s=new u;t.labelNodes.each((t=>{if(null!==t.data){const e=n.getKeyForNodeData(t.data);void 0!==e&&s.add(e)}}));const o=s.copy();o.removeAll(e);const a=e.copy();if(a.removeAll(s),o.count>0||a.count>0){const e=t;o.each((t=>{const n=i.findNodeForKey(t);null!==n&&n.labeledLink===e&&(n.labeledLink=null)})),a.each((t=>{const n=i.findNodeForKey(t);null!==n&&n.labeledLink!==e&&(n.labeledLink=e)}))}}}else if(!(t instanceof fe)){const s=n.getGroupKeyForNodeData(e),o=i.findPartForKey(s);(null===o||o instanceof Ne)&&(t.containingGroup=o)}}N1(t){const e=this.diagram.model,i=e.getKeyForNodeData(t);if(void 0!==i){const n=e.Ny(i),s=this.findPartForData(t);if(null!==n&&null!==s){const t=n.iterator;for(;t.next();){const n=t.value;if(e.containsNodeData(n)){if(s instanceof Ne&&e.getGroupKeyForNodeData(n)===i){const t=this.findPartForData(n);null!==t&&(t.containingGroup=s)}}else{const t=this.findLinkForData(n);if(null!==t&&s instanceof me){e.Fe(n,!0)===i&&(t.fromNode=s),e.Fe(n,!1)===i&&(t.toNode=s);const o=e.getLabelKeysForLinkData(n);Array.isArray(o)&&o.some((e=>e===i&&(s.labeledLink=t,!0)))}}}e._s(i)}const o=e.getGroupKeyForNodeData(t);if(void 0!==o){const t=this.findNodeForKey(o);t instanceof Ne&&(s.containingGroup=t)}}}xN(t){const e=this.diagram.model;if(t instanceof me){const i=e.getKeyForNodeData(t.data);if(void 0!==i){const n=t.linksConnected;for(;n.next();){const t=n.value;e.tn(i,t.data)}if(t.isLinkLabel){const n=t.labeledLink;null!==n&&e.tn(i,n.data)}if(t instanceof Ne){const n=t.memberParts;for(;n.next();){const t=n.value.data;e.containsNodeData(t)&&e.tn(i,t)}}}}}PN(t,i){let n=super.PN(t,i);if(t instanceof ve){const s=t.data;if(null!==s&&null!==i){const t=i.model,o=t.copyLinkData(s);e.H(o)&&(t.addLinkData(o),n=i.findLinkForData(o))}else if(null!==n){const t=this.diagram;if(null!==s&&null!==t&&null!==t.commandHandler&&t.commandHandler.copiesClipboardData){const i=t.model.copyLinkData(s);e.H(i)&&(n.data=i)}}}return n}insertLink(t,i,n,s){const o=this.diagram,r=o.model,a=o.toolManager.findTool("Linking");let l="";null!==t&&(null===i&&(i=t),l=i.portId,null===l&&(l=""));let h="";null!==n&&(null===s&&(s=n),h=s.portId,null===h&&(h=""));const u=a.archetypeLinkData;if(u instanceof ve){u.zt();const e=u.copy();if(null!==e){e.fromNode=t,e.fromPortId=l,e.toNode=n,e.toPortId=h,o.add(e);const i=a.archetypeLabelNodeData;if(i instanceof me){i.zt();const t=i.copy();null!==t&&(t.labeledLink=e,o.add(t))}return e}}else if(null!==u){const i=r.copyLinkData(u);if(e.H(i)){null!==t&&r._d(i,r.getKeyForNodeData(t.data),!0),r.tg(i,l,!0),null!==n&&r._d(i,r.getKeyForNodeData(n.data),!1),r.tg(i,h,!1),r.addLinkData(i);const s=a.archetypeLabelNodeData;if(null!==s&&!(s instanceof me)){const t=r.copyNodeData(s);if(e.H(t)){r.addNodeData(t);const e=r.getKeyForNodeData(t);void 0!==e&&r.addLabelKeyForLinkData(i,e)}}return o.findLinkForData(i)}}return null}}),bt.xM("TreeModel",class extends Ie{Th=null;T1(t,e){if(null===t||null===e||null!==e.findTreeParentLink())return null;const i=this.diagram.toolManager.findTool("Linking");let n=t,s=e;if(this.diagram.isTreePathToChildren){if(null!==i&&i.Pu(n,s,null,!0))return null}else if(n=e,s=t,null!==i&&i.Pu(n,s,null,!0))return null;const o=this.getLinkCategoryForData(e.data),r=this.findLinkTemplateForCategory(o);if(null!==r){r.zt();const t=r.copy();if(null!==t){const i=this.diagram.ge;return this.diagram.ge=!0,t.Wo=o,t.ei=e.data,t.fromNode=n,t.toNode=s,this.diagram.add(t),t.ei=null,t.data=e.data,this.diagram.ge=i,t}}return null}getLinkCategoryForData(t){return this.diagram.model.getParentLinkCategoryForNodeData(t)}setLinkCategoryForData(t,e){this.diagram.model.setParentLinkCategoryForNodeData(t,e)}setFromNodeForLink(t,e,i){const n=this.diagram.model;void 0===i&&(i=null);const s=null!==e?e.data:null;if(this.diagram.isTreePathToChildren)n.setParentKeyForNodeData(t.data,n.getKeyForNodeData(s));else{const e=this.Th;this.Th=t,null!==i&&n.setParentKeyForNodeData(i.data,void 0);const o=null!==t.toNode?t.toNode.data:null;n.setParentKeyForNodeData(s,n.getKeyForNodeData(o)),this.Th=e}}setToNodeForLink(t,e,i){const n=this.diagram.model;void 0===i&&(i=null);const s=null!==e?e.data:null;if(this.diagram.isTreePathToChildren){const e=this.Th;this.Th=t,null!==i&&n.setParentKeyForNodeData(i.data,void 0);const o=null!==t.fromNode?t.fromNode.data:null;n.setParentKeyForNodeData(s,n.getKeyForNodeData(o)),this.Th=e}else n.setParentKeyForNodeData(t.data,n.getKeyForNodeData(s))}aN(t){this.diagram.model.setParentKeyForNodeData(t.data,void 0)}findLinkForKey(t){if(null==t)return null;const e=this.diagram.model.findNodeDataForKey(t);return null!==e?this.findLinkForData(e):null}doModelChanged(t){if(super.doModelChanged(t),!this.diagram)return;const e=this.diagram;if(t.model!==e.model)return;const i=t.change;if(e.K){e.K=!1;try{const n=t.modelChange;if(""!==n){if(2===i){if("nodeParentKey"===n){const i=t.object,n=t.newValue,s=this.findNodeForKey(n),o=this.findNodeForData(i);if(null!==this.Th)null!==s&&(this.Th.data=i,this.Th.category=this.getLinkCategoryForData(i));else if(null!==o){const t=o.findTreeParentLink();null!==t?null===s?e.remove(t):e.isTreePathToChildren?t.fromNode=s:t.toNode=s:this.T1(s,o)}}else if("parentLinkCategory"===n){const e=t.object,i=this.findNodeForData(e),n=t.newValue;if(null!==i&&"string"==typeof n){const t=i.findTreeParentLink();null!==t&&(t.category=n)}}e.isModified=!0}}else if(2===i){const i=t.propertyName,n=t.object;n===e.model&&"nodeParentKeyProperty"===i&&(e.undoManager.isUndoingRedoing||this.rebuildParts()),e.isModified=!0}}finally{e.K=!0}}}updateRelationshipsFromData(t){const e=t.data;if(null===e)return;const i=t.diagram;if(null===i)return;const n=i.model;if(t instanceof me){const s=n.getParentKeyForNodeData(e),o=i.findNodeForKey(s);if(o!==t.findTreeParentNode()){const e=t.findTreeParentLink();null!==o?null!==e?i.isTreePathToChildren?e.fromNode=o:e.toNode=o:this.T1(o,t):null!==e&&i.DM(e,!1)}}}My(t,e){if(super.My(t,e),"string"==typeof e&&null!==this.findPartForData(t)){const i=this.findLinkForData(t);null!==i&&i.updateTargetBindings(e)}}N1(t){const e=this.diagram.model,i=e.getKeyForNodeData(t);if(void 0!==i){const n=e.Ny(i),s=this.findPartForData(t);if(null!==n&&null!==s){const t=n.iterator;for(;t.next();){const n=t.value;if(e.containsNodeData(n)&&s instanceof me&&e.getParentKeyForNodeData(n)===i){const t=this.findNodeForData(n);this.T1(s,t)}}e._s(i)}const o=e.getParentKeyForNodeData(t);if(void 0!==o&&s instanceof me){const t=this.findNodeForKey(o);this.T1(t,s)}}}xN(t){const e=this.diagram.model;if(t instanceof me){const i=e.getKeyForNodeData(t.data),n=this.findLinkForData(t.data);if(null!==n){n.isSelected=!1,n.isHighlighted=!1;const t=n.layer;if(null!==t){const e=t.se(-1,n,!1);e>=0&&this.diagram.raiseChangedEvent(4,"parts",t,n,null,e,null);const i=n.layerChanged;null!==i&&i(n,t,null)}}const s=this.diagram.isTreePathToChildren,o=t.linksConnected;for(;o.next();){const t=o.value,n=(s?t.toNode:t.fromNode).data;e.containsNodeData(n)&&e.tn(i,n)}}}insertLink(t,e,i,n){const s=this.diagram.model;let o=t,r=i;if(this.diagram.isTreePathToChildren||(o=i,r=t),null!==o&&null!==r){const t=o.data,e=r.data;return s.setParentKeyForNodeData(e,s.getKeyForNodeData(t)),r.findTreeParentLink()}return null}});const Li=t.go,Ai={get version(){return bt.version},Group:Ne,List:l,Set:u,Map:p,Point:y,Size:x,Rect:b,Margin:v,Spot:w,Geometry:N,PathFigure:T,PathSegment:A,InputEvent:D,DiagramEvent:F,ChangedEvent:R,Model:Ue,GraphLinksModel:Ge,TreeModel:Ke,Binding:Ve,ThemeBinding:je,Transaction:E,UndoManager:B,CommandHandler:Ct,Tool:I,DraggingTool:U,DraggingInfo:wt,DraggingOptions:St,LinkingBaseTool:G,LinkingTool:X,RelinkingTool:Y,LinkReshapingTool:H,ResizingTool:q,RotatingTool:W,ClickSelectingTool:$,ActionTool:J,ClickCreatingTool:Z,HTMLInfo:et,ContextMenuTool:nt,DragSelectingTool:Q,PanningTool:tt,TextEditingTool:at,ToolManager:j,Animation:ut,AnimationManager:ht,AnimationTrigger:ft,Layer:gt,Diagram:bt,Palette:class extends bt{constructor(i,n){let s;return void 0===i||"string"==typeof i||t.Element&&i instanceof Element?s=i:e.H(i)&&(n=i),super(s),this.lA(),n&&this.setProperties(n),this}lA(){this.allowDragOut=!0,this.allowMove=!1,this.isReadOnly=!0,this.contentAlignment=w.TopCenter,this.layout=new Be}setupRouters(){}reset(){super.reset(),this.lA()}},Overview:Pt,Brush:Ut,GraphObject:At,Panel:Yt,RowColumnDefinition:$t,Shape:Jt,TextBlock:ie,Picture:re,Part:ce,Adornment:fe,Node:me,Link:ve,Placeholder:Te,Layout:Le,LayoutNetwork:Ae,LayoutVertex:De,LayoutEdge:Fe,GridLayout:Be,PanelLayout:Gt,CircularLayout:qe,CircularNetwork:$e,CircularVertex:Je,CircularEdge:Ze,ForceDirectedLayout:Qe,ForceDirectedNetwork:ti,ForceDirectedVertex:ei,ForceDirectedEdge:ii,LayeredDigraphLayout:ui,LayeredDigraphNetwork:ci,LayeredDigraphVertex:di,LayeredDigraphEdge:fi,TreeLayout:wi,TreeNetwork:ki,TreeVertex:Si,TreeEdge:Pi,Themes:Mi,ThemeManager:Ci,Router:Ni,AnimationStyle:lt,AutoScale:mt,CycleMode:pt,Flip:Lt,TextFormat:ee,ImageStretch:oe,LayoutConditions:ue,LinkAdjusting:ye,Curve:be,Routing:xe,Orientation:Tt,TextOverflow:te,PortSpreading:ge,ScrollMode:yt,CollapsePolicy:xt,Sizing:Wt,TriggerStart:dt,Stretch:Nt,ViewboxStretch:Xt,Wrap:Qt,BrushType:zt,ColorSpace:Vt,GeometryStretch:C,GeometryType:M,SegmentType:L,BindingMode:ze,ChangeType:O,CircularArrangement:Xe,CircularDirection:Ye,CircularNodeDiameterFormula:He,CircularSorting:_e,GridAlignment:Oe,GridArrangement:Re,GridSorting:Ee,LayeredDigraphAggressive:ai,LayeredDigraphAlign:hi,LayeredDigraphCycleRemove:si,LayeredDigraphInit:ri,LayeredDigraphLayering:oi,LayeredDigraphPack:li,TreeAlignment:pi,TreeArrangement:bi,TreeCompaction:yi,TreeLayerStyle:vi,TreePath:gi,TreeSorting:mi,TreeStyle:xi,GestureMode:V,LinkingDirection:K,ReshapingBehavior:_,TextEditingAccept:st,TextEditingStarting:ot,TextEditingState:rt,WheelMode:z};for(const Di in Ai){const t=Ai[Di];e.ot(t)&&t!==ee&&(t.className=Di)}e.H(Li)&&Li.version&&e.li("WARNING: a `go` object on the root object is already defined.  "+("Debug"in Li?"debug ":"")+"version: "+Li.version+", replaced with version: "+Ai.version),bt.prototype.go=Ai,t.go=Ai}();"undefined"!==typeof global?global.go:self.go;const o="undefined"!==typeof global?global.go:self.go,r=(o.Group,o.List,o.Set,o.Map,o.Point),a=o.Size,l=(o.Rect,o.Margin),h=o.Spot,u=(o.Geometry,o.PathFigure,o.PathSegment,o.InputEvent,o.DiagramEvent,o.ChangedEvent,o.Model,o.GraphLinksModel),c=(o.TreeModel,o.Binding),d=(o.ThemeBinding,o.Transaction,o.UndoManager,o.CommandHandler,o.Tool,o.DraggingTool,o.DraggingInfo,o.DraggingOptions,o.LinkingBaseTool,o.LinkingTool,o.RelinkingTool,o.LinkReshapingTool,o.ResizingTool,o.RotatingTool,o.ClickSelectingTool,o.ActionTool,o.ClickCreatingTool,o.HTMLInfo,o.ContextMenuTool,o.DragSelectingTool,o.PanningTool,o.TextEditingTool,o.ToolManager,o.Animation,o.AnimationManager,o.AnimationTrigger,o.Layer,o.Diagram),f=(o.Palette,o.Overview,o.Brush,o.GraphObject),g=(o.Panel,o.RowColumnDefinition,o.Shape),m=o.TextBlock,p=(o.Picture,o.Part,o.Adornment,o.Node),y=(o.Link,o.Placeholder,o.Layout,o.LayoutNetwork,o.LayoutVertex,o.LayoutEdge,o.GridLayout,o.PanelLayout,o.CircularLayout,o.CircularNetwork,o.CircularVertex,o.CircularEdge,o.ForceDirectedLayout,o.ForceDirectedNetwork,o.ForceDirectedVertex,o.ForceDirectedEdge,o.LayeredDigraphLayout),x=(o.LayeredDigraphNetwork,o.LayeredDigraphVertex,o.LayeredDigraphEdge,o.TreeLayout,o.TreeNetwork,o.TreeVertex,o.TreeEdge,o.Themes,o.ThemeManager,o.Router,o.version,o.AnimationStyle,o.AutoScale,o.Curve,o.CycleMode,o.Flip,o.ImageStretch,o.LayoutConditions,o.LinkAdjusting,o.Orientation,o.PortSpreading,o.Routing,o.ScrollMode,o.CollapsePolicy,o.Sizing,o.TriggerStart,o.Stretch,o.TextFormat,o.TextOverflow,o.ViewboxStretch,o.Wrap,o.BrushType,o.ColorSpace,o.GeometryStretch,o.GeometryType,o.SegmentType,o.BindingMode,o.ChangeType,o.CircularArrangement,o.CircularDirection,o.CircularNodeDiameterFormula,o.CircularSorting,o.GridAlignment,o.GridArrangement,o.GridSorting,o.LayeredDigraphAggressive,o.LayeredDigraphAlign,o.LayeredDigraphCycleRemove,o.LayeredDigraphInit,o.LayeredDigraphLayering,o.LayeredDigraphPack,o.TreeAlignment,o.TreeArrangement,o.TreeCompaction,o.TreeLayerStyle,o.TreePath,o.TreeSorting,o.TreeStyle,o.GestureMode,o.LinkingDirection,o.ReshapingBehavior,o.TextEditingAccept,o.TextEditingStarting,o.TextEditingState,o.WheelMode,{nodeDataArray:[{key:"start",text:"Start",description:"Este \xe9 o ponto inicial do fluxo."},{key:"config",text:"Configura\xe7\xe3o do Colegiado"},{key:"cronograma",text:"Cronograma da Sess\xe3o"},{key:"preparacao",text:"Prepara\xe7\xe3o da Sess\xe3o"},{key:"durante",text:"Durante a Sess\xe3o"},{key:"pos",text:"P\xf3s-Sess\xe3o"},{key:"finish",text:"Finish"}],linkDataArray:[{from:"start",to:"config"},{from:"config",to:"cronograma"},{from:"cronograma",to:"preparacao"},{from:"preparacao",to:"durante"},{from:"durante",to:"pos"},{from:"pos",to:"finish"}]});function b(t,e){console.log(`\ud83c\udfa8 Atualizando cores do UpperFlowchart: N\xf3 selecionado -> ${e}`),t.startTransaction("updateColors"),t.nodes.each((t=>{const i=t.findObject("SHAPE");i&&(i.fill=e&&t.data.key!==e?"#BDC3C7":"#70A1FF")})),t.commitTransaction("updateColors")}var v=i(579);const w=t=>{let{isOpen:e,onClose:i,content:n,onModalClose:s,description:o}=t;if(!e)return null;const r=()=>{i(),s&&s()};return(0,v.jsx)("div",{className:"modal-overlay",onClick:r,children:(0,v.jsxs)("div",{className:"modal-content",onClick:t=>t.stopPropagation(),children:[(0,v.jsx)("button",{className:"modal-close",onClick:r,children:"\xd7"}),(0,v.jsx)("h2",{className:"modal-title",children:n})," ",Array.isArray(o)?(0,v.jsx)("ul",{className:"modal-list",children:o.map(((t,e)=>(0,v.jsxs)("li",{children:["\u2022 ",t]},e)))}):(0,v.jsx)("p",{children:o})]})})},k=t=>{let{onNodeSelect:e,selectedUpperNode:i,setSelectedUpperNode:s,isUpperModalOpen:o,setIsUpperModalOpen:k}=t;const S=(0,n.useRef)(null),P=(0,n.useRef)(null),[M,C]=(0,n.useState)(0);(0,n.useEffect)((()=>{if(P.current)return void console.log("\u26a0\ufe0f UpperFlowchart: Diagrama j\xe1 inicializado.");const t=f.make,i=S.current,n=t(d,i,{"undoManager.isEnabled":!0,layout:t(y,{direction:0,layerSpacing:50}),padding:new l(10,10,10,10)});P.current=n,n.nodeTemplate=(t=>{const e=f.make;return e(p,"Auto",{selectionAdorned:!1,shadowOffset:new r(4,4),shadowColor:"rgba(0, 0, 0, 0.15)",shadowBlur:10,mouseEnter:(t,e)=>{e.diagram.startTransaction("hover"),e.scale=1.05,e.findObject("SHAPE").stroke="#1E3799",e.diagram.commitTransaction("hover")},mouseLeave:(t,e)=>{e.diagram.startTransaction("hover"),e.scale=1,e.findObject("SHAPE").stroke="#1E3799",e.diagram.commitTransaction("hover")},click:(e,i)=>{t&&t(i.data)}},e(g,"RoundedRectangle",{name:"SHAPE",fill:"#70A1FF",stroke:"#1E3799",strokeWidth:2}),e(m,{margin:10,font:"14px sans-serif",textAlign:"center",wrap:m.WrapFit,minSize:new a(100,30),verticalAlignment:h.Center},new c("text","text")))})((t=>{console.log("\ud83d\udd14 N\xf3 da upper chart clicado:",t),s(t),e(t),b(n,t.key),C(Date.now())})),n.model=new u(x.nodeDataArray,x.linkDataArray),n.addDiagramListener("BackgroundSingleClicked",(()=>{s(null),b(n,null)}))}),[e,s]);return(0,v.jsxs)("div",{className:"flowchart-container",children:[(0,v.jsx)("div",{className:"flowchart-diagram",ref:S}),i&&(0,v.jsx)("button",{className:"content-button",onClick:()=>{console.log("\ud83d\udccc UpperFlowchart: Bot\xe3o 'Conte\xfado' pressionado."),k(!0)},children:"Conte\xfado"},M),(0,v.jsx)(w,{isOpen:o,onClose:()=>k(!1),onModalClose:()=>s(null),content:i?i.text:"Nenhum n\xf3 selecionado",description:i?i.description:"Sem detalhes dispon\xedveis."})]})},S={config:{nodeDataArray:[{key:"sub-config-1",text:"\xd3rg\xe3os de Gabinete e Secretaria",description:"Conte\xfado em Prepara\xe7\xe3o"},{key:"sub-config-2",text:"Associa\xe7\xe3o de Magistrados ao \xf3rg\xe3o julgador",description:"Conte\xfado em Prepara\xe7\xe3o"},{key:"sub-config-3",text:"Defini\xe7\xe3o da ordem dos Gabinetes no colegiado",description:"Conte\xfado em Prepara\xe7\xe3o"},{key:"sub-config-4",text:"Configura\xe7\xe3o dos agrupamentos do \xf3rg\xe3o",description:"Conte\xfado em Prepara\xe7\xe3o"}],linkDataArray:[{from:"sub-config-1",to:"sub-config-2"},{from:"sub-config-2",to:"sub-config-3"},{from:"sub-config-3",to:"sub-config-4"}]},cronograma:{nodeDataArray:[{key:"sub-cron-1",text:"Cronograma Padr\xe3o",description:"Defini\xe7\xe3o de datas limites (pauta, mesa, minutas, publica\xe7\xe3o)"},{key:"sub-cron-2",text:"Defini\xe7\xe3o de datas limites",description:"Conte\xfado em Prepara\xe7\xe3o"},{key:"sub-cron-3",text:"Cronograma de Sess\xf5es de Julgamento",description:"Conte\xfado em Prepara\xe7\xe3o"},{key:"sub-cron-4",text:"Calend\xe1rio de Sess\xf5es de Julgamento",description:"Conte\xfado em Prepara\xe7\xe3o"}],linkDataArray:[{from:"sub-cron-1",to:"sub-cron-2"},{from:"sub-cron-2",to:"sub-cron-3"},{from:"sub-cron-3",to:"sub-cron-4"}]},preparacao:{nodeDataArray:[{key:"sub-prep-1",text:"Pauta",description:["Abrir Pauta","Gabinetes incluem processos na pauta","Fechar Pauta"]},{key:"sub-prep-2",text:"Status da Sess\xe3o e Recursos",description:"Conte\xfado em Prepara\xe7\xe3o"},{key:"sub-prep-3",text:"Painel da Sess\xe3o de Julgamento",description:["Abas da Sess\xe3o (Com apontamentos, Sem apontamentos, Integra)","Crit\xe9rios de Exibi\xe7\xe3o (organiza\xe7\xe3o das informa\xe7\xf5es)","Recursos do Item da Sess\xe3o (a\xe7\xf5es para cada processo)"]},{key:"sub-prep-4",text:"Impedimentos",description:["Em bloco ou individualmente","Se houver impedimento, convocar novo magistrado"]},{key:"sub-prep-5",text:"Qu\xf3rum e Composi\xe7\xe3o",description:["Definir magistrados participantes","Definir presidente da sess\xe3o","Informar a composi\xe7\xe3o dos julgamentos"]},{key:"sub-prep-6",text:"Gera\xe7\xe3o da Pauta e Intima\xe7\xe3o",description:["Gerar pauta","Lan\xe7ar eventos de inclus\xe3o em pauta e intima\xe7\xe3o (opcional)"]},{key:"sub-prep-7",text:"Publica\xe7\xe3o",description:["Enviar pauta para publica\xe7\xe3o no DJEN","Possibilidade de envio pelo MEM em caso de instabilidade"]},{key:"sub-prep-8",text:"Relat\xf3rio Geral da Sess\xe3o de Julgamento",description:"Conte\xfado em Prepara\xe7\xe3o"},{key:"sub-prep-9",text:"Altera\xe7\xe3o de Data/Hora da Sess\xe3o",description:["-(se necess\xe1rio)-","Nova intima\xe7\xe3o ser\xe1 necess\xe1ria"]},{key:"sub-prep-10",text:"Aditamento",description:["-(se necess\xe1rio, dentro do prazo)-","Gabinetes incluem processos por aditamento","Gerar aditamento","Publicar aditamento"]},{key:"sub-prep-11",text:"Pedidos de Sustenta\xe7\xe3o Oral e Prefer\xeancia",description:["Advogados fazem pedidos no eproc","Secret\xe1rio aprova os pedidos","Secret\xe1rio pode cadastrar pedidos diretamente","Ordenar os pedidos da sess\xe3o"]}],linkDataArray:[{from:"sub-prep-1",to:"sub-prep-2"},{from:"sub-prep-2",to:"sub-prep-3"},{from:"sub-prep-3",to:"sub-prep-4"},{from:"sub-prep-4",to:"sub-prep-5"},{from:"sub-prep-5",to:"sub-prep-6"},{from:"sub-prep-6",to:"sub-prep-7"},{from:"sub-prep-7",to:"sub-prep-8"},{from:"sub-prep-8",to:"sub-prep-9"},{from:"sub-prep-9",to:"sub-prep-10"},{from:"sub-prep-10",to:"sub-prep-11"}]},durante:{nodeDataArray:[{key:"sub-dur-1",text:"Abrir a Sess\xe3o",description:['Status muda para "Sess\xe3o aberta"']},{key:"sub-dur-2",text:"Exibi\xe7\xe3o dos Itens em Julgamento",description:['Secret\xe1rio marca o processo como "em julgamento"']},{key:"sub-dur-3",text:"Tela de Resumo do Item da Sess\xe3o",description:["Visualiza\xe7\xe3o do resumo do item (martelinho)","Acesso \xe0 minuta"]},{key:"sub-dur-4",text:"Atualizar Resultados da Sess\xe3o",description:["Individualmente ou em bloco","Possibilidade de excluir resultado lan\xe7ado"]},{key:"sub-dur-5",text:"Automa\xe7\xe3o dos Julgamentos Un\xe2nimes",description:["-(p\xf3s-julgamento)-","Se individual, secret\xe1rio deve encaminhar minutas para assinatura (se gabinete do relator tiver configurado a automa\xe7\xe3o)","Se em bloco, sistema agenda automaticamente","Minutas de julgamento v\xe3o para o status 'para assinar'","Sistema agenda 'Juntada de Relat\xf3rio/Voto/Ac\xf3rd\xe3o' e remessa \xe0 DRI","Ap\xf3s assinatura, eventos s\xe3o lan\xe7ados e processo \xe9 inclu\xeddo no localizador"]},{key:"sub-dur-6",text:"Confirmar Previs\xe3o de Resultado",description:["-(se sess\xe3o aberta)-","Exibe resultado do julgamento ao passar o mouse",'Bot\xe3o "Ver Extrato de Ata da Sess\xe3o"']},{key:"sub-dur-7",text:"Lan\xe7amento dos Eventos de Julgamento",description:["Individualmente, para um grupo de processos ou em bloco","Extrato da ata (certid\xe3o de julgamento) \xe9 juntado ao processo"]},{key:"sub-dur-8",text:"Visualizar Resumo da Sess\xe3o de Julgamento (ement\xe1rio)",description:"Conte\xfado em Prepara\xe7\xe3o"},{key:"sub-dur-9",text:"Visualizar Estat\xedsticas da Sess\xe3o de Julgamento",description:"Conte\xfado em Prepara\xe7\xe3o"},{key:"sub-dur-10",text:"Encerrar a Sess\xe3o",description:['Status muda para "Sess\xe3o encerrada"',"Possibilidade de cancelar o encerramento"]}],linkDataArray:[{from:"sub-dur-1",to:"sub-dur-2"},{from:"sub-dur-2",to:"sub-dur-3"},{from:"sub-dur-3",to:"sub-dur-4"},{from:"sub-dur-4",to:"sub-dur-5"},{from:"sub-dur-5",to:"sub-dur-6"},{from:"sub-dur-6",to:"sub-dur-7"},{from:"sub-dur-7",to:"sub-dur-8"},{from:"sub-dur-8",to:"sub-dur-9"},{from:"sub-dur-9",to:"sub-dur-10"}]},pos:{nodeDataArray:[{key:"sub-pos-1",text:"Pedido de Vista",description:["Resultados atualizados individualmente","Processo inclu\xeddo em pauta novamente (pauta ou mesa)","Gabinete que pediu vista remete ao relator para inclus\xe3o em pauta"]},{key:"sub-pos-2",text:"Julgamento Sobrestado (Art. 942 CPC)",description:["Julgamento n\xe3o un\xe2nime",'Sistema indica julgamento como "Sobrestado - art. 942 do CPC"',"Resultado com texto padr\xe3o",'Evento lan\xe7ado: "Deliberado em Sess\xe3o - Sobrestado - art. 942 do CPC"',"Processo permanece com o relator","Novo magistrado \xe9 convocado","Processo \xe9 pautado novamente"]},{key:"sub-pos-3",text:"Julgamento Adiado e Retirado de Pauta",description:["Eventos lan\xe7ados pelo Gabinete (se entre intima\xe7\xe3o e sess\xe3o)","Evento lan\xe7ado pelo Secret\xe1rio (se no dia da sess\xe3o)","Processos adiados n\xe3o s\xe3o inclu\xeddos automaticamente na pauta seguinte","Nova inclus\xe3o em pauta ou mesa \xe9 necess\xe1ria"]},{key:"sub-pos-4",text:"Confer\xeancia da Sess\xe3o de Julgamento",description:["Secret\xe1rio tem acesso ao \xedcone ap\xf3s o encerramento da sess\xe3o","Confer\xeancia ap\xf3s lan\xe7amento dos resultados","Sistema verifica poss\xedveis erros no lan\xe7amento de resultado","Se n\xe3o houver inconsist\xeancias, mensagem \xe9 exibida"]},{key:"sub-pos-5",text:"Encerramento da Ata",description:["Conferir dados","Verificar inconsist\xeancias","Alterar informa\xe7\xf5es da sess\xe3o","Alterar textos inicial e final","Ajustar qu\xf3rum e composi\xe7\xf5es","Encerrar Ata",'Status muda para "Ata encerrada"',"Consulta da ata pelo \xedcone","Possibilidade de imprimir e arquivar"]},{key:"sub-pos-6",text:"Retifica\xe7\xe3o de Ata",description:["Se necess\xe1rio, para corrigir dados/resultados equivocados",'Secret\xe1rio cria documento "Retifica\xe7\xe3o de Ata" vinculado ao julgamento a ser corrigido','Inclus\xe3o do processo em pauta com tipo "Retifica\xe7\xe3o de Ata"',"Elabora\xe7\xe3o da minuta n\xe3o \xe9 obrigat\xf3ria",'Processo consta na aba "Retifica\xe7\xe3o de Ata"',"Secret\xe1rio lan\xe7a resultado do julgamento e novo extrato da ata com as retifica\xe7\xf5es"]}],linkDataArray:[{from:"sub-pos-1",to:"sub-pos-2"},{from:"sub-pos-2",to:"sub-pos-3"},{from:"sub-pos-3",to:"sub-pos-4"},{from:"sub-pos-4",to:"sub-pos-5"},{from:"sub-pos-5",to:"sub-pos-6"}]}};function P(t,e){console.log(`\ud83c\udfa8 Atualizando cores na LowerFlowchart: N\xf3 selecionado -> ${e}`),t.startTransaction("updateColors"),t.nodes.each((t=>{const i=t.findObject("SHAPE");i&&(i.fill=e&&t.data.key!==e?"#BDC3C7":"#9B59B6")})),t.commitTransaction("updateColors")}function M(t,e){console.log("\ud83c\udfa8 Criando o diagrama LowerFlowchart...");const i=f.make,n=t.current,s=i(d,n,{"undoManager.isEnabled":!0,layout:i(y,{direction:0,layerSpacing:50}),padding:new l(10,10,10,10)});return s.model=new u,s.model.linkKeyProperty="key",s.nodeTemplate=(t=>{const e=f.make;return e(p,"Auto",{selectionAdorned:!1,shadowOffset:new r(4,4),shadowColor:"rgba(0, 0, 0, 0.15)",shadowBlur:10,mouseEnter:(t,e)=>{e.diagram.startTransaction("hover"),e.scale=1.05,e.findObject("SHAPE").stroke="#5D3F6A",e.diagram.commitTransaction("hover")},mouseLeave:(t,e)=>{e.diagram.startTransaction("hover"),e.scale=1,e.findObject("SHAPE").stroke="#5D3F6A",e.diagram.commitTransaction("hover")},click:(e,i)=>{t&&t(i.data),console.log(`\ud83d\uddb1\ufe0f N\xf3 clicado na LowerFlowchart: ${i.data.key}`),P(i.diagram,i.data.key)}},e(g,"RoundedRectangle",{name:"SHAPE",fill:"#9B59B6",stroke:"#5D3F6A",strokeWidth:2}),e(m,{margin:10,font:"14px sans-serif",textAlign:"center",wrap:m.WrapFit,maxSize:new a(120,NaN),verticalAlignment:h.Center},new c("text","text")))})(e),console.log("\u2705 Diagrama LowerFlowchart criado com sucesso!"),s.addDiagramListener("BackgroundSingleClicked",(()=>{console.log("\ud83d\uddb1\ufe0f Clique no fundo do LowerFlowchart \u2192 Resetando sele\xe7\xe3o."),e(null)})),s}function C(t,e){if(!t)return;if(console.log("\ud83d\udd01 Atualizando LowerFlowchart..."),console.log("\ud83d\udcca Dados recebidos para atualiza\xe7\xe3o:",e),t.isTransactionInProgress&&(console.warn("\u26a0\ufe0f Uma transa\xe7\xe3o ainda ativa! Cancelando antes de atualizar..."),t.rollbackTransaction()),!e||!e.nodeDataArray||0===e.nodeDataArray.length)return console.log("\u26a0\ufe0f Nenhum n\xf3 dispon\xedvel. Limpando o diagrama."),void t.clear();const i=()=>{if(t.isTransactionInProgress)return console.warn("\u26a0\ufe0f Transa\xe7\xe3o ainda ativa! Agendando nova tentativa..."),void setTimeout(i,50);console.log("\ud83d\udee0\ufe0f Resetando e atualizando o modelo do diagrama..."),t.model=new u(e.nodeDataArray,e.linkDataArray),P(t,null),console.log("\u2705 LowerFlowchart atualizado com sucesso!")};setTimeout(i,50)}const N=t=>{let{selectedUpperNodeKey:e}=t;const i=(0,n.useRef)(null),s=(0,n.useRef)(null),[o,r]=(0,n.useState)(null),[a,l]=(0,n.useState)(!1),[h,u]=(0,n.useState)(0);console.log("\ud83d\udd04 LowerFlowchart renderizou! N\xf3 selecionado (upper):",e),(0,n.useEffect)((()=>{s.current?console.log("\u26a0\ufe0f LowerFlowchart: Diagrama j\xe1 inicializado."):s.current=M(i,(t=>{console.log("\ud83d\udd14 N\xf3 da lower chart clicado:",t),r(t),u(Date.now())}))}),[]),(0,n.useEffect)((()=>{if(!s.current)return void console.log("\u26a0\ufe0f LowerFlowchart: Tentativa de atualiza\xe7\xe3o antes da inicializa\xe7\xe3o.");if(console.log("\ud83d\udd0d Buscando dados para a chave selecionada:",e),!e)return console.log("\u26a0\ufe0f Nenhuma chave selecionada. O diagrama ser\xe1 limpo."),void C(s.current,{nodeDataArray:[],linkDataArray:[]});const t=S[e];t?(console.log("\u2705 Dados encontrados para o n\xf3 selecionado:",t),C(s.current,t)):console.log(`\ud83d\udea8 ERRO: Nenhum dado encontrado para a chave '${e}'. Verifique 'subFlowchartData.js'.`)}),[e]);return(0,v.jsxs)("div",{className:"flowchart-container",children:[(0,v.jsx)("div",{className:"flowchart-diagram",ref:i}),o&&(0,v.jsx)("button",{className:"content-button",onClick:()=>{console.log("\ud83d\udccc LowerFlowchart: Bot\xe3o 'Conte\xfado' pressionado."),l(!0)},children:"Conte\xfado"},h),(0,v.jsx)(w,{isOpen:a,onClose:()=>l(!1),onModalClose:()=>r(null),content:o?o.text:"Nenhum n\xf3 selecionado",description:o?o.description:"Sem detalhes dispon\xedveis."})]})},T=()=>{const[t,e]=(0,n.useState)(null),[i,s]=(0,n.useState)(!1),[o,r]=(0,n.useState)(0);return(0,v.jsxs)("div",{className:"dual-flowchart-container",children:[(0,v.jsxs)("div",{className:"reset-container",onClick:()=>{console.log("\ud83d\udd04 Resetando fluxogramas..."),e(null),s(!1),r(Date.now())},children:["\ud83d\udd04",(0,v.jsx)("span",{children:"Resetar"})]}),(0,v.jsx)("div",{className:"watermark-blocker blocker-top"}),(0,v.jsx)("div",{className:"watermark-blocker blocker-bottom"}),(0,v.jsx)("div",{className:"upper-flowchart-container",children:(0,v.jsx)(k,{onNodeSelect:t=>{console.log("Upper node selected:",t),e(t)},selectedUpperNode:t,setSelectedUpperNode:e,isUpperModalOpen:i,setIsUpperModalOpen:s},o)}),(0,v.jsx)("div",{className:"lower-flowchart-container",children:(0,v.jsx)(N,{selectedUpperNodeKey:t?t.key:null},o)})]})};const L=function(){return(0,v.jsx)("div",{className:"App",children:(0,v.jsx)(T,{})})},A=t=>{t&&t instanceof Function&&i.e(453).then(i.bind(i,453)).then((e=>{let{getCLS:i,getFID:n,getFCP:s,getLCP:o,getTTFB:r}=e;i(t),n(t),s(t),o(t),r(t)}))};s.createRoot(document.getElementById("root")).render((0,v.jsx)(n.StrictMode,{children:(0,v.jsx)(L,{})})),A()})();
//# sourceMappingURL=main.d30b9e2f.js.map